var fne=Object.defineProperty;var pne=(n,e,t)=>e in n?fne(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ut=(n,e,t)=>pne(n,typeof e!="symbol"?e+"":e,t);function mne(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in n)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function Oj(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function gne(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var i=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:function(){return n[s]}})}),t}var IN={exports:{}},rb={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C3;function yne(){if(C3)return rb;C3=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(s,i,r){var o=null;if(r!==void 0&&(o=""+r),i.key!==void 0&&(o=""+i.key),"key"in i){r={};for(var a in i)a!=="key"&&(r[a]=i[a])}else r=i;return i=r.ref,{$$typeof:n,type:s,key:o,ref:i!==void 0?i:null,props:r}}return rb.Fragment=e,rb.jsx=t,rb.jsxs=t,rb}var I3;function bne(){return I3||(I3=1,IN.exports=yne()),IN.exports}var be=bne(),kN={exports:{}},ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k3;function vne(){if(k3)return ft;k3=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function p(H){return H===null||typeof H!="object"?null:(H=f&&H[f]||H["@@iterator"],typeof H=="function"?H:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,x={};function v(H,ee,he){this.props=H,this.context=ee,this.refs=x,this.updater=he||g}v.prototype.isReactComponent={},v.prototype.setState=function(H,ee){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ee,"setState")},v.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function w(){}w.prototype=v.prototype;function S(H,ee,he){this.props=H,this.context=ee,this.refs=x,this.updater=he||g}var C=S.prototype=new w;C.constructor=S,y(C,v.prototype),C.isPureReactComponent=!0;var I=Array.isArray,A={H:null,A:null,T:null,S:null},L=Object.prototype.hasOwnProperty;function O(H,ee,he,ae,pe,_e){return he=_e.ref,{$$typeof:n,type:H,key:ee,ref:he!==void 0?he:null,props:_e}}function N(H,ee){return O(H.type,ee,void 0,void 0,void 0,H.props)}function k(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function $(H){var ee={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(he){return ee[he]})}var R=/\/+/g;function z(H,ee){return typeof H=="object"&&H!==null&&H.key!=null?$(""+H.key):ee.toString(36)}function V(){}function ne(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(V,V):(H.status="pending",H.then(function(ee){H.status==="pending"&&(H.status="fulfilled",H.value=ee)},function(ee){H.status==="pending"&&(H.status="rejected",H.reason=ee)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function Q(H,ee,he,ae,pe){var _e=typeof H;(_e==="undefined"||_e==="boolean")&&(H=null);var Ee=!1;if(H===null)Ee=!0;else switch(_e){case"bigint":case"string":case"number":Ee=!0;break;case"object":switch(H.$$typeof){case n:case e:Ee=!0;break;case h:return Ee=H._init,Q(Ee(H._payload),ee,he,ae,pe)}}if(Ee)return pe=pe(H),Ee=ae===""?"."+z(H,0):ae,I(pe)?(he="",Ee!=null&&(he=Ee.replace(R,"$&/")+"/"),Q(pe,ee,he,"",function(Me){return Me})):pe!=null&&(k(pe)&&(pe=N(pe,he+(pe.key==null||H&&H.key===pe.key?"":(""+pe.key).replace(R,"$&/")+"/")+Ee)),ee.push(pe)),1;Ee=0;var Le=ae===""?".":ae+":";if(I(H))for(var $e=0;$e<H.length;$e++)ae=H[$e],_e=Le+z(ae,$e),Ee+=Q(ae,ee,he,_e,pe);else if($e=p(H),typeof $e=="function")for(H=$e.call(H),$e=0;!(ae=H.next()).done;)ae=ae.value,_e=Le+z(ae,$e++),Ee+=Q(ae,ee,he,_e,pe);else if(_e==="object"){if(typeof H.then=="function")return Q(ne(H),ee,he,ae,pe);throw ee=String(H),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return Ee}function G(H,ee,he){if(H==null)return H;var ae=[],pe=0;return Q(H,ae,"","",function(_e){return ee.call(he,_e,pe++)}),ae}function J(H){if(H._status===-1){var ee=H._result;ee=ee(),ee.then(function(he){(H._status===0||H._status===-1)&&(H._status=1,H._result=he)},function(he){(H._status===0||H._status===-1)&&(H._status=2,H._result=he)}),H._status===-1&&(H._status=0,H._result=ee)}if(H._status===1)return H._result.default;throw H._result}var Z=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)};function le(){}return ft.Children={map:G,forEach:function(H,ee,he){G(H,function(){ee.apply(this,arguments)},he)},count:function(H){var ee=0;return G(H,function(){ee++}),ee},toArray:function(H){return G(H,function(ee){return ee})||[]},only:function(H){if(!k(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},ft.Component=v,ft.Fragment=t,ft.Profiler=i,ft.PureComponent=S,ft.StrictMode=s,ft.Suspense=l,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ft.act=function(){throw Error("act(...) is not supported in production builds of React.")},ft.cache=function(H){return function(){return H.apply(null,arguments)}},ft.cloneElement=function(H,ee,he){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var ae=y({},H.props),pe=H.key,_e=void 0;if(ee!=null)for(Ee in ee.ref!==void 0&&(_e=void 0),ee.key!==void 0&&(pe=""+ee.key),ee)!L.call(ee,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&ee.ref===void 0||(ae[Ee]=ee[Ee]);var Ee=arguments.length-2;if(Ee===1)ae.children=he;else if(1<Ee){for(var Le=Array(Ee),$e=0;$e<Ee;$e++)Le[$e]=arguments[$e+2];ae.children=Le}return O(H.type,pe,void 0,void 0,_e,ae)},ft.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:r,_context:H},H},ft.createElement=function(H,ee,he){var ae,pe={},_e=null;if(ee!=null)for(ae in ee.key!==void 0&&(_e=""+ee.key),ee)L.call(ee,ae)&&ae!=="key"&&ae!=="__self"&&ae!=="__source"&&(pe[ae]=ee[ae]);var Ee=arguments.length-2;if(Ee===1)pe.children=he;else if(1<Ee){for(var Le=Array(Ee),$e=0;$e<Ee;$e++)Le[$e]=arguments[$e+2];pe.children=Le}if(H&&H.defaultProps)for(ae in Ee=H.defaultProps,Ee)pe[ae]===void 0&&(pe[ae]=Ee[ae]);return O(H,_e,void 0,void 0,null,pe)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(H){return{$$typeof:a,render:H}},ft.isValidElement=k,ft.lazy=function(H){return{$$typeof:h,_payload:{_status:-1,_result:H},_init:J}},ft.memo=function(H,ee){return{$$typeof:c,type:H,compare:ee===void 0?null:ee}},ft.startTransition=function(H){var ee=A.T,he={};A.T=he;try{var ae=H(),pe=A.S;pe!==null&&pe(he,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(le,Z)}catch(_e){Z(_e)}finally{A.T=ee}},ft.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ft.use=function(H){return A.H.use(H)},ft.useActionState=function(H,ee,he){return A.H.useActionState(H,ee,he)},ft.useCallback=function(H,ee){return A.H.useCallback(H,ee)},ft.useContext=function(H){return A.H.useContext(H)},ft.useDebugValue=function(){},ft.useDeferredValue=function(H,ee){return A.H.useDeferredValue(H,ee)},ft.useEffect=function(H,ee){return A.H.useEffect(H,ee)},ft.useId=function(){return A.H.useId()},ft.useImperativeHandle=function(H,ee,he){return A.H.useImperativeHandle(H,ee,he)},ft.useInsertionEffect=function(H,ee){return A.H.useInsertionEffect(H,ee)},ft.useLayoutEffect=function(H,ee){return A.H.useLayoutEffect(H,ee)},ft.useMemo=function(H,ee){return A.H.useMemo(H,ee)},ft.useOptimistic=function(H,ee){return A.H.useOptimistic(H,ee)},ft.useReducer=function(H,ee,he){return A.H.useReducer(H,ee,he)},ft.useRef=function(H){return A.H.useRef(H)},ft.useState=function(H){return A.H.useState(H)},ft.useSyncExternalStore=function(H,ee,he){return A.H.useSyncExternalStore(H,ee,he)},ft.useTransition=function(){return A.H.useTransition()},ft.version="19.0.0",ft}var N3;function hD(){return N3||(N3=1,kN.exports=vne()),kN.exports}var oe=hD();const Kl=Oj(oe);var NN={exports:{}},ob={},AN={exports:{}},RN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A3;function xne(){return A3||(A3=1,function(n){function e(G,J){var Z=G.length;G.push(J);e:for(;0<Z;){var le=Z-1>>>1,H=G[le];if(0<i(H,J))G[le]=J,G[Z]=H,Z=le;else break e}}function t(G){return G.length===0?null:G[0]}function s(G){if(G.length===0)return null;var J=G[0],Z=G.pop();if(Z!==J){G[0]=Z;e:for(var le=0,H=G.length,ee=H>>>1;le<ee;){var he=2*(le+1)-1,ae=G[he],pe=he+1,_e=G[pe];if(0>i(ae,Z))pe<H&&0>i(_e,ae)?(G[le]=_e,G[pe]=Z,le=pe):(G[le]=ae,G[he]=Z,le=he);else if(pe<H&&0>i(_e,Z))G[le]=_e,G[pe]=Z,le=pe;else break e}}return J}function i(G,J){var Z=G.sortIndex-J.sortIndex;return Z!==0?Z:G.id-J.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,f=null,p=3,g=!1,y=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function C(G){for(var J=t(c);J!==null;){if(J.callback===null)s(c);else if(J.startTime<=G)s(c),J.sortIndex=J.expirationTime,e(l,J);else break;J=t(c)}}function I(G){if(x=!1,C(G),!y)if(t(l)!==null)y=!0,ne();else{var J=t(c);J!==null&&Q(I,J.startTime-G)}}var A=!1,L=-1,O=5,N=-1;function k(){return!(n.unstable_now()-N<O)}function $(){if(A){var G=n.unstable_now();N=G;var J=!0;try{e:{y=!1,x&&(x=!1,w(L),L=-1),g=!0;var Z=p;try{t:{for(C(G),f=t(l);f!==null&&!(f.expirationTime>G&&k());){var le=f.callback;if(typeof le=="function"){f.callback=null,p=f.priorityLevel;var H=le(f.expirationTime<=G);if(G=n.unstable_now(),typeof H=="function"){f.callback=H,C(G),J=!0;break t}f===t(l)&&s(l),C(G)}else s(l);f=t(l)}if(f!==null)J=!0;else{var ee=t(c);ee!==null&&Q(I,ee.startTime-G),J=!1}}break e}finally{f=null,p=Z,g=!1}J=void 0}}finally{J?R():A=!1}}}var R;if(typeof S=="function")R=function(){S($)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,V=z.port2;z.port1.onmessage=$,R=function(){V.postMessage(null)}}else R=function(){v($,0)};function ne(){A||(A=!0,R())}function Q(G,J){L=v(function(){G(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){y||g||(y=!0,ne())},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(G){switch(p){case 1:case 2:case 3:var J=3;break;default:J=p}var Z=p;p=J;try{return G()}finally{p=Z}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,J){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var Z=p;p=G;try{return J()}finally{p=Z}},n.unstable_scheduleCallback=function(G,J,Z){var le=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?le+Z:le):Z=le,G){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=Z+H,G={id:h++,callback:J,priorityLevel:G,startTime:Z,expirationTime:H,sortIndex:-1},Z>le?(G.sortIndex=Z,e(c,G),t(l)===null&&G===t(c)&&(x?(w(L),L=-1):x=!0,Q(I,Z-le))):(G.sortIndex=H,e(l,G),y||g||(y=!0,ne())),G},n.unstable_shouldYield=k,n.unstable_wrapCallback=function(G){var J=p;return function(){var Z=p;p=J;try{return G.apply(this,arguments)}finally{p=Z}}}}(RN)),RN}var R3;function wne(){return R3||(R3=1,AN.exports=xne()),AN.exports}var DN={exports:{}},vi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D3;function _ne(){if(D3)return vi;D3=1;var n=hD();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var s={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function r(l,c,h){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:f==null?null:""+f,children:l,containerInfo:c,implementation:h}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return vi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,vi.createPortal=function(l,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return r(l,c,null,h)},vi.flushSync=function(l){var c=o.T,h=s.p;try{if(o.T=null,s.p=2,l)return l()}finally{o.T=c,s.p=h,s.d.f()}},vi.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,s.d.C(l,c))},vi.prefetchDNS=function(l){typeof l=="string"&&s.d.D(l)},vi.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var h=c.as,f=a(h,c.crossOrigin),p=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;h==="style"?s.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:f,integrity:p,fetchPriority:g}):h==="script"&&s.d.X(l,{crossOrigin:f,integrity:p,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},vi.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var h=a(c.as,c.crossOrigin);s.d.M(l,{crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&s.d.M(l)},vi.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var h=c.as,f=a(h,c.crossOrigin);s.d.L(l,h,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},vi.preloadModule=function(l,c){if(typeof l=="string")if(c){var h=a(c.as,c.crossOrigin);s.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else s.d.m(l)},vi.requestFormReset=function(l){s.d.r(l)},vi.unstable_batchedUpdates=function(l,c){return l(c)},vi.useFormState=function(l,c,h){return o.H.useFormState(l,c,h)},vi.useFormStatus=function(){return o.H.useHostTransitionStatus()},vi.version="19.0.0",vi}var $3;function Tne(){if($3)return DN.exports;$3=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),DN.exports=_ne(),DN.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O3;function Sne(){if(O3)return ob;O3=1;var n=wne(),e=hD(),t=Tne();function s(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}var r=Symbol.for("react.element"),o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.consumer"),g=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),C=Symbol.for("react.offscreen"),I=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function L(u){return u===null||typeof u!="object"?null:(u=A&&u[A]||u["@@iterator"],typeof u=="function"?u:null)}var O=Symbol.for("react.client.reference");function N(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===O?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case l:return"Fragment";case a:return"Portal";case h:return"Profiler";case c:return"StrictMode";case x:return"Suspense";case v:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case g:return(u.displayName||"Context")+".Provider";case p:return(u._context.displayName||"Context")+".Consumer";case y:var d=u.render;return u=u.displayName,u||(u=d.displayName||d.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case w:return d=u.displayName||null,d!==null?d:N(u.type)||"Memo";case S:d=u._payload,u=u._init;try{return N(u(d))}catch{}}return null}var k=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=Object.assign,R,z;function V(u){if(R===void 0)try{throw Error()}catch(m){var d=m.stack.trim().match(/\n( *(at )?)/);R=d&&d[1]||"",z=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+R+u+z}var ne=!1;function Q(u,d){if(!u||ne)return"";ne=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(d){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(Te){var ge=Te}Reflect.construct(u,[],Re)}else{try{Re.call()}catch(Te){ge=Te}u.call(Re.prototype)}}else{try{throw Error()}catch(Te){ge=Te}(Re=u())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(Te){if(Te&&ge&&typeof Te.stack=="string")return[Te.stack,ge.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var T=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");T&&T.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=b.DetermineComponentFrameRoot(),F=E[0],W=E[1];if(F&&W){var q=F.split(`
`),re=W.split(`
`);for(T=b=0;b<q.length&&!q[b].includes("DetermineComponentFrameRoot");)b++;for(;T<re.length&&!re[T].includes("DetermineComponentFrameRoot");)T++;if(b===q.length||T===re.length)for(b=q.length-1,T=re.length-1;1<=b&&0<=T&&q[b]!==re[T];)T--;for(;1<=b&&0<=T;b--,T--)if(q[b]!==re[T]){if(b!==1||T!==1)do if(b--,T--,0>T||q[b]!==re[T]){var Se=`
`+q[b].replace(" at new "," at ");return u.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",u.displayName)),Se}while(1<=b&&0<=T);break}}}finally{ne=!1,Error.prepareStackTrace=m}return(m=u?u.displayName||u.name:"")?V(m):""}function G(u){switch(u.tag){case 26:case 27:case 5:return V(u.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 15:return u=Q(u.type,!1),u;case 11:return u=Q(u.type.render,!1),u;case 1:return u=Q(u.type,!0),u;default:return""}}function J(u){try{var d="";do d+=G(u),u=u.return;while(u);return d}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}function Z(u){var d=u,m=u;if(u.alternate)for(;d.return;)d=d.return;else{u=d;do d=u,d.flags&4098&&(m=d.return),u=d.return;while(u)}return d.tag===3?m:null}function le(u){if(u.tag===13){var d=u.memoizedState;if(d===null&&(u=u.alternate,u!==null&&(d=u.memoizedState)),d!==null)return d.dehydrated}return null}function H(u){if(Z(u)!==u)throw Error(s(188))}function ee(u){var d=u.alternate;if(!d){if(d=Z(u),d===null)throw Error(s(188));return d!==u?null:u}for(var m=u,b=d;;){var T=m.return;if(T===null)break;var E=T.alternate;if(E===null){if(b=T.return,b!==null){m=b;continue}break}if(T.child===E.child){for(E=T.child;E;){if(E===m)return H(T),u;if(E===b)return H(T),d;E=E.sibling}throw Error(s(188))}if(m.return!==b.return)m=T,b=E;else{for(var F=!1,W=T.child;W;){if(W===m){F=!0,m=T,b=E;break}if(W===b){F=!0,b=T,m=E;break}W=W.sibling}if(!F){for(W=E.child;W;){if(W===m){F=!0,m=E,b=T;break}if(W===b){F=!0,b=E,m=T;break}W=W.sibling}if(!F)throw Error(s(189))}}if(m.alternate!==b)throw Error(s(190))}if(m.tag!==3)throw Error(s(188));return m.stateNode.current===m?u:d}function he(u){var d=u.tag;if(d===5||d===26||d===27||d===6)return u;for(u=u.child;u!==null;){if(d=he(u),d!==null)return d;u=u.sibling}return null}var ae=Array.isArray,pe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e={pending:!1,data:null,method:null,action:null},Ee=[],Le=-1;function $e(u){return{current:u}}function Me(u){0>Le||(u.current=Ee[Le],Ee[Le]=null,Le--)}function ze(u,d){Le++,Ee[Le]=u.current,u.current=d}var Ze=$e(null),yt=$e(null),bt=$e(null),Wt=$e(null);function Nt(u,d){switch(ze(bt,d),ze(yt,u),ze(Ze,null),u=d.nodeType,u){case 9:case 11:d=(d=d.documentElement)&&(d=d.namespaceURI)?t3(d):0;break;default:if(u=u===8?d.parentNode:d,d=u.tagName,u=u.namespaceURI)u=t3(u),d=n3(u,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}Me(Ze),ze(Ze,d)}function xt(){Me(Ze),Me(yt),Me(bt)}function Yt(u){u.memoizedState!==null&&ze(Wt,u);var d=Ze.current,m=n3(d,u.type);d!==m&&(ze(yt,u),ze(Ze,m))}function Ht(u){yt.current===u&&(Me(Ze),Me(yt)),Wt.current===u&&(Me(Wt),eb._currentValue=_e)}var yi=Object.prototype.hasOwnProperty,bn=n.unstable_scheduleCallback,Bi=n.unstable_cancelCallback,ii=n.unstable_shouldYield,Tr=n.unstable_requestPaint,vn=n.unstable_now,or=n.unstable_getCurrentPriorityLevel,an=n.unstable_ImmediatePriority,dn=n.unstable_UserBlockingPriority,Ms=n.unstable_NormalPriority,ca=n.unstable_LowPriority,al=n.unstable_IdlePriority,bh=n.log,ll=n.unstable_setDisableYieldValue,Sr=null,Fs=null;function vh(u){if(Fs&&typeof Fs.onCommitFiberRoot=="function")try{Fs.onCommitFiberRoot(Sr,u,void 0,(u.current.flags&128)===128)}catch{}}function ua(u){if(typeof bh=="function"&&ll(u),Fs&&typeof Fs.setStrictMode=="function")try{Fs.setStrictMode(Sr,u)}catch{}}var Ui=Math.clz32?Math.clz32:dw,iy=Math.log,hw=Math.LN2;function dw(u){return u>>>=0,u===0?32:31-(iy(u)/hw|0)|0}var ha=128,Cc=4194304;function Do(u){var d=u&42;if(d!==0)return d;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function Gr(u,d){var m=u.pendingLanes;if(m===0)return 0;var b=0,T=u.suspendedLanes,E=u.pingedLanes,F=u.warmLanes;u=u.finishedLanes!==0;var W=m&134217727;return W!==0?(m=W&~T,m!==0?b=Do(m):(E&=W,E!==0?b=Do(E):u||(F=W&~F,F!==0&&(b=Do(F))))):(W=m&~T,W!==0?b=Do(W):E!==0?b=Do(E):u||(F=m&~F,F!==0&&(b=Do(F)))),b===0?0:d!==0&&d!==b&&!(d&T)&&(T=b&-b,F=d&-d,T>=F||T===32&&(F&4194176)!==0)?d:b}function Ic(u,d){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&d)===0}function kf(u,d){switch(u){case 1:case 2:case 4:case 8:return d+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ry(){var u=ha;return ha<<=1,!(ha&4194176)&&(ha=128),u}function kc(){var u=Cc;return Cc<<=1,!(Cc&62914560)&&(Cc=4194304),u}function Nf(u){for(var d=[],m=0;31>m;m++)d.push(u);return d}function ts(u,d){u.pendingLanes|=d,d!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function fw(u,d,m,b,T,E){var F=u.pendingLanes;u.pendingLanes=m,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=m,u.entangledLanes&=m,u.errorRecoveryDisabledLanes&=m,u.shellSuspendCounter=0;var W=u.entanglements,q=u.expirationTimes,re=u.hiddenUpdates;for(m=F&~m;0<m;){var Se=31-Ui(m),Re=1<<Se;W[Se]=0,q[Se]=-1;var ge=re[Se];if(ge!==null)for(re[Se]=null,Se=0;Se<ge.length;Se++){var Te=ge[Se];Te!==null&&(Te.lane&=-536870913)}m&=~Re}b!==0&&Nc(u,b,0),E!==0&&T===0&&u.tag!==0&&(u.suspendedLanes|=E&~(F&~d))}function Nc(u,d,m){u.pendingLanes|=d,u.suspendedLanes&=~d;var b=31-Ui(d);u.entangledLanes|=d,u.entanglements[b]=u.entanglements[b]|1073741824|m&4194218}function Ac(u,d){var m=u.entangledLanes|=d;for(u=u.entanglements;m;){var b=31-Ui(m),T=1<<b;T&d|u[b]&d&&(u[b]|=d),m&=~T}}function pw(u){return u&=-u,2<u?8<u?u&134217727?32:268435456:8:2}function mw(){var u=pe.p;return u!==0?u:(u=window.event,u===void 0?32:x3(u.type))}function Rc(u,d){var m=pe.p;try{return pe.p=u,d()}finally{pe.p=m}}var da=Math.random().toString(36).slice(2),Vs="__reactFiber$"+da,_s="__reactProps$"+da,cl="__reactContainer$"+da,xh="__reactEvents$"+da,Af="__reactListeners$"+da,fa="__reactHandles$"+da,oy="__reactResources$"+da,Dc="__reactMarker$"+da;function wh(u){delete u[Vs],delete u[_s],delete u[xh],delete u[Af],delete u[fa]}function $o(u){var d=u[Vs];if(d)return d;for(var m=u.parentNode;m;){if(d=m[cl]||m[Vs]){if(m=d.alternate,d.child!==null||m!==null&&m.child!==null)for(u=r3(u);u!==null;){if(m=u[Vs])return m;u=r3(u)}return d}u=m,m=u.parentNode}return null}function ul(u){if(u=u[Vs]||u[cl]){var d=u.tag;if(d===5||d===6||d===13||d===26||d===27||d===3)return u}return null}function $c(u){var d=u.tag;if(d===5||d===26||d===27||d===6)return u.stateNode;throw Error(s(33))}function Oc(u){var d=u[oy];return d||(d=u[oy]={hoistableStyles:new Map,hoistableScripts:new Map}),d}function Pn(u){u[Dc]=!0}var ay=new Set,Rf={};function Er(u,d){ar(u,d),ar(u+"Capture",d)}function ar(u,d){for(Rf[u]=d,u=0;u<d.length;u++)ay.add(d[u])}var Cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),RI=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ly={},cy={};function gw(u){return yi.call(cy,u)?!0:yi.call(ly,u)?!1:RI.test(u)?cy[u]=!0:(ly[u]=!0,!1)}function Pc(u,d,m){if(gw(d))if(m===null)u.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":u.removeAttribute(d);return;case"boolean":var b=d.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){u.removeAttribute(d);return}}u.setAttribute(d,""+m)}}function Lc(u,d,m){if(m===null)u.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(d);return}u.setAttribute(d,""+m)}}function qr(u,d,m,b){if(b===null)u.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(m);return}u.setAttributeNS(d,m,""+b)}}function Wi(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function yw(u){var d=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function DI(u){var d=yw(u)?"checked":"value",m=Object.getOwnPropertyDescriptor(u.constructor.prototype,d),b=""+u[d];if(!u.hasOwnProperty(d)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var T=m.get,E=m.set;return Object.defineProperty(u,d,{configurable:!0,get:function(){return T.call(this)},set:function(F){b=""+F,E.call(this,F)}}),Object.defineProperty(u,d,{enumerable:m.enumerable}),{getValue:function(){return b},setValue:function(F){b=""+F},stopTracking:function(){u._valueTracker=null,delete u[d]}}}}function _h(u){u._valueTracker||(u._valueTracker=DI(u))}function uy(u){if(!u)return!1;var d=u._valueTracker;if(!d)return!0;var m=d.getValue(),b="";return u&&(b=yw(u)?u.checked?"true":"false":u.value),u=b,u!==m?(d.setValue(u),!0):!1}function Df(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var hl=/[\n"\\]/g;function Un(u){return u.replace(hl,function(d){return"\\"+d.charCodeAt(0).toString(16)+" "})}function Mc(u,d,m,b,T,E,F,W){u.name="",F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?u.type=F:u.removeAttribute("type"),d!=null?F==="number"?(d===0&&u.value===""||u.value!=d)&&(u.value=""+Wi(d)):u.value!==""+Wi(d)&&(u.value=""+Wi(d)):F!=="submit"&&F!=="reset"||u.removeAttribute("value"),d!=null?$f(u,F,Wi(d)):m!=null?$f(u,F,Wi(m)):b!=null&&u.removeAttribute("value"),T==null&&E!=null&&(u.defaultChecked=!!E),T!=null&&(u.checked=T&&typeof T!="function"&&typeof T!="symbol"),W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?u.name=""+Wi(W):u.removeAttribute("name")}function Th(u,d,m,b,T,E,F,W){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(u.type=E),d!=null||m!=null){if(!(E!=="submit"&&E!=="reset"||d!=null))return;m=m!=null?""+Wi(m):"",d=d!=null?""+Wi(d):m,W||d===u.value||(u.value=d),u.defaultValue=d}b=b??T,b=typeof b!="function"&&typeof b!="symbol"&&!!b,u.checked=W?u.checked:!!b,u.defaultChecked=!!b,F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"&&(u.name=F)}function $f(u,d,m){d==="number"&&Df(u.ownerDocument)===u||u.defaultValue===""+m||(u.defaultValue=""+m)}function jt(u,d,m,b){if(u=u.options,d){d={};for(var T=0;T<m.length;T++)d["$"+m[T]]=!0;for(m=0;m<u.length;m++)T=d.hasOwnProperty("$"+u[m].value),u[m].selected!==T&&(u[m].selected=T),T&&b&&(u[m].defaultSelected=!0)}else{for(m=""+Wi(m),d=null,T=0;T<u.length;T++){if(u[T].value===m){u[T].selected=!0,b&&(u[T].defaultSelected=!0);return}d!==null||u[T].disabled||(d=u[T])}d!==null&&(d.selected=!0)}}function Sh(u,d,m){if(d!=null&&(d=""+Wi(d),d!==u.value&&(u.value=d),m==null)){u.defaultValue!==d&&(u.defaultValue=d);return}u.defaultValue=m!=null?""+Wi(m):""}function Fc(u,d,m,b){if(d==null){if(b!=null){if(m!=null)throw Error(s(92));if(ae(b)){if(1<b.length)throw Error(s(93));b=b[0]}m=b}m==null&&(m=""),d=m}m=Wi(d),u.defaultValue=m,b=u.textContent,b===m&&b!==""&&b!==null&&(u.value=b)}function Kr(u,d){if(d){var m=u.firstChild;if(m&&m===u.lastChild&&m.nodeType===3){m.nodeValue=d;return}}u.textContent=d}var $I=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function hy(u,d,m){var b=d.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?b?u.setProperty(d,""):d==="float"?u.cssFloat="":u[d]="":b?u.setProperty(d,m):typeof m!="number"||m===0||$I.has(d)?d==="float"?u.cssFloat=m:u[d]=(""+m).trim():u[d]=m+"px"}function bw(u,d,m){if(d!=null&&typeof d!="object")throw Error(s(62));if(u=u.style,m!=null){for(var b in m)!m.hasOwnProperty(b)||d!=null&&d.hasOwnProperty(b)||(b.indexOf("--")===0?u.setProperty(b,""):b==="float"?u.cssFloat="":u[b]="");for(var T in d)b=d[T],d.hasOwnProperty(T)&&m[T]!==b&&hy(u,T,b)}else for(var E in d)d.hasOwnProperty(E)&&hy(u,E,d[E])}function dy(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var OI=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),PI=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function pa(u){return PI.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}var Xr=null;function Of(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var dl=null,fl=null;function pl(u){var d=ul(u);if(d&&(u=d.stateNode)){var m=u[_s]||null;e:switch(u=d.stateNode,d.type){case"input":if(Mc(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),d=m.name,m.type==="radio"&&d!=null){for(m=u;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+Un(""+d)+'"][type="radio"]'),d=0;d<m.length;d++){var b=m[d];if(b!==u&&b.form===u.form){var T=b[_s]||null;if(!T)throw Error(s(90));Mc(b,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name)}}for(d=0;d<m.length;d++)b=m[d],b.form===u.form&&uy(b)}break e;case"textarea":Sh(u,m.value,m.defaultValue);break e;case"select":d=m.value,d!=null&&jt(u,!!m.multiple,d,!1)}}}var fy=!1;function vw(u,d,m){if(fy)return u(d,m);fy=!0;try{var b=u(d);return b}finally{if(fy=!1,(dl!==null||fl!==null)&&(u_(),dl&&(d=dl,u=fl,fl=dl=null,pl(d),u)))for(d=0;d<u.length;d++)pl(u[d])}}function Eh(u,d){var m=u.stateNode;if(m===null)return null;var b=m[_s]||null;if(b===null)return null;m=b[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(u=u.type,b=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!b;break e;default:u=!1}if(u)return null;if(m&&typeof m!="function")throw Error(s(231,d,typeof m));return m}var Yr=!1;if(Cr)try{var Ch={};Object.defineProperty(Ch,"passive",{get:function(){Yr=!0}}),window.addEventListener("test",Ch,Ch),window.removeEventListener("test",Ch,Ch)}catch{Yr=!1}var ma=null,Vc=null,ml=null;function py(){if(ml)return ml;var u,d=Vc,m=d.length,b,T="value"in ma?ma.value:ma.textContent,E=T.length;for(u=0;u<m&&d[u]===T[u];u++);var F=m-u;for(b=1;b<=F&&d[m-b]===T[E-b];b++);return ml=T.slice(u,1<b?1-b:void 0)}function ga(u){var d=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&d===13&&(u=13)):u=d,u===10&&(u=13),32<=u||u===13?u:0}function ya(){return!0}function my(){return!1}function zs(u){function d(m,b,T,E,F){this._reactName=m,this._targetInst=T,this.type=b,this.nativeEvent=E,this.target=F,this.currentTarget=null;for(var W in u)u.hasOwnProperty(W)&&(m=u[W],this[W]=m?m(E):E[W]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?ya:my,this.isPropagationStopped=my,this}return $(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=ya)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=ya)},persist:function(){},isPersistent:ya}),d}var Qt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pf=zs(Qt),Ih=$({},Qt,{view:0,detail:0}),xw=zs(Ih),Lf,Mf,ba,kh=$({},Ih,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rh,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==ba&&(ba&&u.type==="mousemove"?(Lf=u.screenX-ba.screenX,Mf=u.screenY-ba.screenY):Mf=Lf=0,ba=u),Lf)},movementY:function(u){return"movementY"in u?u.movementY:Mf}}),Qr=zs(kh),ww=$({},kh,{dataTransfer:0}),LI=zs(ww),Nh=$({},Ih,{relatedTarget:0}),Ff=zs(Nh),gy=$({},Qt,{animationName:0,elapsedTime:0,pseudoElement:0}),Vf=zs(gy),_w=$({},Qt,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),zf=zs(_w),MI=$({},Qt,{data:0}),yy=zs(MI),Ah={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function by(u){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(u):(u=Sw[u])?!!d[u]:!1}function Rh(){return by}var Ew=$({},Ih,{key:function(u){if(u.key){var d=Ah[u.key]||u.key;if(d!=="Unidentified")return d}return u.type==="keypress"?(u=ga(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?Tw[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rh,charCode:function(u){return u.type==="keypress"?ga(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?ga(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Bf=zs(Ew),Cw=$({},kh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vy=zs(Cw),gl=$({},Ih,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rh}),Iw=zs(gl),kw=$({},Qt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nw=zs(kw),Aw=$({},kh,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),Uf=zs(Aw),Hi=$({},Qt,{newState:0,oldState:0}),Rw=zs(Hi),Dw=[9,13,27,32],va=Cr&&"CompositionEvent"in window,_=null;Cr&&"documentMode"in document&&(_=document.documentMode);var D=Cr&&"TextEvent"in window&&!_,M=Cr&&(!va||_&&8<_&&11>=_),j=" ",fe=!1;function xe(u,d){switch(u){case"keyup":return Dw.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oe(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Pt=!1;function Ts(u,d){switch(u){case"compositionend":return Oe(d);case"keypress":return d.which!==32?null:(fe=!0,j);case"textInput":return u=d.data,u===j&&fe?null:u;default:return null}}function Lt(u,d){if(Pt)return u==="compositionend"||!va&&xe(u,d)?(u=py(),ml=Vc=ma=null,Pt=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return M&&d.locale!=="ko"?null:d.data;default:return null}}var Bs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ss(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d==="input"?!!Bs[u.type]:d==="textarea"}function yl(u,d,m,b){dl?fl?fl.push(b):fl=[b]:dl=b,d=m_(d,"onChange"),0<d.length&&(m=new Pf("onChange","change",null,m,b),u.push({event:m,listeners:d}))}var ri=null,xa=null;function xy(u){YV(u,0)}function $w(u){var d=$c(u);if(uy(d))return u}function EM(u,d){if(u==="change")return d}var CM=!1;if(Cr){var FI;if(Cr){var VI="oninput"in document;if(!VI){var IM=document.createElement("div");IM.setAttribute("oninput","return;"),VI=typeof IM.oninput=="function"}FI=VI}else FI=!1;CM=FI&&(!document.documentMode||9<document.documentMode)}function kM(){ri&&(ri.detachEvent("onpropertychange",NM),xa=ri=null)}function NM(u){if(u.propertyName==="value"&&$w(xa)){var d=[];yl(d,xa,u,Of(u)),vw(xy,d)}}function Wee(u,d,m){u==="focusin"?(kM(),ri=d,xa=m,ri.attachEvent("onpropertychange",NM)):u==="focusout"&&kM()}function Hee(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return $w(xa)}function jee(u,d){if(u==="click")return $w(d)}function Gee(u,d){if(u==="input"||u==="change")return $w(d)}function qee(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var Ir=typeof Object.is=="function"?Object.is:qee;function wy(u,d){if(Ir(u,d))return!0;if(typeof u!="object"||u===null||typeof d!="object"||d===null)return!1;var m=Object.keys(u),b=Object.keys(d);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var T=m[b];if(!yi.call(d,T)||!Ir(u[T],d[T]))return!1}return!0}function AM(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function RM(u,d){var m=AM(u);u=0;for(var b;m;){if(m.nodeType===3){if(b=u+m.textContent.length,u<=d&&b>=d)return{node:m,offset:d-u};u=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=AM(m)}}function DM(u,d){return u&&d?u===d?!0:u&&u.nodeType===3?!1:d&&d.nodeType===3?DM(u,d.parentNode):"contains"in u?u.contains(d):u.compareDocumentPosition?!!(u.compareDocumentPosition(d)&16):!1:!1}function $M(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var d=Df(u.document);d instanceof u.HTMLIFrameElement;){try{var m=typeof d.contentWindow.location.href=="string"}catch{m=!1}if(m)u=d.contentWindow;else break;d=Df(u.document)}return d}function zI(u){var d=u&&u.nodeName&&u.nodeName.toLowerCase();return d&&(d==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||d==="textarea"||u.contentEditable==="true")}function Kee(u,d){var m=$M(d);d=u.focusedElem;var b=u.selectionRange;if(m!==d&&d&&d.ownerDocument&&DM(d.ownerDocument.documentElement,d)){if(b!==null&&zI(d)){if(u=b.start,m=b.end,m===void 0&&(m=u),"selectionStart"in d)d.selectionStart=u,d.selectionEnd=Math.min(m,d.value.length);else if(m=(u=d.ownerDocument||document)&&u.defaultView||window,m.getSelection){m=m.getSelection();var T=d.textContent.length,E=Math.min(b.start,T);b=b.end===void 0?E:Math.min(b.end,T),!m.extend&&E>b&&(T=b,b=E,E=T),T=RM(d,E);var F=RM(d,b);T&&F&&(m.rangeCount!==1||m.anchorNode!==T.node||m.anchorOffset!==T.offset||m.focusNode!==F.node||m.focusOffset!==F.offset)&&(u=u.createRange(),u.setStart(T.node,T.offset),m.removeAllRanges(),E>b?(m.addRange(u),m.extend(F.node,F.offset)):(u.setEnd(F.node,F.offset),m.addRange(u)))}}for(u=[],m=d;m=m.parentNode;)m.nodeType===1&&u.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<u.length;d++)m=u[d],m.element.scrollLeft=m.left,m.element.scrollTop=m.top}}var Xee=Cr&&"documentMode"in document&&11>=document.documentMode,Wf=null,BI=null,_y=null,UI=!1;function OM(u,d,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;UI||Wf==null||Wf!==Df(b)||(b=Wf,"selectionStart"in b&&zI(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),_y&&wy(_y,b)||(_y=b,b=m_(BI,"onSelect"),0<b.length&&(d=new Pf("onSelect","select",null,d,m),u.push({event:d,listeners:b}),d.target=Wf)))}function Dh(u,d){var m={};return m[u.toLowerCase()]=d.toLowerCase(),m["Webkit"+u]="webkit"+d,m["Moz"+u]="moz"+d,m}var Hf={animationend:Dh("Animation","AnimationEnd"),animationiteration:Dh("Animation","AnimationIteration"),animationstart:Dh("Animation","AnimationStart"),transitionrun:Dh("Transition","TransitionRun"),transitionstart:Dh("Transition","TransitionStart"),transitioncancel:Dh("Transition","TransitionCancel"),transitionend:Dh("Transition","TransitionEnd")},WI={},PM={};Cr&&(PM=document.createElement("div").style,"AnimationEvent"in window||(delete Hf.animationend.animation,delete Hf.animationiteration.animation,delete Hf.animationstart.animation),"TransitionEvent"in window||delete Hf.transitionend.transition);function $h(u){if(WI[u])return WI[u];if(!Hf[u])return u;var d=Hf[u],m;for(m in d)if(d.hasOwnProperty(m)&&m in PM)return WI[u]=d[m];return u}var LM=$h("animationend"),MM=$h("animationiteration"),FM=$h("animationstart"),Yee=$h("transitionrun"),Qee=$h("transitionstart"),Zee=$h("transitioncancel"),VM=$h("transitionend"),zM=new Map,BM="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Oo(u,d){zM.set(u,d),Er(d,[u])}var Zr=[],jf=0,HI=0;function Ow(){for(var u=jf,d=HI=jf=0;d<u;){var m=Zr[d];Zr[d++]=null;var b=Zr[d];Zr[d++]=null;var T=Zr[d];Zr[d++]=null;var E=Zr[d];if(Zr[d++]=null,b!==null&&T!==null){var F=b.pending;F===null?T.next=T:(T.next=F.next,F.next=T),b.pending=T}E!==0&&UM(m,T,E)}}function Pw(u,d,m,b){Zr[jf++]=u,Zr[jf++]=d,Zr[jf++]=m,Zr[jf++]=b,HI|=b,u.lanes|=b,u=u.alternate,u!==null&&(u.lanes|=b)}function jI(u,d,m,b){return Pw(u,d,m,b),Lw(u)}function zc(u,d){return Pw(u,null,null,d),Lw(u)}function UM(u,d,m){u.lanes|=m;var b=u.alternate;b!==null&&(b.lanes|=m);for(var T=!1,E=u.return;E!==null;)E.childLanes|=m,b=E.alternate,b!==null&&(b.childLanes|=m),E.tag===22&&(u=E.stateNode,u===null||u._visibility&1||(T=!0)),u=E,E=E.return;T&&d!==null&&u.tag===3&&(E=u.stateNode,T=31-Ui(m),E=E.hiddenUpdates,u=E[T],u===null?E[T]=[d]:u.push(d),d.lane=m|536870912)}function Lw(u){if(50<qy)throw qy=0,Qk=null,Error(s(185));for(var d=u.return;d!==null;)u=d,d=u.return;return u.tag===3?u.stateNode:null}var Gf={},WM=new WeakMap;function Jr(u,d){if(typeof u=="object"&&u!==null){var m=WM.get(u);return m!==void 0?m:(d={value:u,source:d,stack:J(d)},WM.set(u,d),d)}return{value:u,source:d,stack:J(d)}}var qf=[],Kf=0,Mw=null,Fw=0,eo=[],to=0,Oh=null,bl=1,vl="";function Ph(u,d){qf[Kf++]=Fw,qf[Kf++]=Mw,Mw=u,Fw=d}function HM(u,d,m){eo[to++]=bl,eo[to++]=vl,eo[to++]=Oh,Oh=u;var b=bl;u=vl;var T=32-Ui(b)-1;b&=~(1<<T),m+=1;var E=32-Ui(d)+T;if(30<E){var F=T-T%5;E=(b&(1<<F)-1).toString(32),b>>=F,T-=F,bl=1<<32-Ui(d)+T|m<<T|b,vl=E+u}else bl=1<<E|m<<T|b,vl=u}function GI(u){u.return!==null&&(Ph(u,1),HM(u,1,0))}function qI(u){for(;u===Mw;)Mw=qf[--Kf],qf[Kf]=null,Fw=qf[--Kf],qf[Kf]=null;for(;u===Oh;)Oh=eo[--to],eo[to]=null,vl=eo[--to],eo[to]=null,bl=eo[--to],eo[to]=null}var ji=null,oi=null,Gt=!1,Po=null,wa=!1,KI=Error(s(519));function Lh(u){var d=Error(s(418,""));throw Ey(Jr(d,u)),KI}function jM(u){var d=u.stateNode,m=u.type,b=u.memoizedProps;switch(d[Vs]=u,d[_s]=b,m){case"dialog":Rt("cancel",d),Rt("close",d);break;case"iframe":case"object":case"embed":Rt("load",d);break;case"video":case"audio":for(m=0;m<Xy.length;m++)Rt(Xy[m],d);break;case"source":Rt("error",d);break;case"img":case"image":case"link":Rt("error",d),Rt("load",d);break;case"details":Rt("toggle",d);break;case"input":Rt("invalid",d),Th(d,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0),_h(d);break;case"select":Rt("invalid",d);break;case"textarea":Rt("invalid",d),Fc(d,b.value,b.defaultValue,b.children),_h(d)}m=b.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||d.textContent===""+m||b.suppressHydrationWarning===!0||e3(d.textContent,m)?(b.popover!=null&&(Rt("beforetoggle",d),Rt("toggle",d)),b.onScroll!=null&&Rt("scroll",d),b.onScrollEnd!=null&&Rt("scrollend",d),b.onClick!=null&&(d.onclick=g_),d=!0):d=!1,d||Lh(u)}function GM(u){for(ji=u.return;ji;)switch(ji.tag){case 3:case 27:wa=!0;return;case 5:case 13:wa=!1;return;default:ji=ji.return}}function Ty(u){if(u!==ji)return!1;if(!Gt)return GM(u),Gt=!0,!1;var d=!1,m;if((m=u.tag!==3&&u.tag!==27)&&((m=u.tag===5)&&(m=u.type,m=!(m!=="form"&&m!=="button")||pN(u.type,u.memoizedProps)),m=!m),m&&(d=!0),d&&oi&&Lh(u),GM(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));e:{for(u=u.nextSibling,d=0;u;){if(u.nodeType===8)if(m=u.data,m==="/$"){if(d===0){oi=Mo(u.nextSibling);break e}d--}else m!=="$"&&m!=="$!"&&m!=="$?"||d++;u=u.nextSibling}oi=null}}else oi=ji?Mo(u.stateNode.nextSibling):null;return!0}function Sy(){oi=ji=null,Gt=!1}function Ey(u){Po===null?Po=[u]:Po.push(u)}var Cy=Error(s(460)),qM=Error(s(474)),XI={then:function(){}};function KM(u){return u=u.status,u==="fulfilled"||u==="rejected"}function Vw(){}function XM(u,d,m){switch(m=u[m],m===void 0?u.push(d):m!==d&&(d.then(Vw,Vw),d=m),d.status){case"fulfilled":return d.value;case"rejected":throw u=d.reason,u===Cy?Error(s(483)):u;default:if(typeof d.status=="string")d.then(Vw,Vw);else{if(u=xn,u!==null&&100<u.shellSuspendCounter)throw Error(s(482));u=d,u.status="pending",u.then(function(b){if(d.status==="pending"){var T=d;T.status="fulfilled",T.value=b}},function(b){if(d.status==="pending"){var T=d;T.status="rejected",T.reason=b}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw u=d.reason,u===Cy?Error(s(483)):u}throw Iy=d,Cy}}var Iy=null;function YM(){if(Iy===null)throw Error(s(459));var u=Iy;return Iy=null,u}var Xf=null,ky=0;function zw(u){var d=ky;return ky+=1,Xf===null&&(Xf=[]),XM(Xf,u,d)}function Ny(u,d){d=d.props.ref,u.ref=d!==void 0?d:null}function Bw(u,d){throw d.$$typeof===r?Error(s(525)):(u=Object.prototype.toString.call(d),Error(s(31,u==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":u)))}function QM(u){var d=u._init;return d(u._payload)}function ZM(u){function d(ue,ie){if(u){var me=ue.deletions;me===null?(ue.deletions=[ie],ue.flags|=16):me.push(ie)}}function m(ue,ie){if(!u)return null;for(;ie!==null;)d(ue,ie),ie=ie.sibling;return null}function b(ue){for(var ie=new Map;ue!==null;)ue.key!==null?ie.set(ue.key,ue):ie.set(ue.index,ue),ue=ue.sibling;return ie}function T(ue,ie){return ue=Zc(ue,ie),ue.index=0,ue.sibling=null,ue}function E(ue,ie,me){return ue.index=me,u?(me=ue.alternate,me!==null?(me=me.index,me<ie?(ue.flags|=33554434,ie):me):(ue.flags|=33554434,ie)):(ue.flags|=1048576,ie)}function F(ue){return u&&ue.alternate===null&&(ue.flags|=33554434),ue}function W(ue,ie,me,Ce){return ie===null||ie.tag!==6?(ie=Wk(me,ue.mode,Ce),ie.return=ue,ie):(ie=T(ie,me),ie.return=ue,ie)}function q(ue,ie,me,Ce){var je=me.type;return je===l?Se(ue,ie,me.props.children,Ce,me.key):ie!==null&&(ie.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===S&&QM(je)===ie.type)?(ie=T(ie,me.props),Ny(ie,me),ie.return=ue,ie):(ie=r_(me.type,me.key,me.props,null,ue.mode,Ce),Ny(ie,me),ie.return=ue,ie)}function re(ue,ie,me,Ce){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==me.containerInfo||ie.stateNode.implementation!==me.implementation?(ie=Hk(me,ue.mode,Ce),ie.return=ue,ie):(ie=T(ie,me.children||[]),ie.return=ue,ie)}function Se(ue,ie,me,Ce,je){return ie===null||ie.tag!==7?(ie=Gh(me,ue.mode,Ce,je),ie.return=ue,ie):(ie=T(ie,me),ie.return=ue,ie)}function Re(ue,ie,me){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=Wk(""+ie,ue.mode,me),ie.return=ue,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case o:return me=r_(ie.type,ie.key,ie.props,null,ue.mode,me),Ny(me,ie),me.return=ue,me;case a:return ie=Hk(ie,ue.mode,me),ie.return=ue,ie;case S:var Ce=ie._init;return ie=Ce(ie._payload),Re(ue,ie,me)}if(ae(ie)||L(ie))return ie=Gh(ie,ue.mode,me,null),ie.return=ue,ie;if(typeof ie.then=="function")return Re(ue,zw(ie),me);if(ie.$$typeof===g)return Re(ue,n_(ue,ie),me);Bw(ue,ie)}return null}function ge(ue,ie,me,Ce){var je=ie!==null?ie.key:null;if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return je!==null?null:W(ue,ie,""+me,Ce);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case o:return me.key===je?q(ue,ie,me,Ce):null;case a:return me.key===je?re(ue,ie,me,Ce):null;case S:return je=me._init,me=je(me._payload),ge(ue,ie,me,Ce)}if(ae(me)||L(me))return je!==null?null:Se(ue,ie,me,Ce,null);if(typeof me.then=="function")return ge(ue,ie,zw(me),Ce);if(me.$$typeof===g)return ge(ue,ie,n_(ue,me),Ce);Bw(ue,me)}return null}function Te(ue,ie,me,Ce,je){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return ue=ue.get(me)||null,W(ie,ue,""+Ce,je);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case o:return ue=ue.get(Ce.key===null?me:Ce.key)||null,q(ie,ue,Ce,je);case a:return ue=ue.get(Ce.key===null?me:Ce.key)||null,re(ie,ue,Ce,je);case S:var Tt=Ce._init;return Ce=Tt(Ce._payload),Te(ue,ie,me,Ce,je)}if(ae(Ce)||L(Ce))return ue=ue.get(me)||null,Se(ie,ue,Ce,je,null);if(typeof Ce.then=="function")return Te(ue,ie,me,zw(Ce),je);if(Ce.$$typeof===g)return Te(ue,ie,me,n_(ie,Ce),je);Bw(ie,Ce)}return null}function Xe(ue,ie,me,Ce){for(var je=null,Tt=null,Je=ie,tt=ie=0,Hs=null;Je!==null&&tt<me.length;tt++){Je.index>tt?(Hs=Je,Je=null):Hs=Je.sibling;var qt=ge(ue,Je,me[tt],Ce);if(qt===null){Je===null&&(Je=Hs);break}u&&Je&&qt.alternate===null&&d(ue,Je),ie=E(qt,ie,tt),Tt===null?je=qt:Tt.sibling=qt,Tt=qt,Je=Hs}if(tt===me.length)return m(ue,Je),Gt&&Ph(ue,tt),je;if(Je===null){for(;tt<me.length;tt++)Je=Re(ue,me[tt],Ce),Je!==null&&(ie=E(Je,ie,tt),Tt===null?je=Je:Tt.sibling=Je,Tt=Je);return Gt&&Ph(ue,tt),je}for(Je=b(Je);tt<me.length;tt++)Hs=Te(Je,ue,tt,me[tt],Ce),Hs!==null&&(u&&Hs.alternate!==null&&Je.delete(Hs.key===null?tt:Hs.key),ie=E(Hs,ie,tt),Tt===null?je=Hs:Tt.sibling=Hs,Tt=Hs);return u&&Je.forEach(function(ru){return d(ue,ru)}),Gt&&Ph(ue,tt),je}function lt(ue,ie,me,Ce){if(me==null)throw Error(s(151));for(var je=null,Tt=null,Je=ie,tt=ie=0,Hs=null,qt=me.next();Je!==null&&!qt.done;tt++,qt=me.next()){Je.index>tt?(Hs=Je,Je=null):Hs=Je.sibling;var ru=ge(ue,Je,qt.value,Ce);if(ru===null){Je===null&&(Je=Hs);break}u&&Je&&ru.alternate===null&&d(ue,Je),ie=E(ru,ie,tt),Tt===null?je=ru:Tt.sibling=ru,Tt=ru,Je=Hs}if(qt.done)return m(ue,Je),Gt&&Ph(ue,tt),je;if(Je===null){for(;!qt.done;tt++,qt=me.next())qt=Re(ue,qt.value,Ce),qt!==null&&(ie=E(qt,ie,tt),Tt===null?je=qt:Tt.sibling=qt,Tt=qt);return Gt&&Ph(ue,tt),je}for(Je=b(Je);!qt.done;tt++,qt=me.next())qt=Te(Je,ue,tt,qt.value,Ce),qt!==null&&(u&&qt.alternate!==null&&Je.delete(qt.key===null?tt:qt.key),ie=E(qt,ie,tt),Tt===null?je=qt:Tt.sibling=qt,Tt=qt);return u&&Je.forEach(function(dne){return d(ue,dne)}),Gt&&Ph(ue,tt),je}function jn(ue,ie,me,Ce){if(typeof me=="object"&&me!==null&&me.type===l&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case o:e:{for(var je=me.key;ie!==null;){if(ie.key===je){if(je=me.type,je===l){if(ie.tag===7){m(ue,ie.sibling),Ce=T(ie,me.props.children),Ce.return=ue,ue=Ce;break e}}else if(ie.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===S&&QM(je)===ie.type){m(ue,ie.sibling),Ce=T(ie,me.props),Ny(Ce,me),Ce.return=ue,ue=Ce;break e}m(ue,ie);break}else d(ue,ie);ie=ie.sibling}me.type===l?(Ce=Gh(me.props.children,ue.mode,Ce,me.key),Ce.return=ue,ue=Ce):(Ce=r_(me.type,me.key,me.props,null,ue.mode,Ce),Ny(Ce,me),Ce.return=ue,ue=Ce)}return F(ue);case a:e:{for(je=me.key;ie!==null;){if(ie.key===je)if(ie.tag===4&&ie.stateNode.containerInfo===me.containerInfo&&ie.stateNode.implementation===me.implementation){m(ue,ie.sibling),Ce=T(ie,me.children||[]),Ce.return=ue,ue=Ce;break e}else{m(ue,ie);break}else d(ue,ie);ie=ie.sibling}Ce=Hk(me,ue.mode,Ce),Ce.return=ue,ue=Ce}return F(ue);case S:return je=me._init,me=je(me._payload),jn(ue,ie,me,Ce)}if(ae(me))return Xe(ue,ie,me,Ce);if(L(me)){if(je=L(me),typeof je!="function")throw Error(s(150));return me=je.call(me),lt(ue,ie,me,Ce)}if(typeof me.then=="function")return jn(ue,ie,zw(me),Ce);if(me.$$typeof===g)return jn(ue,ie,n_(ue,me),Ce);Bw(ue,me)}return typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint"?(me=""+me,ie!==null&&ie.tag===6?(m(ue,ie.sibling),Ce=T(ie,me),Ce.return=ue,ue=Ce):(m(ue,ie),Ce=Wk(me,ue.mode,Ce),Ce.return=ue,ue=Ce),F(ue)):m(ue,ie)}return function(ue,ie,me,Ce){try{ky=0;var je=jn(ue,ie,me,Ce);return Xf=null,je}catch(Je){if(Je===Cy)throw Je;var Tt=ro(29,Je,null,ue.mode);return Tt.lanes=Ce,Tt.return=ue,Tt}finally{}}}var Mh=ZM(!0),JM=ZM(!1),Yf=$e(null),Uw=$e(0);function eF(u,d){u=Al,ze(Uw,u),ze(Yf,d),Al=u|d.baseLanes}function YI(){ze(Uw,Al),ze(Yf,Yf.current)}function QI(){Al=Uw.current,Me(Yf),Me(Uw)}var no=$e(null),_a=null;function Bc(u){var d=u.alternate;ze(Es,Es.current&1),ze(no,u),_a===null&&(d===null||Yf.current!==null||d.memoizedState!==null)&&(_a=u)}function tF(u){if(u.tag===22){if(ze(Es,Es.current),ze(no,u),_a===null){var d=u.alternate;d!==null&&d.memoizedState!==null&&(_a=u)}}else Uc()}function Uc(){ze(Es,Es.current),ze(no,no.current)}function xl(u){Me(no),_a===u&&(_a=null),Me(Es)}var Es=$e(0);function Ww(u){for(var d=u;d!==null;){if(d.tag===13){var m=d.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if(d.flags&128)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var Jee=typeof AbortController<"u"?AbortController:function(){var u=[],d=this.signal={aborted:!1,addEventListener:function(m,b){u.push(b)}};this.abort=function(){d.aborted=!0,u.forEach(function(m){return m()})}},ete=n.unstable_scheduleCallback,tte=n.unstable_NormalPriority,Cs={$$typeof:g,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ZI(){return{controller:new Jee,data:new Map,refCount:0}}function Ay(u){u.refCount--,u.refCount===0&&ete(tte,function(){u.controller.abort()})}var Ry=null,JI=0,Qf=0,Zf=null;function nte(u,d){if(Ry===null){var m=Ry=[];JI=0,Qf=rN(),Zf={status:"pending",value:void 0,then:function(b){m.push(b)}}}return JI++,d.then(nF,nF),d}function nF(){if(--JI===0&&Ry!==null){Zf!==null&&(Zf.status="fulfilled");var u=Ry;Ry=null,Qf=0,Zf=null;for(var d=0;d<u.length;d++)(0,u[d])()}}function ste(u,d){var m=[],b={status:"pending",value:null,reason:null,then:function(T){m.push(T)}};return u.then(function(){b.status="fulfilled",b.value=d;for(var T=0;T<m.length;T++)(0,m[T])(d)},function(T){for(b.status="rejected",b.reason=T,T=0;T<m.length;T++)(0,m[T])(void 0)}),b}var sF=k.S;k.S=function(u,d){typeof d=="object"&&d!==null&&typeof d.then=="function"&&nte(u,d),sF!==null&&sF(u,d)};var Fh=$e(null);function ek(){var u=Fh.current;return u!==null?u:xn.pooledCache}function Hw(u,d){d===null?ze(Fh,Fh.current):ze(Fh,d.pool)}function iF(){var u=ek();return u===null?null:{parent:Cs._currentValue,pool:u}}var Wc=0,wt=null,ln=null,us=null,jw=!1,Jf=!1,Vh=!1,Gw=0,Dy=0,ep=null,ite=0;function ns(){throw Error(s(321))}function tk(u,d){if(d===null)return!1;for(var m=0;m<d.length&&m<u.length;m++)if(!Ir(u[m],d[m]))return!1;return!0}function nk(u,d,m,b,T,E){return Wc=E,wt=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,k.H=u===null||u.memoizedState===null?zh:Hc,Vh=!1,E=m(b,T),Vh=!1,Jf&&(E=oF(d,m,b,T)),rF(u),E}function rF(u){k.H=Ta;var d=ln!==null&&ln.next!==null;if(Wc=0,us=ln=wt=null,jw=!1,Dy=0,ep=null,d)throw Error(s(300));u===null||Us||(u=u.dependencies,u!==null&&t_(u)&&(Us=!0))}function oF(u,d,m,b){wt=u;var T=0;do{if(Jf&&(ep=null),Dy=0,Jf=!1,25<=T)throw Error(s(301));if(T+=1,us=ln=null,u.updateQueue!=null){var E=u.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}k.H=Bh,E=d(m,b)}while(Jf);return E}function rte(){var u=k.H,d=u.useState()[0];return d=typeof d.then=="function"?$y(d):d,u=u.useState()[0],(ln!==null?ln.memoizedState:null)!==u&&(wt.flags|=1024),d}function sk(){var u=Gw!==0;return Gw=0,u}function ik(u,d,m){d.updateQueue=u.updateQueue,d.flags&=-2053,u.lanes&=~m}function rk(u){if(jw){for(u=u.memoizedState;u!==null;){var d=u.queue;d!==null&&(d.pending=null),u=u.next}jw=!1}Wc=0,us=ln=wt=null,Jf=!1,Dy=Gw=0,ep=null}function lr(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return us===null?wt.memoizedState=us=u:us=us.next=u,us}function hs(){if(ln===null){var u=wt.alternate;u=u!==null?u.memoizedState:null}else u=ln.next;var d=us===null?wt.memoizedState:us.next;if(d!==null)us=d,ln=u;else{if(u===null)throw wt.alternate===null?Error(s(467)):Error(s(310));ln=u,u={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},us===null?wt.memoizedState=us=u:us=us.next=u}return us}var qw;qw=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function $y(u){var d=Dy;return Dy+=1,ep===null&&(ep=[]),u=XM(ep,u,d),d=wt,(us===null?d.memoizedState:us.next)===null&&(d=d.alternate,k.H=d===null||d.memoizedState===null?zh:Hc),u}function Kw(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return $y(u);if(u.$$typeof===g)return bi(u)}throw Error(s(438,String(u)))}function ok(u){var d=null,m=wt.updateQueue;if(m!==null&&(d=m.memoCache),d==null){var b=wt.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(d={data:b.data.map(function(T){return T.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),m===null&&(m=qw(),wt.updateQueue=m),m.memoCache=d,m=d.data[d.index],m===void 0)for(m=d.data[d.index]=Array(u),b=0;b<u;b++)m[b]=I;return d.index++,m}function wl(u,d){return typeof d=="function"?d(u):d}function Xw(u){var d=hs();return ak(d,ln,u)}function ak(u,d,m){var b=u.queue;if(b===null)throw Error(s(311));b.lastRenderedReducer=m;var T=u.baseQueue,E=b.pending;if(E!==null){if(T!==null){var F=T.next;T.next=E.next,E.next=F}d.baseQueue=T=E,b.pending=null}if(E=u.baseState,T===null)u.memoizedState=E;else{d=T.next;var W=F=null,q=null,re=d,Se=!1;do{var Re=re.lane&-536870913;if(Re!==re.lane?(Mt&Re)===Re:(Wc&Re)===Re){var ge=re.revertLane;if(ge===0)q!==null&&(q=q.next={lane:0,revertLane:0,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),Re===Qf&&(Se=!0);else if((Wc&ge)===ge){re=re.next,ge===Qf&&(Se=!0);continue}else Re={lane:0,revertLane:re.revertLane,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},q===null?(W=q=Re,F=E):q=q.next=Re,wt.lanes|=ge,Jc|=ge;Re=re.action,Vh&&m(E,Re),E=re.hasEagerState?re.eagerState:m(E,Re)}else ge={lane:Re,revertLane:re.revertLane,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},q===null?(W=q=ge,F=E):q=q.next=ge,wt.lanes|=Re,Jc|=Re;re=re.next}while(re!==null&&re!==d);if(q===null?F=E:q.next=W,!Ir(E,u.memoizedState)&&(Us=!0,Se&&(m=Zf,m!==null)))throw m;u.memoizedState=E,u.baseState=F,u.baseQueue=q,b.lastRenderedState=E}return T===null&&(b.lanes=0),[u.memoizedState,b.dispatch]}function lk(u){var d=hs(),m=d.queue;if(m===null)throw Error(s(311));m.lastRenderedReducer=u;var b=m.dispatch,T=m.pending,E=d.memoizedState;if(T!==null){m.pending=null;var F=T=T.next;do E=u(E,F.action),F=F.next;while(F!==T);Ir(E,d.memoizedState)||(Us=!0),d.memoizedState=E,d.baseQueue===null&&(d.baseState=E),m.lastRenderedState=E}return[E,b]}function aF(u,d,m){var b=wt,T=hs(),E=Gt;if(E){if(m===void 0)throw Error(s(407));m=m()}else m=d();var F=!Ir((ln||T).memoizedState,m);if(F&&(T.memoizedState=m,Us=!0),T=T.queue,hk(uF.bind(null,b,T,u),[u]),T.getSnapshot!==d||F||us!==null&&us.memoizedState.tag&1){if(b.flags|=2048,tp(9,cF.bind(null,b,T,m,d),{destroy:void 0},null),xn===null)throw Error(s(349));E||Wc&60||lF(b,d,m)}return m}function lF(u,d,m){u.flags|=16384,u={getSnapshot:d,value:m},d=wt.updateQueue,d===null?(d=qw(),wt.updateQueue=d,d.stores=[u]):(m=d.stores,m===null?d.stores=[u]:m.push(u))}function cF(u,d,m,b){d.value=m,d.getSnapshot=b,hF(d)&&dF(u)}function uF(u,d,m){return m(function(){hF(d)&&dF(u)})}function hF(u){var d=u.getSnapshot;u=u.value;try{var m=d();return!Ir(u,m)}catch{return!0}}function dF(u){var d=zc(u,2);d!==null&&Gi(d,u,2)}function ck(u){var d=lr();if(typeof u=="function"){var m=u;if(u=m(),Vh){ua(!0);try{m()}finally{ua(!1)}}}return d.memoizedState=d.baseState=u,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wl,lastRenderedState:u},d}function fF(u,d,m,b){return u.baseState=m,ak(u,ln,typeof b=="function"?b:wl)}function ote(u,d,m,b,T){if(Zw(u))throw Error(s(485));if(u=d.action,u!==null){var E={payload:T,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(F){E.listeners.push(F)}};k.T!==null?m(!0):E.isTransition=!1,b(E),m=d.pending,m===null?(E.next=d.pending=E,pF(d,E)):(E.next=m.next,d.pending=m.next=E)}}function pF(u,d){var m=d.action,b=d.payload,T=u.state;if(d.isTransition){var E=k.T,F={};k.T=F;try{var W=m(T,b),q=k.S;q!==null&&q(F,W),mF(u,d,W)}catch(re){uk(u,d,re)}finally{k.T=E}}else try{E=m(T,b),mF(u,d,E)}catch(re){uk(u,d,re)}}function mF(u,d,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(b){gF(u,d,b)},function(b){return uk(u,d,b)}):gF(u,d,m)}function gF(u,d,m){d.status="fulfilled",d.value=m,yF(d),u.state=m,d=u.pending,d!==null&&(m=d.next,m===d?u.pending=null:(m=m.next,d.next=m,pF(u,m)))}function uk(u,d,m){var b=u.pending;if(u.pending=null,b!==null){b=b.next;do d.status="rejected",d.reason=m,yF(d),d=d.next;while(d!==b)}u.action=null}function yF(u){u=u.listeners;for(var d=0;d<u.length;d++)(0,u[d])()}function bF(u,d){return d}function vF(u,d){if(Gt){var m=xn.formState;if(m!==null){e:{var b=wt;if(Gt){if(oi){t:{for(var T=oi,E=wa;T.nodeType!==8;){if(!E){T=null;break t}if(T=Mo(T.nextSibling),T===null){T=null;break t}}E=T.data,T=E==="F!"||E==="F"?T:null}if(T){oi=Mo(T.nextSibling),b=T.data==="F!";break e}}Lh(b)}b=!1}b&&(d=m[0])}}return m=lr(),m.memoizedState=m.baseState=d,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bF,lastRenderedState:d},m.queue=b,m=MF.bind(null,wt,b),b.dispatch=m,b=ck(!1),E=gk.bind(null,wt,!1,b.queue),b=lr(),T={state:d,dispatch:null,action:u,pending:null},b.queue=T,m=ote.bind(null,wt,T,E,m),T.dispatch=m,b.memoizedState=u,[d,m,!1]}function xF(u){var d=hs();return wF(d,ln,u)}function wF(u,d,m){d=ak(u,d,bF)[0],u=Xw(wl)[0],d=typeof d=="object"&&d!==null&&typeof d.then=="function"?$y(d):d;var b=hs(),T=b.queue,E=T.dispatch;return m!==b.memoizedState&&(wt.flags|=2048,tp(9,ate.bind(null,T,m),{destroy:void 0},null)),[d,E,u]}function ate(u,d){u.action=d}function _F(u){var d=hs(),m=ln;if(m!==null)return wF(d,m,u);hs(),d=d.memoizedState,m=hs();var b=m.queue.dispatch;return m.memoizedState=u,[d,b,!1]}function tp(u,d,m,b){return u={tag:u,create:d,inst:m,deps:b,next:null},d=wt.updateQueue,d===null&&(d=qw(),wt.updateQueue=d),m=d.lastEffect,m===null?d.lastEffect=u.next=u:(b=m.next,m.next=u,u.next=b,d.lastEffect=u),u}function TF(){return hs().memoizedState}function Yw(u,d,m,b){var T=lr();wt.flags|=u,T.memoizedState=tp(1|d,m,{destroy:void 0},b===void 0?null:b)}function Qw(u,d,m,b){var T=hs();b=b===void 0?null:b;var E=T.memoizedState.inst;ln!==null&&b!==null&&tk(b,ln.memoizedState.deps)?T.memoizedState=tp(d,m,E,b):(wt.flags|=u,T.memoizedState=tp(1|d,m,E,b))}function SF(u,d){Yw(8390656,8,u,d)}function hk(u,d){Qw(2048,8,u,d)}function EF(u,d){return Qw(4,2,u,d)}function CF(u,d){return Qw(4,4,u,d)}function IF(u,d){if(typeof d=="function"){u=u();var m=d(u);return function(){typeof m=="function"?m():d(null)}}if(d!=null)return u=u(),d.current=u,function(){d.current=null}}function kF(u,d,m){m=m!=null?m.concat([u]):null,Qw(4,4,IF.bind(null,d,u),m)}function dk(){}function NF(u,d){var m=hs();d=d===void 0?null:d;var b=m.memoizedState;return d!==null&&tk(d,b[1])?b[0]:(m.memoizedState=[u,d],u)}function AF(u,d){var m=hs();d=d===void 0?null:d;var b=m.memoizedState;if(d!==null&&tk(d,b[1]))return b[0];if(b=u(),Vh){ua(!0);try{u()}finally{ua(!1)}}return m.memoizedState=[b,d],b}function fk(u,d,m){return m===void 0||Wc&1073741824?u.memoizedState=d:(u.memoizedState=m,u=DV(),wt.lanes|=u,Jc|=u,m)}function RF(u,d,m,b){return Ir(m,d)?m:Yf.current!==null?(u=fk(u,m,b),Ir(u,d)||(Us=!0),u):Wc&42?(u=DV(),wt.lanes|=u,Jc|=u,d):(Us=!0,u.memoizedState=m)}function DF(u,d,m,b,T){var E=pe.p;pe.p=E!==0&&8>E?E:8;var F=k.T,W={};k.T=W,gk(u,!1,d,m);try{var q=T(),re=k.S;if(re!==null&&re(W,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var Se=ste(q,b);Oy(u,d,Se,Rr(u))}else Oy(u,d,b,Rr(u))}catch(Re){Oy(u,d,{then:function(){},status:"rejected",reason:Re},Rr())}finally{pe.p=E,k.T=F}}function lte(){}function pk(u,d,m,b){if(u.tag!==5)throw Error(s(476));var T=$F(u).queue;DF(u,T,d,_e,m===null?lte:function(){return OF(u),m(b)})}function $F(u){var d=u.memoizedState;if(d!==null)return d;d={memoizedState:_e,baseState:_e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wl,lastRenderedState:_e},next:null};var m={};return d.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wl,lastRenderedState:m},next:null},u.memoizedState=d,u=u.alternate,u!==null&&(u.memoizedState=d),d}function OF(u){var d=$F(u).next.queue;Oy(u,d,{},Rr())}function mk(){return bi(eb)}function PF(){return hs().memoizedState}function LF(){return hs().memoizedState}function cte(u){for(var d=u.return;d!==null;){switch(d.tag){case 24:case 3:var m=Rr();u=qc(m);var b=Kc(d,u,m);b!==null&&(Gi(b,d,m),My(b,d,m)),d={cache:ZI()},u.payload=d;return}d=d.return}}function ute(u,d,m){var b=Rr();m={lane:b,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null},Zw(u)?FF(d,m):(m=jI(u,d,m,b),m!==null&&(Gi(m,u,b),VF(m,d,b)))}function MF(u,d,m){var b=Rr();Oy(u,d,m,b)}function Oy(u,d,m,b){var T={lane:b,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null};if(Zw(u))FF(d,T);else{var E=u.alternate;if(u.lanes===0&&(E===null||E.lanes===0)&&(E=d.lastRenderedReducer,E!==null))try{var F=d.lastRenderedState,W=E(F,m);if(T.hasEagerState=!0,T.eagerState=W,Ir(W,F))return Pw(u,d,T,0),xn===null&&Ow(),!1}catch{}finally{}if(m=jI(u,d,T,b),m!==null)return Gi(m,u,b),VF(m,d,b),!0}return!1}function gk(u,d,m,b){if(b={lane:2,revertLane:rN(),action:b,hasEagerState:!1,eagerState:null,next:null},Zw(u)){if(d)throw Error(s(479))}else d=jI(u,m,b,2),d!==null&&Gi(d,u,2)}function Zw(u){var d=u.alternate;return u===wt||d!==null&&d===wt}function FF(u,d){Jf=jw=!0;var m=u.pending;m===null?d.next=d:(d.next=m.next,m.next=d),u.pending=d}function VF(u,d,m){if(m&4194176){var b=d.lanes;b&=u.pendingLanes,m|=b,d.lanes=m,Ac(u,m)}}var Ta={readContext:bi,use:Kw,useCallback:ns,useContext:ns,useEffect:ns,useImperativeHandle:ns,useLayoutEffect:ns,useInsertionEffect:ns,useMemo:ns,useReducer:ns,useRef:ns,useState:ns,useDebugValue:ns,useDeferredValue:ns,useTransition:ns,useSyncExternalStore:ns,useId:ns};Ta.useCacheRefresh=ns,Ta.useMemoCache=ns,Ta.useHostTransitionStatus=ns,Ta.useFormState=ns,Ta.useActionState=ns,Ta.useOptimistic=ns;var zh={readContext:bi,use:Kw,useCallback:function(u,d){return lr().memoizedState=[u,d===void 0?null:d],u},useContext:bi,useEffect:SF,useImperativeHandle:function(u,d,m){m=m!=null?m.concat([u]):null,Yw(4194308,4,IF.bind(null,d,u),m)},useLayoutEffect:function(u,d){return Yw(4194308,4,u,d)},useInsertionEffect:function(u,d){Yw(4,2,u,d)},useMemo:function(u,d){var m=lr();d=d===void 0?null:d;var b=u();if(Vh){ua(!0);try{u()}finally{ua(!1)}}return m.memoizedState=[b,d],b},useReducer:function(u,d,m){var b=lr();if(m!==void 0){var T=m(d);if(Vh){ua(!0);try{m(d)}finally{ua(!1)}}}else T=d;return b.memoizedState=b.baseState=T,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:T},b.queue=u,u=u.dispatch=ute.bind(null,wt,u),[b.memoizedState,u]},useRef:function(u){var d=lr();return u={current:u},d.memoizedState=u},useState:function(u){u=ck(u);var d=u.queue,m=MF.bind(null,wt,d);return d.dispatch=m,[u.memoizedState,m]},useDebugValue:dk,useDeferredValue:function(u,d){var m=lr();return fk(m,u,d)},useTransition:function(){var u=ck(!1);return u=DF.bind(null,wt,u.queue,!0,!1),lr().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,d,m){var b=wt,T=lr();if(Gt){if(m===void 0)throw Error(s(407));m=m()}else{if(m=d(),xn===null)throw Error(s(349));Mt&60||lF(b,d,m)}T.memoizedState=m;var E={value:m,getSnapshot:d};return T.queue=E,SF(uF.bind(null,b,E,u),[u]),b.flags|=2048,tp(9,cF.bind(null,b,E,m,d),{destroy:void 0},null),m},useId:function(){var u=lr(),d=xn.identifierPrefix;if(Gt){var m=vl,b=bl;m=(b&~(1<<32-Ui(b)-1)).toString(32)+m,d=":"+d+"R"+m,m=Gw++,0<m&&(d+="H"+m.toString(32)),d+=":"}else m=ite++,d=":"+d+"r"+m.toString(32)+":";return u.memoizedState=d},useCacheRefresh:function(){return lr().memoizedState=cte.bind(null,wt)}};zh.useMemoCache=ok,zh.useHostTransitionStatus=mk,zh.useFormState=vF,zh.useActionState=vF,zh.useOptimistic=function(u){var d=lr();d.memoizedState=d.baseState=u;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=m,d=gk.bind(null,wt,!0,m),m.dispatch=d,[u,d]};var Hc={readContext:bi,use:Kw,useCallback:NF,useContext:bi,useEffect:hk,useImperativeHandle:kF,useInsertionEffect:EF,useLayoutEffect:CF,useMemo:AF,useReducer:Xw,useRef:TF,useState:function(){return Xw(wl)},useDebugValue:dk,useDeferredValue:function(u,d){var m=hs();return RF(m,ln.memoizedState,u,d)},useTransition:function(){var u=Xw(wl)[0],d=hs().memoizedState;return[typeof u=="boolean"?u:$y(u),d]},useSyncExternalStore:aF,useId:PF};Hc.useCacheRefresh=LF,Hc.useMemoCache=ok,Hc.useHostTransitionStatus=mk,Hc.useFormState=xF,Hc.useActionState=xF,Hc.useOptimistic=function(u,d){var m=hs();return fF(m,ln,u,d)};var Bh={readContext:bi,use:Kw,useCallback:NF,useContext:bi,useEffect:hk,useImperativeHandle:kF,useInsertionEffect:EF,useLayoutEffect:CF,useMemo:AF,useReducer:lk,useRef:TF,useState:function(){return lk(wl)},useDebugValue:dk,useDeferredValue:function(u,d){var m=hs();return ln===null?fk(m,u,d):RF(m,ln.memoizedState,u,d)},useTransition:function(){var u=lk(wl)[0],d=hs().memoizedState;return[typeof u=="boolean"?u:$y(u),d]},useSyncExternalStore:aF,useId:PF};Bh.useCacheRefresh=LF,Bh.useMemoCache=ok,Bh.useHostTransitionStatus=mk,Bh.useFormState=_F,Bh.useActionState=_F,Bh.useOptimistic=function(u,d){var m=hs();return ln!==null?fF(m,ln,u,d):(m.baseState=u,[u,m.queue.dispatch])};function yk(u,d,m,b){d=u.memoizedState,m=m(b,d),m=m==null?d:$({},d,m),u.memoizedState=m,u.lanes===0&&(u.updateQueue.baseState=m)}var bk={isMounted:function(u){return(u=u._reactInternals)?Z(u)===u:!1},enqueueSetState:function(u,d,m){u=u._reactInternals;var b=Rr(),T=qc(b);T.payload=d,m!=null&&(T.callback=m),d=Kc(u,T,b),d!==null&&(Gi(d,u,b),My(d,u,b))},enqueueReplaceState:function(u,d,m){u=u._reactInternals;var b=Rr(),T=qc(b);T.tag=1,T.payload=d,m!=null&&(T.callback=m),d=Kc(u,T,b),d!==null&&(Gi(d,u,b),My(d,u,b))},enqueueForceUpdate:function(u,d){u=u._reactInternals;var m=Rr(),b=qc(m);b.tag=2,d!=null&&(b.callback=d),d=Kc(u,b,m),d!==null&&(Gi(d,u,m),My(d,u,m))}};function zF(u,d,m,b,T,E,F){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(b,E,F):d.prototype&&d.prototype.isPureReactComponent?!wy(m,b)||!wy(T,E):!0}function BF(u,d,m,b){u=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(m,b),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(m,b),d.state!==u&&bk.enqueueReplaceState(d,d.state,null)}function Uh(u,d){var m=d;if("ref"in d){m={};for(var b in d)b!=="ref"&&(m[b]=d[b])}if(u=u.defaultProps){m===d&&(m=$({},m));for(var T in u)m[T]===void 0&&(m[T]=u[T])}return m}var Jw=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)};function UF(u){Jw(u)}function WF(u){console.error(u)}function HF(u){Jw(u)}function e_(u,d){try{var m=u.onUncaughtError;m(d.value,{componentStack:d.stack})}catch(b){setTimeout(function(){throw b})}}function jF(u,d,m){try{var b=u.onCaughtError;b(m.value,{componentStack:m.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(T){setTimeout(function(){throw T})}}function vk(u,d,m){return m=qc(m),m.tag=3,m.payload={element:null},m.callback=function(){e_(u,d)},m}function GF(u){return u=qc(u),u.tag=3,u}function qF(u,d,m,b){var T=m.type.getDerivedStateFromError;if(typeof T=="function"){var E=b.value;u.payload=function(){return T(E)},u.callback=function(){jF(d,m,b)}}var F=m.stateNode;F!==null&&typeof F.componentDidCatch=="function"&&(u.callback=function(){jF(d,m,b),typeof T!="function"&&(eu===null?eu=new Set([this]):eu.add(this));var W=b.stack;this.componentDidCatch(b.value,{componentStack:W!==null?W:""})})}function hte(u,d,m,b,T){if(m.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(d=m.alternate,d!==null&&Ly(d,m,T,!0),m=no.current,m!==null){switch(m.tag){case 13:return _a===null?eN():m.alternate===null&&Hn===0&&(Hn=3),m.flags&=-257,m.flags|=65536,m.lanes=T,b===XI?m.flags|=16384:(d=m.updateQueue,d===null?m.updateQueue=new Set([b]):d.add(b),nN(u,b,T)),!1;case 22:return m.flags|=65536,b===XI?m.flags|=16384:(d=m.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([b])},m.updateQueue=d):(m=d.retryQueue,m===null?d.retryQueue=new Set([b]):m.add(b)),nN(u,b,T)),!1}throw Error(s(435,m.tag))}return nN(u,b,T),eN(),!1}if(Gt)return d=no.current,d!==null?(!(d.flags&65536)&&(d.flags|=256),d.flags|=65536,d.lanes=T,b!==KI&&(u=Error(s(422),{cause:b}),Ey(Jr(u,m)))):(b!==KI&&(d=Error(s(423),{cause:b}),Ey(Jr(d,m))),u=u.current.alternate,u.flags|=65536,T&=-T,u.lanes|=T,b=Jr(b,m),T=vk(u.stateNode,b,T),Ok(u,T),Hn!==4&&(Hn=2)),!1;var E=Error(s(520),{cause:b});if(E=Jr(E,m),jy===null?jy=[E]:jy.push(E),Hn!==4&&(Hn=2),d===null)return!0;b=Jr(b,m),m=d;do{switch(m.tag){case 3:return m.flags|=65536,u=T&-T,m.lanes|=u,u=vk(m.stateNode,b,u),Ok(m,u),!1;case 1:if(d=m.type,E=m.stateNode,(m.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(eu===null||!eu.has(E))))return m.flags|=65536,T&=-T,m.lanes|=T,T=GF(T),qF(T,u,m,b),Ok(m,T),!1}m=m.return}while(m!==null);return!1}var KF=Error(s(461)),Us=!1;function ai(u,d,m,b){d.child=u===null?JM(d,null,m,b):Mh(d,u.child,m,b)}function XF(u,d,m,b,T){m=m.render;var E=d.ref;if("ref"in b){var F={};for(var W in b)W!=="ref"&&(F[W]=b[W])}else F=b;return Hh(d),b=nk(u,d,m,F,E,T),W=sk(),u!==null&&!Us?(ik(u,d,T),_l(u,d,T)):(Gt&&W&&GI(d),d.flags|=1,ai(u,d,b,T),d.child)}function YF(u,d,m,b,T){if(u===null){var E=m.type;return typeof E=="function"&&!Uk(E)&&E.defaultProps===void 0&&m.compare===null?(d.tag=15,d.type=E,QF(u,d,E,b,T)):(u=r_(m.type,null,b,d,d.mode,T),u.ref=d.ref,u.return=d,d.child=u)}if(E=u.child,!kk(u,T)){var F=E.memoizedProps;if(m=m.compare,m=m!==null?m:wy,m(F,b)&&u.ref===d.ref)return _l(u,d,T)}return d.flags|=1,u=Zc(E,b),u.ref=d.ref,u.return=d,d.child=u}function QF(u,d,m,b,T){if(u!==null){var E=u.memoizedProps;if(wy(E,b)&&u.ref===d.ref)if(Us=!1,d.pendingProps=b=E,kk(u,T))u.flags&131072&&(Us=!0);else return d.lanes=u.lanes,_l(u,d,T)}return xk(u,d,m,b,T)}function ZF(u,d,m){var b=d.pendingProps,T=b.children,E=(d.stateNode._pendingVisibility&2)!==0,F=u!==null?u.memoizedState:null;if(Py(u,d),b.mode==="hidden"||E){if(d.flags&128){if(b=F!==null?F.baseLanes|m:m,u!==null){for(T=d.child=u.child,E=0;T!==null;)E=E|T.lanes|T.childLanes,T=T.sibling;d.childLanes=E&~b}else d.childLanes=0,d.child=null;return JF(u,d,b,m)}if(m&536870912)d.memoizedState={baseLanes:0,cachePool:null},u!==null&&Hw(d,F!==null?F.cachePool:null),F!==null?eF(d,F):YI(),tF(d);else return d.lanes=d.childLanes=536870912,JF(u,d,F!==null?F.baseLanes|m:m,m)}else F!==null?(Hw(d,F.cachePool),eF(d,F),Uc(),d.memoizedState=null):(u!==null&&Hw(d,null),YI(),Uc());return ai(u,d,T,m),d.child}function JF(u,d,m,b){var T=ek();return T=T===null?null:{parent:Cs._currentValue,pool:T},d.memoizedState={baseLanes:m,cachePool:T},u!==null&&Hw(d,null),YI(),tF(d),u!==null&&Ly(u,d,b,!0),null}function Py(u,d){var m=d.ref;if(m===null)u!==null&&u.ref!==null&&(d.flags|=2097664);else{if(typeof m!="function"&&typeof m!="object")throw Error(s(284));(u===null||u.ref!==m)&&(d.flags|=2097664)}}function xk(u,d,m,b,T){return Hh(d),m=nk(u,d,m,b,void 0,T),b=sk(),u!==null&&!Us?(ik(u,d,T),_l(u,d,T)):(Gt&&b&&GI(d),d.flags|=1,ai(u,d,m,T),d.child)}function eV(u,d,m,b,T,E){return Hh(d),d.updateQueue=null,m=oF(d,b,m,T),rF(u),b=sk(),u!==null&&!Us?(ik(u,d,E),_l(u,d,E)):(Gt&&b&&GI(d),d.flags|=1,ai(u,d,m,E),d.child)}function tV(u,d,m,b,T){if(Hh(d),d.stateNode===null){var E=Gf,F=m.contextType;typeof F=="object"&&F!==null&&(E=bi(F)),E=new m(b,E),d.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=bk,d.stateNode=E,E._reactInternals=d,E=d.stateNode,E.props=b,E.state=d.memoizedState,E.refs={},Dk(d),F=m.contextType,E.context=typeof F=="object"&&F!==null?bi(F):Gf,E.state=d.memoizedState,F=m.getDerivedStateFromProps,typeof F=="function"&&(yk(d,m,F,b),E.state=d.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(F=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),F!==E.state&&bk.enqueueReplaceState(E,E.state,null),Vy(d,b,E,T),Fy(),E.state=d.memoizedState),typeof E.componentDidMount=="function"&&(d.flags|=4194308),b=!0}else if(u===null){E=d.stateNode;var W=d.memoizedProps,q=Uh(m,W);E.props=q;var re=E.context,Se=m.contextType;F=Gf,typeof Se=="object"&&Se!==null&&(F=bi(Se));var Re=m.getDerivedStateFromProps;Se=typeof Re=="function"||typeof E.getSnapshotBeforeUpdate=="function",W=d.pendingProps!==W,Se||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(W||re!==F)&&BF(d,E,b,F),Gc=!1;var ge=d.memoizedState;E.state=ge,Vy(d,b,E,T),Fy(),re=d.memoizedState,W||ge!==re||Gc?(typeof Re=="function"&&(yk(d,m,Re,b),re=d.memoizedState),(q=Gc||zF(d,m,q,b,ge,re,F))?(Se||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(d.flags|=4194308)):(typeof E.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=b,d.memoizedState=re),E.props=b,E.state=re,E.context=F,b=q):(typeof E.componentDidMount=="function"&&(d.flags|=4194308),b=!1)}else{E=d.stateNode,$k(u,d),F=d.memoizedProps,Se=Uh(m,F),E.props=Se,Re=d.pendingProps,ge=E.context,re=m.contextType,q=Gf,typeof re=="object"&&re!==null&&(q=bi(re)),W=m.getDerivedStateFromProps,(re=typeof W=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(F!==Re||ge!==q)&&BF(d,E,b,q),Gc=!1,ge=d.memoizedState,E.state=ge,Vy(d,b,E,T),Fy();var Te=d.memoizedState;F!==Re||ge!==Te||Gc||u!==null&&u.dependencies!==null&&t_(u.dependencies)?(typeof W=="function"&&(yk(d,m,W,b),Te=d.memoizedState),(Se=Gc||zF(d,m,Se,b,ge,Te,q)||u!==null&&u.dependencies!==null&&t_(u.dependencies))?(re||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(b,Te,q),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(b,Te,q)),typeof E.componentDidUpdate=="function"&&(d.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof E.componentDidUpdate!="function"||F===u.memoizedProps&&ge===u.memoizedState||(d.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||F===u.memoizedProps&&ge===u.memoizedState||(d.flags|=1024),d.memoizedProps=b,d.memoizedState=Te),E.props=b,E.state=Te,E.context=q,b=Se):(typeof E.componentDidUpdate!="function"||F===u.memoizedProps&&ge===u.memoizedState||(d.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||F===u.memoizedProps&&ge===u.memoizedState||(d.flags|=1024),b=!1)}return E=b,Py(u,d),b=(d.flags&128)!==0,E||b?(E=d.stateNode,m=b&&typeof m.getDerivedStateFromError!="function"?null:E.render(),d.flags|=1,u!==null&&b?(d.child=Mh(d,u.child,null,T),d.child=Mh(d,null,m,T)):ai(u,d,m,T),d.memoizedState=E.state,u=d.child):u=_l(u,d,T),u}function nV(u,d,m,b){return Sy(),d.flags|=256,ai(u,d,m,b),d.child}var wk={dehydrated:null,treeContext:null,retryLane:0};function _k(u){return{baseLanes:u,cachePool:iF()}}function Tk(u,d,m){return u=u!==null?u.childLanes&~m:0,d&&(u|=oo),u}function sV(u,d,m){var b=d.pendingProps,T=!1,E=(d.flags&128)!==0,F;if((F=E)||(F=u!==null&&u.memoizedState===null?!1:(Es.current&2)!==0),F&&(T=!0,d.flags&=-129),F=(d.flags&32)!==0,d.flags&=-33,u===null){if(Gt){if(T?Bc(d):Uc(),Gt){var W=oi,q;if(q=W){e:{for(q=W,W=wa;q.nodeType!==8;){if(!W){W=null;break e}if(q=Mo(q.nextSibling),q===null){W=null;break e}}W=q}W!==null?(d.memoizedState={dehydrated:W,treeContext:Oh!==null?{id:bl,overflow:vl}:null,retryLane:536870912},q=ro(18,null,null,0),q.stateNode=W,q.return=d,d.child=q,ji=d,oi=null,q=!0):q=!1}q||Lh(d)}if(W=d.memoizedState,W!==null&&(W=W.dehydrated,W!==null))return W.data==="$!"?d.lanes=16:d.lanes=536870912,null;xl(d)}return W=b.children,b=b.fallback,T?(Uc(),T=d.mode,W=Ek({mode:"hidden",children:W},T),b=Gh(b,T,m,null),W.return=d,b.return=d,W.sibling=b,d.child=W,T=d.child,T.memoizedState=_k(m),T.childLanes=Tk(u,F,m),d.memoizedState=wk,b):(Bc(d),Sk(d,W))}if(q=u.memoizedState,q!==null&&(W=q.dehydrated,W!==null)){if(E)d.flags&256?(Bc(d),d.flags&=-257,d=Ck(u,d,m)):d.memoizedState!==null?(Uc(),d.child=u.child,d.flags|=128,d=null):(Uc(),T=b.fallback,W=d.mode,b=Ek({mode:"visible",children:b.children},W),T=Gh(T,W,m,null),T.flags|=2,b.return=d,T.return=d,b.sibling=T,d.child=b,Mh(d,u.child,null,m),b=d.child,b.memoizedState=_k(m),b.childLanes=Tk(u,F,m),d.memoizedState=wk,d=T);else if(Bc(d),W.data==="$!"){if(F=W.nextSibling&&W.nextSibling.dataset,F)var re=F.dgst;F=re,b=Error(s(419)),b.stack="",b.digest=F,Ey({value:b,source:null,stack:null}),d=Ck(u,d,m)}else if(Us||Ly(u,d,m,!1),F=(m&u.childLanes)!==0,Us||F){if(F=xn,F!==null){if(b=m&-m,b&42)b=1;else switch(b){case 2:b=1;break;case 8:b=4;break;case 32:b=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:b=64;break;case 268435456:b=134217728;break;default:b=0}if(b=b&(F.suspendedLanes|m)?0:b,b!==0&&b!==q.retryLane)throw q.retryLane=b,zc(u,b),Gi(F,u,b),KF}W.data==="$?"||eN(),d=Ck(u,d,m)}else W.data==="$?"?(d.flags|=128,d.child=u.child,d=Cte.bind(null,u),W._reactRetry=d,d=null):(u=q.treeContext,oi=Mo(W.nextSibling),ji=d,Gt=!0,Po=null,wa=!1,u!==null&&(eo[to++]=bl,eo[to++]=vl,eo[to++]=Oh,bl=u.id,vl=u.overflow,Oh=d),d=Sk(d,b.children),d.flags|=4096);return d}return T?(Uc(),T=b.fallback,W=d.mode,q=u.child,re=q.sibling,b=Zc(q,{mode:"hidden",children:b.children}),b.subtreeFlags=q.subtreeFlags&31457280,re!==null?T=Zc(re,T):(T=Gh(T,W,m,null),T.flags|=2),T.return=d,b.return=d,b.sibling=T,d.child=b,b=T,T=d.child,W=u.child.memoizedState,W===null?W=_k(m):(q=W.cachePool,q!==null?(re=Cs._currentValue,q=q.parent!==re?{parent:re,pool:re}:q):q=iF(),W={baseLanes:W.baseLanes|m,cachePool:q}),T.memoizedState=W,T.childLanes=Tk(u,F,m),d.memoizedState=wk,b):(Bc(d),m=u.child,u=m.sibling,m=Zc(m,{mode:"visible",children:b.children}),m.return=d,m.sibling=null,u!==null&&(F=d.deletions,F===null?(d.deletions=[u],d.flags|=16):F.push(u)),d.child=m,d.memoizedState=null,m)}function Sk(u,d){return d=Ek({mode:"visible",children:d},u.mode),d.return=u,u.child=d}function Ek(u,d){return NV(u,d,0,null)}function Ck(u,d,m){return Mh(d,u.child,null,m),u=Sk(d,d.pendingProps.children),u.flags|=2,d.memoizedState=null,u}function iV(u,d,m){u.lanes|=d;var b=u.alternate;b!==null&&(b.lanes|=d),Ak(u.return,d,m)}function Ik(u,d,m,b,T){var E=u.memoizedState;E===null?u.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:T}:(E.isBackwards=d,E.rendering=null,E.renderingStartTime=0,E.last=b,E.tail=m,E.tailMode=T)}function rV(u,d,m){var b=d.pendingProps,T=b.revealOrder,E=b.tail;if(ai(u,d,b.children,m),b=Es.current,b&2)b=b&1|2,d.flags|=128;else{if(u!==null&&u.flags&128)e:for(u=d.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&iV(u,m,d);else if(u.tag===19)iV(u,m,d);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===d)break e;for(;u.sibling===null;){if(u.return===null||u.return===d)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}b&=1}switch(ze(Es,b),T){case"forwards":for(m=d.child,T=null;m!==null;)u=m.alternate,u!==null&&Ww(u)===null&&(T=m),m=m.sibling;m=T,m===null?(T=d.child,d.child=null):(T=m.sibling,m.sibling=null),Ik(d,!1,T,m,E);break;case"backwards":for(m=null,T=d.child,d.child=null;T!==null;){if(u=T.alternate,u!==null&&Ww(u)===null){d.child=T;break}u=T.sibling,T.sibling=m,m=T,T=u}Ik(d,!0,m,null,E);break;case"together":Ik(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function _l(u,d,m){if(u!==null&&(d.dependencies=u.dependencies),Jc|=d.lanes,!(m&d.childLanes))if(u!==null){if(Ly(u,d,m,!1),(m&d.childLanes)===0)return null}else return null;if(u!==null&&d.child!==u.child)throw Error(s(153));if(d.child!==null){for(u=d.child,m=Zc(u,u.pendingProps),d.child=m,m.return=d;u.sibling!==null;)u=u.sibling,m=m.sibling=Zc(u,u.pendingProps),m.return=d;m.sibling=null}return d.child}function kk(u,d){return u.lanes&d?!0:(u=u.dependencies,!!(u!==null&&t_(u)))}function dte(u,d,m){switch(d.tag){case 3:Nt(d,d.stateNode.containerInfo),jc(d,Cs,u.memoizedState.cache),Sy();break;case 27:case 5:Yt(d);break;case 4:Nt(d,d.stateNode.containerInfo);break;case 10:jc(d,d.type,d.memoizedProps.value);break;case 13:var b=d.memoizedState;if(b!==null)return b.dehydrated!==null?(Bc(d),d.flags|=128,null):m&d.child.childLanes?sV(u,d,m):(Bc(d),u=_l(u,d,m),u!==null?u.sibling:null);Bc(d);break;case 19:var T=(u.flags&128)!==0;if(b=(m&d.childLanes)!==0,b||(Ly(u,d,m,!1),b=(m&d.childLanes)!==0),T){if(b)return rV(u,d,m);d.flags|=128}if(T=d.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),ze(Es,Es.current),b)break;return null;case 22:case 23:return d.lanes=0,ZF(u,d,m);case 24:jc(d,Cs,u.memoizedState.cache)}return _l(u,d,m)}function oV(u,d,m){if(u!==null)if(u.memoizedProps!==d.pendingProps)Us=!0;else{if(!kk(u,m)&&!(d.flags&128))return Us=!1,dte(u,d,m);Us=!!(u.flags&131072)}else Us=!1,Gt&&d.flags&1048576&&HM(d,Fw,d.index);switch(d.lanes=0,d.tag){case 16:e:{u=d.pendingProps;var b=d.elementType,T=b._init;if(b=T(b._payload),d.type=b,typeof b=="function")Uk(b)?(u=Uh(b,u),d.tag=1,d=tV(null,d,b,u,m)):(d.tag=0,d=xk(null,d,b,u,m));else{if(b!=null){if(T=b.$$typeof,T===y){d.tag=11,d=XF(null,d,b,u,m);break e}else if(T===w){d.tag=14,d=YF(null,d,b,u,m);break e}}throw d=N(b)||b,Error(s(306,d,""))}}return d;case 0:return xk(u,d,d.type,d.pendingProps,m);case 1:return b=d.type,T=Uh(b,d.pendingProps),tV(u,d,b,T,m);case 3:e:{if(Nt(d,d.stateNode.containerInfo),u===null)throw Error(s(387));var E=d.pendingProps;T=d.memoizedState,b=T.element,$k(u,d),Vy(d,E,null,m);var F=d.memoizedState;if(E=F.cache,jc(d,Cs,E),E!==T.cache&&Rk(d,[Cs],m,!0),Fy(),E=F.element,T.isDehydrated)if(T={element:E,isDehydrated:!1,cache:F.cache},d.updateQueue.baseState=T,d.memoizedState=T,d.flags&256){d=nV(u,d,E,m);break e}else if(E!==b){b=Jr(Error(s(424)),d),Ey(b),d=nV(u,d,E,m);break e}else for(oi=Mo(d.stateNode.containerInfo.firstChild),ji=d,Gt=!0,Po=null,wa=!0,m=JM(d,null,E,m),d.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Sy(),E===b){d=_l(u,d,m);break e}ai(u,d,E,m)}d=d.child}return d;case 26:return Py(u,d),u===null?(m=c3(d.type,null,d.pendingProps,null))?d.memoizedState=m:Gt||(m=d.type,u=d.pendingProps,b=y_(bt.current).createElement(m),b[Vs]=d,b[_s]=u,li(b,m,u),Pn(b),d.stateNode=b):d.memoizedState=c3(d.type,u.memoizedProps,d.pendingProps,u.memoizedState),null;case 27:return Yt(d),u===null&&Gt&&(b=d.stateNode=o3(d.type,d.pendingProps,bt.current),ji=d,wa=!0,oi=Mo(b.firstChild)),b=d.pendingProps.children,u!==null||Gt?ai(u,d,b,m):d.child=Mh(d,null,b,m),Py(u,d),d.child;case 5:return u===null&&Gt&&((T=b=oi)&&(b=Ute(b,d.type,d.pendingProps,wa),b!==null?(d.stateNode=b,ji=d,oi=Mo(b.firstChild),wa=!1,T=!0):T=!1),T||Lh(d)),Yt(d),T=d.type,E=d.pendingProps,F=u!==null?u.memoizedProps:null,b=E.children,pN(T,E)?b=null:F!==null&&pN(T,F)&&(d.flags|=32),d.memoizedState!==null&&(T=nk(u,d,rte,null,null,m),eb._currentValue=T),Py(u,d),ai(u,d,b,m),d.child;case 6:return u===null&&Gt&&((u=m=oi)&&(m=Wte(m,d.pendingProps,wa),m!==null?(d.stateNode=m,ji=d,oi=null,u=!0):u=!1),u||Lh(d)),null;case 13:return sV(u,d,m);case 4:return Nt(d,d.stateNode.containerInfo),b=d.pendingProps,u===null?d.child=Mh(d,null,b,m):ai(u,d,b,m),d.child;case 11:return XF(u,d,d.type,d.pendingProps,m);case 7:return ai(u,d,d.pendingProps,m),d.child;case 8:return ai(u,d,d.pendingProps.children,m),d.child;case 12:return ai(u,d,d.pendingProps.children,m),d.child;case 10:return b=d.pendingProps,jc(d,d.type,b.value),ai(u,d,b.children,m),d.child;case 9:return T=d.type._context,b=d.pendingProps.children,Hh(d),T=bi(T),b=b(T),d.flags|=1,ai(u,d,b,m),d.child;case 14:return YF(u,d,d.type,d.pendingProps,m);case 15:return QF(u,d,d.type,d.pendingProps,m);case 19:return rV(u,d,m);case 22:return ZF(u,d,m);case 24:return Hh(d),b=bi(Cs),u===null?(T=ek(),T===null&&(T=xn,E=ZI(),T.pooledCache=E,E.refCount++,E!==null&&(T.pooledCacheLanes|=m),T=E),d.memoizedState={parent:b,cache:T},Dk(d),jc(d,Cs,T)):(u.lanes&m&&($k(u,d),Vy(d,null,null,m),Fy()),T=u.memoizedState,E=d.memoizedState,T.parent!==b?(T={parent:b,cache:b},d.memoizedState=T,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=T),jc(d,Cs,b)):(b=E.cache,jc(d,Cs,b),b!==T.cache&&Rk(d,[Cs],m,!0))),ai(u,d,d.pendingProps.children,m),d.child;case 29:throw d.pendingProps}throw Error(s(156,d.tag))}var Nk=$e(null),Wh=null,Tl=null;function jc(u,d,m){ze(Nk,d._currentValue),d._currentValue=m}function Sl(u){u._currentValue=Nk.current,Me(Nk)}function Ak(u,d,m){for(;u!==null;){var b=u.alternate;if((u.childLanes&d)!==d?(u.childLanes|=d,b!==null&&(b.childLanes|=d)):b!==null&&(b.childLanes&d)!==d&&(b.childLanes|=d),u===m)break;u=u.return}}function Rk(u,d,m,b){var T=u.child;for(T!==null&&(T.return=u);T!==null;){var E=T.dependencies;if(E!==null){var F=T.child;E=E.firstContext;e:for(;E!==null;){var W=E;E=T;for(var q=0;q<d.length;q++)if(W.context===d[q]){E.lanes|=m,W=E.alternate,W!==null&&(W.lanes|=m),Ak(E.return,m,u),b||(F=null);break e}E=W.next}}else if(T.tag===18){if(F=T.return,F===null)throw Error(s(341));F.lanes|=m,E=F.alternate,E!==null&&(E.lanes|=m),Ak(F,m,u),F=null}else F=T.child;if(F!==null)F.return=T;else for(F=T;F!==null;){if(F===u){F=null;break}if(T=F.sibling,T!==null){T.return=F.return,F=T;break}F=F.return}T=F}}function Ly(u,d,m,b){u=null;for(var T=d,E=!1;T!==null;){if(!E){if(T.flags&524288)E=!0;else if(T.flags&262144)break}if(T.tag===10){var F=T.alternate;if(F===null)throw Error(s(387));if(F=F.memoizedProps,F!==null){var W=T.type;Ir(T.pendingProps.value,F.value)||(u!==null?u.push(W):u=[W])}}else if(T===Wt.current){if(F=T.alternate,F===null)throw Error(s(387));F.memoizedState.memoizedState!==T.memoizedState.memoizedState&&(u!==null?u.push(eb):u=[eb])}T=T.return}u!==null&&Rk(d,u,m,b),d.flags|=262144}function t_(u){for(u=u.firstContext;u!==null;){if(!Ir(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function Hh(u){Wh=u,Tl=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function bi(u){return aV(Wh,u)}function n_(u,d){return Wh===null&&Hh(u),aV(u,d)}function aV(u,d){var m=d._currentValue;if(d={context:d,memoizedValue:m,next:null},Tl===null){if(u===null)throw Error(s(308));Tl=d,u.dependencies={lanes:0,firstContext:d},u.flags|=524288}else Tl=Tl.next=d;return m}var Gc=!1;function Dk(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $k(u,d){u=u.updateQueue,d.updateQueue===u&&(d.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function qc(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function Kc(u,d,m){var b=u.updateQueue;if(b===null)return null;if(b=b.shared,Mn&2){var T=b.pending;return T===null?d.next=d:(d.next=T.next,T.next=d),b.pending=d,d=Lw(u),UM(u,null,m),d}return Pw(u,b,d,m),Lw(u)}function My(u,d,m){if(d=d.updateQueue,d!==null&&(d=d.shared,(m&4194176)!==0)){var b=d.lanes;b&=u.pendingLanes,m|=b,d.lanes=m,Ac(u,m)}}function Ok(u,d){var m=u.updateQueue,b=u.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var T=null,E=null;if(m=m.firstBaseUpdate,m!==null){do{var F={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};E===null?T=E=F:E=E.next=F,m=m.next}while(m!==null);E===null?T=E=d:E=E.next=d}else T=E=d;m={baseState:b.baseState,firstBaseUpdate:T,lastBaseUpdate:E,shared:b.shared,callbacks:b.callbacks},u.updateQueue=m;return}u=m.lastBaseUpdate,u===null?m.firstBaseUpdate=d:u.next=d,m.lastBaseUpdate=d}var Pk=!1;function Fy(){if(Pk){var u=Zf;if(u!==null)throw u}}function Vy(u,d,m,b){Pk=!1;var T=u.updateQueue;Gc=!1;var E=T.firstBaseUpdate,F=T.lastBaseUpdate,W=T.shared.pending;if(W!==null){T.shared.pending=null;var q=W,re=q.next;q.next=null,F===null?E=re:F.next=re,F=q;var Se=u.alternate;Se!==null&&(Se=Se.updateQueue,W=Se.lastBaseUpdate,W!==F&&(W===null?Se.firstBaseUpdate=re:W.next=re,Se.lastBaseUpdate=q))}if(E!==null){var Re=T.baseState;F=0,Se=re=q=null,W=E;do{var ge=W.lane&-536870913,Te=ge!==W.lane;if(Te?(Mt&ge)===ge:(b&ge)===ge){ge!==0&&ge===Qf&&(Pk=!0),Se!==null&&(Se=Se.next={lane:0,tag:W.tag,payload:W.payload,callback:null,next:null});e:{var Xe=u,lt=W;ge=d;var jn=m;switch(lt.tag){case 1:if(Xe=lt.payload,typeof Xe=="function"){Re=Xe.call(jn,Re,ge);break e}Re=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=lt.payload,ge=typeof Xe=="function"?Xe.call(jn,Re,ge):Xe,ge==null)break e;Re=$({},Re,ge);break e;case 2:Gc=!0}}ge=W.callback,ge!==null&&(u.flags|=64,Te&&(u.flags|=8192),Te=T.callbacks,Te===null?T.callbacks=[ge]:Te.push(ge))}else Te={lane:ge,tag:W.tag,payload:W.payload,callback:W.callback,next:null},Se===null?(re=Se=Te,q=Re):Se=Se.next=Te,F|=ge;if(W=W.next,W===null){if(W=T.shared.pending,W===null)break;Te=W,W=Te.next,Te.next=null,T.lastBaseUpdate=Te,T.shared.pending=null}}while(!0);Se===null&&(q=Re),T.baseState=q,T.firstBaseUpdate=re,T.lastBaseUpdate=Se,E===null&&(T.shared.lanes=0),Jc|=F,u.lanes=F,u.memoizedState=Re}}function lV(u,d){if(typeof u!="function")throw Error(s(191,u));u.call(d)}function cV(u,d){var m=u.callbacks;if(m!==null)for(u.callbacks=null,u=0;u<m.length;u++)lV(m[u],d)}function zy(u,d){try{var m=d.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var T=b.next;m=T;do{if((m.tag&u)===u){b=void 0;var E=m.create,F=m.inst;b=E(),F.destroy=b}m=m.next}while(m!==T)}}catch(W){fn(d,d.return,W)}}function Xc(u,d,m){try{var b=d.updateQueue,T=b!==null?b.lastEffect:null;if(T!==null){var E=T.next;b=E;do{if((b.tag&u)===u){var F=b.inst,W=F.destroy;if(W!==void 0){F.destroy=void 0,T=d;var q=m;try{W()}catch(re){fn(T,q,re)}}}b=b.next}while(b!==E)}}catch(re){fn(d,d.return,re)}}function uV(u){var d=u.updateQueue;if(d!==null){var m=u.stateNode;try{cV(d,m)}catch(b){fn(u,u.return,b)}}}function hV(u,d,m){m.props=Uh(u.type,u.memoizedProps),m.state=u.memoizedState;try{m.componentWillUnmount()}catch(b){fn(u,d,b)}}function jh(u,d){try{var m=u.ref;if(m!==null){var b=u.stateNode;switch(u.tag){case 26:case 27:case 5:var T=b;break;default:T=b}typeof m=="function"?u.refCleanup=m(T):m.current=T}}catch(E){fn(u,d,E)}}function kr(u,d){var m=u.ref,b=u.refCleanup;if(m!==null)if(typeof b=="function")try{b()}catch(T){fn(u,d,T)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(T){fn(u,d,T)}else m.current=null}function dV(u){var d=u.type,m=u.memoizedProps,b=u.stateNode;try{e:switch(d){case"button":case"input":case"select":case"textarea":m.autoFocus&&b.focus();break e;case"img":m.src?b.src=m.src:m.srcSet&&(b.srcset=m.srcSet)}}catch(T){fn(u,u.return,T)}}function fV(u,d,m){try{var b=u.stateNode;Mte(b,u.type,m,d),b[_s]=d}catch(T){fn(u,u.return,T)}}function pV(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27||u.tag===4}function Lk(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||pV(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==27&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Mk(u,d,m){var b=u.tag;if(b===5||b===6)u=u.stateNode,d?m.nodeType===8?m.parentNode.insertBefore(u,d):m.insertBefore(u,d):(m.nodeType===8?(d=m.parentNode,d.insertBefore(u,m)):(d=m,d.appendChild(u)),m=m._reactRootContainer,m!=null||d.onclick!==null||(d.onclick=g_));else if(b!==4&&b!==27&&(u=u.child,u!==null))for(Mk(u,d,m),u=u.sibling;u!==null;)Mk(u,d,m),u=u.sibling}function s_(u,d,m){var b=u.tag;if(b===5||b===6)u=u.stateNode,d?m.insertBefore(u,d):m.appendChild(u);else if(b!==4&&b!==27&&(u=u.child,u!==null))for(s_(u,d,m),u=u.sibling;u!==null;)s_(u,d,m),u=u.sibling}var El=!1,Wn=!1,Fk=!1,mV=typeof WeakSet=="function"?WeakSet:Set,Ws=null,gV=!1;function fte(u,d){if(u=u.containerInfo,dN=T_,u=$M(u),zI(u)){if("selectionStart"in u)var m={start:u.selectionStart,end:u.selectionEnd};else e:{m=(m=u.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var T=b.anchorOffset,E=b.focusNode;b=b.focusOffset;try{m.nodeType,E.nodeType}catch{m=null;break e}var F=0,W=-1,q=-1,re=0,Se=0,Re=u,ge=null;t:for(;;){for(var Te;Re!==m||T!==0&&Re.nodeType!==3||(W=F+T),Re!==E||b!==0&&Re.nodeType!==3||(q=F+b),Re.nodeType===3&&(F+=Re.nodeValue.length),(Te=Re.firstChild)!==null;)ge=Re,Re=Te;for(;;){if(Re===u)break t;if(ge===m&&++re===T&&(W=F),ge===E&&++Se===b&&(q=F),(Te=Re.nextSibling)!==null)break;Re=ge,ge=Re.parentNode}Re=Te}m=W===-1||q===-1?null:{start:W,end:q}}else m=null}m=m||{start:0,end:0}}else m=null;for(fN={focusedElem:u,selectionRange:m},T_=!1,Ws=d;Ws!==null;)if(d=Ws,u=d.child,(d.subtreeFlags&1028)!==0&&u!==null)u.return=d,Ws=u;else for(;Ws!==null;){switch(d=Ws,E=d.alternate,u=d.flags,d.tag){case 0:break;case 11:case 15:break;case 1:if(u&1024&&E!==null){u=void 0,m=d,T=E.memoizedProps,E=E.memoizedState,b=m.stateNode;try{var Xe=Uh(m.type,T,m.elementType===m.type);u=b.getSnapshotBeforeUpdate(Xe,E),b.__reactInternalSnapshotBeforeUpdate=u}catch(lt){fn(m,m.return,lt)}}break;case 3:if(u&1024){if(u=d.stateNode.containerInfo,m=u.nodeType,m===9)yN(u);else if(m===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":yN(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(u&1024)throw Error(s(163))}if(u=d.sibling,u!==null){u.return=d.return,Ws=u;break}Ws=d.return}return Xe=gV,gV=!1,Xe}function yV(u,d,m){var b=m.flags;switch(m.tag){case 0:case 11:case 15:Il(u,m),b&4&&zy(5,m);break;case 1:if(Il(u,m),b&4)if(u=m.stateNode,d===null)try{u.componentDidMount()}catch(W){fn(m,m.return,W)}else{var T=Uh(m.type,d.memoizedProps);d=d.memoizedState;try{u.componentDidUpdate(T,d,u.__reactInternalSnapshotBeforeUpdate)}catch(W){fn(m,m.return,W)}}b&64&&uV(m),b&512&&jh(m,m.return);break;case 3:if(Il(u,m),b&64&&(b=m.updateQueue,b!==null)){if(u=null,m.child!==null)switch(m.child.tag){case 27:case 5:u=m.child.stateNode;break;case 1:u=m.child.stateNode}try{cV(b,u)}catch(W){fn(m,m.return,W)}}break;case 26:Il(u,m),b&512&&jh(m,m.return);break;case 27:case 5:Il(u,m),d===null&&b&4&&dV(m),b&512&&jh(m,m.return);break;case 12:Il(u,m);break;case 13:Il(u,m),b&4&&xV(u,m);break;case 22:if(T=m.memoizedState!==null||El,!T){d=d!==null&&d.memoizedState!==null||Wn;var E=El,F=Wn;El=T,(Wn=d)&&!F?Yc(u,m,(m.subtreeFlags&8772)!==0):Il(u,m),El=E,Wn=F}b&512&&(m.memoizedProps.mode==="manual"?jh(m,m.return):kr(m,m.return));break;default:Il(u,m)}}function bV(u){var d=u.alternate;d!==null&&(u.alternate=null,bV(d)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(d=u.stateNode,d!==null&&wh(d)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var ds=null,Nr=!1;function Cl(u,d,m){for(m=m.child;m!==null;)vV(u,d,m),m=m.sibling}function vV(u,d,m){if(Fs&&typeof Fs.onCommitFiberUnmount=="function")try{Fs.onCommitFiberUnmount(Sr,m)}catch{}switch(m.tag){case 26:Wn||kr(m,d),Cl(u,d,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Wn||kr(m,d);var b=ds,T=Nr;for(ds=m.stateNode,Cl(u,d,m),m=m.stateNode,d=m.attributes;d.length;)m.removeAttributeNode(d[0]);wh(m),ds=b,Nr=T;break;case 5:Wn||kr(m,d);case 6:T=ds;var E=Nr;if(ds=null,Cl(u,d,m),ds=T,Nr=E,ds!==null)if(Nr)try{u=ds,b=m.stateNode,u.nodeType===8?u.parentNode.removeChild(b):u.removeChild(b)}catch(F){fn(m,d,F)}else try{ds.removeChild(m.stateNode)}catch(F){fn(m,d,F)}break;case 18:ds!==null&&(Nr?(d=ds,m=m.stateNode,d.nodeType===8?gN(d.parentNode,m):d.nodeType===1&&gN(d,m),ib(d)):gN(ds,m.stateNode));break;case 4:b=ds,T=Nr,ds=m.stateNode.containerInfo,Nr=!0,Cl(u,d,m),ds=b,Nr=T;break;case 0:case 11:case 14:case 15:Wn||Xc(2,m,d),Wn||Xc(4,m,d),Cl(u,d,m);break;case 1:Wn||(kr(m,d),b=m.stateNode,typeof b.componentWillUnmount=="function"&&hV(m,d,b)),Cl(u,d,m);break;case 21:Cl(u,d,m);break;case 22:Wn||kr(m,d),Wn=(b=Wn)||m.memoizedState!==null,Cl(u,d,m),Wn=b;break;default:Cl(u,d,m)}}function xV(u,d){if(d.memoizedState===null&&(u=d.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{ib(u)}catch(m){fn(d,d.return,m)}}function pte(u){switch(u.tag){case 13:case 19:var d=u.stateNode;return d===null&&(d=u.stateNode=new mV),d;case 22:return u=u.stateNode,d=u._retryCache,d===null&&(d=u._retryCache=new mV),d;default:throw Error(s(435,u.tag))}}function Vk(u,d){var m=pte(u);d.forEach(function(b){var T=Ite.bind(null,u,b);m.has(b)||(m.add(b),b.then(T,T))})}function so(u,d){var m=d.deletions;if(m!==null)for(var b=0;b<m.length;b++){var T=m[b],E=u,F=d,W=F;e:for(;W!==null;){switch(W.tag){case 27:case 5:ds=W.stateNode,Nr=!1;break e;case 3:ds=W.stateNode.containerInfo,Nr=!0;break e;case 4:ds=W.stateNode.containerInfo,Nr=!0;break e}W=W.return}if(ds===null)throw Error(s(160));vV(E,F,T),ds=null,Nr=!1,E=T.alternate,E!==null&&(E.return=null),T.return=null}if(d.subtreeFlags&13878)for(d=d.child;d!==null;)wV(d,u),d=d.sibling}var Lo=null;function wV(u,d){var m=u.alternate,b=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:so(d,u),io(u),b&4&&(Xc(3,u,u.return),zy(3,u),Xc(5,u,u.return));break;case 1:so(d,u),io(u),b&512&&(Wn||m===null||kr(m,m.return)),b&64&&El&&(u=u.updateQueue,u!==null&&(b=u.callbacks,b!==null&&(m=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=m===null?b:m.concat(b))));break;case 26:var T=Lo;if(so(d,u),io(u),b&512&&(Wn||m===null||kr(m,m.return)),b&4){var E=m!==null?m.memoizedState:null;if(b=u.memoizedState,m===null)if(b===null)if(u.stateNode===null){e:{b=u.type,m=u.memoizedProps,T=T.ownerDocument||T;t:switch(b){case"title":E=T.getElementsByTagName("title")[0],(!E||E[Dc]||E[Vs]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=T.createElement(b),T.head.insertBefore(E,T.querySelector("head > title"))),li(E,b,m),E[Vs]=u,Pn(E),b=E;break e;case"link":var F=d3("link","href",T).get(b+(m.href||""));if(F){for(var W=0;W<F.length;W++)if(E=F[W],E.getAttribute("href")===(m.href==null?null:m.href)&&E.getAttribute("rel")===(m.rel==null?null:m.rel)&&E.getAttribute("title")===(m.title==null?null:m.title)&&E.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){F.splice(W,1);break t}}E=T.createElement(b),li(E,b,m),T.head.appendChild(E);break;case"meta":if(F=d3("meta","content",T).get(b+(m.content||""))){for(W=0;W<F.length;W++)if(E=F[W],E.getAttribute("content")===(m.content==null?null:""+m.content)&&E.getAttribute("name")===(m.name==null?null:m.name)&&E.getAttribute("property")===(m.property==null?null:m.property)&&E.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&E.getAttribute("charset")===(m.charSet==null?null:m.charSet)){F.splice(W,1);break t}}E=T.createElement(b),li(E,b,m),T.head.appendChild(E);break;default:throw Error(s(468,b))}E[Vs]=u,Pn(E),b=E}u.stateNode=b}else f3(T,u.type,u.stateNode);else u.stateNode=h3(T,b,u.memoizedProps);else E!==b?(E===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):E.count--,b===null?f3(T,u.type,u.stateNode):h3(T,b,u.memoizedProps)):b===null&&u.stateNode!==null&&fV(u,u.memoizedProps,m.memoizedProps)}break;case 27:if(b&4&&u.alternate===null){T=u.stateNode,E=u.memoizedProps;try{for(var q=T.firstChild;q;){var re=q.nextSibling,Se=q.nodeName;q[Dc]||Se==="HEAD"||Se==="BODY"||Se==="SCRIPT"||Se==="STYLE"||Se==="LINK"&&q.rel.toLowerCase()==="stylesheet"||T.removeChild(q),q=re}for(var Re=u.type,ge=T.attributes;ge.length;)T.removeAttributeNode(ge[0]);li(T,Re,E),T[Vs]=u,T[_s]=E}catch(Xe){fn(u,u.return,Xe)}}case 5:if(so(d,u),io(u),b&512&&(Wn||m===null||kr(m,m.return)),u.flags&32){T=u.stateNode;try{Kr(T,"")}catch(Xe){fn(u,u.return,Xe)}}b&4&&u.stateNode!=null&&(T=u.memoizedProps,fV(u,T,m!==null?m.memoizedProps:T)),b&1024&&(Fk=!0);break;case 6:if(so(d,u),io(u),b&4){if(u.stateNode===null)throw Error(s(162));b=u.memoizedProps,m=u.stateNode;try{m.nodeValue=b}catch(Xe){fn(u,u.return,Xe)}}break;case 3:if(x_=null,T=Lo,Lo=b_(d.containerInfo),so(d,u),Lo=T,io(u),b&4&&m!==null&&m.memoizedState.isDehydrated)try{ib(d.containerInfo)}catch(Xe){fn(u,u.return,Xe)}Fk&&(Fk=!1,_V(u));break;case 4:b=Lo,Lo=b_(u.stateNode.containerInfo),so(d,u),io(u),Lo=b;break;case 12:so(d,u),io(u);break;case 13:so(d,u),io(u),u.child.flags&8192&&u.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(Kk=vn()),b&4&&(b=u.updateQueue,b!==null&&(u.updateQueue=null,Vk(u,b)));break;case 22:if(b&512&&(Wn||m===null||kr(m,m.return)),q=u.memoizedState!==null,re=m!==null&&m.memoizedState!==null,Se=El,Re=Wn,El=Se||q,Wn=Re||re,so(d,u),Wn=Re,El=Se,io(u),d=u.stateNode,d._current=u,d._visibility&=-3,d._visibility|=d._pendingVisibility&2,b&8192&&(d._visibility=q?d._visibility&-2:d._visibility|1,q&&(d=El||Wn,m===null||re||d||np(u)),u.memoizedProps===null||u.memoizedProps.mode!=="manual"))e:for(m=null,d=u;;){if(d.tag===5||d.tag===26||d.tag===27){if(m===null){re=m=d;try{if(T=re.stateNode,q)E=T.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{F=re.stateNode,W=re.memoizedProps.style;var Te=W!=null&&W.hasOwnProperty("display")?W.display:null;F.style.display=Te==null||typeof Te=="boolean"?"":(""+Te).trim()}}catch(Xe){fn(re,re.return,Xe)}}}else if(d.tag===6){if(m===null){re=d;try{re.stateNode.nodeValue=q?"":re.memoizedProps}catch(Xe){fn(re,re.return,Xe)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===u)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===u)break e;for(;d.sibling===null;){if(d.return===null||d.return===u)break e;m===d&&(m=null),d=d.return}m===d&&(m=null),d.sibling.return=d.return,d=d.sibling}b&4&&(b=u.updateQueue,b!==null&&(m=b.retryQueue,m!==null&&(b.retryQueue=null,Vk(u,m))));break;case 19:so(d,u),io(u),b&4&&(b=u.updateQueue,b!==null&&(u.updateQueue=null,Vk(u,b)));break;case 21:break;default:so(d,u),io(u)}}function io(u){var d=u.flags;if(d&2){try{if(u.tag!==27){e:{for(var m=u.return;m!==null;){if(pV(m)){var b=m;break e}m=m.return}throw Error(s(160))}switch(b.tag){case 27:var T=b.stateNode,E=Lk(u);s_(u,E,T);break;case 5:var F=b.stateNode;b.flags&32&&(Kr(F,""),b.flags&=-33);var W=Lk(u);s_(u,W,F);break;case 3:case 4:var q=b.stateNode.containerInfo,re=Lk(u);Mk(u,re,q);break;default:throw Error(s(161))}}}catch(Se){fn(u,u.return,Se)}u.flags&=-3}d&4096&&(u.flags&=-4097)}function _V(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var d=u;_V(d),d.tag===5&&d.flags&1024&&d.stateNode.reset(),u=u.sibling}}function Il(u,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)yV(u,d.alternate,d),d=d.sibling}function np(u){for(u=u.child;u!==null;){var d=u;switch(d.tag){case 0:case 11:case 14:case 15:Xc(4,d,d.return),np(d);break;case 1:kr(d,d.return);var m=d.stateNode;typeof m.componentWillUnmount=="function"&&hV(d,d.return,m),np(d);break;case 26:case 27:case 5:kr(d,d.return),np(d);break;case 22:kr(d,d.return),d.memoizedState===null&&np(d);break;default:np(d)}u=u.sibling}}function Yc(u,d,m){for(m=m&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var b=d.alternate,T=u,E=d,F=E.flags;switch(E.tag){case 0:case 11:case 15:Yc(T,E,m),zy(4,E);break;case 1:if(Yc(T,E,m),b=E,T=b.stateNode,typeof T.componentDidMount=="function")try{T.componentDidMount()}catch(re){fn(b,b.return,re)}if(b=E,T=b.updateQueue,T!==null){var W=b.stateNode;try{var q=T.shared.hiddenCallbacks;if(q!==null)for(T.shared.hiddenCallbacks=null,T=0;T<q.length;T++)lV(q[T],W)}catch(re){fn(b,b.return,re)}}m&&F&64&&uV(E),jh(E,E.return);break;case 26:case 27:case 5:Yc(T,E,m),m&&b===null&&F&4&&dV(E),jh(E,E.return);break;case 12:Yc(T,E,m);break;case 13:Yc(T,E,m),m&&F&4&&xV(T,E);break;case 22:E.memoizedState===null&&Yc(T,E,m),jh(E,E.return);break;default:Yc(T,E,m)}d=d.sibling}}function zk(u,d){var m=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),u=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(u=d.memoizedState.cachePool.pool),u!==m&&(u!=null&&u.refCount++,m!=null&&Ay(m))}function Bk(u,d){u=null,d.alternate!==null&&(u=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==u&&(d.refCount++,u!=null&&Ay(u))}function Qc(u,d,m,b){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)TV(u,d,m,b),d=d.sibling}function TV(u,d,m,b){var T=d.flags;switch(d.tag){case 0:case 11:case 15:Qc(u,d,m,b),T&2048&&zy(9,d);break;case 3:Qc(u,d,m,b),T&2048&&(u=null,d.alternate!==null&&(u=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==u&&(d.refCount++,u!=null&&Ay(u)));break;case 12:if(T&2048){Qc(u,d,m,b),u=d.stateNode;try{var E=d.memoizedProps,F=E.id,W=E.onPostCommit;typeof W=="function"&&W(F,d.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(q){fn(d,d.return,q)}}else Qc(u,d,m,b);break;case 23:break;case 22:E=d.stateNode,d.memoizedState!==null?E._visibility&4?Qc(u,d,m,b):By(u,d):E._visibility&4?Qc(u,d,m,b):(E._visibility|=4,sp(u,d,m,b,(d.subtreeFlags&10256)!==0)),T&2048&&zk(d.alternate,d);break;case 24:Qc(u,d,m,b),T&2048&&Bk(d.alternate,d);break;default:Qc(u,d,m,b)}}function sp(u,d,m,b,T){for(T=T&&(d.subtreeFlags&10256)!==0,d=d.child;d!==null;){var E=u,F=d,W=m,q=b,re=F.flags;switch(F.tag){case 0:case 11:case 15:sp(E,F,W,q,T),zy(8,F);break;case 23:break;case 22:var Se=F.stateNode;F.memoizedState!==null?Se._visibility&4?sp(E,F,W,q,T):By(E,F):(Se._visibility|=4,sp(E,F,W,q,T)),T&&re&2048&&zk(F.alternate,F);break;case 24:sp(E,F,W,q,T),T&&re&2048&&Bk(F.alternate,F);break;default:sp(E,F,W,q,T)}d=d.sibling}}function By(u,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var m=u,b=d,T=b.flags;switch(b.tag){case 22:By(m,b),T&2048&&zk(b.alternate,b);break;case 24:By(m,b),T&2048&&Bk(b.alternate,b);break;default:By(m,b)}d=d.sibling}}var Uy=8192;function ip(u){if(u.subtreeFlags&Uy)for(u=u.child;u!==null;)SV(u),u=u.sibling}function SV(u){switch(u.tag){case 26:ip(u),u.flags&Uy&&u.memoizedState!==null&&nne(Lo,u.memoizedState,u.memoizedProps);break;case 5:ip(u);break;case 3:case 4:var d=Lo;Lo=b_(u.stateNode.containerInfo),ip(u),Lo=d;break;case 22:u.memoizedState===null&&(d=u.alternate,d!==null&&d.memoizedState!==null?(d=Uy,Uy=16777216,ip(u),Uy=d):ip(u));break;default:ip(u)}}function EV(u){var d=u.alternate;if(d!==null&&(u=d.child,u!==null)){d.child=null;do d=u.sibling,u.sibling=null,u=d;while(u!==null)}}function Wy(u){var d=u.deletions;if(u.flags&16){if(d!==null)for(var m=0;m<d.length;m++){var b=d[m];Ws=b,IV(b,u)}EV(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)CV(u),u=u.sibling}function CV(u){switch(u.tag){case 0:case 11:case 15:Wy(u),u.flags&2048&&Xc(9,u,u.return);break;case 3:Wy(u);break;case 12:Wy(u);break;case 22:var d=u.stateNode;u.memoizedState!==null&&d._visibility&4&&(u.return===null||u.return.tag!==13)?(d._visibility&=-5,i_(u)):Wy(u);break;default:Wy(u)}}function i_(u){var d=u.deletions;if(u.flags&16){if(d!==null)for(var m=0;m<d.length;m++){var b=d[m];Ws=b,IV(b,u)}EV(u)}for(u=u.child;u!==null;){switch(d=u,d.tag){case 0:case 11:case 15:Xc(8,d,d.return),i_(d);break;case 22:m=d.stateNode,m._visibility&4&&(m._visibility&=-5,i_(d));break;default:i_(d)}u=u.sibling}}function IV(u,d){for(;Ws!==null;){var m=Ws;switch(m.tag){case 0:case 11:case 15:Xc(8,m,d);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var b=m.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:Ay(m.memoizedState.cache)}if(b=m.child,b!==null)b.return=m,Ws=b;else e:for(m=u;Ws!==null;){b=Ws;var T=b.sibling,E=b.return;if(bV(b),b===m){Ws=null;break e}if(T!==null){T.return=E,Ws=T;break e}Ws=E}}}function mte(u,d,m,b){this.tag=u,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ro(u,d,m,b){return new mte(u,d,m,b)}function Uk(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Zc(u,d){var m=u.alternate;return m===null?(m=ro(u.tag,d,u.key,u.mode),m.elementType=u.elementType,m.type=u.type,m.stateNode=u.stateNode,m.alternate=u,u.alternate=m):(m.pendingProps=d,m.type=u.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=u.flags&31457280,m.childLanes=u.childLanes,m.lanes=u.lanes,m.child=u.child,m.memoizedProps=u.memoizedProps,m.memoizedState=u.memoizedState,m.updateQueue=u.updateQueue,d=u.dependencies,m.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},m.sibling=u.sibling,m.index=u.index,m.ref=u.ref,m.refCleanup=u.refCleanup,m}function kV(u,d){u.flags&=31457282;var m=u.alternate;return m===null?(u.childLanes=0,u.lanes=d,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=m.childLanes,u.lanes=m.lanes,u.child=m.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=m.memoizedProps,u.memoizedState=m.memoizedState,u.updateQueue=m.updateQueue,u.type=m.type,d=m.dependencies,u.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),u}function r_(u,d,m,b,T,E){var F=0;if(b=u,typeof u=="function")Uk(u)&&(F=1);else if(typeof u=="string")F=ene(u,m,Ze.current)?26:u==="html"||u==="head"||u==="body"?27:5;else e:switch(u){case l:return Gh(m.children,T,E,d);case c:F=8,T|=24;break;case h:return u=ro(12,m,d,T|2),u.elementType=h,u.lanes=E,u;case x:return u=ro(13,m,d,T),u.elementType=x,u.lanes=E,u;case v:return u=ro(19,m,d,T),u.elementType=v,u.lanes=E,u;case C:return NV(m,T,E,d);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case f:case g:F=10;break e;case p:F=9;break e;case y:F=11;break e;case w:F=14;break e;case S:F=16,b=null;break e}F=29,m=Error(s(130,u===null?"null":typeof u,"")),b=null}return d=ro(F,m,d,T),d.elementType=u,d.type=b,d.lanes=E,d}function Gh(u,d,m,b){return u=ro(7,u,b,d),u.lanes=m,u}function NV(u,d,m,b){u=ro(22,u,b,d),u.elementType=C,u.lanes=m;var T={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var E=T._current;if(E===null)throw Error(s(456));if(!(T._pendingVisibility&2)){var F=zc(E,2);F!==null&&(T._pendingVisibility|=2,Gi(F,E,2))}},attach:function(){var E=T._current;if(E===null)throw Error(s(456));if(T._pendingVisibility&2){var F=zc(E,2);F!==null&&(T._pendingVisibility&=-3,Gi(F,E,2))}}};return u.stateNode=T,u}function Wk(u,d,m){return u=ro(6,u,null,d),u.lanes=m,u}function Hk(u,d,m){return d=ro(4,u.children!==null?u.children:[],u.key,d),d.lanes=m,d.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},d}function kl(u){u.flags|=4}function AV(u,d){if(d.type!=="stylesheet"||d.state.loading&4)u.flags&=-16777217;else if(u.flags|=16777216,!p3(d)){if(d=no.current,d!==null&&((Mt&4194176)===Mt?_a!==null:(Mt&62914560)!==Mt&&!(Mt&536870912)||d!==_a))throw Iy=XI,qM;u.flags|=8192}}function o_(u,d){d!==null&&(u.flags|=4),u.flags&16384&&(d=u.tag!==22?kc():536870912,u.lanes|=d,op|=d)}function Hy(u,d){if(!Gt)switch(u.tailMode){case"hidden":d=u.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?u.tail=null:m.sibling=null;break;case"collapsed":m=u.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?d||u.tail===null?u.tail=null:u.tail.sibling=null:b.sibling=null}}function Ln(u){var d=u.alternate!==null&&u.alternate.child===u.child,m=0,b=0;if(d)for(var T=u.child;T!==null;)m|=T.lanes|T.childLanes,b|=T.subtreeFlags&31457280,b|=T.flags&31457280,T.return=u,T=T.sibling;else for(T=u.child;T!==null;)m|=T.lanes|T.childLanes,b|=T.subtreeFlags,b|=T.flags,T.return=u,T=T.sibling;return u.subtreeFlags|=b,u.childLanes=m,d}function gte(u,d,m){var b=d.pendingProps;switch(qI(d),d.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ln(d),null;case 1:return Ln(d),null;case 3:return m=d.stateNode,b=null,u!==null&&(b=u.memoizedState.cache),d.memoizedState.cache!==b&&(d.flags|=2048),Sl(Cs),xt(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(u===null||u.child===null)&&(Ty(d)?kl(d):u===null||u.memoizedState.isDehydrated&&!(d.flags&256)||(d.flags|=1024,Po!==null&&(Zk(Po),Po=null))),Ln(d),null;case 26:return m=d.memoizedState,u===null?(kl(d),m!==null?(Ln(d),AV(d,m)):(Ln(d),d.flags&=-16777217)):m?m!==u.memoizedState?(kl(d),Ln(d),AV(d,m)):(Ln(d),d.flags&=-16777217):(u.memoizedProps!==b&&kl(d),Ln(d),d.flags&=-16777217),null;case 27:Ht(d),m=bt.current;var T=d.type;if(u!==null&&d.stateNode!=null)u.memoizedProps!==b&&kl(d);else{if(!b){if(d.stateNode===null)throw Error(s(166));return Ln(d),null}u=Ze.current,Ty(d)?jM(d):(u=o3(T,b,m),d.stateNode=u,kl(d))}return Ln(d),null;case 5:if(Ht(d),m=d.type,u!==null&&d.stateNode!=null)u.memoizedProps!==b&&kl(d);else{if(!b){if(d.stateNode===null)throw Error(s(166));return Ln(d),null}if(u=Ze.current,Ty(d))jM(d);else{switch(T=y_(bt.current),u){case 1:u=T.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:u=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":u=T.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":u=T.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":u=T.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild);break;case"select":u=typeof b.is=="string"?T.createElement("select",{is:b.is}):T.createElement("select"),b.multiple?u.multiple=!0:b.size&&(u.size=b.size);break;default:u=typeof b.is=="string"?T.createElement(m,{is:b.is}):T.createElement(m)}}u[Vs]=d,u[_s]=b;e:for(T=d.child;T!==null;){if(T.tag===5||T.tag===6)u.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===d)break e;for(;T.sibling===null;){if(T.return===null||T.return===d)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}d.stateNode=u;e:switch(li(u,m,b),m){case"button":case"input":case"select":case"textarea":u=!!b.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&kl(d)}}return Ln(d),d.flags&=-16777217,null;case 6:if(u&&d.stateNode!=null)u.memoizedProps!==b&&kl(d);else{if(typeof b!="string"&&d.stateNode===null)throw Error(s(166));if(u=bt.current,Ty(d)){if(u=d.stateNode,m=d.memoizedProps,b=null,T=ji,T!==null)switch(T.tag){case 27:case 5:b=T.memoizedProps}u[Vs]=d,u=!!(u.nodeValue===m||b!==null&&b.suppressHydrationWarning===!0||e3(u.nodeValue,m)),u||Lh(d)}else u=y_(u).createTextNode(b),u[Vs]=d,d.stateNode=u}return Ln(d),null;case 13:if(b=d.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(T=Ty(d),b!==null&&b.dehydrated!==null){if(u===null){if(!T)throw Error(s(318));if(T=d.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(s(317));T[Vs]=d}else Sy(),!(d.flags&128)&&(d.memoizedState=null),d.flags|=4;Ln(d),T=!1}else Po!==null&&(Zk(Po),Po=null),T=!0;if(!T)return d.flags&256?(xl(d),d):(xl(d),null)}if(xl(d),d.flags&128)return d.lanes=m,d;if(m=b!==null,u=u!==null&&u.memoizedState!==null,m){b=d.child,T=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(T=b.alternate.memoizedState.cachePool.pool);var E=null;b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(E=b.memoizedState.cachePool.pool),E!==T&&(b.flags|=2048)}return m!==u&&m&&(d.child.flags|=8192),o_(d,d.updateQueue),Ln(d),null;case 4:return xt(),u===null&&cN(d.stateNode.containerInfo),Ln(d),null;case 10:return Sl(d.type),Ln(d),null;case 19:if(Me(Es),T=d.memoizedState,T===null)return Ln(d),null;if(b=(d.flags&128)!==0,E=T.rendering,E===null)if(b)Hy(T,!1);else{if(Hn!==0||u!==null&&u.flags&128)for(u=d.child;u!==null;){if(E=Ww(u),E!==null){for(d.flags|=128,Hy(T,!1),u=E.updateQueue,d.updateQueue=u,o_(d,u),d.subtreeFlags=0,u=m,m=d.child;m!==null;)kV(m,u),m=m.sibling;return ze(Es,Es.current&1|2),d.child}u=u.sibling}T.tail!==null&&vn()>a_&&(d.flags|=128,b=!0,Hy(T,!1),d.lanes=4194304)}else{if(!b)if(u=Ww(E),u!==null){if(d.flags|=128,b=!0,u=u.updateQueue,d.updateQueue=u,o_(d,u),Hy(T,!0),T.tail===null&&T.tailMode==="hidden"&&!E.alternate&&!Gt)return Ln(d),null}else 2*vn()-T.renderingStartTime>a_&&m!==536870912&&(d.flags|=128,b=!0,Hy(T,!1),d.lanes=4194304);T.isBackwards?(E.sibling=d.child,d.child=E):(u=T.last,u!==null?u.sibling=E:d.child=E,T.last=E)}return T.tail!==null?(d=T.tail,T.rendering=d,T.tail=d.sibling,T.renderingStartTime=vn(),d.sibling=null,u=Es.current,ze(Es,b?u&1|2:u&1),d):(Ln(d),null);case 22:case 23:return xl(d),QI(),b=d.memoizedState!==null,u!==null?u.memoizedState!==null!==b&&(d.flags|=8192):b&&(d.flags|=8192),b?m&536870912&&!(d.flags&128)&&(Ln(d),d.subtreeFlags&6&&(d.flags|=8192)):Ln(d),m=d.updateQueue,m!==null&&o_(d,m.retryQueue),m=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),b=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),b!==m&&(d.flags|=2048),u!==null&&Me(Fh),null;case 24:return m=null,u!==null&&(m=u.memoizedState.cache),d.memoizedState.cache!==m&&(d.flags|=2048),Sl(Cs),Ln(d),null;case 25:return null}throw Error(s(156,d.tag))}function yte(u,d){switch(qI(d),d.tag){case 1:return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 3:return Sl(Cs),xt(),u=d.flags,u&65536&&!(u&128)?(d.flags=u&-65537|128,d):null;case 26:case 27:case 5:return Ht(d),null;case 13:if(xl(d),u=d.memoizedState,u!==null&&u.dehydrated!==null){if(d.alternate===null)throw Error(s(340));Sy()}return u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 19:return Me(Es),null;case 4:return xt(),null;case 10:return Sl(d.type),null;case 22:case 23:return xl(d),QI(),u!==null&&Me(Fh),u=d.flags,u&65536?(d.flags=u&-65537|128,d):null;case 24:return Sl(Cs),null;case 25:return null;default:return null}}function RV(u,d){switch(qI(d),d.tag){case 3:Sl(Cs),xt();break;case 26:case 27:case 5:Ht(d);break;case 4:xt();break;case 13:xl(d);break;case 19:Me(Es);break;case 10:Sl(d.type);break;case 22:case 23:xl(d),QI(),u!==null&&Me(Fh);break;case 24:Sl(Cs)}}var bte={getCacheForType:function(u){var d=bi(Cs),m=d.data.get(u);return m===void 0&&(m=u(),d.data.set(u,m)),m}},vte=typeof WeakMap=="function"?WeakMap:Map,Mn=0,xn=null,Ct=null,Mt=0,wn=0,Ar=null,Nl=!1,rp=!1,jk=!1,Al=0,Hn=0,Jc=0,qh=0,Gk=0,oo=0,op=0,jy=null,Sa=null,qk=!1,Kk=0,a_=1/0,l_=null,eu=null,c_=!1,Kh=null,Gy=0,Xk=0,Yk=null,qy=0,Qk=null;function Rr(){if(Mn&2&&Mt!==0)return Mt&-Mt;if(k.T!==null){var u=Qf;return u!==0?u:rN()}return mw()}function DV(){oo===0&&(oo=!(Mt&536870912)||Gt?ry():536870912);var u=no.current;return u!==null&&(u.flags|=32),oo}function Gi(u,d,m){(u===xn&&wn===2||u.cancelPendingCommit!==null)&&(ap(u,0),Rl(u,Mt,oo,!1)),ts(u,m),(!(Mn&2)||u!==xn)&&(u===xn&&(!(Mn&2)&&(qh|=m),Hn===4&&Rl(u,Mt,oo,!1)),Ea(u))}function $V(u,d,m){if(Mn&6)throw Error(s(327));var b=!m&&(d&60)===0&&(d&u.expiredLanes)===0||Ic(u,d),T=b?_te(u,d):tN(u,d,!0),E=b;do{if(T===0){rp&&!b&&Rl(u,d,0,!1);break}else if(T===6)Rl(u,d,0,!Nl);else{if(m=u.current.alternate,E&&!xte(m)){T=tN(u,d,!1),E=!1;continue}if(T===2){if(E=d,u.errorRecoveryDisabledLanes&E)var F=0;else F=u.pendingLanes&-536870913,F=F!==0?F:F&536870912?536870912:0;if(F!==0){d=F;e:{var W=u;T=jy;var q=W.current.memoizedState.isDehydrated;if(q&&(ap(W,F).flags|=256),F=tN(W,F,!1),F!==2){if(jk&&!q){W.errorRecoveryDisabledLanes|=E,qh|=E,T=4;break e}E=Sa,Sa=T,E!==null&&Zk(E)}T=F}if(E=!1,T!==2)continue}}if(T===1){ap(u,0),Rl(u,d,0,!0);break}e:{switch(b=u,T){case 0:case 1:throw Error(s(345));case 4:if((d&4194176)===d){Rl(b,d,oo,!Nl);break e}break;case 2:Sa=null;break;case 3:case 5:break;default:throw Error(s(329))}if(b.finishedWork=m,b.finishedLanes=d,(d&62914560)===d&&(E=Kk+300-vn(),10<E)){if(Rl(b,d,oo,!Nl),Gr(b,0)!==0)break e;b.timeoutHandle=s3(OV.bind(null,b,m,Sa,l_,qk,d,oo,qh,op,Nl,2,-0,0),E);break e}OV(b,m,Sa,l_,qk,d,oo,qh,op,Nl,0,-0,0)}}break}while(!0);Ea(u)}function Zk(u){Sa===null?Sa=u:Sa.push.apply(Sa,u)}function OV(u,d,m,b,T,E,F,W,q,re,Se,Re,ge){var Te=d.subtreeFlags;if((Te&8192||(Te&16785408)===16785408)&&(Jy={stylesheets:null,count:0,unsuspend:tne},SV(d),d=sne(),d!==null)){u.cancelPendingCommit=d(BV.bind(null,u,m,b,T,F,W,q,1,Re,ge)),Rl(u,E,F,!re);return}BV(u,m,b,T,F,W,q,Se,Re,ge)}function xte(u){for(var d=u;;){var m=d.tag;if((m===0||m===11||m===15)&&d.flags&16384&&(m=d.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var b=0;b<m.length;b++){var T=m[b],E=T.getSnapshot;T=T.value;try{if(!Ir(E(),T))return!1}catch{return!1}}if(m=d.child,d.subtreeFlags&16384&&m!==null)m.return=d,d=m;else{if(d===u)break;for(;d.sibling===null;){if(d.return===null||d.return===u)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Rl(u,d,m,b){d&=~Gk,d&=~qh,u.suspendedLanes|=d,u.pingedLanes&=~d,b&&(u.warmLanes|=d),b=u.expirationTimes;for(var T=d;0<T;){var E=31-Ui(T),F=1<<E;b[E]=-1,T&=~F}m!==0&&Nc(u,m,d)}function u_(){return Mn&6?!0:(Ky(0),!1)}function Jk(){if(Ct!==null){if(wn===0)var u=Ct.return;else u=Ct,Tl=Wh=null,rk(u),Xf=null,ky=0,u=Ct;for(;u!==null;)RV(u.alternate,u),u=u.return;Ct=null}}function ap(u,d){u.finishedWork=null,u.finishedLanes=0;var m=u.timeoutHandle;m!==-1&&(u.timeoutHandle=-1,Vte(m)),m=u.cancelPendingCommit,m!==null&&(u.cancelPendingCommit=null,m()),Jk(),xn=u,Ct=m=Zc(u.current,null),Mt=d,wn=0,Ar=null,Nl=!1,rp=Ic(u,d),jk=!1,op=oo=Gk=qh=Jc=Hn=0,Sa=jy=null,qk=!1,d&8&&(d|=d&32);var b=u.entangledLanes;if(b!==0)for(u=u.entanglements,b&=d;0<b;){var T=31-Ui(b),E=1<<T;d|=u[T],b&=~E}return Al=d,Ow(),m}function PV(u,d){wt=null,k.H=Ta,d===Cy?(d=YM(),wn=3):d===qM?(d=YM(),wn=4):wn=d===KF?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,Ar=d,Ct===null&&(Hn=1,e_(u,Jr(d,u.current)))}function LV(){var u=k.H;return k.H=Ta,u===null?Ta:u}function MV(){var u=k.A;return k.A=bte,u}function eN(){Hn=4,Nl||(Mt&4194176)!==Mt&&no.current!==null||(rp=!0),!(Jc&134217727)&&!(qh&134217727)||xn===null||Rl(xn,Mt,oo,!1)}function tN(u,d,m){var b=Mn;Mn|=2;var T=LV(),E=MV();(xn!==u||Mt!==d)&&(l_=null,ap(u,d)),d=!1;var F=Hn;e:do try{if(wn!==0&&Ct!==null){var W=Ct,q=Ar;switch(wn){case 8:Jk(),F=6;break e;case 3:case 2:case 6:no.current===null&&(d=!0);var re=wn;if(wn=0,Ar=null,lp(u,W,q,re),m&&rp){F=0;break e}break;default:re=wn,wn=0,Ar=null,lp(u,W,q,re)}}wte(),F=Hn;break}catch(Se){PV(u,Se)}while(!0);return d&&u.shellSuspendCounter++,Tl=Wh=null,Mn=b,k.H=T,k.A=E,Ct===null&&(xn=null,Mt=0,Ow()),F}function wte(){for(;Ct!==null;)FV(Ct)}function _te(u,d){var m=Mn;Mn|=2;var b=LV(),T=MV();xn!==u||Mt!==d?(l_=null,a_=vn()+500,ap(u,d)):rp=Ic(u,d);e:do try{if(wn!==0&&Ct!==null){d=Ct;var E=Ar;t:switch(wn){case 1:wn=0,Ar=null,lp(u,d,E,1);break;case 2:if(KM(E)){wn=0,Ar=null,VV(d);break}d=function(){wn===2&&xn===u&&(wn=7),Ea(u)},E.then(d,d);break e;case 3:wn=7;break e;case 4:wn=5;break e;case 7:KM(E)?(wn=0,Ar=null,VV(d)):(wn=0,Ar=null,lp(u,d,E,7));break;case 5:var F=null;switch(Ct.tag){case 26:F=Ct.memoizedState;case 5:case 27:var W=Ct;if(!F||p3(F)){wn=0,Ar=null;var q=W.sibling;if(q!==null)Ct=q;else{var re=W.return;re!==null?(Ct=re,h_(re)):Ct=null}break t}}wn=0,Ar=null,lp(u,d,E,5);break;case 6:wn=0,Ar=null,lp(u,d,E,6);break;case 8:Jk(),Hn=6;break e;default:throw Error(s(462))}}Tte();break}catch(Se){PV(u,Se)}while(!0);return Tl=Wh=null,k.H=b,k.A=T,Mn=m,Ct!==null?0:(xn=null,Mt=0,Ow(),Hn)}function Tte(){for(;Ct!==null&&!ii();)FV(Ct)}function FV(u){var d=oV(u.alternate,u,Al);u.memoizedProps=u.pendingProps,d===null?h_(u):Ct=d}function VV(u){var d=u,m=d.alternate;switch(d.tag){case 15:case 0:d=eV(m,d,d.pendingProps,d.type,void 0,Mt);break;case 11:d=eV(m,d,d.pendingProps,d.type.render,d.ref,Mt);break;case 5:rk(d);default:RV(m,d),d=Ct=kV(d,Al),d=oV(m,d,Al)}u.memoizedProps=u.pendingProps,d===null?h_(u):Ct=d}function lp(u,d,m,b){Tl=Wh=null,rk(d),Xf=null,ky=0;var T=d.return;try{if(hte(u,T,d,m,Mt)){Hn=1,e_(u,Jr(m,u.current)),Ct=null;return}}catch(E){if(T!==null)throw Ct=T,E;Hn=1,e_(u,Jr(m,u.current)),Ct=null;return}d.flags&32768?(Gt||b===1?u=!0:rp||Mt&536870912?u=!1:(Nl=u=!0,(b===2||b===3||b===6)&&(b=no.current,b!==null&&b.tag===13&&(b.flags|=16384))),zV(d,u)):h_(d)}function h_(u){var d=u;do{if(d.flags&32768){zV(d,Nl);return}u=d.return;var m=gte(d.alternate,d,Al);if(m!==null){Ct=m;return}if(d=d.sibling,d!==null){Ct=d;return}Ct=d=u}while(d!==null);Hn===0&&(Hn=5)}function zV(u,d){do{var m=yte(u.alternate,u);if(m!==null){m.flags&=32767,Ct=m;return}if(m=u.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!d&&(u=u.sibling,u!==null)){Ct=u;return}Ct=u=m}while(u!==null);Hn=6,Ct=null}function BV(u,d,m,b,T,E,F,W,q,re){var Se=k.T,Re=pe.p;try{pe.p=2,k.T=null,Ste(u,d,m,b,Re,T,E,F,W,q,re)}finally{k.T=Se,pe.p=Re}}function Ste(u,d,m,b,T,E,F,W){do cp();while(Kh!==null);if(Mn&6)throw Error(s(327));var q=u.finishedWork;if(b=u.finishedLanes,q===null)return null;if(u.finishedWork=null,u.finishedLanes=0,q===u.current)throw Error(s(177));u.callbackNode=null,u.callbackPriority=0,u.cancelPendingCommit=null;var re=q.lanes|q.childLanes;if(re|=HI,fw(u,b,re,E,F,W),u===xn&&(Ct=xn=null,Mt=0),!(q.subtreeFlags&10256)&&!(q.flags&10256)||c_||(c_=!0,Xk=re,Yk=m,kte(Ms,function(){return cp(),null})),m=(q.flags&15990)!==0,q.subtreeFlags&15990||m?(m=k.T,k.T=null,E=pe.p,pe.p=2,F=Mn,Mn|=4,fte(u,q),wV(q,u),Kee(fN,u.containerInfo),T_=!!dN,fN=dN=null,u.current=q,yV(u,q.alternate,q),Tr(),Mn=F,pe.p=E,k.T=m):u.current=q,c_?(c_=!1,Kh=u,Gy=b):UV(u,re),re=u.pendingLanes,re===0&&(eu=null),vh(q.stateNode),Ea(u),d!==null)for(T=u.onRecoverableError,q=0;q<d.length;q++)re=d[q],T(re.value,{componentStack:re.stack});return Gy&3&&cp(),re=u.pendingLanes,b&4194218&&re&42?u===Qk?qy++:(qy=0,Qk=u):qy=0,Ky(0),null}function UV(u,d){(u.pooledCacheLanes&=d)===0&&(d=u.pooledCache,d!=null&&(u.pooledCache=null,Ay(d)))}function cp(){if(Kh!==null){var u=Kh,d=Xk;Xk=0;var m=pw(Gy),b=k.T,T=pe.p;try{if(pe.p=32>m?32:m,k.T=null,Kh===null)var E=!1;else{m=Yk,Yk=null;var F=Kh,W=Gy;if(Kh=null,Gy=0,Mn&6)throw Error(s(331));var q=Mn;if(Mn|=4,CV(F.current),TV(F,F.current,W,m),Mn=q,Ky(0,!1),Fs&&typeof Fs.onPostCommitFiberRoot=="function")try{Fs.onPostCommitFiberRoot(Sr,F)}catch{}E=!0}return E}finally{pe.p=T,k.T=b,UV(u,d)}}return!1}function WV(u,d,m){d=Jr(m,d),d=vk(u.stateNode,d,2),u=Kc(u,d,2),u!==null&&(ts(u,2),Ea(u))}function fn(u,d,m){if(u.tag===3)WV(u,u,m);else for(;d!==null;){if(d.tag===3){WV(d,u,m);break}else if(d.tag===1){var b=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(eu===null||!eu.has(b))){u=Jr(m,u),m=GF(2),b=Kc(d,m,2),b!==null&&(qF(m,b,d,u),ts(b,2),Ea(b));break}}d=d.return}}function nN(u,d,m){var b=u.pingCache;if(b===null){b=u.pingCache=new vte;var T=new Set;b.set(d,T)}else T=b.get(d),T===void 0&&(T=new Set,b.set(d,T));T.has(m)||(jk=!0,T.add(m),u=Ete.bind(null,u,d,m),d.then(u,u))}function Ete(u,d,m){var b=u.pingCache;b!==null&&b.delete(d),u.pingedLanes|=u.suspendedLanes&m,u.warmLanes&=~m,xn===u&&(Mt&m)===m&&(Hn===4||Hn===3&&(Mt&62914560)===Mt&&300>vn()-Kk?!(Mn&2)&&ap(u,0):Gk|=m,op===Mt&&(op=0)),Ea(u)}function HV(u,d){d===0&&(d=kc()),u=zc(u,d),u!==null&&(ts(u,d),Ea(u))}function Cte(u){var d=u.memoizedState,m=0;d!==null&&(m=d.retryLane),HV(u,m)}function Ite(u,d){var m=0;switch(u.tag){case 13:var b=u.stateNode,T=u.memoizedState;T!==null&&(m=T.retryLane);break;case 19:b=u.stateNode;break;case 22:b=u.stateNode._retryCache;break;default:throw Error(s(314))}b!==null&&b.delete(d),HV(u,m)}function kte(u,d){return bn(u,d)}var d_=null,up=null,sN=!1,f_=!1,iN=!1,Xh=0;function Ea(u){u!==up&&u.next===null&&(up===null?d_=up=u:up=up.next=u),f_=!0,sN||(sN=!0,Ate(Nte))}function Ky(u,d){if(!iN&&f_){iN=!0;do for(var m=!1,b=d_;b!==null;){if(u!==0){var T=b.pendingLanes;if(T===0)var E=0;else{var F=b.suspendedLanes,W=b.pingedLanes;E=(1<<31-Ui(42|u)+1)-1,E&=T&~(F&~W),E=E&201326677?E&201326677|1:E?E|2:0}E!==0&&(m=!0,qV(b,E))}else E=Mt,E=Gr(b,b===xn?E:0),!(E&3)||Ic(b,E)||(m=!0,qV(b,E));b=b.next}while(m);iN=!1}}function Nte(){f_=sN=!1;var u=0;Xh!==0&&(Fte()&&(u=Xh),Xh=0);for(var d=vn(),m=null,b=d_;b!==null;){var T=b.next,E=jV(b,d);E===0?(b.next=null,m===null?d_=T:m.next=T,T===null&&(up=m)):(m=b,(u!==0||E&3)&&(f_=!0)),b=T}Ky(u)}function jV(u,d){for(var m=u.suspendedLanes,b=u.pingedLanes,T=u.expirationTimes,E=u.pendingLanes&-62914561;0<E;){var F=31-Ui(E),W=1<<F,q=T[F];q===-1?(!(W&m)||W&b)&&(T[F]=kf(W,d)):q<=d&&(u.expiredLanes|=W),E&=~W}if(d=xn,m=Mt,m=Gr(u,u===d?m:0),b=u.callbackNode,m===0||u===d&&wn===2||u.cancelPendingCommit!==null)return b!==null&&b!==null&&Bi(b),u.callbackNode=null,u.callbackPriority=0;if(!(m&3)||Ic(u,m)){if(d=m&-m,d===u.callbackPriority)return d;switch(b!==null&&Bi(b),pw(m)){case 2:case 8:m=dn;break;case 32:m=Ms;break;case 268435456:m=al;break;default:m=Ms}return b=GV.bind(null,u),m=bn(m,b),u.callbackPriority=d,u.callbackNode=m,d}return b!==null&&b!==null&&Bi(b),u.callbackPriority=2,u.callbackNode=null,2}function GV(u,d){var m=u.callbackNode;if(cp()&&u.callbackNode!==m)return null;var b=Mt;return b=Gr(u,u===xn?b:0),b===0?null:($V(u,b,d),jV(u,vn()),u.callbackNode!=null&&u.callbackNode===m?GV.bind(null,u):null)}function qV(u,d){if(cp())return null;$V(u,d,!0)}function Ate(u){zte(function(){Mn&6?bn(an,u):u()})}function rN(){return Xh===0&&(Xh=ry()),Xh}function KV(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:pa(""+u)}function XV(u,d){var m=d.ownerDocument.createElement("input");return m.name=d.name,m.value=d.value,u.id&&m.setAttribute("form",u.id),d.parentNode.insertBefore(m,d),u=new FormData(u),m.parentNode.removeChild(m),u}function Rte(u,d,m,b,T){if(d==="submit"&&m&&m.stateNode===T){var E=KV((T[_s]||null).action),F=b.submitter;F&&(d=(d=F[_s]||null)?KV(d.formAction):F.getAttribute("formAction"),d!==null&&(E=d,F=null));var W=new Pf("action","action",null,b,T);u.push({event:W,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(Xh!==0){var q=F?XV(T,F):new FormData(T);pk(m,{pending:!0,data:q,method:T.method,action:E},null,q)}}else typeof E=="function"&&(W.preventDefault(),q=F?XV(T,F):new FormData(T),pk(m,{pending:!0,data:q,method:T.method,action:E},E,q))},currentTarget:T}]})}}for(var oN=0;oN<BM.length;oN++){var aN=BM[oN],Dte=aN.toLowerCase(),$te=aN[0].toUpperCase()+aN.slice(1);Oo(Dte,"on"+$te)}Oo(LM,"onAnimationEnd"),Oo(MM,"onAnimationIteration"),Oo(FM,"onAnimationStart"),Oo("dblclick","onDoubleClick"),Oo("focusin","onFocus"),Oo("focusout","onBlur"),Oo(Yee,"onTransitionRun"),Oo(Qee,"onTransitionStart"),Oo(Zee,"onTransitionCancel"),Oo(VM,"onTransitionEnd"),ar("onMouseEnter",["mouseout","mouseover"]),ar("onMouseLeave",["mouseout","mouseover"]),ar("onPointerEnter",["pointerout","pointerover"]),ar("onPointerLeave",["pointerout","pointerover"]),Er("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Er("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Er("onBeforeInput",["compositionend","keypress","textInput","paste"]),Er("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Er("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Er("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ote=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xy));function YV(u,d){d=(d&4)!==0;for(var m=0;m<u.length;m++){var b=u[m],T=b.event;b=b.listeners;e:{var E=void 0;if(d)for(var F=b.length-1;0<=F;F--){var W=b[F],q=W.instance,re=W.currentTarget;if(W=W.listener,q!==E&&T.isPropagationStopped())break e;E=W,T.currentTarget=re;try{E(T)}catch(Se){Jw(Se)}T.currentTarget=null,E=q}else for(F=0;F<b.length;F++){if(W=b[F],q=W.instance,re=W.currentTarget,W=W.listener,q!==E&&T.isPropagationStopped())break e;E=W,T.currentTarget=re;try{E(T)}catch(Se){Jw(Se)}T.currentTarget=null,E=q}}}}function Rt(u,d){var m=d[xh];m===void 0&&(m=d[xh]=new Set);var b=u+"__bubble";m.has(b)||(QV(d,u,2,!1),m.add(b))}function lN(u,d,m){var b=0;d&&(b|=4),QV(m,u,b,d)}var p_="_reactListening"+Math.random().toString(36).slice(2);function cN(u){if(!u[p_]){u[p_]=!0,ay.forEach(function(m){m!=="selectionchange"&&(Ote.has(m)||lN(m,!1,u),lN(m,!0,u))});var d=u.nodeType===9?u:u.ownerDocument;d===null||d[p_]||(d[p_]=!0,lN("selectionchange",!1,d))}}function QV(u,d,m,b){switch(x3(d)){case 2:var T=one;break;case 8:T=ane;break;default:T=_N}m=T.bind(null,d,m,u),T=void 0,!Yr||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(T=!0),b?T!==void 0?u.addEventListener(d,m,{capture:!0,passive:T}):u.addEventListener(d,m,!0):T!==void 0?u.addEventListener(d,m,{passive:T}):u.addEventListener(d,m,!1)}function uN(u,d,m,b,T){var E=b;if(!(d&1)&&!(d&2)&&b!==null)e:for(;;){if(b===null)return;var F=b.tag;if(F===3||F===4){var W=b.stateNode.containerInfo;if(W===T||W.nodeType===8&&W.parentNode===T)break;if(F===4)for(F=b.return;F!==null;){var q=F.tag;if((q===3||q===4)&&(q=F.stateNode.containerInfo,q===T||q.nodeType===8&&q.parentNode===T))return;F=F.return}for(;W!==null;){if(F=$o(W),F===null)return;if(q=F.tag,q===5||q===6||q===26||q===27){b=E=F;continue e}W=W.parentNode}}b=b.return}vw(function(){var re=E,Se=Of(m),Re=[];e:{var ge=zM.get(u);if(ge!==void 0){var Te=Pf,Xe=u;switch(u){case"keypress":if(ga(m)===0)break e;case"keydown":case"keyup":Te=Bf;break;case"focusin":Xe="focus",Te=Ff;break;case"focusout":Xe="blur",Te=Ff;break;case"beforeblur":case"afterblur":Te=Ff;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=Qr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=LI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=Iw;break;case LM:case MM:case FM:Te=Vf;break;case VM:Te=Nw;break;case"scroll":case"scrollend":Te=xw;break;case"wheel":Te=Uf;break;case"copy":case"cut":case"paste":Te=zf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=vy;break;case"toggle":case"beforetoggle":Te=Rw}var lt=(d&4)!==0,jn=!lt&&(u==="scroll"||u==="scrollend"),ue=lt?ge!==null?ge+"Capture":null:ge;lt=[];for(var ie=re,me;ie!==null;){var Ce=ie;if(me=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||me===null||ue===null||(Ce=Eh(ie,ue),Ce!=null&&lt.push(Yy(ie,Ce,me))),jn)break;ie=ie.return}0<lt.length&&(ge=new Te(ge,Xe,null,m,Se),Re.push({event:ge,listeners:lt}))}}if(!(d&7)){e:{if(ge=u==="mouseover"||u==="pointerover",Te=u==="mouseout"||u==="pointerout",ge&&m!==Xr&&(Xe=m.relatedTarget||m.fromElement)&&($o(Xe)||Xe[cl]))break e;if((Te||ge)&&(ge=Se.window===Se?Se:(ge=Se.ownerDocument)?ge.defaultView||ge.parentWindow:window,Te?(Xe=m.relatedTarget||m.toElement,Te=re,Xe=Xe?$o(Xe):null,Xe!==null&&(jn=Z(Xe),lt=Xe.tag,Xe!==jn||lt!==5&&lt!==27&&lt!==6)&&(Xe=null)):(Te=null,Xe=re),Te!==Xe)){if(lt=Qr,Ce="onMouseLeave",ue="onMouseEnter",ie="mouse",(u==="pointerout"||u==="pointerover")&&(lt=vy,Ce="onPointerLeave",ue="onPointerEnter",ie="pointer"),jn=Te==null?ge:$c(Te),me=Xe==null?ge:$c(Xe),ge=new lt(Ce,ie+"leave",Te,m,Se),ge.target=jn,ge.relatedTarget=me,Ce=null,$o(Se)===re&&(lt=new lt(ue,ie+"enter",Xe,m,Se),lt.target=me,lt.relatedTarget=jn,Ce=lt),jn=Ce,Te&&Xe)t:{for(lt=Te,ue=Xe,ie=0,me=lt;me;me=hp(me))ie++;for(me=0,Ce=ue;Ce;Ce=hp(Ce))me++;for(;0<ie-me;)lt=hp(lt),ie--;for(;0<me-ie;)ue=hp(ue),me--;for(;ie--;){if(lt===ue||ue!==null&&lt===ue.alternate)break t;lt=hp(lt),ue=hp(ue)}lt=null}else lt=null;Te!==null&&ZV(Re,ge,Te,lt,!1),Xe!==null&&jn!==null&&ZV(Re,jn,Xe,lt,!0)}}e:{if(ge=re?$c(re):window,Te=ge.nodeName&&ge.nodeName.toLowerCase(),Te==="select"||Te==="input"&&ge.type==="file")var je=EM;else if(Ss(ge))if(CM)je=Gee;else{je=Hee;var Tt=Wee}else Te=ge.nodeName,!Te||Te.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?re&&dy(re.elementType)&&(je=EM):je=jee;if(je&&(je=je(u,re))){yl(Re,je,m,Se);break e}Tt&&Tt(u,ge,re),u==="focusout"&&re&&ge.type==="number"&&re.memoizedProps.value!=null&&$f(ge,"number",ge.value)}switch(Tt=re?$c(re):window,u){case"focusin":(Ss(Tt)||Tt.contentEditable==="true")&&(Wf=Tt,BI=re,_y=null);break;case"focusout":_y=BI=Wf=null;break;case"mousedown":UI=!0;break;case"contextmenu":case"mouseup":case"dragend":UI=!1,OM(Re,m,Se);break;case"selectionchange":if(Xee)break;case"keydown":case"keyup":OM(Re,m,Se)}var Je;if(va)e:{switch(u){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else Pt?xe(u,m)&&(tt="onCompositionEnd"):u==="keydown"&&m.keyCode===229&&(tt="onCompositionStart");tt&&(M&&m.locale!=="ko"&&(Pt||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&Pt&&(Je=py()):(ma=Se,Vc="value"in ma?ma.value:ma.textContent,Pt=!0)),Tt=m_(re,tt),0<Tt.length&&(tt=new yy(tt,u,null,m,Se),Re.push({event:tt,listeners:Tt}),Je?tt.data=Je:(Je=Oe(m),Je!==null&&(tt.data=Je)))),(Je=D?Ts(u,m):Lt(u,m))&&(tt=m_(re,"onBeforeInput"),0<tt.length&&(Tt=new yy("onBeforeInput","beforeinput",null,m,Se),Re.push({event:Tt,listeners:tt}),Tt.data=Je)),Rte(Re,u,re,m,Se)}YV(Re,d)})}function Yy(u,d,m){return{instance:u,listener:d,currentTarget:m}}function m_(u,d){for(var m=d+"Capture",b=[];u!==null;){var T=u,E=T.stateNode;T=T.tag,T!==5&&T!==26&&T!==27||E===null||(T=Eh(u,m),T!=null&&b.unshift(Yy(u,T,E)),T=Eh(u,d),T!=null&&b.push(Yy(u,T,E))),u=u.return}return b}function hp(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function ZV(u,d,m,b,T){for(var E=d._reactName,F=[];m!==null&&m!==b;){var W=m,q=W.alternate,re=W.stateNode;if(W=W.tag,q!==null&&q===b)break;W!==5&&W!==26&&W!==27||re===null||(q=re,T?(re=Eh(m,E),re!=null&&F.unshift(Yy(m,re,q))):T||(re=Eh(m,E),re!=null&&F.push(Yy(m,re,q)))),m=m.return}F.length!==0&&u.push({event:d,listeners:F})}var Pte=/\r\n?/g,Lte=/\u0000|\uFFFD/g;function JV(u){return(typeof u=="string"?u:""+u).replace(Pte,`
`).replace(Lte,"")}function e3(u,d){return d=JV(d),JV(u)===d}function g_(){}function cn(u,d,m,b,T,E){switch(m){case"children":typeof b=="string"?d==="body"||d==="textarea"&&b===""||Kr(u,b):(typeof b=="number"||typeof b=="bigint")&&d!=="body"&&Kr(u,""+b);break;case"className":Lc(u,"class",b);break;case"tabIndex":Lc(u,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":Lc(u,m,b);break;case"style":bw(u,b,E);break;case"data":if(d!=="object"){Lc(u,"data",b);break}case"src":case"href":if(b===""&&(d!=="a"||m!=="href")){u.removeAttribute(m);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){u.removeAttribute(m);break}b=pa(""+b),u.setAttribute(m,b);break;case"action":case"formAction":if(typeof b=="function"){u.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(m==="formAction"?(d!=="input"&&cn(u,d,"name",T.name,T,null),cn(u,d,"formEncType",T.formEncType,T,null),cn(u,d,"formMethod",T.formMethod,T,null),cn(u,d,"formTarget",T.formTarget,T,null)):(cn(u,d,"encType",T.encType,T,null),cn(u,d,"method",T.method,T,null),cn(u,d,"target",T.target,T,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){u.removeAttribute(m);break}b=pa(""+b),u.setAttribute(m,b);break;case"onClick":b!=null&&(u.onclick=g_);break;case"onScroll":b!=null&&Rt("scroll",u);break;case"onScrollEnd":b!=null&&Rt("scrollend",u);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(s(61));if(m=b.__html,m!=null){if(T.children!=null)throw Error(s(60));u.innerHTML=m}}break;case"multiple":u.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":u.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){u.removeAttribute("xlink:href");break}m=pa(""+b),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?u.setAttribute(m,""+b):u.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?u.setAttribute(m,""):u.removeAttribute(m);break;case"capture":case"download":b===!0?u.setAttribute(m,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?u.setAttribute(m,b):u.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?u.setAttribute(m,b):u.removeAttribute(m);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?u.removeAttribute(m):u.setAttribute(m,b);break;case"popover":Rt("beforetoggle",u),Rt("toggle",u),Pc(u,"popover",b);break;case"xlinkActuate":qr(u,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":qr(u,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":qr(u,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":qr(u,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":qr(u,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":qr(u,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":qr(u,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":qr(u,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":qr(u,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":Pc(u,"is",b);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=OI.get(m)||m,Pc(u,m,b))}}function hN(u,d,m,b,T,E){switch(m){case"style":bw(u,b,E);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(s(61));if(m=b.__html,m!=null){if(T.children!=null)throw Error(s(60));u.innerHTML=m}}break;case"children":typeof b=="string"?Kr(u,b):(typeof b=="number"||typeof b=="bigint")&&Kr(u,""+b);break;case"onScroll":b!=null&&Rt("scroll",u);break;case"onScrollEnd":b!=null&&Rt("scrollend",u);break;case"onClick":b!=null&&(u.onclick=g_);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Rf.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(T=m.endsWith("Capture"),d=m.slice(2,T?m.length-7:void 0),E=u[_s]||null,E=E!=null?E[m]:null,typeof E=="function"&&u.removeEventListener(d,E,T),typeof b=="function")){typeof E!="function"&&E!==null&&(m in u?u[m]=null:u.hasAttribute(m)&&u.removeAttribute(m)),u.addEventListener(d,b,T);break e}m in u?u[m]=b:b===!0?u.setAttribute(m,""):Pc(u,m,b)}}}function li(u,d,m){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Rt("error",u),Rt("load",u);var b=!1,T=!1,E;for(E in m)if(m.hasOwnProperty(E)){var F=m[E];if(F!=null)switch(E){case"src":b=!0;break;case"srcSet":T=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,d));default:cn(u,d,E,F,m,null)}}T&&cn(u,d,"srcSet",m.srcSet,m,null),b&&cn(u,d,"src",m.src,m,null);return;case"input":Rt("invalid",u);var W=E=F=T=null,q=null,re=null;for(b in m)if(m.hasOwnProperty(b)){var Se=m[b];if(Se!=null)switch(b){case"name":T=Se;break;case"type":F=Se;break;case"checked":q=Se;break;case"defaultChecked":re=Se;break;case"value":E=Se;break;case"defaultValue":W=Se;break;case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(s(137,d));break;default:cn(u,d,b,Se,m,null)}}Th(u,E,W,q,re,F,T,!1),_h(u);return;case"select":Rt("invalid",u),b=F=E=null;for(T in m)if(m.hasOwnProperty(T)&&(W=m[T],W!=null))switch(T){case"value":E=W;break;case"defaultValue":F=W;break;case"multiple":b=W;default:cn(u,d,T,W,m,null)}d=E,m=F,u.multiple=!!b,d!=null?jt(u,!!b,d,!1):m!=null&&jt(u,!!b,m,!0);return;case"textarea":Rt("invalid",u),E=T=b=null;for(F in m)if(m.hasOwnProperty(F)&&(W=m[F],W!=null))switch(F){case"value":b=W;break;case"defaultValue":T=W;break;case"children":E=W;break;case"dangerouslySetInnerHTML":if(W!=null)throw Error(s(91));break;default:cn(u,d,F,W,m,null)}Fc(u,b,T,E),_h(u);return;case"option":for(q in m)if(m.hasOwnProperty(q)&&(b=m[q],b!=null))switch(q){case"selected":u.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:cn(u,d,q,b,m,null)}return;case"dialog":Rt("cancel",u),Rt("close",u);break;case"iframe":case"object":Rt("load",u);break;case"video":case"audio":for(b=0;b<Xy.length;b++)Rt(Xy[b],u);break;case"image":Rt("error",u),Rt("load",u);break;case"details":Rt("toggle",u);break;case"embed":case"source":case"link":Rt("error",u),Rt("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(re in m)if(m.hasOwnProperty(re)&&(b=m[re],b!=null))switch(re){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,d));default:cn(u,d,re,b,m,null)}return;default:if(dy(d)){for(Se in m)m.hasOwnProperty(Se)&&(b=m[Se],b!==void 0&&hN(u,d,Se,b,m,void 0));return}}for(W in m)m.hasOwnProperty(W)&&(b=m[W],b!=null&&cn(u,d,W,b,m,null))}function Mte(u,d,m,b){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var T=null,E=null,F=null,W=null,q=null,re=null,Se=null;for(Te in m){var Re=m[Te];if(m.hasOwnProperty(Te)&&Re!=null)switch(Te){case"checked":break;case"value":break;case"defaultValue":q=Re;default:b.hasOwnProperty(Te)||cn(u,d,Te,null,b,Re)}}for(var ge in b){var Te=b[ge];if(Re=m[ge],b.hasOwnProperty(ge)&&(Te!=null||Re!=null))switch(ge){case"type":E=Te;break;case"name":T=Te;break;case"checked":re=Te;break;case"defaultChecked":Se=Te;break;case"value":F=Te;break;case"defaultValue":W=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(s(137,d));break;default:Te!==Re&&cn(u,d,ge,Te,b,Re)}}Mc(u,F,W,q,re,Se,E,T);return;case"select":Te=F=W=ge=null;for(E in m)if(q=m[E],m.hasOwnProperty(E)&&q!=null)switch(E){case"value":break;case"multiple":Te=q;default:b.hasOwnProperty(E)||cn(u,d,E,null,b,q)}for(T in b)if(E=b[T],q=m[T],b.hasOwnProperty(T)&&(E!=null||q!=null))switch(T){case"value":ge=E;break;case"defaultValue":W=E;break;case"multiple":F=E;default:E!==q&&cn(u,d,T,E,b,q)}d=W,m=F,b=Te,ge!=null?jt(u,!!m,ge,!1):!!b!=!!m&&(d!=null?jt(u,!!m,d,!0):jt(u,!!m,m?[]:"",!1));return;case"textarea":Te=ge=null;for(W in m)if(T=m[W],m.hasOwnProperty(W)&&T!=null&&!b.hasOwnProperty(W))switch(W){case"value":break;case"children":break;default:cn(u,d,W,null,b,T)}for(F in b)if(T=b[F],E=m[F],b.hasOwnProperty(F)&&(T!=null||E!=null))switch(F){case"value":ge=T;break;case"defaultValue":Te=T;break;case"children":break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(s(91));break;default:T!==E&&cn(u,d,F,T,b,E)}Sh(u,ge,Te);return;case"option":for(var Xe in m)if(ge=m[Xe],m.hasOwnProperty(Xe)&&ge!=null&&!b.hasOwnProperty(Xe))switch(Xe){case"selected":u.selected=!1;break;default:cn(u,d,Xe,null,b,ge)}for(q in b)if(ge=b[q],Te=m[q],b.hasOwnProperty(q)&&ge!==Te&&(ge!=null||Te!=null))switch(q){case"selected":u.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:cn(u,d,q,ge,b,Te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var lt in m)ge=m[lt],m.hasOwnProperty(lt)&&ge!=null&&!b.hasOwnProperty(lt)&&cn(u,d,lt,null,b,ge);for(re in b)if(ge=b[re],Te=m[re],b.hasOwnProperty(re)&&ge!==Te&&(ge!=null||Te!=null))switch(re){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(s(137,d));break;default:cn(u,d,re,ge,b,Te)}return;default:if(dy(d)){for(var jn in m)ge=m[jn],m.hasOwnProperty(jn)&&ge!==void 0&&!b.hasOwnProperty(jn)&&hN(u,d,jn,void 0,b,ge);for(Se in b)ge=b[Se],Te=m[Se],!b.hasOwnProperty(Se)||ge===Te||ge===void 0&&Te===void 0||hN(u,d,Se,ge,b,Te);return}}for(var ue in m)ge=m[ue],m.hasOwnProperty(ue)&&ge!=null&&!b.hasOwnProperty(ue)&&cn(u,d,ue,null,b,ge);for(Re in b)ge=b[Re],Te=m[Re],!b.hasOwnProperty(Re)||ge===Te||ge==null&&Te==null||cn(u,d,Re,ge,b,Te)}var dN=null,fN=null;function y_(u){return u.nodeType===9?u:u.ownerDocument}function t3(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function n3(u,d){if(u===0)switch(d){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&d==="foreignObject"?0:u}function pN(u,d){return u==="textarea"||u==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.children=="bigint"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var mN=null;function Fte(){var u=window.event;return u&&u.type==="popstate"?u===mN?!1:(mN=u,!0):(mN=null,!1)}var s3=typeof setTimeout=="function"?setTimeout:void 0,Vte=typeof clearTimeout=="function"?clearTimeout:void 0,i3=typeof Promise=="function"?Promise:void 0,zte=typeof queueMicrotask=="function"?queueMicrotask:typeof i3<"u"?function(u){return i3.resolve(null).then(u).catch(Bte)}:s3;function Bte(u){setTimeout(function(){throw u})}function gN(u,d){var m=d,b=0;do{var T=m.nextSibling;if(u.removeChild(m),T&&T.nodeType===8)if(m=T.data,m==="/$"){if(b===0){u.removeChild(T),ib(d);return}b--}else m!=="$"&&m!=="$?"&&m!=="$!"||b++;m=T}while(m);ib(d)}function yN(u){var d=u.firstChild;for(d&&d.nodeType===10&&(d=d.nextSibling);d;){var m=d;switch(d=d.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":yN(m),wh(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}u.removeChild(m)}}function Ute(u,d,m,b){for(;u.nodeType===1;){var T=m;if(u.nodeName.toLowerCase()!==d.toLowerCase()){if(!b&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(b){if(!u[Dc])switch(d){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(E=u.getAttribute("rel"),E==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(E!==T.rel||u.getAttribute("href")!==(T.href==null?null:T.href)||u.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin)||u.getAttribute("title")!==(T.title==null?null:T.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(E=u.getAttribute("src"),(E!==(T.src==null?null:T.src)||u.getAttribute("type")!==(T.type==null?null:T.type)||u.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin))&&E&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(d==="input"&&u.type==="hidden"){var E=T.name==null?null:""+T.name;if(T.type==="hidden"&&u.getAttribute("name")===E)return u}else return u;if(u=Mo(u.nextSibling),u===null)break}return null}function Wte(u,d,m){if(d==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!m||(u=Mo(u.nextSibling),u===null))return null;return u}function Mo(u){for(;u!=null;u=u.nextSibling){var d=u.nodeType;if(d===1||d===3)break;if(d===8){if(d=u.data,d==="$"||d==="$!"||d==="$?"||d==="F!"||d==="F")break;if(d==="/$")return null}}return u}function r3(u){u=u.previousSibling;for(var d=0;u;){if(u.nodeType===8){var m=u.data;if(m==="$"||m==="$!"||m==="$?"){if(d===0)return u;d--}else m==="/$"&&d++}u=u.previousSibling}return null}function o3(u,d,m){switch(d=y_(m),u){case"html":if(u=d.documentElement,!u)throw Error(s(452));return u;case"head":if(u=d.head,!u)throw Error(s(453));return u;case"body":if(u=d.body,!u)throw Error(s(454));return u;default:throw Error(s(451))}}var ao=new Map,a3=new Set;function b_(u){return typeof u.getRootNode=="function"?u.getRootNode():u.ownerDocument}var Dl=pe.d;pe.d={f:Hte,r:jte,D:Gte,C:qte,L:Kte,m:Xte,X:Qte,S:Yte,M:Zte};function Hte(){var u=Dl.f(),d=u_();return u||d}function jte(u){var d=ul(u);d!==null&&d.tag===5&&d.type==="form"?OF(d):Dl.r(u)}var dp=typeof document>"u"?null:document;function l3(u,d,m){var b=dp;if(b&&typeof d=="string"&&d){var T=Un(d);T='link[rel="'+u+'"][href="'+T+'"]',typeof m=="string"&&(T+='[crossorigin="'+m+'"]'),a3.has(T)||(a3.add(T),u={rel:u,crossOrigin:m,href:d},b.querySelector(T)===null&&(d=b.createElement("link"),li(d,"link",u),Pn(d),b.head.appendChild(d)))}}function Gte(u){Dl.D(u),l3("dns-prefetch",u,null)}function qte(u,d){Dl.C(u,d),l3("preconnect",u,d)}function Kte(u,d,m){Dl.L(u,d,m);var b=dp;if(b&&u&&d){var T='link[rel="preload"][as="'+Un(d)+'"]';d==="image"&&m&&m.imageSrcSet?(T+='[imagesrcset="'+Un(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(T+='[imagesizes="'+Un(m.imageSizes)+'"]')):T+='[href="'+Un(u)+'"]';var E=T;switch(d){case"style":E=fp(u);break;case"script":E=pp(u)}ao.has(E)||(u=$({rel:"preload",href:d==="image"&&m&&m.imageSrcSet?void 0:u,as:d},m),ao.set(E,u),b.querySelector(T)!==null||d==="style"&&b.querySelector(Qy(E))||d==="script"&&b.querySelector(Zy(E))||(d=b.createElement("link"),li(d,"link",u),Pn(d),b.head.appendChild(d)))}}function Xte(u,d){Dl.m(u,d);var m=dp;if(m&&u){var b=d&&typeof d.as=="string"?d.as:"script",T='link[rel="modulepreload"][as="'+Un(b)+'"][href="'+Un(u)+'"]',E=T;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=pp(u)}if(!ao.has(E)&&(u=$({rel:"modulepreload",href:u},d),ao.set(E,u),m.querySelector(T)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(Zy(E)))return}b=m.createElement("link"),li(b,"link",u),Pn(b),m.head.appendChild(b)}}}function Yte(u,d,m){Dl.S(u,d,m);var b=dp;if(b&&u){var T=Oc(b).hoistableStyles,E=fp(u);d=d||"default";var F=T.get(E);if(!F){var W={loading:0,preload:null};if(F=b.querySelector(Qy(E)))W.loading=5;else{u=$({rel:"stylesheet",href:u,"data-precedence":d},m),(m=ao.get(E))&&bN(u,m);var q=F=b.createElement("link");Pn(q),li(q,"link",u),q._p=new Promise(function(re,Se){q.onload=re,q.onerror=Se}),q.addEventListener("load",function(){W.loading|=1}),q.addEventListener("error",function(){W.loading|=2}),W.loading|=4,v_(F,d,b)}F={type:"stylesheet",instance:F,count:1,state:W},T.set(E,F)}}}function Qte(u,d){Dl.X(u,d);var m=dp;if(m&&u){var b=Oc(m).hoistableScripts,T=pp(u),E=b.get(T);E||(E=m.querySelector(Zy(T)),E||(u=$({src:u,async:!0},d),(d=ao.get(T))&&vN(u,d),E=m.createElement("script"),Pn(E),li(E,"link",u),m.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},b.set(T,E))}}function Zte(u,d){Dl.M(u,d);var m=dp;if(m&&u){var b=Oc(m).hoistableScripts,T=pp(u),E=b.get(T);E||(E=m.querySelector(Zy(T)),E||(u=$({src:u,async:!0,type:"module"},d),(d=ao.get(T))&&vN(u,d),E=m.createElement("script"),Pn(E),li(E,"link",u),m.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},b.set(T,E))}}function c3(u,d,m,b){var T=(T=bt.current)?b_(T):null;if(!T)throw Error(s(446));switch(u){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(d=fp(m.href),m=Oc(T).hoistableStyles,b=m.get(d),b||(b={type:"style",instance:null,count:0,state:null},m.set(d,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){u=fp(m.href);var E=Oc(T).hoistableStyles,F=E.get(u);if(F||(T=T.ownerDocument||T,F={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(u,F),(E=T.querySelector(Qy(u)))&&!E._p&&(F.instance=E,F.state.loading=5),ao.has(u)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},ao.set(u,m),E||Jte(T,u,m,F.state))),d&&b===null)throw Error(s(528,""));return F}if(d&&b!==null)throw Error(s(529,""));return null;case"script":return d=m.async,m=m.src,typeof m=="string"&&d&&typeof d!="function"&&typeof d!="symbol"?(d=pp(m),m=Oc(T).hoistableScripts,b=m.get(d),b||(b={type:"script",instance:null,count:0,state:null},m.set(d,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,u))}}function fp(u){return'href="'+Un(u)+'"'}function Qy(u){return'link[rel="stylesheet"]['+u+"]"}function u3(u){return $({},u,{"data-precedence":u.precedence,precedence:null})}function Jte(u,d,m,b){u.querySelector('link[rel="preload"][as="style"]['+d+"]")?b.loading=1:(d=u.createElement("link"),b.preload=d,d.addEventListener("load",function(){return b.loading|=1}),d.addEventListener("error",function(){return b.loading|=2}),li(d,"link",m),Pn(d),u.head.appendChild(d))}function pp(u){return'[src="'+Un(u)+'"]'}function Zy(u){return"script[async]"+u}function h3(u,d,m){if(d.count++,d.instance===null)switch(d.type){case"style":var b=u.querySelector('style[data-href~="'+Un(m.href)+'"]');if(b)return d.instance=b,Pn(b),b;var T=$({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return b=(u.ownerDocument||u).createElement("style"),Pn(b),li(b,"style",T),v_(b,m.precedence,u),d.instance=b;case"stylesheet":T=fp(m.href);var E=u.querySelector(Qy(T));if(E)return d.state.loading|=4,d.instance=E,Pn(E),E;b=u3(m),(T=ao.get(T))&&bN(b,T),E=(u.ownerDocument||u).createElement("link"),Pn(E);var F=E;return F._p=new Promise(function(W,q){F.onload=W,F.onerror=q}),li(E,"link",b),d.state.loading|=4,v_(E,m.precedence,u),d.instance=E;case"script":return E=pp(m.src),(T=u.querySelector(Zy(E)))?(d.instance=T,Pn(T),T):(b=m,(T=ao.get(E))&&(b=$({},m),vN(b,T)),u=u.ownerDocument||u,T=u.createElement("script"),Pn(T),li(T,"link",b),u.head.appendChild(T),d.instance=T);case"void":return null;default:throw Error(s(443,d.type))}else d.type==="stylesheet"&&!(d.state.loading&4)&&(b=d.instance,d.state.loading|=4,v_(b,m.precedence,u));return d.instance}function v_(u,d,m){for(var b=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),T=b.length?b[b.length-1]:null,E=T,F=0;F<b.length;F++){var W=b[F];if(W.dataset.precedence===d)E=W;else if(E!==T)break}E?E.parentNode.insertBefore(u,E.nextSibling):(d=m.nodeType===9?m.head:m,d.insertBefore(u,d.firstChild))}function bN(u,d){u.crossOrigin==null&&(u.crossOrigin=d.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=d.referrerPolicy),u.title==null&&(u.title=d.title)}function vN(u,d){u.crossOrigin==null&&(u.crossOrigin=d.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=d.referrerPolicy),u.integrity==null&&(u.integrity=d.integrity)}var x_=null;function d3(u,d,m){if(x_===null){var b=new Map,T=x_=new Map;T.set(m,b)}else T=x_,b=T.get(m),b||(b=new Map,T.set(m,b));if(b.has(u))return b;for(b.set(u,null),m=m.getElementsByTagName(u),T=0;T<m.length;T++){var E=m[T];if(!(E[Dc]||E[Vs]||u==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var F=E.getAttribute(d)||"";F=u+F;var W=b.get(F);W?W.push(E):b.set(F,[E])}}return b}function f3(u,d,m){u=u.ownerDocument||u,u.head.insertBefore(m,d==="title"?u.querySelector("head > title"):null)}function ene(u,d,m){if(m===1||d.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof d.precedence!="string"||typeof d.href!="string"||d.href==="")break;return!0;case"link":if(typeof d.rel!="string"||typeof d.href!="string"||d.href===""||d.onLoad||d.onError)break;switch(d.rel){case"stylesheet":return u=d.disabled,typeof d.precedence=="string"&&u==null;default:return!0}case"script":if(d.async&&typeof d.async!="function"&&typeof d.async!="symbol"&&!d.onLoad&&!d.onError&&d.src&&typeof d.src=="string")return!0}return!1}function p3(u){return!(u.type==="stylesheet"&&!(u.state.loading&3))}var Jy=null;function tne(){}function nne(u,d,m){if(Jy===null)throw Error(s(475));var b=Jy;if(d.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&!(d.state.loading&4)){if(d.instance===null){var T=fp(m.href),E=u.querySelector(Qy(T));if(E){u=E._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(b.count++,b=w_.bind(b),u.then(b,b)),d.state.loading|=4,d.instance=E,Pn(E);return}E=u.ownerDocument||u,m=u3(m),(T=ao.get(T))&&bN(m,T),E=E.createElement("link"),Pn(E);var F=E;F._p=new Promise(function(W,q){F.onload=W,F.onerror=q}),li(E,"link",m),d.instance=E}b.stylesheets===null&&(b.stylesheets=new Map),b.stylesheets.set(d,u),(u=d.state.preload)&&!(d.state.loading&3)&&(b.count++,d=w_.bind(b),u.addEventListener("load",d),u.addEventListener("error",d))}}function sne(){if(Jy===null)throw Error(s(475));var u=Jy;return u.stylesheets&&u.count===0&&xN(u,u.stylesheets),0<u.count?function(d){var m=setTimeout(function(){if(u.stylesheets&&xN(u,u.stylesheets),u.unsuspend){var b=u.unsuspend;u.unsuspend=null,b()}},6e4);return u.unsuspend=d,function(){u.unsuspend=null,clearTimeout(m)}}:null}function w_(){if(this.count--,this.count===0){if(this.stylesheets)xN(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var __=null;function xN(u,d){u.stylesheets=null,u.unsuspend!==null&&(u.count++,__=new Map,d.forEach(ine,u),__=null,w_.call(u))}function ine(u,d){if(!(d.state.loading&4)){var m=__.get(u);if(m)var b=m.get(null);else{m=new Map,__.set(u,m);for(var T=u.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<T.length;E++){var F=T[E];(F.nodeName==="LINK"||F.getAttribute("media")!=="not all")&&(m.set(F.dataset.precedence,F),b=F)}b&&m.set(null,b)}T=d.instance,F=T.getAttribute("data-precedence"),E=m.get(F)||b,E===b&&m.set(null,T),m.set(F,T),this.count++,b=w_.bind(this),T.addEventListener("load",b),T.addEventListener("error",b),E?E.parentNode.insertBefore(T,E.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(T,u.firstChild)),d.state.loading|=4}}var eb={$$typeof:g,Provider:null,Consumer:null,_currentValue:_e,_currentValue2:_e,_threadCount:0};function rne(u,d,m,b,T,E,F,W){this.tag=1,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nf(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nf(0),this.hiddenUpdates=Nf(null),this.identifierPrefix=b,this.onUncaughtError=T,this.onCaughtError=E,this.onRecoverableError=F,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function m3(u,d,m,b,T,E,F,W,q,re,Se,Re){return u=new rne(u,d,m,F,W,q,re,Re),d=1,E===!0&&(d|=24),E=ro(3,null,null,d),u.current=E,E.stateNode=u,d=ZI(),d.refCount++,u.pooledCache=d,d.refCount++,E.memoizedState={element:b,isDehydrated:m,cache:d},Dk(E),u}function g3(u){return u?(u=Gf,u):Gf}function y3(u,d,m,b,T,E){T=g3(T),b.context===null?b.context=T:b.pendingContext=T,b=qc(d),b.payload={element:m},E=E===void 0?null:E,E!==null&&(b.callback=E),m=Kc(u,b,d),m!==null&&(Gi(m,u,d),My(m,u,d))}function b3(u,d){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var m=u.retryLane;u.retryLane=m!==0&&m<d?m:d}}function wN(u,d){b3(u,d),(u=u.alternate)&&b3(u,d)}function v3(u){if(u.tag===13){var d=zc(u,67108864);d!==null&&Gi(d,u,67108864),wN(u,67108864)}}var T_=!0;function one(u,d,m,b){var T=k.T;k.T=null;var E=pe.p;try{pe.p=2,_N(u,d,m,b)}finally{pe.p=E,k.T=T}}function ane(u,d,m,b){var T=k.T;k.T=null;var E=pe.p;try{pe.p=8,_N(u,d,m,b)}finally{pe.p=E,k.T=T}}function _N(u,d,m,b){if(T_){var T=TN(b);if(T===null)uN(u,d,b,S_,m),w3(u,b);else if(cne(T,u,d,m,b))b.stopPropagation();else if(w3(u,b),d&4&&-1<lne.indexOf(u)){for(;T!==null;){var E=ul(T);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var F=Do(E.pendingLanes);if(F!==0){var W=E;for(W.pendingLanes|=2,W.entangledLanes|=2;F;){var q=1<<31-Ui(F);W.entanglements[1]|=q,F&=~q}Ea(E),!(Mn&6)&&(a_=vn()+500,Ky(0))}}break;case 13:W=zc(E,2),W!==null&&Gi(W,E,2),u_(),wN(E,2)}if(E=TN(b),E===null&&uN(u,d,b,S_,m),E===T)break;T=E}T!==null&&b.stopPropagation()}else uN(u,d,b,null,m)}}function TN(u){return u=Of(u),SN(u)}var S_=null;function SN(u){if(S_=null,u=$o(u),u!==null){var d=Z(u);if(d===null)u=null;else{var m=d.tag;if(m===13){if(u=le(d),u!==null)return u;u=null}else if(m===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;u=null}else d!==u&&(u=null)}}return S_=u,null}function x3(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(or()){case an:return 2;case dn:return 8;case Ms:case ca:return 32;case al:return 268435456;default:return 32}default:return 32}}var EN=!1,tu=null,nu=null,su=null,tb=new Map,nb=new Map,iu=[],lne="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function w3(u,d){switch(u){case"focusin":case"focusout":tu=null;break;case"dragenter":case"dragleave":nu=null;break;case"mouseover":case"mouseout":su=null;break;case"pointerover":case"pointerout":tb.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":nb.delete(d.pointerId)}}function sb(u,d,m,b,T,E){return u===null||u.nativeEvent!==E?(u={blockedOn:d,domEventName:m,eventSystemFlags:b,nativeEvent:E,targetContainers:[T]},d!==null&&(d=ul(d),d!==null&&v3(d)),u):(u.eventSystemFlags|=b,d=u.targetContainers,T!==null&&d.indexOf(T)===-1&&d.push(T),u)}function cne(u,d,m,b,T){switch(d){case"focusin":return tu=sb(tu,u,d,m,b,T),!0;case"dragenter":return nu=sb(nu,u,d,m,b,T),!0;case"mouseover":return su=sb(su,u,d,m,b,T),!0;case"pointerover":var E=T.pointerId;return tb.set(E,sb(tb.get(E)||null,u,d,m,b,T)),!0;case"gotpointercapture":return E=T.pointerId,nb.set(E,sb(nb.get(E)||null,u,d,m,b,T)),!0}return!1}function _3(u){var d=$o(u.target);if(d!==null){var m=Z(d);if(m!==null){if(d=m.tag,d===13){if(d=le(m),d!==null){u.blockedOn=d,Rc(u.priority,function(){if(m.tag===13){var b=Rr(),T=zc(m,b);T!==null&&Gi(T,m,b),wN(m,b)}});return}}else if(d===3&&m.stateNode.current.memoizedState.isDehydrated){u.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}u.blockedOn=null}function E_(u){if(u.blockedOn!==null)return!1;for(var d=u.targetContainers;0<d.length;){var m=TN(u.nativeEvent);if(m===null){m=u.nativeEvent;var b=new m.constructor(m.type,m);Xr=b,m.target.dispatchEvent(b),Xr=null}else return d=ul(m),d!==null&&v3(d),u.blockedOn=m,!1;d.shift()}return!0}function T3(u,d,m){E_(u)&&m.delete(d)}function une(){EN=!1,tu!==null&&E_(tu)&&(tu=null),nu!==null&&E_(nu)&&(nu=null),su!==null&&E_(su)&&(su=null),tb.forEach(T3),nb.forEach(T3)}function C_(u,d){u.blockedOn===d&&(u.blockedOn=null,EN||(EN=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,une)))}var I_=null;function S3(u){I_!==u&&(I_=u,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){I_===u&&(I_=null);for(var d=0;d<u.length;d+=3){var m=u[d],b=u[d+1],T=u[d+2];if(typeof b!="function"){if(SN(b||m)===null)continue;break}var E=ul(m);E!==null&&(u.splice(d,3),d-=3,pk(E,{pending:!0,data:T,method:m.method,action:b},b,T))}}))}function ib(u){function d(q){return C_(q,u)}tu!==null&&C_(tu,u),nu!==null&&C_(nu,u),su!==null&&C_(su,u),tb.forEach(d),nb.forEach(d);for(var m=0;m<iu.length;m++){var b=iu[m];b.blockedOn===u&&(b.blockedOn=null)}for(;0<iu.length&&(m=iu[0],m.blockedOn===null);)_3(m),m.blockedOn===null&&iu.shift();if(m=(u.ownerDocument||u).$$reactFormReplay,m!=null)for(b=0;b<m.length;b+=3){var T=m[b],E=m[b+1],F=T[_s]||null;if(typeof E=="function")F||S3(m);else if(F){var W=null;if(E&&E.hasAttribute("formAction")){if(T=E,F=E[_s]||null)W=F.formAction;else if(SN(T)!==null)continue}else W=F.action;typeof W=="function"?m[b+1]=W:(m.splice(b,3),b-=3),S3(m)}}}function CN(u){this._internalRoot=u}k_.prototype.render=CN.prototype.render=function(u){var d=this._internalRoot;if(d===null)throw Error(s(409));var m=d.current,b=Rr();y3(m,b,u,d,null,null)},k_.prototype.unmount=CN.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var d=u.containerInfo;u.tag===0&&cp(),y3(u.current,2,null,u,null,null),u_(),d[cl]=null}};function k_(u){this._internalRoot=u}k_.prototype.unstable_scheduleHydration=function(u){if(u){var d=mw();u={blockedOn:null,target:u,priority:d};for(var m=0;m<iu.length&&d!==0&&d<iu[m].priority;m++);iu.splice(m,0,u),m===0&&_3(u)}};var E3=e.version;if(E3!=="19.0.0")throw Error(s(527,E3,"19.0.0"));pe.findDOMNode=function(u){var d=u._reactInternals;if(d===void 0)throw typeof u.render=="function"?Error(s(188)):(u=Object.keys(u).join(","),Error(s(268,u)));return u=ee(d),u=u!==null?he(u):null,u=u===null?null:u.stateNode,u};var hne={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:k,findFiberByHostInstance:$o,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var N_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!N_.isDisabled&&N_.supportsFiber)try{Sr=N_.inject(hne),Fs=N_}catch{}}return ob.createRoot=function(u,d){if(!i(u))throw Error(s(299));var m=!1,b="",T=UF,E=WF,F=HF,W=null;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onUncaughtError!==void 0&&(T=d.onUncaughtError),d.onCaughtError!==void 0&&(E=d.onCaughtError),d.onRecoverableError!==void 0&&(F=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(W=d.unstable_transitionCallbacks)),d=m3(u,1,!1,null,null,m,b,T,E,F,W,null),u[cl]=d.current,cN(u.nodeType===8?u.parentNode:u),new CN(d)},ob.hydrateRoot=function(u,d,m){if(!i(u))throw Error(s(299));var b=!1,T="",E=UF,F=WF,W=HF,q=null,re=null;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(T=m.identifierPrefix),m.onUncaughtError!==void 0&&(E=m.onUncaughtError),m.onCaughtError!==void 0&&(F=m.onCaughtError),m.onRecoverableError!==void 0&&(W=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(q=m.unstable_transitionCallbacks),m.formState!==void 0&&(re=m.formState)),d=m3(u,1,!0,d,m??null,b,T,E,F,W,q,re),d.context=g3(null),m=d.current,b=Rr(),T=qc(b),T.callback=null,Kc(m,T,b),d.current.lanes=b,ts(d,b),Ea(d),u[cl]=d.current,cN(u),new k_(d)},ob.version="19.0.0",ob}var P3;function Ene(){if(P3)return NN.exports;P3=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),NN.exports=Sne(),NN.exports}var Cne=Ene(),ab={},L3;function Ine(){if(L3)return ab;L3=1,Object.defineProperty(ab,"__esModule",{value:!0}),ab.parse=o,ab.serialize=c;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,r=(()=>{const p=function(){};return p.prototype=Object.create(null),p})();function o(p,g){const y=new r,x=p.length;if(x<2)return y;const v=(g==null?void 0:g.decode)||h;let w=0;do{const S=p.indexOf("=",w);if(S===-1)break;const C=p.indexOf(";",w),I=C===-1?x:C;if(S>I){w=p.lastIndexOf(";",S-1)+1;continue}const A=a(p,w,S),L=l(p,S,A),O=p.slice(A,L);if(y[O]===void 0){let N=a(p,S+1,I),k=l(p,I,N);const $=v(p.slice(N,k));y[O]=$}w=I+1}while(w<x);return y}function a(p,g,y){do{const x=p.charCodeAt(g);if(x!==32&&x!==9)return g}while(++g<y);return y}function l(p,g,y){for(;g>y;){const x=p.charCodeAt(--g);if(x!==32&&x!==9)return g+1}return y}function c(p,g,y){const x=(y==null?void 0:y.encode)||encodeURIComponent;if(!n.test(p))throw new TypeError(`argument name is invalid: ${p}`);const v=x(g);if(!e.test(v))throw new TypeError(`argument val is invalid: ${g}`);let w=p+"="+v;if(!y)return w;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);w+="; Max-Age="+y.maxAge}if(y.domain){if(!t.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);w+="; Domain="+y.domain}if(y.path){if(!s.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);w+="; Path="+y.path}if(y.expires){if(!f(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);w+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(w+="; HttpOnly"),y.secure&&(w+="; Secure"),y.partitioned&&(w+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return w}function h(p){if(p.indexOf("%")===-1)return p;try{return decodeURIComponent(p)}catch{return p}}function f(p){return i.call(p)==="[object Date]"}return ab}Ine();/**
 * react-router v7.2.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var M3="popstate";function kne(n={}){function e(s,i){let{pathname:r,search:o,hash:a}=s.location;return YA("",{pathname:r,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(s,i){return typeof i=="string"?i:a0(i)}return Ane(e,t,null,n)}function zn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Xa(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Nne(){return Math.random().toString(36).substring(2,10)}function F3(n,e){return{usr:n.state,key:n.key,idx:e}}function YA(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Em(e):e,state:t,key:e&&e.key||s||Nne()}}function a0({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Em(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function Ane(n,e,t,s={}){let{window:i=document.defaultView,v5Compat:r=!1}=s,o=i.history,a="POP",l=null,c=h();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function h(){return(o.state||{idx:null}).idx}function f(){a="POP";let v=h(),w=v==null?null:v-c;c=v,l&&l({action:a,location:x.location,delta:w})}function p(v,w){a="PUSH";let S=YA(x.location,v,w);c=h()+1;let C=F3(S,c),I=x.createHref(S);try{o.pushState(C,"",I)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;i.location.assign(I)}r&&l&&l({action:a,location:x.location,delta:1})}function g(v,w){a="REPLACE";let S=YA(x.location,v,w);c=h();let C=F3(S,c),I=x.createHref(S);o.replaceState(C,"",I),r&&l&&l({action:a,location:x.location,delta:0})}function y(v){let w=i.location.origin!=="null"?i.location.origin:i.location.href,S=typeof v=="string"?v:a0(v);return S=S.replace(/ $/,"%20"),zn(w,`No window.location.(origin|href) available to create URL for href: ${S}`),new URL(S,w)}let x={get action(){return a},get location(){return n(i,o)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(M3,f),l=v,()=>{i.removeEventListener(M3,f),l=null}},createHref(v){return e(i,v)},createURL:y,encodeLocation(v){let w=y(v);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:p,replace:g,go(v){return o.go(v)}};return x}function Pj(n,e,t="/"){return Rne(n,e,t,!1)}function Rne(n,e,t,s){let i=typeof e=="string"?Em(e):e,r=Ou(i.pathname||"/",t);if(r==null)return null;let o=Lj(n);Dne(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=Wne(r);a=Bne(o[l],c,s)}return a}function Lj(n,e=[],t=[],s=""){let i=(r,o,a)=>{let l={relativePath:a===void 0?r.path||"":a,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};l.relativePath.startsWith("/")&&(zn(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length));let c=Xl([s,l.relativePath]),h=t.concat(l);r.children&&r.children.length>0&&(zn(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),Lj(r.children,e,h,c)),!(r.path==null&&!r.index)&&e.push({path:c,score:Vne(c,r.index),routesMeta:h})};return n.forEach((r,o)=>{var a;if(r.path===""||!((a=r.path)!=null&&a.includes("?")))i(r,o);else for(let l of Mj(r.path))i(r,o,l)}),e}function Mj(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,i=t.endsWith("?"),r=t.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let o=Mj(s.join("/")),a=[];return a.push(...o.map(l=>l===""?r:[r,l].join("/"))),i&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function Dne(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:zne(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var $ne=/^:[\w-]+$/,One=3,Pne=2,Lne=1,Mne=10,Fne=-2,V3=n=>n==="*";function Vne(n,e){let t=n.split("/"),s=t.length;return t.some(V3)&&(s+=Fne),e&&(s+=Pne),t.filter(i=>!V3(i)).reduce((i,r)=>i+($ne.test(r)?One:r===""?Lne:Mne),s)}function zne(n,e){return n.length===e.length&&n.slice(0,-1).every((s,i)=>s===e[i])?n[n.length-1]-e[e.length-1]:0}function Bne(n,e,t=!1){let{routesMeta:s}=n,i={},r="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,h=r==="/"?e:e.slice(r.length)||"/",f=eT({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),p=l.route;if(!f&&c&&t&&!s[s.length-1].route.index&&(f=eT({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:Xl([r,f.pathname]),pathnameBase:qne(Xl([r,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(r=Xl([r,f.pathnameBase]))}return o}function eT(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=Une(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let r=i[0],o=r.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:s.reduce((c,{paramName:h,isOptional:f},p)=>{if(h==="*"){let y=a[p]||"";o=r.slice(0,r.length-y.length).replace(/(.)\/+$/,"$1")}const g=a[p];return f&&!g?c[h]=void 0:c[h]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:r,pathnameBase:o,pattern:n}}function Une(n,e=!1,t=!0){Xa(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function Wne(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Xa(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Ou(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}function Hne(n,e="/"){let{pathname:t,search:s="",hash:i=""}=typeof n=="string"?Em(n):n;return{pathname:t?t.startsWith("/")?t:jne(t,e):e,search:Kne(s),hash:Xne(i)}}function jne(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function $N(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Gne(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Fj(n){let e=Gne(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function Vj(n,e,t,s=!1){let i;typeof n=="string"?i=Em(n):(i={...n},zn(!i.pathname||!i.pathname.includes("?"),$N("?","pathname","search",i)),zn(!i.pathname||!i.pathname.includes("#"),$N("#","pathname","hash",i)),zn(!i.search||!i.search.includes("#"),$N("#","search","hash",i)));let r=n===""||i.pathname==="",o=r?"/":i.pathname,a;if(o==null)a=t;else{let f=e.length-1;if(!s&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;i.pathname=p.join("/")}a=f>=0?e[f]:"/"}let l=Hne(i,a),c=o&&o!=="/"&&o.endsWith("/"),h=(r||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}var Xl=n=>n.join("/").replace(/\/\/+/g,"/"),qne=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Kne=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Xne=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Yne(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var zj=["POST","PUT","PATCH","DELETE"];new Set(zj);var Qne=["GET",...zj];new Set(Qne);var Cm=oe.createContext(null);Cm.displayName="DataRouter";var CS=oe.createContext(null);CS.displayName="DataRouterState";var Bj=oe.createContext({isTransitioning:!1});Bj.displayName="ViewTransition";var Zne=oe.createContext(new Map);Zne.displayName="Fetchers";var Jne=oe.createContext(null);Jne.displayName="Await";var sl=oe.createContext(null);sl.displayName="Navigation";var ev=oe.createContext(null);ev.displayName="Location";var fc=oe.createContext({outlet:null,matches:[],isDataRoute:!1});fc.displayName="Route";var dD=oe.createContext(null);dD.displayName="RouteError";function ese(n,{relative:e}={}){zn(tv(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=oe.useContext(sl),{hash:i,pathname:r,search:o}=nv(n,{relative:e}),a=r;return t!=="/"&&(a=r==="/"?t:Xl([t,r])),s.createHref({pathname:a,search:o,hash:i})}function tv(){return oe.useContext(ev)!=null}function of(){return zn(tv(),"useLocation() may be used only in the context of a <Router> component."),oe.useContext(ev).location}var Uj="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Wj(n){oe.useContext(sl).static||oe.useLayoutEffect(n)}function Im(){let{isDataRoute:n}=oe.useContext(fc);return n?fse():tse()}function tse(){zn(tv(),"useNavigate() may be used only in the context of a <Router> component.");let n=oe.useContext(Cm),{basename:e,navigator:t}=oe.useContext(sl),{matches:s}=oe.useContext(fc),{pathname:i}=of(),r=JSON.stringify(Fj(s)),o=oe.useRef(!1);return Wj(()=>{o.current=!0}),oe.useCallback((l,c={})=>{if(Xa(o.current,Uj),!o.current)return;if(typeof l=="number"){t.go(l);return}let h=Vj(l,JSON.parse(r),i,c.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Xl([e,h.pathname])),(c.replace?t.replace:t.push)(h,c.state,c)},[e,t,r,i,n])}oe.createContext(null);function nv(n,{relative:e}={}){let{matches:t}=oe.useContext(fc),{pathname:s}=of(),i=JSON.stringify(Fj(t));return oe.useMemo(()=>Vj(n,JSON.parse(i),s,e==="path"),[n,i,s,e])}function nse(n,e){return Hj(n,e)}function Hj(n,e,t,s){var S;zn(tv(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:r}=oe.useContext(sl),{matches:o}=oe.useContext(fc),a=o[o.length-1],l=a?a.params:{},c=a?a.pathname:"/",h=a?a.pathnameBase:"/",f=a&&a.route;{let C=f&&f.path||"";jj(c,!f||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let p=of(),g;if(e){let C=typeof e=="string"?Em(e):e;zn(h==="/"||((S=C.pathname)==null?void 0:S.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${C.pathname}" was given in the \`location\` prop.`),g=C}else g=p;let y=g.pathname||"/",x=y;if(h!=="/"){let C=h.replace(/^\//,"").split("/");x="/"+y.replace(/^\//,"").split("/").slice(C.length).join("/")}let v=!r&&t&&t.matches&&t.matches.length>0?t.matches:Pj(n,{pathname:x});Xa(f||v!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),Xa(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=ase(v&&v.map(C=>Object.assign({},C,{params:Object.assign({},l,C.params),pathname:Xl([h,i.encodeLocation?i.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:Xl([h,i.encodeLocation?i.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),o,t,s);return e&&w?oe.createElement(ev.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},w):w}function sse(){let n=dse(),e=Yne(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},r={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=oe.createElement(oe.Fragment,null,oe.createElement("p",null," Hey developer "),oe.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",oe.createElement("code",{style:r},"ErrorBoundary")," or"," ",oe.createElement("code",{style:r},"errorElement")," prop on your route.")),oe.createElement(oe.Fragment,null,oe.createElement("h2",null,"Unexpected Application Error!"),oe.createElement("h3",{style:{fontStyle:"italic"}},e),t?oe.createElement("pre",{style:i},t):null,o)}var ise=oe.createElement(sse,null),rse=class extends oe.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?oe.createElement(fc.Provider,{value:this.props.routeContext},oe.createElement(dD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ose({routeContext:n,match:e,children:t}){let s=oe.useContext(Cm);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),oe.createElement(fc.Provider,{value:n},t)}function ase(n,e=[],t=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let i=n,r=t==null?void 0:t.errors;if(r!=null){let l=i.findIndex(c=>c.route.id&&(r==null?void 0:r[c.route.id])!==void 0);zn(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let o=!1,a=-1;if(t)for(let l=0;l<i.length;l++){let c=i[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:h,errors:f}=t,p=c.route.loader&&!h.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||p){o=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((l,c,h)=>{let f,p=!1,g=null,y=null;t&&(f=r&&c.route.id?r[c.route.id]:void 0,g=c.route.errorElement||ise,o&&(a<0&&h===0?(jj("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,y=null):a===h&&(p=!0,y=c.route.hydrateFallbackElement||null)));let x=e.concat(i.slice(0,h+1)),v=()=>{let w;return f?w=g:p?w=y:c.route.Component?w=oe.createElement(c.route.Component,null):c.route.element?w=c.route.element:w=l,oe.createElement(ose,{match:c,routeContext:{outlet:l,matches:x,isDataRoute:t!=null},children:w})};return t&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?oe.createElement(rse,{location:t.location,revalidation:t.revalidation,component:g,error:f,children:v(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):v()},null)}function fD(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lse(n){let e=oe.useContext(Cm);return zn(e,fD(n)),e}function cse(n){let e=oe.useContext(CS);return zn(e,fD(n)),e}function use(n){let e=oe.useContext(fc);return zn(e,fD(n)),e}function pD(n){let e=use(n),t=e.matches[e.matches.length-1];return zn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function hse(){return pD("useRouteId")}function dse(){var s;let n=oe.useContext(dD),e=cse("useRouteError"),t=pD("useRouteError");return n!==void 0?n:(s=e.errors)==null?void 0:s[t]}function fse(){let{router:n}=lse("useNavigate"),e=pD("useNavigate"),t=oe.useRef(!1);return Wj(()=>{t.current=!0}),oe.useCallback(async(i,r={})=>{Xa(t.current,Uj),t.current&&(typeof i=="number"?n.navigate(i):await n.navigate(i,{fromRouteId:e,...r}))},[n,e])}var z3={};function jj(n,e,t){!e&&!z3[n]&&(z3[n]=!0,Xa(!1,t))}oe.memo(pse);function pse({routes:n,future:e,state:t}){return Hj(n,void 0,t,e)}function cu(n){zn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mse({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:i,static:r=!1}){zn(!tv(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),a=oe.useMemo(()=>({basename:o,navigator:i,static:r,future:{}}),[o,i,r]);typeof t=="string"&&(t=Em(t));let{pathname:l="/",search:c="",hash:h="",state:f=null,key:p="default"}=t,g=oe.useMemo(()=>{let y=Ou(l,o);return y==null?null:{location:{pathname:y,search:c,hash:h,state:f,key:p},navigationType:s}},[o,l,c,h,f,p,s]);return Xa(g!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:oe.createElement(sl.Provider,{value:a},oe.createElement(ev.Provider,{children:e,value:g}))}function gse({children:n,location:e}){return nse(QA(n),e)}function QA(n,e=[]){let t=[];return oe.Children.forEach(n,(s,i)=>{if(!oe.isValidElement(s))return;let r=[...e,i];if(s.type===oe.Fragment){t.push.apply(t,QA(s.props.children,r));return}zn(s.type===cu,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),zn(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=QA(s.props.children,r)),t.push(o)}),t}var v1="get",x1="application/x-www-form-urlencoded";function IS(n){return n!=null&&typeof n.tagName=="string"}function yse(n){return IS(n)&&n.tagName.toLowerCase()==="button"}function bse(n){return IS(n)&&n.tagName.toLowerCase()==="form"}function vse(n){return IS(n)&&n.tagName.toLowerCase()==="input"}function xse(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function wse(n,e){return n.button===0&&(!e||e==="_self")&&!xse(n)}var A_=null;function _se(){if(A_===null)try{new FormData(document.createElement("form"),0),A_=!1}catch{A_=!0}return A_}var Tse=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ON(n){return n!=null&&!Tse.has(n)?(Xa(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${x1}"`),null):n}function Sse(n,e){let t,s,i,r,o;if(bse(n)){let a=n.getAttribute("action");s=a?Ou(a,e):null,t=n.getAttribute("method")||v1,i=ON(n.getAttribute("enctype"))||x1,r=new FormData(n)}else if(yse(n)||vse(n)&&(n.type==="submit"||n.type==="image")){let a=n.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||a.getAttribute("action");if(s=l?Ou(l,e):null,t=n.getAttribute("formmethod")||a.getAttribute("method")||v1,i=ON(n.getAttribute("formenctype"))||ON(a.getAttribute("enctype"))||x1,r=new FormData(a,n),!_se()){let{name:c,type:h,value:f}=n;if(h==="image"){let p=c?`${c}.`:"";r.append(`${p}x`,"0"),r.append(`${p}y`,"0")}else c&&r.append(c,f)}}else{if(IS(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=v1,s=null,i=x1,o=n}return r&&i==="text/plain"&&(o=r,r=void 0),{action:s,method:t.toLowerCase(),encType:i,formData:r,body:o}}function mD(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function Ese(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Cse(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Ise(n,e,t){let s=await Promise.all(n.map(async i=>{let r=e.routes[i.route.id];if(r){let o=await Ese(r,t);return o.links?o.links():[]}return[]}));return Rse(s.flat(1).filter(Cse).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function B3(n,e,t,s,i,r){let o=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,a=(l,c)=>{var h;return t[c].pathname!==l.pathname||((h=t[c].route.path)==null?void 0:h.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return r==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):r==="data"?e.filter((l,c)=>{var f;let h=s.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let p=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((f=t[0])==null?void 0:f.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function kse(n,e,{includeHydrateFallback:t}={}){return Nse(n.map(s=>{let i=e.routes[s.route.id];if(!i)return[];let r=[i.module];return i.clientActionModule&&(r=r.concat(i.clientActionModule)),i.clientLoaderModule&&(r=r.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(r=r.concat(i.hydrateFallbackModule)),i.imports&&(r=r.concat(i.imports)),r}).flat(1))}function Nse(n){return[...new Set(n)]}function Ase(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function Rse(n,e){let t=new Set;return new Set(e),n.reduce((s,i)=>{let r=JSON.stringify(Ase(i));return t.has(r)||(t.add(r),s.push({key:r,link:i})),s},[])}function Dse(n){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function $se(){let n=oe.useContext(Cm);return mD(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function Ose(){let n=oe.useContext(CS);return mD(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var gD=oe.createContext(void 0);gD.displayName="FrameworkContext";function Gj(){let n=oe.useContext(gD);return mD(n,"You must render this element inside a <HydratedRouter> element"),n}function Pse(n,e){let t=oe.useContext(gD),[s,i]=oe.useState(!1),[r,o]=oe.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:h,onTouchStart:f}=e,p=oe.useRef(null);oe.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let x=w=>{w.forEach(S=>{o(S.isIntersecting)})},v=new IntersectionObserver(x,{threshold:.5});return p.current&&v.observe(p.current),()=>{v.disconnect()}}},[n]),oe.useEffect(()=>{if(s){let x=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(x)}}},[s]);let g=()=>{i(!0)},y=()=>{i(!1),o(!1)};return t?n!=="intent"?[r,p,{}]:[r,p,{onFocus:lb(a,g),onBlur:lb(l,y),onMouseEnter:lb(c,g),onMouseLeave:lb(h,y),onTouchStart:lb(f,g)}]:[!1,p,{}]}function lb(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function Lse({page:n,...e}){let{router:t}=$se(),s=oe.useMemo(()=>Pj(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?oe.createElement(Fse,{page:n,matches:s,...e}):null}function Mse(n){let{manifest:e,routeModules:t}=Gj(),[s,i]=oe.useState([]);return oe.useEffect(()=>{let r=!1;return Ise(n,e,t).then(o=>{r||i(o)}),()=>{r=!0}},[n,e,t]),s}function Fse({page:n,matches:e,...t}){let s=of(),{manifest:i,routeModules:r}=Gj(),{loaderData:o,matches:a}=Ose(),l=oe.useMemo(()=>B3(n,e,a,i,s,"data"),[n,e,a,i,s]),c=oe.useMemo(()=>B3(n,e,a,i,s,"assets"),[n,e,a,i,s]),h=oe.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let g=new Set,y=!1;if(e.forEach(v=>{var S;let w=i.routes[v.route.id];!w||!w.hasLoader||(!l.some(C=>C.route.id===v.route.id)&&v.route.id in o&&((S=r[v.route.id])!=null&&S.shouldRevalidate)||w.hasClientLoader?y=!0:g.add(v.route.id))}),g.size===0)return[];let x=Dse(n);return y&&g.size>0&&x.searchParams.set("_routes",e.filter(v=>g.has(v.route.id)).map(v=>v.route.id).join(",")),[x.pathname+x.search]},[o,s,i,l,e,n,r]),f=oe.useMemo(()=>kse(c,i),[c,i]),p=Mse(c);return oe.createElement(oe.Fragment,null,h.map(g=>oe.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...t})),f.map(g=>oe.createElement("link",{key:g,rel:"modulepreload",href:g,...t})),p.map(({key:g,link:y})=>oe.createElement("link",{key:g,...y})))}function Vse(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var qj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{qj&&(window.__reactRouterVersion="7.2.0")}catch{}function zse({basename:n,children:e,window:t}){let s=oe.useRef();s.current==null&&(s.current=kne({window:t,v5Compat:!0}));let i=s.current,[r,o]=oe.useState({action:i.action,location:i.location}),a=oe.useCallback(l=>{oe.startTransition(()=>o(l))},[o]);return oe.useLayoutEffect(()=>i.listen(a),[i,a]),oe.createElement(mse,{basename:n,children:e,location:r.location,navigationType:r.action,navigator:i})}var Kj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Td=oe.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:i,reloadDocument:r,replace:o,state:a,target:l,to:c,preventScrollReset:h,viewTransition:f,...p},g){let{basename:y}=oe.useContext(sl),x=typeof c=="string"&&Kj.test(c),v,w=!1;if(typeof c=="string"&&x&&(v=c,qj))try{let k=new URL(window.location.href),$=c.startsWith("//")?new URL(k.protocol+c):new URL(c),R=Ou($.pathname,y);$.origin===k.origin&&R!=null?c=R+$.search+$.hash:w=!0}catch{Xa(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let S=ese(c,{relative:i}),[C,I,A]=Pse(s,p),L=Hse(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:i,viewTransition:f});function O(k){e&&e(k),k.defaultPrevented||L(k)}let N=oe.createElement("a",{...p,...A,href:v||S,onClick:w||r?e:O,ref:Vse(g,I),target:l,"data-discover":!x&&t==="render"?"true":void 0});return C&&!x?oe.createElement(oe.Fragment,null,N,oe.createElement(Lse,{page:S})):N});Td.displayName="Link";var Bse=oe.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:i=!1,style:r,to:o,viewTransition:a,children:l,...c},h){let f=nv(o,{relative:c.relative}),p=of(),g=oe.useContext(CS),{navigator:y,basename:x}=oe.useContext(sl),v=g!=null&&Xse(f)&&a===!0,w=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,S=p.pathname,C=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;t||(S=S.toLowerCase(),C=C?C.toLowerCase():null,w=w.toLowerCase()),C&&x&&(C=Ou(C,x)||C);const I=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let A=S===w||!i&&S.startsWith(w)&&S.charAt(I)==="/",L=C!=null&&(C===w||!i&&C.startsWith(w)&&C.charAt(w.length)==="/"),O={isActive:A,isPending:L,isTransitioning:v},N=A?e:void 0,k;typeof s=="function"?k=s(O):k=[s,A?"active":null,L?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let $=typeof r=="function"?r(O):r;return oe.createElement(Td,{...c,"aria-current":N,className:k,ref:h,style:$,to:o,viewTransition:a},typeof l=="function"?l(O):l)});Bse.displayName="NavLink";var Use=oe.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:i,state:r,method:o=v1,action:a,onSubmit:l,relative:c,preventScrollReset:h,viewTransition:f,...p},g)=>{let y=qse(),x=Kse(a,{relative:c}),v=o.toLowerCase()==="get"?"get":"post",w=typeof a=="string"&&Kj.test(a),S=C=>{if(l&&l(C),C.defaultPrevented)return;C.preventDefault();let I=C.nativeEvent.submitter,A=(I==null?void 0:I.getAttribute("formmethod"))||o;y(I||C.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:i,state:r,relative:c,preventScrollReset:h,viewTransition:f})};return oe.createElement("form",{ref:g,method:v,action:x,onSubmit:s?l:S,...p,"data-discover":!w&&n==="render"?"true":void 0})});Use.displayName="Form";function Wse(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Xj(n){let e=oe.useContext(Cm);return zn(e,Wse(n)),e}function Hse(n,{target:e,replace:t,state:s,preventScrollReset:i,relative:r,viewTransition:o}={}){let a=Im(),l=of(),c=nv(n,{relative:r});return oe.useCallback(h=>{if(wse(h,e)){h.preventDefault();let f=t!==void 0?t:a0(l)===a0(c);a(n,{replace:f,state:s,preventScrollReset:i,relative:r,viewTransition:o})}},[l,a,c,t,s,e,n,i,r,o])}var jse=0,Gse=()=>`__${String(++jse)}__`;function qse(){let{router:n}=Xj("useSubmit"),{basename:e}=oe.useContext(sl),t=hse();return oe.useCallback(async(s,i={})=>{let{action:r,method:o,encType:a,formData:l,body:c}=Sse(s,e);if(i.navigate===!1){let h=i.fetcherKey||Gse();await n.fetch(h,t,i.action||r,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await n.navigate(i.action||r,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[n,e,t])}function Kse(n,{relative:e}={}){let{basename:t}=oe.useContext(sl),s=oe.useContext(fc);zn(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),r={...nv(n||".",{relative:e})},o=of();if(n==null){r.search=o.search;let a=new URLSearchParams(r.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(f=>f).forEach(f=>a.append("index",f));let h=a.toString();r.search=h?`?${h}`:""}}return(!n||n===".")&&i.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(r.pathname=r.pathname==="/"?t:Xl([t,r.pathname])),a0(r)}function Xse(n,e={}){let t=oe.useContext(Bj);zn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Xj("useViewTransitionState"),i=nv(n,{relative:e.relative});if(!t.isTransitioning)return!1;let r=Ou(t.currentLocation.pathname,s)||t.currentLocation.pathname,o=Ou(t.nextLocation.pathname,s)||t.nextLocation.pathname;return eT(i.pathname,o)!=null||eT(i.pathname,r)!=null}new TextEncoder;var Yj={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},U3=Kl.createContext&&Kl.createContext(Yj),Yse=["attr","size","title"];function Qse(n,e){if(n==null)return{};var t=Zse(n,e),s,i;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(n,s)&&(t[s]=n[s])}return t}function Zse(n,e){if(n==null)return{};var t={};for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){if(e.indexOf(s)>=0)continue;t[s]=n[s]}return t}function tT(){return tT=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},tT.apply(this,arguments)}function W3(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,s)}return t}function nT(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?W3(Object(t),!0).forEach(function(s){Jse(n,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):W3(Object(t)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(t,s))})}return n}function Jse(n,e,t){return e=eie(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eie(n){var e=tie(n,"string");return typeof e=="symbol"?e:e+""}function tie(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Qj(n){return n&&n.map((e,t)=>Kl.createElement(e.tag,nT({key:t},e.attr),Qj(e.child)))}function kS(n){return e=>Kl.createElement(nie,tT({attr:nT({},n.attr)},e),Qj(n.child))}function nie(n){var e=t=>{var{attr:s,size:i,title:r}=n,o=Qse(n,Yse),a=i||t.size||"1em",l;return t.className&&(l=t.className),n.className&&(l=(l?l+" ":"")+n.className),Kl.createElement("svg",tT({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,o,{className:l,style:nT(nT({color:n.color||t.color},t.style),n.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),r&&Kl.createElement("title",null,r),n.children)};return U3!==void 0?Kl.createElement(U3.Consumer,null,t=>e(t)):e(Yj)}function sie(n){return kS({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(n)}function iie(n){return kS({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"8",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"8",y1:"18",x2:"21",y2:"18"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"3.01",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"12",x2:"3.01",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"3.01",y2:"18"},child:[]}]})(n)}function rie(n){return kS({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(n)}const NS=()=>be.jsxs("nav",{className:"fixed bottom-0 -left-1 w-full bg-transparent/10 shadow-md flex justify-around py-4",children:[be.jsxs(Td,{to:"/home",className:"flex flex-col items-center text-gray-600 hover:text-primary",children:[be.jsx(sie,{size:24}),be.jsx("span",{className:"text-xs",children:"Home"})]}),be.jsxs(Td,{to:"/track",className:"flex flex-col items-center text-gray-600 hover:text-primary",children:[be.jsx(iie,{size:24}),be.jsx("span",{className:"text-xs",children:"Track"})]}),be.jsxs(Td,{to:"/profile",className:"flex flex-col items-center text-gray-600 hover:text-primary",children:[be.jsx(rie,{size:24}),be.jsx("span",{className:"text-xs",children:"Profile"})]})]}),oie=()=>{const n=Im(),[e,t]=oe.useState(0);oe.useEffect(()=>{const r=Math.floor(Math.random()*51);t(r)},[]);const s=()=>{n("/progress")},i=()=>{n("/track")};return be.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[be.jsx("h1",{className:"text-2xl font-bold text-primary",children:"Welcome Back!"}),be.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[be.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md",children:[be.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Fiber Intake"}),be.jsxs("p",{className:"text-2xl font-bold text-secondary ",children:[e,"g"]}),be.jsx("p",{className:"text-sm text-gray-500",children:"Goal: 50/day"})]}),be.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md",children:[be.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Yeast Intake"}),be.jsx("p",{className:"text-2xl font-bold text-primary",children:"3g"}),be.jsx("p",{className:"text-sm text-gray-500",children:"Goal: 5g/day"})]})]}),be.jsxs("div",{className:"mt-6 space-y-4",children:[be.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-md hover:bg-primary/80",onClick:i,children:"Log a Meal"}),be.jsx("button",{className:"w-full bg-secondary text-white py-3 rounded-md hover:bg-secondary/80 duration-200",onClick:s,children:"View Progress"})]}),be.jsx(NS,{})]})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aie=1e-7,lie=1e-4;class yD{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class AS{refCount(e){return cr("refCount")}incRef(e){return cr("incRef")}timerAvailable(){return!0}time(e){return cr("time")}read(e){return cr("read")}readSync(e){return cr("readSync")}readToGPU(e,t){return cr("readToGPU")}numDataIds(){return cr("numDataIds")}disposeData(e,t){return cr("disposeData")}write(e,t,s){return cr("write")}move(e,t,s,i,r){return cr("move")}createTensorFromGPUData(e,t,s){return cr("createTensorFromGPUData")}memory(){return cr("memory")}floatPrecision(){return cr("floatPrecision")}epsilon(){return this.floatPrecision()===32?aie:lie}dispose(){return cr("dispose")}}function cr(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bD(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,Bl(n,e,t)}function cie(n,e){if(n.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${n.length}Second array length was ${e.length}`);let t=n.length,s=0;for(;t>0;)s=Math.random()*t|0,t--,Bl(n,t,s),Bl(e,t,s)}function Pu(n,e,t){return Math.max(n,Math.min(e,t))}function RS(n){return n%2===0?n:n+1}function Bl(n,e,t){const s=n[e];n[e]=n[t],n[t]=s}function Zj(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function uie(n,e){const t=Math.random();return e*t+(1-t)*n}function hie(n,e){let t=0;for(let s=0;s<n.length;s++){const i=Number(n[s])-Number(e[s]);t+=i*i}return t}function B(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function Js(n,e,t=""){B(_t(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function af(n){B(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ye(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function die(n){return n.length===0}function Jj(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==null&&e[t]!==null&&n[t]!==e[t])return!1;return!0}function _t(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Od(n){return n%1===0}function fie(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{const e=Math.exp(2*n);return(e-1)/(e+1)}}function sT(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function pie(n){const e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return bD(e),e}function Sd(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function ZA(n,e=i=>0,t,s){return new Promise((i,r)=>{let o=0;const a=()=>{if(n()){i();return}o++;const l=e(o);if(t!=null&&o>=t){r();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function vD(n,e){let t=1,s=-1;for(let r=0;r<n.length;++r)if(n[r]>=0)t*=n[r];else if(n[r]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${r}`);s=r}else if(n[r]<0)throw Error(`Shapes can not be < 0. Found ${n[r]} at dim ${r}`);if(s===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const i=n.slice();return i[s]=e/t,i}function gt(n,e){const t=e.length;return n=n==null?e.map((s,i)=>i):[].concat(n),B(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),B(n.every(s=>Od(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function pc(n,e){const t=[],s=[],i=e!=null&&Array.isArray(e)&&e.length===0,r=e==null||i?null:gt(e,n).sort();let o=0;for(let a=0;a<n.length;++a){if(r!=null){if(r[o]===a&&n[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(r[o]==null||r[o]>a)&&n[a]===1&&(t.push(n[a]),s.push(a)),r[o]<=a&&o++}n[a]!==1&&(t.push(n[a]),s.push(a))}return{newShape:t,keptDims:s}}function $s(n,e){return Vn(n,e)}function Vn(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function e6(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function t6(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function xD(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function l0(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function n6(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function Oa(n){return typeof n=="string"||n instanceof String}function s6(n){return typeof n=="boolean"}function iT(n){return typeof n=="number"}function lf(n){return Array.isArray(n)?lf(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":iT(n)?"float32":Oa(n)?"string":s6(n)?"bool":"float32"}function Lu(n){return!!(n&&n.constructor&&n.call&&n.apply)}function rT(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Ye(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function i6(n,e,t,s=!1){const i=new Array;if(e.length===1){const r=e[0]*(s?2:1);for(let o=0;o<r;o++)i[o]=t[n+o]}else{const r=e[0],o=e.slice(1),a=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<r;l++)i[l]=i6(n+l*a,o,t,s)}return i}function Mr(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((i,r)=>i*r)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return i6(0,n,e,t)}function r6(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function DS(n,e){const t=Zs(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function Zs(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function wD(n,e){const t=n.reduce((s,i)=>s*i,1);if(e==null||e==="float32")return Mr(n,new Float32Array(t));if(e==="int32")return Mr(n,new Int32Array(t));if(e==="bool")return Mr(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function _r(n){n.forEach(e=>{B(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function Xo(n,e,t){if(e===0)return 0;if(e===1)return n[0];let s=n[n.length-1];for(let i=0;i<n.length-1;++i)s+=t[i]*n[i];return s}function cf(n,e,t){if(e===0)return[];if(e===1)return[n];const s=new Array(e);for(let i=0;i<s.length-1;++i)s[i]=Math.floor(n/t[i]),n-=s[i]*t[i];return s[s.length-1]=n,s}function Mu(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H3="tfjsflags";class o6{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=mie,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(de().getBool("IS_TEST")||de().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const i=this.urlFlags[e];de().getBool("IS_TEST")||de().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${i}.`),this.set(e,i)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Mu(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);H3 in e&&e[H3].split(",").forEach(s=>{const[i,r]=s.split(":");this.urlFlags[i]=yie(i,r)})}}function mie(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(gie(e,s[0],s[1]),s.join("="))),e}function gie(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function yie(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function de(){return _D}let _D=null;function bie(n){_D=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let PN;function a6(){if(PN==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");PN=n}return PN}function vie(){const n=a6();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function TD(n,e){const t=vie();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const sv="Abs",km="Acos",Nm="Acosh",uf="Add",iv="AddN",$S="All",OS="Any",rv="ArgMax",ov="ArgMin",Am="Asin",Rm="Asinh",Dm="Atan",$m="Atanh",Om="Atan2",av="AvgPool",PS="AvgPoolGrad",lv="AvgPool3D",LS="AvgPool3DGrad",cv="BatchMatMul",uv="BatchToSpaceND",MS="Bincount",hv="BitwiseAnd",l6="BroadcastTo",FS="BroadcastArgs",Pm="Cast",Lm="Ceil",Mm="ClipByValue",VS="Complex",dv="ComplexAbs",fv="Concat",pv="Conv2D",zS="Conv2DBackpropFilter",mv="Conv2DBackpropInput",gv="Conv3D",BS="Conv3DBackpropFilterV2",US="Conv3DBackpropInputV2",Fm="Cos",Vm="Cosh",WS="Cumprod",yv="Cumsum",HS="CropAndResize",jS="DenseBincount",GS="DepthToSpace",bv="DepthwiseConv2dNative",qS="DepthwiseConv2dNativeBackpropFilter",KS="DepthwiseConv2dNativeBackpropInput",XS="Diag",vv="Dilation2D",oT="Dilation2DBackpropInput",aT="Dilation2DBackpropFilter",YS="Draw",zm="RealDiv",QS="Einsum",Bm="Elu",ZS="EluGrad",Um="Erf",xv="Equal",Wm="Exp",wv="ExpandDims",Hm="Expm1",JS="FFT",eE="Fill",tE="FlipLeftRight",jm="Floor",Gm="FloorDiv",_v="FusedBatchNorm",Tv="GatherV2",nE="GatherNd",Sv="Greater",qm="GreaterEqual",Km="Identity",sE="IFFT",iE="Imag",Xm="IsFinite",Ym="IsInf",Qm="IsNan",Ev="LeakyRelu",Cv="Less",Iv="LessEqual",rE="LinSpace",Zm="Log",Jm="Log1p",kv="LogicalAnd",Nv="LogicalNot",Av="LogicalOr",xie="LogicalXor",c6="LogSoftmax",wie="LowerBound",Rv="LRN",oE="LRNGrad",_ie="MatrixBandPart",Dv="Max",eg="Maximum",$v="MaxPool",aE="MaxPoolGrad",Ov="MaxPool3D",lE="MaxPool3DGrad",cE="MaxPoolWithArgmax",Pv="Mean",Lv="Min",tg="Minimum",Mv="MirrorPad",ng="Mod",uE="Multinomial",sg="Multiply",Fv="Neg",Vv="NotEqual",hE="NonMaxSuppressionV3",dE="NonMaxSuppressionV4",fE="NonMaxSuppressionV5",zv="OnesLike",Bv="OneHot",Uv="Pack",Wv="PadV2",Tie="Pool",ig="Pow",Hv="Prelu",jv="Prod",pE="RaggedGather",mE="RaggedRange",gE="RaggedTensorToTensor",yE="Range",bE="Real",rg="Reciprocal",og="Relu",Gv="Reshape",qv="ResizeNearestNeighbor",vE="ResizeNearestNeighborGrad",Kv="ResizeBilinear",xE="ResizeBilinearGrad",ag="Relu6",Xv="Reverse",lg="Round",cg="Rsqrt",wE="ScatterNd",_E="TensorScatterUpdate",TE="SearchSorted",Yv="Select",ug="Selu",Qv="Slice",hg="Sin",dg="Sinh",fg="Sign",pg="Sigmoid",mg="Softplus",gg="Sqrt",Zv="Sum",Jv="SpaceToBatchND",ex="SplitV",tx="Softmax",SE="SparseFillEmptyRows",EE="SparseReshape",CE="SparseSegmentMean",IE="SparseSegmentSum",kE="SparseToDense",yg="SquaredDifference",NE="Square",nx="StaticRegexReplace",AE="StridedSlice",RE="StringNGrams",DE="StringSplit",$E="StringToHashBucketFast",bg="Sub",vg="Tan",xg="Tanh",wg="Tile",OE="TopK",PE="Transform",Ed="Transpose",LE="Unique",sx="Unpack",ix="UnsortedSegmentSum",Sie="UpperBound",rx="ZerosLike",_g="Step",lT="FromPixels",ME="RotateWithOffset",c0="_FusedMatMul",u0="FusedConv2D",h0="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dr(...n){de().getBool("IS_TEST")||de().getBool("PROD")||console.warn(...n)}function Eie(...n){de().getBool("IS_TEST")||de().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xp=TD("kernelRegistry",()=>new Map),d0=TD("gradRegistry",()=>new Map);function f0(n,e){const t=SD(n,e);return Xp.get(t)}function JA(n){return d0.get(n)}function cT(n){const e=Xp.entries(),t=[];for(;;){const{done:s,value:i}=e.next();if(s)break;const[r,o]=i,[a]=r.split("_");a===n&&t.push(o)}return t}function FE(n){const{kernelName:e,backendName:t}=n,s=SD(e,t);Xp.has(s)&&Dr(`The kernel '${e}' for backend '${t}' is already registered`),Xp.set(s,n)}function u6(n){const{kernelName:e}=n;d0.has(e)&&de().getBool("DEBUG")&&Dr(`Overriding the gradient for '${e}'`),d0.set(e,n)}function Cie(n,e){const t=SD(n,e);if(!Xp.has(t))throw new Error(`The kernel '${n}' for backend '${e}' is not registered`);Xp.delete(t)}function Iie(n){if(!d0.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);d0.delete(n)}function kie(n,e){cT(n).forEach(s=>{const i=Object.assign({},s,{backendName:e});FE(i)})}function SD(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h6(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var LN,j3;function Nie(){if(j3)return LN;j3=1,LN=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e($,R,z){this.low=$|0,this.high=R|0,this.unsigned=!!z}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t($){return($&&$.__isLong__)===!0}e.isLong=t;var s={},i={};function r($,R){var z,V,ne;return R?($>>>=0,(ne=0<=$&&$<256)&&(V=i[$],V)?V:(z=a($,($|0)<0?-1:0,!0),ne&&(i[$]=z),z)):($|=0,(ne=-128<=$&&$<128)&&(V=s[$],V)?V:(z=a($,$<0?-1:0,!1),ne&&(s[$]=z),z))}e.fromInt=r;function o($,R){if(isNaN($))return R?S:w;if(R){if($<0)return S;if($>=y)return O}else{if($<=-9223372036854776e3)return N;if($+1>=x)return L}return $<0?o(-$,R).neg():a($%g|0,$/g|0,R)}e.fromNumber=o;function a($,R,z){return new e($,R,z)}e.fromBits=a;var l=Math.pow;function c($,R,z){if($.length===0)throw Error("empty string");if($==="NaN"||$==="Infinity"||$==="+Infinity"||$==="-Infinity")return w;if(typeof R=="number"?(z=R,R=!1):R=!!R,z=z||10,z<2||36<z)throw RangeError("radix");var V;if((V=$.indexOf("-"))>0)throw Error("interior hyphen");if(V===0)return c($.substring(1),R,z).neg();for(var ne=o(l(z,8)),Q=w,G=0;G<$.length;G+=8){var J=Math.min(8,$.length-G),Z=parseInt($.substring(G,G+J),z);if(J<8){var le=o(l(z,J));Q=Q.mul(le).add(o(Z))}else Q=Q.mul(ne),Q=Q.add(o(Z))}return Q.unsigned=R,Q}e.fromString=c;function h($,R){return typeof $=="number"?o($,R):typeof $=="string"?c($,R):a($.low,$.high,typeof R=="boolean"?R:$.unsigned)}e.fromValue=h;var f=65536,p=1<<24,g=f*f,y=g*g,x=y/2,v=r(p),w=r(0);e.ZERO=w;var S=r(0,!0);e.UZERO=S;var C=r(1);e.ONE=C;var I=r(1,!0);e.UONE=I;var A=r(-1);e.NEG_ONE=A;var L=a(-1,2147483647,!1);e.MAX_VALUE=L;var O=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=O;var N=a(0,-2147483648,!1);e.MIN_VALUE=N;var k=e.prototype;return k.toInt=function(){return this.unsigned?this.low>>>0:this.low},k.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},k.toString=function(R){if(R=R||10,R<2||36<R)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(N)){var z=o(R),V=this.div(z),ne=V.mul(z).sub(this);return V.toString(R)+ne.toInt().toString(R)}else return"-"+this.neg().toString(R);for(var Q=o(l(R,6),this.unsigned),G=this,J="";;){var Z=G.div(Q),le=G.sub(Z.mul(Q)).toInt()>>>0,H=le.toString(R);if(G=Z,G.isZero())return H+J;for(;H.length<6;)H="0"+H;J=""+H+J}},k.getHighBits=function(){return this.high},k.getHighBitsUnsigned=function(){return this.high>>>0},k.getLowBits=function(){return this.low},k.getLowBitsUnsigned=function(){return this.low>>>0},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(N)?64:this.neg().getNumBitsAbs();for(var R=this.high!=0?this.high:this.low,z=31;z>0&&!(R&1<<z);z--);return this.high!=0?z+33:z+1},k.isZero=function(){return this.high===0&&this.low===0},k.eqz=k.isZero,k.isNegative=function(){return!this.unsigned&&this.high<0},k.isPositive=function(){return this.unsigned||this.high>=0},k.isOdd=function(){return(this.low&1)===1},k.isEven=function(){return(this.low&1)===0},k.equals=function(R){return t(R)||(R=h(R)),this.unsigned!==R.unsigned&&this.high>>>31===1&&R.high>>>31===1?!1:this.high===R.high&&this.low===R.low},k.eq=k.equals,k.notEquals=function(R){return!this.eq(R)},k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=function(R){return this.comp(R)<0},k.lt=k.lessThan,k.lessThanOrEqual=function(R){return this.comp(R)<=0},k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=function(R){return this.comp(R)>0},k.gt=k.greaterThan,k.greaterThanOrEqual=function(R){return this.comp(R)>=0},k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=function(R){if(t(R)||(R=h(R)),this.eq(R))return 0;var z=this.isNegative(),V=R.isNegative();return z&&!V?-1:!z&&V?1:this.unsigned?R.high>>>0>this.high>>>0||R.high===this.high&&R.low>>>0>this.low>>>0?-1:1:this.sub(R).isNegative()?-1:1},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(N)?N:this.not().add(C)},k.neg=k.negate,k.add=function(R){t(R)||(R=h(R));var z=this.high>>>16,V=this.high&65535,ne=this.low>>>16,Q=this.low&65535,G=R.high>>>16,J=R.high&65535,Z=R.low>>>16,le=R.low&65535,H=0,ee=0,he=0,ae=0;return ae+=Q+le,he+=ae>>>16,ae&=65535,he+=ne+Z,ee+=he>>>16,he&=65535,ee+=V+J,H+=ee>>>16,ee&=65535,H+=z+G,H&=65535,a(he<<16|ae,H<<16|ee,this.unsigned)},k.subtract=function(R){return t(R)||(R=h(R)),this.add(R.neg())},k.sub=k.subtract,k.multiply=function(R){if(this.isZero())return w;if(t(R)||(R=h(R)),n){var z=n.mul(this.low,this.high,R.low,R.high);return a(z,n.get_high(),this.unsigned)}if(R.isZero())return w;if(this.eq(N))return R.isOdd()?N:w;if(R.eq(N))return this.isOdd()?N:w;if(this.isNegative())return R.isNegative()?this.neg().mul(R.neg()):this.neg().mul(R).neg();if(R.isNegative())return this.mul(R.neg()).neg();if(this.lt(v)&&R.lt(v))return o(this.toNumber()*R.toNumber(),this.unsigned);var V=this.high>>>16,ne=this.high&65535,Q=this.low>>>16,G=this.low&65535,J=R.high>>>16,Z=R.high&65535,le=R.low>>>16,H=R.low&65535,ee=0,he=0,ae=0,pe=0;return pe+=G*H,ae+=pe>>>16,pe&=65535,ae+=Q*H,he+=ae>>>16,ae&=65535,ae+=G*le,he+=ae>>>16,ae&=65535,he+=ne*H,ee+=he>>>16,he&=65535,he+=Q*le,ee+=he>>>16,he&=65535,he+=G*Z,ee+=he>>>16,he&=65535,ee+=V*H+ne*le+Q*Z+G*J,ee&=65535,a(ae<<16|pe,ee<<16|he,this.unsigned)},k.mul=k.multiply,k.divide=function(R){if(t(R)||(R=h(R)),R.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&R.low===-1&&R.high===-1)return this;var z=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,R.low,R.high);return a(z,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?S:w;var V,ne,Q;if(this.unsigned){if(R.unsigned||(R=R.toUnsigned()),R.gt(this))return S;if(R.gt(this.shru(1)))return I;Q=S}else{if(this.eq(N)){if(R.eq(C)||R.eq(A))return N;if(R.eq(N))return C;var G=this.shr(1);return V=G.div(R).shl(1),V.eq(w)?R.isNegative()?C:A:(ne=this.sub(R.mul(V)),Q=V.add(ne.div(R)),Q)}else if(R.eq(N))return this.unsigned?S:w;if(this.isNegative())return R.isNegative()?this.neg().div(R.neg()):this.neg().div(R).neg();if(R.isNegative())return this.div(R.neg()).neg();Q=w}for(ne=this;ne.gte(R);){V=Math.max(1,Math.floor(ne.toNumber()/R.toNumber()));for(var J=Math.ceil(Math.log(V)/Math.LN2),Z=J<=48?1:l(2,J-48),le=o(V),H=le.mul(R);H.isNegative()||H.gt(ne);)V-=Z,le=o(V,this.unsigned),H=le.mul(R);le.isZero()&&(le=C),Q=Q.add(le),ne=ne.sub(H)}return Q},k.div=k.divide,k.modulo=function(R){if(t(R)||(R=h(R)),n){var z=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,R.low,R.high);return a(z,n.get_high(),this.unsigned)}return this.sub(this.div(R).mul(R))},k.mod=k.modulo,k.rem=k.modulo,k.not=function(){return a(~this.low,~this.high,this.unsigned)},k.and=function(R){return t(R)||(R=h(R)),a(this.low&R.low,this.high&R.high,this.unsigned)},k.or=function(R){return t(R)||(R=h(R)),a(this.low|R.low,this.high|R.high,this.unsigned)},k.xor=function(R){return t(R)||(R=h(R)),a(this.low^R.low,this.high^R.high,this.unsigned)},k.shiftLeft=function(R){return t(R)&&(R=R.toInt()),(R&=63)===0?this:R<32?a(this.low<<R,this.high<<R|this.low>>>32-R,this.unsigned):a(0,this.low<<R-32,this.unsigned)},k.shl=k.shiftLeft,k.shiftRight=function(R){return t(R)&&(R=R.toInt()),(R&=63)===0?this:R<32?a(this.low>>>R|this.high<<32-R,this.high>>R,this.unsigned):a(this.high>>R-32,this.high>=0?0:-1,this.unsigned)},k.shr=k.shiftRight,k.shiftRightUnsigned=function(R){if(t(R)&&(R=R.toInt()),R&=63,R===0)return this;var z=this.high;if(R<32){var V=this.low;return a(V>>>R|z<<32-R,z>>>R,this.unsigned)}else return R===32?a(z,0,this.unsigned):a(z>>>R-32,0,this.unsigned)},k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},k.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},k.toBytes=function(R){return R?this.toBytesLE():this.toBytesBE()},k.toBytesLE=function(){var R=this.high,z=this.low;return[z&255,z>>>8&255,z>>>16&255,z>>>24,R&255,R>>>8&255,R>>>16&255,R>>>24]},k.toBytesBE=function(){var R=this.high,z=this.low;return[R>>>24,R>>>16&255,R>>>8&255,R&255,z>>>24,z>>>16&255,z>>>8&255,z&255]},e.fromBytes=function(R,z,V){return V?e.fromBytesLE(R,z):e.fromBytesBE(R,z)},e.fromBytesLE=function(R,z){return new e(R[0]|R[1]<<8|R[2]<<16|R[3]<<24,R[4]|R[5]<<8|R[6]<<16|R[7]<<24,z)},e.fromBytesBE=function(R,z){return new e(R[4]<<24|R[5]<<16|R[6]<<8|R[7],R[0]<<24|R[1]<<16|R[2]<<8|R[3],z)},LN}var d6=Nie();const f6=Oj(d6),Aie=mne({__proto__:null,default:f6},[d6]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ud=f6||Aie;function ox(n){return ud.fromString(n,!0,16)}const p6=ox("c3a5c85c97cb3127"),id=ox("b492b66fbe98f273"),Ci=ox("9ae16a3b2f90404f");function eR(n){return n.xor(n.shru(47))}function m6(n,e,t){const s=n.slice(e,e+t);return ud.fromBytes(Array.from(s),!0,!0)}function pn(n,e){return m6(n,e,8)}function G3(n,e){return m6(n,e,4)}function Is(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function _u(n,e,t=ox("9ddfea08eb382d69")){let s=n.xor(e).mul(t);s=s.xor(s.shru(47));let i=e.xor(s).mul(t);return i=i.xor(i.shru(47)),i=i.mul(t),i}function Rie(n,e,t,s,i,r){i=i.add(n),r=Is(r.add(i).add(s),21);const o=i;return i=i.add(e),i=i.add(t),r=r.add(Is(i,44)),[i.add(s),r.add(o)]}function R_(n,e,t,s){return Rie(pn(n,e),pn(n,e+8),pn(n,e+16),pn(n,e+24),t,s)}function Die(n,e=n.length){if(e>=8){const t=Ci.add(e*2),s=pn(n,0).add(Ci),i=pn(n,e-8),r=Is(i,37).mul(t).add(s),o=Is(s,25).add(i).mul(t);return _u(r,o,t)}if(e>=4){const t=Ci.add(e*2),s=G3(n,0);return _u(s.shl(3).add(e),G3(n,e-4),t)}if(e>0){const t=n[0],s=n[e>>1],i=n[e-1],r=t+(s<<8),o=e+(i<<2);return eR(Ci.mul(r).xor(p6.mul(o))).mul(Ci)}return Ci}function $ie(n,e=n.length){const t=Ci.add(e*2),s=pn(n,0).mul(id),i=pn(n,8),r=pn(n,e-8).mul(t),o=pn(n,e-16).mul(Ci);return _u(Is(s.add(i),43).add(Is(r,30)).add(o),s.add(Is(i.add(Ci),18)).add(r),t)}function Oie(n,e=n.length){const t=Ci.add(e*2),s=pn(n,0).mul(Ci),i=pn(n,8),r=pn(n,e-8).mul(t),o=pn(n,e-16).mul(Ci),a=Is(s.add(i),43).add(Is(r,30)).add(o),l=_u(a,s.add(Is(i.add(Ci),18)).add(r),t),c=pn(n,16).mul(t),h=pn(n,24),f=a.add(pn(n,e-32)).mul(t),p=l.add(pn(n,e-24)).mul(t);return _u(Is(c.add(h),43).add(Is(f,30)).add(p),c.add(Is(h.add(s),18)).add(f),t)}function g6(n,e=n.length){const t=ud.fromNumber(81,!0);if(e<=32)return e<=16?Die(n,e):$ie(n,e);if(e<=64)return Oie(n,e);let s=t,i=t.mul(id).add(113),r=eR(i.mul(Ci).add(113)).mul(Ci),o=[ud.UZERO,ud.UZERO],a=[ud.UZERO,ud.UZERO];s=s.mul(Ci).add(pn(n,0));let l=0;const c=(e-1>>6)*64,h=c+(e-1&63)-63;do s=Is(s.add(i).add(o[0]).add(pn(n,l+8)),37).mul(id),i=Is(i.add(o[1]).add(pn(n,l+48)),42).mul(id),s=s.xor(a[1]),i=i.add(o[0]).add(pn(n,l+40)),r=Is(r.add(a[0]),33).mul(id),o=R_(n,l,o[1].mul(id),s.add(a[0])),a=R_(n,l+32,r.add(a[1]),i.add(pn(n,l+16))),[r,s]=[s,r],l+=64;while(l!==c);const f=id.add(r.and(255).shl(1));return l=h,a[0]=a[0].add(e-1&63),o[0]=o[0].add(a[0]),a[0]=a[0].add(o[0]),s=Is(s.add(i).add(o[0]).add(pn(n,l+8)),37).mul(f),i=Is(i.add(o[1]).add(pn(n,l+48)),42).mul(f),s=s.xor(a[1].mul(9)),i=i.add(o[0].mul(9).add(pn(n,l+40))),r=Is(r.add(a[0]),33).mul(f),o=R_(n,l,o[1].mul(f),s.add(a[0])),a=R_(n,l+32,r.add(a[1]),i.add(pn(n,l+16))),[r,s]=[s,r],_u(_u(o[0],a[0],f).add(eR(i).mul(p6)).add(r),_u(o[1],a[1],f).add(s),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mc(n,e){return e==="string"?Fa(n):ih([n],e)}function Pie(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function ih(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Ya(n)),de().getBool("DEBUG")&&e6(n,e),Pie(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Si(){return de().platform.now()}function Lie(n,e){return de().platform.fetch(n,e)}function Fa(n,e="utf-8"){return e=e||"utf-8",de().platform.encode(n,e)}function tc(n,e="utf-8"){return e=e||"utf-8",de().platform.decode(n,e)}function ks(n){return de().platform.isTypedArray!=null?de().platform.isTypedArray(n):h6(n)}function Ya(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||Mu(n)||n==null||ks(n)&&t)e.push(n);else if(Array.isArray(n)||ks(n))for(let s=0;s<n.length;++s)Ya(n[s],e,t);else{let s=-1;for(const i of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(i)&&(s=Math.max(s,Number(i)));for(let i=0;i<=s;i++)Ya(n[i],e,t)}return e}const Mie=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:_t,arraysEqualWithNull:Jj,assert:B,assertNonNegativeIntegerDimensions:_r,assertNonNull:af,assertShapesMatch:Js,bytesFromStringArray:n6,bytesPerElement:l0,checkConversionForErrors:e6,clamp:Pu,computeStrides:Ye,convertBackendValuesAndArrayBuffer:r6,createScalarValue:mc,createShuffledIndices:pie,decodeString:tc,distSquared:hie,encodeString:Fa,fetch:Lie,fingerPrint64:g6,flatten:Ya,getArrayFromDType:Vn,getTypedArrayFromDType:$s,hasEncodingLoss:xD,hexToLong:ox,indexToLoc:cf,inferDtype:lf,inferFromImplicitShape:vD,isBoolean:s6,isFunction:Lu,isInt:Od,isNumber:iT,isPromise:Mu,isScalarShape:die,isString:Oa,isTypedArray:ks,isValidDtype:t6,locToIndex:Xo,makeOnesTypedArray:DS,makeZerosNestedTypedArray:wD,makeZerosTypedArray:Zs,nearestDivisor:rT,nearestLargerEven:RS,now:Si,parseAxisParam:gt,randUniform:uie,repeatedTry:ZA,rightPad:Sd,shuffle:bD,shuffleCombo:cie,sizeFromShape:ye,sizeToSquarishShape:sT,squeezeShape:pc,sum:Zj,swap:Bl,tanh:fie,toNestedArray:Mr,toTypedArray:ih},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fie{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new zie)}profileKernel(e,t,s){let i;const r=()=>{i=s()};let o;const a=Si();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(r);else{r();for(const c of i)c.dataSync();o=Promise.resolve({kernelMs:Si()-a})}if(de().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<i.length;c++){const h=i[c];h.data().then(f=>{Vie(f,h.dtype,e)})}return{kernelName:e,outputs:i,inputs:t,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:i,inputs:r,extraInfo:o}=e;s.forEach(a=>{Promise.all([a.data(),i,o]).then(l=>{this.logger.logKernelProfile(t,a,l[0],l[1],r,l[2])})})}}function Vie(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const i=n[s];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${t}'`),!0}return!1}let zie=class{logKernelProfile(e,t,s,i,r,o){const a=typeof i=="number"?Sd(`${i}ms`,9):i.error,l=Sd(e,25),c=t.rank,h=t.size,f=Sd(t.shape.toString(),14);let p="";for(const g in r){const y=r[g];if(y!=null){const x=y.shape||t.shape,v=x.length;p+=`${g}: ${v}D ${v>0?x:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${f}	%c${h}	%c${p}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bie(n,e,t){const s={},i={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<n.length;l++){const c=n[l],h=c.inputs;for(const f in h){const p=h[f];let g=!1;for(let y=0;y<e.length;y++)if(s[p.id]){c.outputs.forEach(x=>s[x.id]=!0),g=!0,i[c.id]=!0;break}if(g)break}}const r={};r[t.id]=!0;const o={};for(let l=n.length-1;l>=0;l--){const c=n[l],h=c.inputs;for(let f=0;f<c.outputs.length;f++)if(r[c.outputs[f].id]){for(const p in h)r[h[p].id]=!0,o[c.id]=!0;break}}const a=[];for(let l=0;l<n.length;l++){const c=n[l];if(i[c.id]&&o[c.id]){const h={};for(const p in c.inputs){const g=c.inputs[p];s[g.id]&&(h[p]=g)}const f=Object.assign({},c);f.inputs=h,f.outputs=c.outputs,a.push(f)}}return a}function Uie(n,e,t,s){for(let i=e.length-1;i>=0;i--){const r=e[i],o=[];if(r.outputs.forEach(l=>{const c=n[l.id];c!=null?o.push(c):o.push(null)}),r.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${r.kernelName}.`);const a=r.gradient(o);for(const l in r.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=t(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const h=r.inputs[l];if(!_t(c.shape,h.shape))throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${h.shape}'`);if(n[h.id]==null)n[h.id]=c;else{const f=n[h.id];n[h.id]=s(f,c),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q3=20,cb=3,MN=7;function Wie(n,e,t,s){const i=Ye(e),r=Hie(n,e,t,i),o=e.length,a=w1(n,e,t,i,r),l=["Tensor"];return s&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function Hie(n,e,t,s){const i=ye(e),r=s[s.length-1],o=new Array(r).fill(0),a=e.length,l=t==="complex64"?Cb(n):n;if(a>1)for(let c=0;c<i/r;c++){const h=c*r;for(let f=0;f<r;f++)o[f]=Math.max(o[f],Eb(l[h+f],0,t).length)}return o}function Eb(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(MN))} + ${parseFloat(n[1].toFixed(MN))}j`:Oa(n)?s=`'${n}'`:t==="bool"?s=y6(n):s=parseFloat(n.toFixed(MN)).toString(),Sd(s,e)}function y6(n){return n===0?"false":"true"}function w1(n,e,t,s,i,r=!0){const o=t==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(t==="complex64"){const x=Cb(n);return[Eb(x[0],0,t)]}return t==="bool"?[y6(n[0])]:[n[0].toString()]}if(l===1){if(a>q3){const v=cb*o;let w=Array.from(n.slice(0,v)),S=Array.from(n.slice((a-cb)*o,a*o));return t==="complex64"&&(w=Cb(w),S=Cb(S)),["["+w.map((C,I)=>Eb(C,i[I],t)).join(", ")+", ..., "+S.map((C,I)=>Eb(C,i[a-cb+I],t)).join(", ")+"]"]}return["["+(t==="complex64"?Cb(n):Array.from(n)).map((v,w)=>Eb(v,i[w],t)).join(", ")+"]"]}const c=e.slice(1),h=s.slice(1),f=s[0]*o,p=[];if(a>q3){for(let x=0;x<cb;x++){const v=x*f,w=v+f;p.push(...w1(n.slice(v,w),c,t,h,i,!1))}p.push("...");for(let x=a-cb;x<a;x++){const v=x*f,w=v+f;p.push(...w1(n.slice(v,w),c,t,h,i,x===a-1))}}else for(let x=0;x<a;x++){const v=x*f,w=v+f;p.push(...w1(n.slice(v,w),c,t,h,i,x===a-1))}const g=l===2?",":"";p[0]="["+(a>0?p[0]+g:"");for(let x=1;x<p.length-1;x++)p[x]=" "+p[x]+g;let y=`,
`;for(let x=2;x<l;x++)y+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(r?"":y),p}function Cb(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class as{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=ye(e),s!=null){const i=s.length;B(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Vn(t,this.size),this.strides=Ye(e)}set(e,...t){t.length===0&&(t=[0]),B(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const i of e){if(i<0||i>=this.shape[t]){const r=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(r)}t++}let s=e[e.length-1];for(let i=0;i<e.length-1;++i)s+=this.strides[i]*e[i];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Uo().makeTensor(this.values,this.shape,this.dtype)}}let Uo=null,vp=null;function jie(n){Uo=n}function Gie(n){vp=n}class Kt{constructor(e,t,s,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=ye(e),this.strides=Ye(e),this.dataId=s,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return vp.buffer(this.shape,this.dtype,e)}bufferSync(){return vp.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Mr(this.shape,e,this.dtype==="complex64")}arraySync(){return Mr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Uo().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>tc(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Uo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Uo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>tc(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Uo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Uo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return vp.print(this,e)}clone(){return this.throwIfDisposed(),vp.clone(this)}toString(e=!1){const t=this.dataSync();return Wie(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),vp.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),Uo().makeVariable(this,e,t,s)}}Object.defineProperty(Kt,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function ve(){return TD("Tensor",()=>Kt)}ve();class p0 extends Kt{constructor(e,t,s,i){super(e.shape,e.dtype,e.dataId,i),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!_t(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Uo().disposeTensor(this),this.dataId=e.dataId,Uo().incRef(this,null)}dispose(){Uo().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(p0,Symbol.hasInstance,{value:n=>n instanceof Kt&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var tR;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(tR||(tR={}));var nR;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(nR||(nR={}));var sR;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(sR||(sR={}));var iR;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(iR||(iR={}));var rR;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(rR||(rR={}));const qie={float32:iR,int32:nR,bool:sR,complex64:rR};function Ji(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return qie[n][e]}function VE(n){return Ji(n,"int32")}function b6(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function v6(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $n(n,e){if(n.dtype===e.dtype)return[n,e];const t=Ji(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function x6(n,e){B(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function Kie(n,e){return e.some(t=>t.id===n.id)}function ED(n){const e=[];return w6(n,e,new Set),e}function w6(n,e,t){if(n==null)return;if(n instanceof Kt){e.push(n);return}if(!Xie(n))return;const s=n;for(const i in s){const r=s[i];t.has(r)||(t.add(r),w6(r,e,t))}}function Xie(n){return Array.isArray(n)||typeof n=="object"}const Yie=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:x6,getTensorsInContainer:ED,isTensorInList:Kie,makeTypesMatch:$n},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FN(n){return n.kernelName!=null}class K3{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Yp{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new K3}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(Dr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Fie(this.backendInstance),!0}setupRegisteredKernels(){cT(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){cT(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof AS)&&typeof s.then=="function"){const i=++this.pendingBackendInitId,r=s.then(o=>i<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,Dr(`Initialization of backend ${e} failed`),Dr(o.stack||o.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Dr(`Initialization of backend ${e} failed`),Dr(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:i,asyncInit:r}=this.initializeBackend(s);if(r||i)return{name:s,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),i=s.backend,r=this.readSync(t),o=i.refCount(t);i.disposeData(t,!0),s.backend=e,e.move(t,r,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let i;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(i),()=>(i=t(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(e,t,s){e();try{const i=s();return t(),i}catch(i){throw t(),i}}nextTensorId(){return Yp.nextTensorId++}nextVariableId(){return Yp.nextVariableId++}clone(e){const t=K.runKernel(Km,{x:e}),s={x:e},i=o=>({x:()=>{const a="float32",l={x:o},c={dtype:a};return K.runKernel(Pm,l,c)}}),r=[];return this.addTapeNode(this.state.activeScope.name,s,[t],i,r,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(f0(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const i=this.backend.numDataIds();let r=0;s.forEach(l=>{r+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=i-t-r-o;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const i=this.isTapeOn(),r=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=FN(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(FN(e)){const{kernelName:y,inputs:x,attrs:v}=e;this.backendName==null&&this.backend;const w=f0(y,this.backendName);B(w!=null,()=>`Cannot find registered kernel '${y}' for backend '${this.backendName}'`),a=()=>{const S=this.backend.numDataIds();l=w.kernelFunc({inputs:x,attrs:v,backend:this.backend});const C=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,S,C);const I=C.map(A=>A.rank!=null?A:this.makeTensorFromTensorInfo(A));if(i){const A=this.getTensorsForGradient(y,x,I);s=this.saveTensorsForBackwardMode(A)}return I}}else{const{forwardFunc:y}=e,x=v=>{i&&(s=v.map(w=>this.keep(this.clone(w))))};a=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>y(this.backend,x));const w=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,v,w),w}}const{inputs:h,attrs:f}=e,p=FN(e)?null:e.backwardsFunc;let g;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=a():(g=this.profiler.profileKernel(c,h,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),t=g.outputs)}),i&&this.addTapeNode(c,h,t,p,s,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-r,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(y=>h[y]!=null?h[y].shape:null),outputShapes:t.map(y=>y.shape),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const i=JA(e);if(i!=null){const r=i.inputsToSave||[],o=i.outputsToSave||[];let a;i.saveAllInputs?(B(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(t).map(c=>t[c])):a=r.map(c=>t[c]);const l=s.filter((c,h)=>o[h]);return a.concat(l)}return[]}makeTensor(e,t,s,i){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",i=i||this.backend;let r=e;s==="string"&&Oa(e[0])&&(r=e.map(l=>Fa(l)));const o=i.write(r,t,s),a=new Kt(t,s,o,this.nextTensorId());if(this.trackTensor(a,i),s==="string"){const l=this.state.tensorInfo.get(o),c=n6(r);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,t,s,i){s=s||"float32";const r={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(r,i)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:i,dtype:r}=e,o=new Kt(i,r,s,this.nextTensorId());return this.trackTensor(o,t),o}makeVariable(e,t=!0,s,i){s=s||this.nextVariableId().toString(),i!=null&&i!==e.dtype&&(e=e.cast(i));const r=new p0(e,t,s,this.nextTensorId());if(this.state.registeredVariables[r.name]!=null)throw new Error(`Variable with name ${r.name} was already registered`);return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*l0(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof p0||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*l0(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,i,r,o){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:r},l=JA(e);l!=null&&(i=l.gradFunc),i!=null&&(a.gradient=c=>(c=c.map((h,f)=>{if(h==null){const p=s[f],g=Zs(p.size,p.dtype);return this.makeTensor(g,p.shape,p.dtype)}return h}),i(c.length>1?c:c[0],r,o))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=ED(e),s=new Set(t.map(r=>r.id));for(let r=0;r<this.state.activeScope.track.length;r++){const o=this.state.activeScope.track[r];!o.kept&&!s.has(o.id)&&o.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(r=>{!r.kept&&r.scopeId===i.id&&this.track(r)})}gradients(e,t,s,i=!1){if(B(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const r=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));B(r instanceof Kt,()=>"The result y returned by f() must be a tensor.");const o=Bie(this.state.activeTape,t,r);if(!i&&o.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[r.id]=s??Qie(r.shape),Uie(a,o,c=>this.tidy(c),Zie);const l=t.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const h of c.saved)h.dispose()}),this.state.activeTape=null),{value:r,grads:l}})}customGrad(e){return B(Lu(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{B(t.every(a=>a instanceof Kt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const i={};t.forEach((a,l)=>{i[l]=a});const r=(a,l)=>(s=e(...t,l),B(s.value instanceof Kt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),B(Lu(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(a,l)=>{const c=s.gradFunc(a,l),h=Array.isArray(c)?c:[c];B(h.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),B(h.every(p=>p instanceof Kt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return h.forEach((p,g)=>{f[g]=()=>p}),f};return this.runKernelFunc({forwardFunc:r,backwardsFunc:o,inputs:i})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Si(),s=await this.backend.time(e);return s.wallMs=Si()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new K3;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Yp.nextTensorId=0;Yp.nextVariableId=0;function Qie(n){const e=DS(ye(n),"float32");return K.makeTensor(e,n,"float32")}function _6(){const n=a6();if(n._tfengine==null){const e=new o6(n);n._tfengine=new Yp(e)}return bie(n._tfengine.ENV),jie(()=>n._tfengine),n._tfengine}const K=_6();function Zie(n,e){const t={a:n,b:e};return K.runKernel(uf,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jie(){return typeof navigator<"u"&&navigator!=null}let oR;function ere(n){oR=n}function CD(n){if(oR!==void 0)return oR;if(n||Jie()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function ID(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const tre=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:ID,isMobile:CD,mockIsMobile:ere},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const er=de();er.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});er.registerFlag("IS_BROWSER",()=>ID());er.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");er.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));er.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));er.registerFlag("PROD",()=>!1);er.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>er.getBool("DEBUG"));er.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);er.registerFlag("IS_TEST",()=>!1);er.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>er.getBool("DEBUG"));er.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);er.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);er.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qa(n,e){let t=n;if(ks(n))return e==="string"?[]:[n.length];if(b6(n)){const i=n.channels||"RGBA";return[n.height,n.width*i.length]}else if(v6(n))return[n.buffer.size/(e==null?4:l0(e))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||ks(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&de().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&T6(n,s,[]),s}function T6(n,e,t){if(t=t||[],!Array.isArray(n)&&!ks(n)){B(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}B(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),B(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let i=0;i<n.length;++i)T6(n[i],s,t.concat(i))}function X3(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function U(n,e,t,s="numeric"){if(n instanceof ve())return X3(s,n.dtype,e,t),n;let i=lf(n);if(i!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(i=s),X3(s,i,e,t),n==null||!ks(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const r=Qa(n,i);!ks(n)&&!Array.isArray(n)&&(n=[n]);const a=i!=="string"?ih(n,i):Ya(n,[],!0);return K.makeTensor(a,r,i)}function m0(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((r,o)=>U(r,`${e}[${o}]`,t,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kD="__op";function X(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+kD;const i=(...r)=>{K.startScope(t);try{const o=s(...r);return Mu(o)&&console.error("Cannot return a Promise inside of tidy."),K.endScope(o),o}catch(o){throw K.endScope(null),o}};return Object.defineProperty(i,"name",{value:t,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nre(n,e){const t=U(n,"real","complex"),s=U(e,"imag","complex");Js(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const i={real:t,imag:s};return K.runKernel(VS,i)}const nc=X({complex_:nre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rh(n,e,t,s){if(s==null)s=lf(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(v6(n)||b6(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return K.backend.createTensorFromGPUData(n,e||t,s)}if(!ks(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){_r(e);const i=ye(e),r=ye(t);B(i===r,()=>`Based on the provided shape, [${e}], the tensor should have ${i} values but has ${r}`);for(let o=0;o<t.length;++o){const a=t[o],l=o===t.length-1?a!==ye(e.slice(o)):!0;B(t[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!ks(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?ih(n,s):Ya(n,[],!0),K.makeTensor(n,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _o(n,e,t){const s=Qa(n,t);return rh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pd={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ra{static join(e){return new ra(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>ks(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let s=0;s<e.length;s++){const i=e[s];s!==e.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const r=t+i.byteLength;this.shards.push({buffer:i,start:t,end:r}),t=r}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const i=t-e,r=new ArrayBuffer(i),o=new Uint8Array(r);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],f=e+a-c.start,p=a,y=Math.min(t,c.end)-c.start,x=new Uint8Array(c.buffer,f,y-f);if(o.set(x,p),a+=x.length,t<c.end)break}return r}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(i){return e<i.start?-1:e>=i.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=sre(this.shards,t);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function sre(n,e){let t=0,s=n.length;for(;t<=s;){const i=Math.floor((s-t)/2)+t,r=e(n[i]);if(r===0)return i;r<0?s=i:t=i+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ire(){de().set("PROD",!0)}function rre(){de().set("DEBUG",!0)}function ore(){de().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function are(n){de().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function lre(){K.disposeVariables()}function Bo(){return K}function aR(){return K.memory()}function cre(n){return K.profile(n)}function ce(n,e){return K.tidy(n,e)}function mt(n){ED(n).forEach(t=>t.dispose())}function ms(n){return K.keep(n)}function ure(n){return K.time(n)}function hre(n){return K.setBackend(n)}function dre(){return K.ready()}function S6(){return K.backendName}function fre(n){K.removeBackend(n)}function pre(n){return K.findBackend(n)}function mre(n){return K.findBackendFactory(n)}function ND(n,e,t=1){return K.registerBackend(n,e,t)}function AD(){return K.backend}function gre(n,e){de().setPlatform(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fu=4;async function lR(n,e){const t=[],s=[],i=Array.isArray(n)?n.map(o=>o.name):Object.keys(n);for(let o=0;o<i.length;++o){const a=i[o],l=Array.isArray(n)?n[o].tensor:n[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const h=new Promise(async f=>{const p=await l.bytes(),g=p.reduce((v,w)=>v+w.length,0)+Fu*p.length,y=new Uint8Array(g);let x=0;for(let v=0;v<p.length;v++){const w=p[v],S=new Uint8Array(new Uint32Array([w.length]).buffer);y.set(S,x),x+=Fu,y.set(w,x),x+=w.length}f(y)});s.push(h)}else s.push(l.data());e!=null&&(c.group=e),t.push(c)}const r=await Promise.all(s);return{data:vre(r),specs:t}}function E6(n,e){const t=new ra(n),s={};let i=0;for(const r of e){const o=yre(r,(a,l)=>t.slice(i+a,i+l));s[r.name]=C6(r,t.slice(i,i+o)),i+=o}return s}function yre(n,e){const t=ye(n.shape);let s;if("quantization"in n){const i=n.quantization;s=Pd[i.dtype]}else if(n.dtype==="string"){let i=0;for(let r=0;r<t;r++)i+=Fu+new Uint32Array(e(i,i+Fu))[0];return i}else s=Pd[n.dtype];return t*s}async function bre(n,e){const t=ye(n.shape);let s;if("quantization"in n){const i=n.quantization;s=Pd[i.dtype]}else if(n.dtype==="string"){let i=0;for(let r=0;r<t;r++)i+=Fu+new Uint32Array(await e(i,i+Fu))[0];return i}else s=Pd[n.dtype];return t*s}function C6(n,e){const t=n.name,s=n.dtype,i=n.shape,r=ye(i);let o,a=0;if("quantization"in n){const l=n.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${n.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${n.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${n.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=Pd[l.dtype],h=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(h.length);for(let f=0;f<h.length;f++){const p=h[f];o[f]=p*l.scale+l.min}}else if(l.dtype==="float16")o=Ere()(h);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(h.length);for(let f=0;f<h.length;f++){const p=h[f];o[f]=Math.round(p*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${t}': ${s}`);a+=r*c}else if(s==="string"){const l=ye(n.shape);o=[];for(let c=0;c<l;c++){const h=new Uint32Array(e.slice(a,a+Fu))[0];a+=Fu;const f=new Uint8Array(e.slice(a,a+h));o.push(f),a+=h}}else{const l=Pd[s];if(s==="float32")o=new Float32Array(e);else if(s==="int32")o=new Int32Array(e);else if(s==="bool")o=new Uint8Array(e);else if(s==="complex64"){o=new Float32Array(e);const c=new Float32Array(o.length/2),h=new Float32Array(o.length/2);for(let y=0;y<c.length;y++)c[y]=o[y*2],h[y]=o[y*2+1];const f=_o(c,i,"float32"),p=_o(h,i,"float32"),g=nc(f,p);return f.dispose(),p.dispose(),g}else throw new Error(`Unsupported dtype in weight '${t}': ${s}`);a+=r*l}return _o(o,i,s)}async function Y3(n,e,t){let s=new Uint8Array(e);for(;s.byteLength<t;){const{done:i,value:r}=await n.read();if(i&&r==null){const a=t-s.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const o=new Uint8Array(s.length+r.byteLength);o.set(s,0),o.set(new Uint8Array(r),s.length),s=o}return s.buffer}async function I6(n,e){const t={},s=n.getReader();let i=new ArrayBuffer(0);for(const r of e){const o=await bre(r,async(c,h)=>(i=await Y3(s,i,h),i.slice(c,h)));i=await Y3(s,i,o);const a=i.slice(0,o);i=i.slice(o);const l=C6(r,a);if(t[r.name]=l,S6()==="webgpu"){const c=AD();"uploadToGPU"in c&&ye(l.shape)>=de().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return t}function vre(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(r=>{if(e+=r.byteLength,t.push(r.byteLength===r.buffer.byteLength?r:new r.constructor(r)),!(r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${r.constructor.name}`)});const s=new Uint8Array(e);let i=0;return t.forEach(r=>{s.set(new Uint8Array(r.buffer),i),i+=r.byteLength}),s.buffer}const RD=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Q3(n){return RD?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function xre(n){if(RD)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,i=e.length;s<i;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function wre(n){if(RD){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function k6(n){return ra.join(n)}function Z3(n){const e="/";for(n=n.trim();n.endsWith(e);)n=n.slice(0,n.length-1);const t=n.split(e);return t[t.length-1]}function N6(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(t.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function A6(n,e,t){const s={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(s.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=t}return n.signature!=null&&(s.signature=n.signature),n.userDefinedMetadata!=null&&(s.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(s.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(s.initializerSignature=n.initializerSignature),s}async function DD(n,e){let t,s;return n.weightsManifest!=null&&([t,s]=await e(n.weightsManifest)),A6(n,t,s)}function ax(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:Q3(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:Q3(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new ra(n.weightData).byteLength}}function cR(n){const e=[];for(const t of n)e.push(...t.weights);return e}function _re(){const n=t=>{let s=t<<13,i=0;for(;!(s&8388608);)i-=8388608,s<<=1;return s&=-8388609,i+=947912704,s|i},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function Tre(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function Sre(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function Ere(){const n=_re(),e=Tre(),t=Sre();return s=>{const i=new ArrayBuffer(4*s.length),r=new Uint32Array(i);for(let o=0;o<s.length;o++){const a=s[o],l=n[t[a>>10]+(a&1023)]+e[a>>10];r[o]=l}return new Float32Array(i)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class An{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return An.instance==null&&(An.instance=new An),An.instance}static registerSaveRouter(e){An.getInstance().saveRouters.push(e)}static registerLoadRouter(e){An.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return An.getHandlers(e,"save")}static getLoadHandlers(e,t){return An.getHandlers(e,"load",t)}static getHandlers(e,t,s){const i=[];return(t==="load"?An.getInstance().loadRouters:An.getInstance().saveRouters).forEach(o=>{const a=o(e,s);a!==null&&i.push(a)}),i}}const Cre=n=>An.registerSaveRouter(n),Ire=n=>An.registerLoadRouter(n),R6=n=>An.getSaveHandlers(n),kre=(n,e)=>An.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uR="tensorflowjs",hR=1,md="models_store",gu="model_info_store";function D6(){if(!de().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function dR(n){const e=n.result;e.createObjectStore(md,{keyPath:"modelPath"}),e.createObjectStore(gu,{keyPath:"modelPath"})}class Ld{constructor(e){if(this.indexedDB=D6(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,i)=>{const r=this.indexedDB.open(uR,hR);r.onupgradeneeded=()=>dR(r),r.onsuccess=()=>{const o=r.result;if(t==null){const a=o.transaction(md,"readonly"),c=a.objectStore(md).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=h=>(o.close(),i(c.error)),a.oncomplete=()=>o.close()}else{t.weightData=ra.join(t.weightData);const a=ax(t),l=o.transaction(gu,"readwrite");let c=l.objectStore(gu),h;try{h=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(p){return i(p)}let f;h.onsuccess=()=>{f=o.transaction(md,"readwrite");const p=f.objectStore(md);let g;try{g=p.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:a})}catch(y){return i(y)}g.onsuccess=()=>s({modelArtifactsInfo:a}),g.onerror=y=>{c=l.objectStore(gu);const x=c.delete(this.modelPath);x.onsuccess=()=>(o.close(),i(g.error)),x.onerror=v=>(o.close(),i(g.error))}},h.onerror=p=>(o.close(),i(h.error)),l.oncomplete=()=>{f==null?o.close():f.oncomplete=()=>o.close()}}},r.onerror=o=>i(r.error)})}}Ld.URL_SCHEME="indexeddb://";const $6=n=>de().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ld.URL_SCHEME)?Nre(n.slice(Ld.URL_SCHEME.length)):null;An.registerSaveRouter($6);An.registerLoadRouter($6);function Nre(n){return new Ld(n)}function Are(n){return n.startsWith(Ld.URL_SCHEME)?n.slice(Ld.URL_SCHEME.length):n}class Rre{constructor(){this.indexedDB=D6()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(uR,hR);s.onupgradeneeded=()=>dR(s),s.onsuccess=()=>{const i=s.result,r=i.transaction(gu,"readonly"),a=r.objectStore(gu).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(i.close(),t(a.error)),r.oncomplete=()=>i.close()},s.onerror=i=>t(s.error)})}async removeModel(e){return e=Are(e),new Promise((t,s)=>{const i=this.indexedDB.open(uR,hR);i.onupgradeneeded=()=>dR(i),i.onsuccess=()=>{const r=i.result,o=r.transaction(gu,"readwrite"),a=o.objectStore(gu),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return r.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const h=a.delete(e),f=()=>{c=r.transaction(md,"readwrite");const g=c.objectStore(md).delete(e);g.onsuccess=()=>t(l.result.modelArtifactsInfo),g.onerror=y=>s(l.error)};h.onsuccess=f,h.onerror=p=>(f(),r.close(),s(l.error))}},l.onerror=h=>(r.close(),s(l.error)),o.oncomplete=()=>{c==null?r.close():c.oncomplete=()=>r.close()}},i.onerror=r=>s(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ul="/",xp="tensorflowjs_models",O6="info",Dre="model_topology",$re="weight_specs",Ore="weight_data",Pre="model_metadata";function P6(n){return{info:[xp,n,O6].join(Ul),topology:[xp,n,Dre].join(Ul),weightSpecs:[xp,n,$re].join(Ul),weightData:[xp,n,Ore].join(Ul),modelMetadata:[xp,n,Pre].join(Ul)}}function L6(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function Lre(n){const e=n.split(Ul);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(Ul)}function Mre(n){return n.startsWith(Md.URL_SCHEME)?n.slice(Md.URL_SCHEME.length):n}class Md{constructor(e){if(!de().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=P6(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),i=ax(e),r=ra.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,xre(r));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:i}}catch{throw L6(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=i;const r=this.LS.getItem(this.keys.modelMetadata);if(r!=null){const a=JSON.parse(r);t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy,a.signature!=null&&(t.signature=a.signature),a.userDefinedMetadata!=null&&(t.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(t.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(t.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(t.trainingConfig=a.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=wre(o),t}}Md.URL_SCHEME="localstorage://";const M6=n=>de().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Md.URL_SCHEME)?Fre(n.slice(Md.URL_SCHEME.length)):null;An.registerSaveRouter(M6);An.registerLoadRouter(M6);function Fre(n){return new Md(n)}class Vre{constructor(){B(de().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),B(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=xp+Ul,s=Ul+O6;for(let i=0;i<this.LS.length;++i){const r=this.LS.key(i);if(r.startsWith(t)&&r.endsWith(s)){const o=Lre(r);e[o]=JSON.parse(this.LS.getItem(r))}}return e}async removeModel(e){e=Mre(e);const t=P6(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return L6(t),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pp="://";class Ei{constructor(){this.managers={}}static getInstance(){return Ei.instance==null&&(Ei.instance=new Ei),Ei.instance}static registerManager(e,t){B(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Pp)&&(e=e.slice(0,e.indexOf(Pp))),B(e.length>0,()=>"scheme must not be an empty string.");const s=Ei.getInstance();B(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=Ei.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(Ei.getInstance().managers)}}function _1(n){if(n.indexOf(Pp)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Ei.getSchemes().join(",")}`);return{scheme:n.split(Pp)[0],path:n.split(Pp)[1]}}async function F6(n,e,t=!1){B(n!==e,()=>`Old path and new path are the same: '${n}'`);const s=An.getLoadHandlers(n);B(s.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),B(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${n}.`);const i=s[0],r=An.getSaveHandlers(e);B(r.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),B(r.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const o=r[0],a=_1(n).scheme,l=_1(n).path,c=a===_1(n).scheme,h=await i.load();t&&c&&await Ei.getManager(a).removeModel(l);const f=await o.save(h);return t&&!c&&await Ei.getManager(a).removeModel(l),f.modelArtifactsInfo}async function zre(){const n=Ei.getSchemes(),e={};for(const t of n){const s=await Ei.getManager(t).listModels();for(const i in s){const r=t+Pp+i;e[r]=s[i]}}return e}async function Bre(n){const e=_1(n);return Ei.getManager(e.scheme).removeModel(e.path)}async function Ure(n,e){return F6(n,e,!1)}async function Wre(n,e){return F6(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hre{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!de().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const i=this.functionRefs[s.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return h6(e)}}if(de().get("IS_BROWSER")){de().setPlatform("browser",new Hre);try{Ei.registerManager(Md.URL_SCHEME,new Vre)}catch{}try{Ei.registerManager(Ld.URL_SCHEME,new Rre)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jre={importFetch:()=>require("node-fetch")};let VN;class Gre{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return de().global.fetch!=null?de().global.fetch(e,t):(VN==null&&(VN=jre.importFetch()),VN(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}de().get("IS_NODE")&&!de().get("IS_BROWSER")&&de().setPlatform("node",new Gre);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ut(n,e="float32",t){return e=e||"float32",_r(n),new as(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qre(n,e){const t=U(n,"x","cast");if(!t6(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},i={dtype:e};return K.runKernel(Pm,s,i)}const De=X({cast_:qre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(n){const t={x:U(n,"x","clone","string_or_numeric")};return K.runKernel(Km,t)}const Va=X({clone_:Kre});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $D(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */_6();const Xre={buffer:ut,cast:De,clone:Va,print:$D};Gie(Xre);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(n,e){let t=U(n,"a","add"),s=U(e,"b","add");[t,s]=$n(t,s);const i={a:t,b:s};return K.runKernel(uf,i)}const ke=X({add_:Yre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(n,e){let t=U(n,"a","floorDiv"),s=U(e,"b","floorDiv");[t,s]=$n(t,s);const i={a:t,b:s};return K.runKernel(Gm,i)}const zE=X({floorDiv_:Qre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zre(n,e){let t=U(n,"a","div"),s=U(e,"b","div");if([t,s]=$n(t,s),t.dtype==="int32"&&s.dtype==="int32")return zE(t,s);const i={a:t,b:s},r={};return K.runKernel(zm,i,r)}const qe=X({div_:Zre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jre(n,e){let t=U(n,"a","mul"),s=U(e,"b","mul");[t,s]=$n(t,s);const i={a:t,b:s};return K.runKernel(sg,i)}const Y=X({mul_:Jre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eoe(n){const e=U(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return K.runKernel(dv,t)}else{const t={x:e};return K.runKernel(sv,t)}}const is=X({abs_:eoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function toe(n){const t={x:U(n,"x","acos")};return K.runKernel(km,t)}const OD=X({acos_:toe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function noe(n){const t={x:U(n,"x","acosh")};return K.runKernel(Nm,t)}const PD=X({acosh_:noe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function soe(n){B(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),B(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((i,r)=>U(i,`tensors${r}`,"addN")),t=e[0];e.forEach(i=>{if(i.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(i=>{if(!_t(i.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return K.runKernel(iv,s)}const V6=X({addN_:soe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(n,e=null,t=!1){const i={x:U(n,"x","all","bool")},r={axis:e,keepDims:t};return K.runKernel($S,i,r)}const BE=X({all_:ioe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function roe(n,e=null,t=!1){const i={x:U(n,"x","any","bool")},r={axis:e,keepDims:t};return K.runKernel(OS,i,r)}const g0=X({any_:roe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ooe(n,e=0){const s={x:U(n,"x","argMax")},i={axis:e};return K.runKernel(rv,s,i)}const Fd=X({argMax_:ooe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aoe(n,e=0){const s={x:U(n,"x","argMin")},i={axis:e};return K.runKernel(ov,s,i)}const LD=X({argMin_:aoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(n){const t={x:U(n,"x","asin")};return K.runKernel(Am,t)}const MD=X({asin_:loe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(n){const t={x:U(n,"x","asinh")};return K.runKernel(Rm,t)}const FD=X({asinh_:coe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(n){const t={x:U(n,"x","atan")};return K.runKernel(Dm,t)}const VD=X({atan_:uoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hoe(n,e){let t=U(n,"a","atan2"),s=U(e,"b","atan2");[t,s]=$n(t,s);const i={a:t,b:s};return K.runKernel(Om,i)}const zD=X({atan2_:hoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(n){const t={x:U(n,"x","atanh")};return K.runKernel($m,t)}const BD=X({atanh_:doe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lx(n,e,t,s,i="NHWC",r){const o=n[3],a=[...e,o],l=yc(i);return Ps(n,a,t,r,s,null,null,l)}function No(n,e,t,s,i,r,o="channelsLast"){const[a,l]=y0(e);let c;if(o==="channelsLast")c=[a,l,n[3],n[3]];else if(o==="channelsFirst")c=[a,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return Ps(n,c,t,s,i,r,!1,o)}function gc(n,e,t,s,i,r,o="NDHWC"){const[a,l,c]=fR(e);let h,f;if(o==="NDHWC")f="channelsLast",h=[a,l,c,n[4],n[4]];else if(o==="NCDHW")f="channelsFirst",h=[a,l,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${o}`);return oh(n,h,t,s,i,!1,f,r)}function Ps(n,e,t,s,i,r,o=!1,a="channelsLast"){let[l,c,h,f]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,h,f]=n;else if(a==="channelsFirst")[l,f,c,h]=n;else throw new Error(`Unknown dataFormat ${a}`);const[p,g,,y]=e,[x,v]=y0(t),[w,S]=y0(s),C=Lp(p,w),I=Lp(g,S),{padInfo:A,outHeight:L,outWidth:O}=moe(i,c,h,x,v,C,I,r,a),N=o?y*f:y;let k;return a==="channelsFirst"?k=[l,N,L,O]:a==="channelsLast"&&(k=[l,L,O,N]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:h,inChannels:f,outHeight:L,outWidth:O,outChannels:N,padInfo:A,strideHeight:x,strideWidth:v,filterHeight:p,filterWidth:g,effectiveFilterHeight:C,effectiveFilterWidth:I,dilationHeight:w,dilationWidth:S,inShape:n,outShape:k,filterShape:e}}function oh(n,e,t,s,i,r=!1,o="channelsLast",a){let[l,c,h,f,p]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,h,f,p]=n;else if(o==="channelsFirst")[l,p,c,h,f]=n;else throw new Error(`Unknown dataFormat ${o}`);const[g,y,x,,v]=e,[w,S,C]=fR(t),[I,A,L]=fR(s),O=Lp(g,I),N=Lp(y,A),k=Lp(x,L),{padInfo:$,outDepth:R,outHeight:z,outWidth:V}=goe(i,c,h,f,w,S,C,O,N,k,a),ne=r?v*p:v;let Q;return o==="channelsFirst"?Q=[l,ne,R,z,V]:o==="channelsLast"&&(Q=[l,R,z,V,ne]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:h,inWidth:f,inChannels:p,outDepth:R,outHeight:z,outWidth:V,outChannels:ne,padInfo:$,strideDepth:w,strideHeight:S,strideWidth:C,filterDepth:g,filterHeight:y,filterWidth:x,effectiveFilterDepth:O,effectiveFilterHeight:N,effectiveFilterWidth:k,dilationDepth:I,dilationHeight:A,dilationWidth:L,inShape:n,outShape:Q,filterShape:e}}function foe(n,e,t,s,i){s==null&&(s=UD(n,e,t));const r=n[0],o=n[1],a=b0((r-e+2*s)/t+1,i),l=b0((o-e+2*s)/t+1,i);return[a,l]}function poe(n,e,t,s,i,r){i==null&&(i=UD(n,e[0],s[0]));const o=[0,0,0,t];for(let a=0;a<3;a++)n[a]+2*i>=e[a]&&(o[a]=b0((n[a]-e[a]+2*i)/s[a]+1,r));return o}function UD(n,e,t,s=1){const i=Lp(e,s);return Math.floor((n[0]*(t-1)-t+i)/2)}function y0(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function fR(n){return typeof n=="number"?[n,n,n]:n}function Lp(n,e){return e<=1?n:n+(n-1)*(e-1)}function moe(n,e,t,s,i,r,o,a,l){let c,h,f;if(typeof n=="number"){c={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const g=foe([e,t],r,s,n,a);h=g[0],f=g[1]}else if(n==="same"){h=Math.ceil(e/s),f=Math.ceil(t/i);const p=Math.max(0,(h-1)*s+r-e),g=Math.max(0,(f-1)*i+o-t),y=Math.floor(p/2),x=p-y,v=Math.floor(g/2),w=g-v;c={top:y,bottom:x,left:v,right:w,type:"SAME"}}else if(n==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-r+1)/s),f=Math.ceil((t-o+1)/i);else if(typeof n=="object"){const p=l==="channelsLast"?n[1][0]:n[2][0],g=l==="channelsLast"?n[1][1]:n[2][1],y=l==="channelsLast"?n[2][0]:n[3][0],x=l==="channelsLast"?n[2][1]:n[3][1];c={top:p,bottom:g,left:y,right:x,type:p===0&&g===0&&y===0&&x===0?"VALID":"EXPLICIT"},h=b0((e-r+p+g)/s+1,a),f=b0((t-o+y+x)/i+1,a)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:c,outHeight:h,outWidth:f}}function goe(n,e,t,s,i,r,o,a,l,c,h){let f,p,g,y;if(n==="valid"&&(n=0),typeof n=="number"){f={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const v=poe([e,t,s,1],[a,l,c],1,[i,r,o],n,h);p=v[0],g=v[1],y=v[2]}else if(n==="same"){p=Math.ceil(e/i),g=Math.ceil(t/r),y=Math.ceil(s/o);const x=(p-1)*i+a-e,v=(g-1)*r+l-t,w=(y-1)*o+c-s,S=Math.floor(x/2),C=x-S,I=Math.floor(v/2),A=v-I,L=Math.floor(w/2),O=w-L;f={top:I,bottom:A,left:L,right:O,front:S,back:C,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:f,outDepth:p,outHeight:g,outWidth:y}}function b0(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function Vu(n){const[e,t,s]=y0(n);return e===1&&t===1&&s===1}function ei(n,e){return Vu(n)||Vu(e)}function Vd(n){return y0(n).every(e=>e>0)}function yc(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function Vi(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")B(Od(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(i=>{B(Od(i),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${i}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yoe(n,e){const s={x:U(n,"x","reshape","string_or_numeric")},i={shape:e};return K.runKernel(Gv,s,i)}const te=X({reshape_:yoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function boe(n,e,t,s,i){const r=U(n,"x","avgPool","float32"),o=1;B(ei(t,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);let a=r,l=!1;r.rank===3&&(l=!0,a=te(r,[1,r.shape[0],r.shape[1],r.shape[2]])),B(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Vi("avgPool",s,i);const c={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:i};let f=K.runKernel(av,c,h);return f=De(f,r.dtype),l?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const cx=X({avgPool_:boe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function voe(n,e,t,s,i,r="NDHWC"){const o=U(n,"x","avgPool3d","float32");let a=o,l=!1;o.rank===4&&(l=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),B(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),B(r==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),B(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),Vi("avgPool3d",s,i);const c={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:i,dataFormat:r};let f=K.runKernel(lv,c,h);return f=De(f,a.dtype),l?te(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const WD=X({avgPool3d_:voe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(n,e=0){B(n.length>=1,()=>"Pass at least one tensor to concat");const t=m0(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(r=>{if(r.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${r.dtype}. `)}),t.length===1)return Va(t[0]);const s=t,i={axis:e};return K.runKernel(fv,s,i)}const Kn=X({concat_:xoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(n,e,t=!1,s=!1){let i=U(n,"a","matMul"),r=U(e,"b","matMul");[i,r]=$n(i,r);const o={a:i,b:r},a={transposeA:t,transposeB:s};return K.runKernel(cv,o,a)}const pt=X({matMul_:woe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _oe(n){const t={x:U(n,"x","sigmoid","float32")};return K.runKernel(pg,t)}const Yo=X({sigmoid_:_oe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(n,e,t){const s=U(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const i={x:s},r={begin:e,size:t};return K.runKernel(Qv,i,r)}const St=X({slice_:Toe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Soe(n){const t={x:U(n,"x","tanh","float32")};return K.runKernel(xg,t)}const zu=X({tanh_:Soe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(n,e,t,s,i,r){const o=U(n,"forgetBias","basicLSTMCell"),a=U(e,"lstmKernel","basicLSTMCell"),l=U(t,"lstmBias","basicLSTMCell"),c=U(s,"data","basicLSTMCell"),h=U(i,"c","basicLSTMCell"),f=U(r,"h","basicLSTMCell"),p=Kn([c,f],1),g=pt(p,a),y=ke(g,l),x=y.shape[0],v=y.shape[1]/4,w=[x,v],S=St(y,[0,0],w),C=St(y,[0,v],w),I=St(y,[0,v*2],w),A=St(y,[0,v*3],w),L=ke(Y(Yo(S),zu(C)),Y(h,Yo(ke(o,I)))),O=Y(zu(L),Yo(A));return[L,O]}const z6=X({basicLSTMCell_:Eoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Coe(n,e,t){const s=U(n,"x","batchToSpaceND"),i=e.reduce((a,l)=>a*l);B(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),B(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),B(s.shape[0]%i===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${i}`);const r={x:s},o={blockShape:e,crops:t};return K.runKernel(uv,r,o)}const ux=X({batchToSpaceND_:Coe});function Ioe(n){let e;return n.rank===0||n.rank===1?e=te(n,[1,1,1,n.size]):n.rank===2?e=te(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=te(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(n,e,t,s,i,r){r==null&&(r=.001);const o=U(n,"x","batchNorm"),a=U(e,"mean","batchNorm"),l=U(t,"variance","batchNorm");let c;i!=null&&(c=U(i,"scale","batchNorm"));let h;s!=null&&(h=U(s,"offset","batchNorm")),B(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(h==null||a.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:Ioe(o),scale:c,offset:h,mean:a,variance:l},g={varianceEpsilon:r},y=K.runKernel(_v,p,g);return te(y,o.shape)}const Tg=X({batchNorm_:koe});function Noe(n,e,t,s,i,r){const o=U(n,"x","batchNorm"),a=U(e,"mean","batchNorm"),l=U(t,"variance","batchNorm");let c;i!=null&&(c=U(i,"scale","batchNorm"));let h;return s!=null&&(h=U(s,"offset","batchNorm")),B(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),B(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),B(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&B(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),h!=null&&B(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),Tg(o,a,l,h,c,r)}const HD=X({batchNorm2d_:Noe});function Aoe(n,e,t,s,i,r){const o=U(n,"x","batchNorm"),a=U(e,"mean","batchNorm"),l=U(t,"variance","batchNorm");let c;i!=null&&(c=U(i,"scale","batchNorm"));let h;return s!=null&&(h=U(s,"offset","batchNorm")),B(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),B(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),B(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&B(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),h!=null&&B(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),Tg(o,a,l,h,c,r)}const jD=X({batchNorm3d_:Aoe});function Roe(n,e,t,s,i,r){const o=U(n,"x","batchNorm"),a=U(e,"mean","batchNorm"),l=U(t,"variance","batchNorm");let c;i!=null&&(c=U(i,"scale","batchNorm"));let h;return s!=null&&(h=U(s,"offset","batchNorm")),B(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),B(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),B(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&B(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),h!=null&&B(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),Tg(o,a,l,h,c,r)}const GD=X({batchNorm4d_:Roe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Doe(n,e,t){const s=U(n,"x","bincount"),i=U(e,"weights","bincount");B(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),B(t>=0,()=>`size must be non-negative, but got ${t}.`),B(i.size===s.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${i.shape}.`);const r={x:s,weights:i},o={size:t};return K.runKernel(MS,r,o)}const qD=X({bincount_:Doe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $oe(n,e){const t=U(n,"x","bitwiseAnd"),s=U(e,"y","bitwiseAnd");if(!_t(t.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${t.shape}, y: ${s.shape}`);if(t.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${t.dtype} and type of y: ${s.dtype}`);const i={a:t,b:s};return K.runKernel(hv,i)}const B6=X({bitwiseAnd_:$oe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ooe(n,e){const t=U(n,"s0","broadcastArgs","int32"),s=U(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const i={s0:t,s1:s};return K.runKernel(FS,i)}const U6=X({broadcastArgs_:Ooe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Poe(n,e){let t=U(n,"broadcastTo","x");const s=t.shape;if(_r(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const c=t.shape.slice();for(;c.length<e.length;)c.unshift(1);t=te(t,c)}const i=t.shape,r=Array.from(e);for(let c=e.length-1;c>=0;c--)if(i[c]===e[c])r[c]=1;else if(t.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(r.map((c,h)=>c>1?h:-1).filter(c=>c>=0).length===0)return Va(t);const a={x:t},l={reps:r};return K.runKernel(wg,a,l)}const Cd=X({broadcastTo_:Poe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Loe(n){const t={x:U(n,"x","ceil","float32")};return K.runKernel(Lm,t)}const KD=X({ceil_:Loe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hf(n,e,t){_r(n),t=t||lf(e);const s={shape:n,value:e,dtype:t};return K.runKernel(eE,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Moe(n,e,t){const s=U(n,"x","clipByValue");if(B(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return hf(s.shape,e,s.dtype);const i={x:s},r={clipValueMin:e,clipValueMax:t};return K.runKernel(Mm,i,r)}const tr=X({clipByValue_:Moe});function Foe(n){return Kn(n,0)}const XD=X({concat1d_:Foe});function Voe(n,e){return Kn(n,e)}const YD=X({concat2d_:Voe});function zoe(n,e){return Kn(n,e)}const QD=X({concat3d_:zoe});function Boe(n,e){return Kn(n,e)}const ZD=X({concat4d_:Boe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(n,e,t,s,i="NHWC",r=[1,1],o){const a=U(n,"x","conv2d","float32"),l=U(e,"filter","conv2d","float32");let c=a,h=!1;a.rank===3&&(h=!0,c=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),B(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),B(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Vi("conv2d",s,o);const f=i==="NHWC"?c.shape[3]:c.shape[1];B(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),B(ei(t,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${r}'`),B(Vd(r),()=>"Error in conv2D: Dilated rates should be larger than 0."),B(Vd(t),()=>"Error in conv2D: Strides should be larger than 0.");const p={x:c,filter:l},g={strides:t,pad:s,dataFormat:i,dilations:r,dimRoundingMode:o},y=K.runKernel(pv,p,g);return h?te(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const sc=X({conv2d_:Uoe});function Woe(n,e,t,s,i="NWC",r=1,o){const a=U(n,"x","conv1d"),l=U(e,"filter","conv1d");let c=a,h=!1;a.rank===2&&(h=!0,c=te(a,[1,a.shape[0],a.shape[1]])),B(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),B(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Vi("conv1d",s,o),B(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),B(ei(t,r),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${r}'`),B(Vd(r),()=>"Error in conv1D: Dilated rates should be larger than 0."),B(Vd(t),()=>"Error in conv1D: Stride should be larger than 0."),B(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const f=te(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=te(c,[c.shape[0],1,c.shape[1],c.shape[2]]),v=sc(p,f,[1,t],s,"NHWC",[1,r],o);return h?te(v,[v.shape[2],v.shape[3]]):te(v,[v.shape[0],v.shape[2],v.shape[3]])}const UE=X({conv1d_:Woe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hoe(n,e,t,s,i,r="NHWC",o){B(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,l=e,c=!1;e.rank===3&&(c=!0,l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,n[0],n[1],n[2]]),B(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),B(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),B(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const h=r==="NHWC"?a[3]:a[1],f=r==="NHWC"?l.shape[3]:l.shape[1];B(h===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${t.shape[2]}.`),B(f===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${t.shape[3]}.`),Vi("conv2dDerInput",i,o);const p={dy:l,filter:t},g={strides:s,pad:i,dataFormat:r,dimRoundingMode:o,inputShape:a},y=K.runKernel(mv,p,g);return c?te(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const JD=X({conv2DBackpropInput_:Hoe});function joe(n,e,t,s,i,r){const o=U(n,"x","conv2dTranspose"),a=U(e,"filter","conv2dTranspose");return JD(t,o,a,s,i,"NHWC",r)}const WE=X({conv2dTranspose_:joe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Goe(n,e,t,s,i="NDHWC",r=[1,1,1]){const o=U(n,"x","conv3d"),a=U(e,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),B(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),B(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),B(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),B(ei(t,r),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${r}'`),B(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),B(Vd(r),()=>"Error in conv3D: Dilated rates should be larger than 0."),B(Vd(t),()=>"Error in conv3D: Strides should be larger than 0.");const h={x:l,filter:a},f={strides:t,pad:s,dataFormat:i,dilations:r},p=K.runKernel(gv,h,f);return c?te(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const e$=X({conv3d_:Goe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qoe(n,e,t,s,i){B(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let r=n,o=e,a=!1;e.rank===4&&(a=!0,o=te(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),r=[1,n[0],n[1],n[2],n[3]]);const l=r[4],c=o.shape[4];B(r.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${r.length}.`),B(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),B(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),B(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),B(c===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${t.shape[4]}.`);const h={dy:o,filter:t},f={pad:i,strides:s,inputShape:r},p=K.runKernel(US,h,f);return a?te(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const W6=X({conv3DBackpropInput_:qoe});function Koe(n,e,t,s,i){const r=U(n,"x","conv3dTranspose"),o=U(e,"filter","conv3dTranspose");return W6(t,r,o,s,i)}const t$=X({conv3dTranspose_:Koe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(n){const t={x:U(n,"x","cos","float32")};return K.runKernel(Fm,t)}const hx=X({cos_:Xoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yoe(n){const t={x:U(n,"x","cosh","float32")};return K.runKernel(Vm,t)}const HE=X({cosh_:Yoe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qoe(n,e=0,t=!1,s=!1){const r={x:U(n,"x","cumprod")},o={axis:e,exclusive:t,reverse:s};return K.runKernel(WS,r,o)}const v0=X({cumprod_:Qoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(n,e=0,t=!1,s=!1){const r={x:U(n,"x","cumsum")},o={axis:e,exclusive:t,reverse:s};return K.runKernel(yv,r,o)}const jE=X({cumsum_:Zoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Joe(n,e,t,s=!1){const i=U(n,"x","denseBincount"),r=U(e,"weights","denseBincount");B(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),B(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),B(t>=0,()=>`size must be non-negative, but got ${t}.`),B(r.size===i.size||r.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${r.shape}.`);const o={x:i,weights:r},a={size:t,binaryOutput:s};return K.runKernel(jS,o,a)}const uT=X({denseBincount_:Joe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eae(n,e,t="NHWC"){const s=U(n,"x","depthToSpace","float32"),i=t==="NHWC"?s.shape[1]:s.shape[2],r=t==="NHWC"?s.shape[2]:s.shape[3],o=t==="NHWC"?s.shape[3]:s.shape[1];B(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),B(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e}  for depthToSpace with input shape
    ${s.shape}`),B(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e} for depthToSpace with input shape
        ${s.shape}`),B(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:t};return K.runKernel(GS,a,l)}const n$=X({depthToSpace_:eae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tae(n,e,t,s,i="NHWC",r=[1,1],o){const a=U(n,"x","depthwiseConv2d","float32"),l=U(e,"filter","depthwiseConv2d","float32");let c=a,h=!1;a.rank===3&&(h=!0,c=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),B(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),B(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=i==="NHWC"?c.shape[3]:c.shape[1];B(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),Vi("depthwiseConv2d",s,o);const p={x:c,filter:l},g={strides:t,pad:s,dataFormat:i,dilations:r,dimRoundingMode:o},y=K.runKernel(bv,p,g);return h?te(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Sg=X({depthwiseConv2d_:tae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nae(n){const t={x:U(n,"x","diag")};return K.runKernel(XS,t)}const H6=X({diag_:nae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sae(n,e,t,s,i=[1,1],r="NHWC"){const o=U(n,"x","dilation2d"),a=U(e,"filter","dilation2d");B(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),B(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),B(r==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${r}`);let l=o,c=!1;o.rank===3&&(l=te(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0),B(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const h={x:l,filter:a},f={strides:t,pad:s,dilations:i},p=K.runKernel(vv,h,f);return c?te(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const s$=X({dilation2d_:sae});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zd(n,e){const t=n.length,s=[];for(let i=0;i<t;i++){const r=t-1-i,o=n[r]||1;(e[e.length-1-i]||1)>1&&o===1&&s.unshift(r)}return s}function ls(n,e){const t=[];for(let s=0;s<e.length;s++){const i=n[n.length-s-1],r=e.length-s-1,o=e[r];(i==null||i===1&&o>1)&&t.unshift(r)}return t}function ot(n,e){const t=Math.max(n.length,e.length),s=new Array(t);for(let i=0;i<t;i++){let r=n[n.length-i-1];r==null&&(r=1);let o=e[e.length-i-1];if(o==null&&(o=1),r===1)s[t-i-1]=o;else if(o===1)s[t-i-1]=r;else if(r!==o){const a=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(a)}else s[t-i-1]=r}return s}const iae=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:ot,getBroadcastDims:zd,getReductionAxes:ls},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rae(n,e){let t=U(n,"a","equal","string_or_numeric"),s=U(e,"b","equal","string_or_numeric");[t,s]=$n(t,s),ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(xv,i)}const So=X({equal_:rae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oae(n,e,t){const s=U(e,"a","where"),i=U(t,"b","where"),r=U(n,"condition","where","bool"),o=ot(ot(r.shape,s.shape),i.shape),a=Cd(r,o),l=Cd(s,o),c=Cd(i,o),h={condition:a,t:l,e:c};return K.runKernel(Yv,h)}const Qs=X({where_:oae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aae(n){const t={x:U(n,"x","zerosLike")};return K.runKernel(rx,t)}const kt=X({zerosLike_:aae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lae(n,e){let t=U(n,"a","div"),s=U(e,"b","div");[t,s]=$n(t,s);const i=qe(t,s),r=kt(i),o=So(s,r);return Qs(o,r,i)}const i$=X({divNoNan_:lae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cae(n,e){const t=U(n,"t1","dot"),s=U(e,"t2","dot");B((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const i=t.rank===1?t.size:t.shape[1],r=s.rank===1?s.size:s.shape[0];if(B(i===r,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${r}.`),t.rank===1&&s.rank===1){const o=te(t,[1,-1]),a=te(s,[-1,1]),l=pt(o,a);return te(l,[])}else if(t.rank===1&&s.rank===2){const o=te(t,[1,-1]),a=te(s,[s.shape[0],s.shape[1]]),l=pt(o,a);return te(l,[l.size])}else if(t.rank===2&&s.rank===1){const o=te(s,[-1,1]),a=pt(t,o);return te(a,[a.size])}else{const o=te(s,[s.shape[0],s.shape[1]]);return pt(t,o)}}const r$=X({dot_:cae});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uae(n,...e){const t=e.map((i,r)=>U(i,`tensors${r}`,"einsum")),s={equation:n};return K.runKernel(QS,t,s)}const hd=X({einsum_:uae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hae(n){const t={x:U(n,"x","elu","float32")};return K.runKernel(Bm,t)}const Eg=X({elu_:hae});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dae(n,e){const t=U(n,"x","ensureShape","string_or_numeric");if(!Jj(t.shape,e))throw new Error(`EnsureShape: Shape of tensor ${t.shape} is not compatible with expected shape ${e}`);return n}const j6=X({ensureShape_:dae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fae(n){let e=U(n,"x","erf");B(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=De(e,"float32"));const t={x:e};return K.runKernel(Um,t)}const GE=X({erf_:fae});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function G6(n,e,t){const s=n.length+e.length,i=[];let r=0,o=0;for(let a=0;a<s;a++)t.indexOf(a)===-1?i.push(n[r++]):i.push(e[o++]);return i}function Ls(n,e){const t=[],s=n.length;for(let r=0;r<s;r++)e.indexOf(r)===-1&&t.push(n[r]);const i=e.map(r=>n[r]);return[t,i]}function Xn(n,e){const t=e.map(s=>1);return G6(n,t,e)}function ti(n,e,t){B(o$(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function On(n,e){if(o$(n,e))return null;const t=[];for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);return n.forEach(s=>t.push(s)),t}function ah(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Qn(n,e){const t=[];for(let s=e-n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pae(n,e=null,t=!1){const i={x:U(n,"x","max")},r={reductionIndices:e,keepDims:t};return K.runKernel(Dv,i,r)}const Fr=X({max_:pae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mae(n,e=null,t=!1){const i={x:U(n,"x","min")},r={axis:e,keepDims:t};return K.runKernel(Lv,i,r)}const Qp=X({min_:mae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gae(n,e){let t=U(n,"base","pow"),s=U(e,"exp","pow");[t,s]=$n(t,s);const i={a:t,b:s};return K.runKernel(ig,i)}const Za=X({pow_:gae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qe(n,e){if((ks(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&ks(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return rh(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yae(n){const t={x:U(n,"x","sqrt","float32")};return K.runKernel(gg,t)}const Os=X({sqrt_:yae});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bae(n){const e=U(n,"x","square"),t={};return K.runKernel("Square",{x:e},t)}const rn=X({square_:bae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vae(n,e=null,t=!1){let s=U(n,"x","sum");s.dtype==="bool"&&(s=De(s,"int32"));const i={x:s},r={axis:e,keepDims:t};return K.runKernel(Zv,i,r)}const We=X({sum_:vae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xae(n,e="euclidean",t=null,s=!1){n=U(n,"x","norm");const i=q6(n,e,t);let r=i.shape;if(s){const o=gt(t,n.shape);r=Xn(i.shape,o)}return te(i,r)}function q6(n,e,t=null){if(n.rank===0)return is(n);if(n.rank!==1&&t===null)return q6(te(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return We(is(n),t);if(e===1/0)return Fr(is(n),t);if(e===-1/0)return Qp(is(n),t);if(e==="euclidean"||e===2)return Os(We(Za(is(n),Qe(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Fr(We(is(n),t[0]),t[1]-1);if(e===1/0)return Fr(We(is(n),t[1]),t[0]);if(e===-1/0)return Qp(We(is(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Os(We(rn(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const Cg=X({norm_:xae});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wae(n,e=null,t=!1){return Cg(n,"euclidean",e,t)}const a$=X({euclideanNorm_:wae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ae(n){const t={x:U(n,"x","exp")};return K.runKernel(Wm,t)}const nr=X({exp_:_ae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tae(n,e=0){const t=U(n,"x","expandDims","string_or_numeric");B(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},i={dim:e};return K.runKernel(wv,s,i)}const ui=X({expandDims_:Tae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sae(n){const t={x:U(n,"x","expm1")};return K.runKernel(Hm,t)}const l$=X({expm1_:Sae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eae(n,e){const t=U(n,"x","tile","string_or_numeric");B(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},i={reps:e};return K.runKernel(wg,s,i)}const Or=X({tile_:Eae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cae(n,e,t,s="float32"){e==null&&(e=n);const i=ut([n,e],s),r=n<=e?n:e;for(let a=0;a<r;++a)i.set(1,a,a);const o=te(i.toTensor(),[n,e]);if(t==null)return o;if(t.length===1)return Or(ui(o,0),[t[0],1,1]);if(t.length===2)return Or(ui(ui(o,0),0),[t[0],t[1],1,1]);if(t.length===3)return Or(ui(ui(ui(o,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const qE=X({eye_:Cae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iae(n){const t={x:U(n,"x","floor","float32")};return K.runKernel(jm,t)}const Ig=X({floor_:Iae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kae(n,e,t=0,s=0){const i=U(n,"x","gather"),r=U(e,"indices","gather","int32"),o={x:i,indices:r},a={axis:t,batchDims:s};return K.runKernel(Tv,o,a)}const kg=X({gather_:kae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nae(n,e){let t=U(n,"a","greater","string_or_numeric"),s=U(e,"b","greater","string_or_numeric");[t,s]=$n(t,s),ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(Sv,i)}const rr=X({greater_:Nae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aae(n,e){let t=U(n,"a","greaterEqual","string_or_numeric"),s=U(e,"b","greaterEqual","string_or_numeric");[t,s]=$n(t,s),ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(qm,i)}const bc=X({greaterEqual_:Aae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rae(n){const t={input:U(n,"input","imag")};return K.runKernel(iE,t)}const dx=X({imag_:Rae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(n){const t={x:U(n,"x","isFinite")};return K.runKernel(Xm,t)}const c$=X({isFinite_:Dae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ae(n){const t={x:U(n,"x","isInf")};return K.runKernel(Ym,t)}const u$=X({isInf_:$ae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oae(n){const t={x:U(n,"x","isNaN")};return K.runKernel(Qm,t)}const h$=X({isNaN_:Oae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pae(n,e=.2){const s={x:U(n,"x","leakyRelu")},i={alpha:e};return K.runKernel(Ev,s,i)}const fx=X({leakyRelu_:Pae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lae(n,e){let t=U(n,"a","less","string_or_numeric"),s=U(e,"b","less","string_or_numeric");[t,s]=$n(t,s),ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(Cv,i)}const Zp=X({less_:Lae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mae(n,e){let t=U(n,"a","lessEqual","string_or_numeric"),s=U(e,"b","lessEqual","string_or_numeric");[t,s]=$n(t,s),ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(Iv,i)}const lh=X({lessEqual_:Mae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K6(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const s={start:n,stop:e,num:t};return K.runKernel(rE,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fae(n,e=5,t=1,s=1,i=.5){const r=U(n,"x","localResponseNormalization");B(r.rank===4||r.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${r.rank}.`),B(Od(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=r,a=!1;r.rank===3&&(a=!0,o=te(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={x:o},c={depthRadius:e,bias:t,alpha:s,beta:i},h=K.runKernel(Rv,l,c);return a?te(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const d$=X({localResponseNormalization_:Fae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vae(n){const t={x:U(n,"x","log","float32")};return K.runKernel(Zm,t)}const br=X({log_:Vae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zae(n){const t={x:U(n,"x","log1p")};return K.runKernel(Jm,t)}const px=X({log1p_:zae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bae(n){return B(Lu(n),()=>"The f passed in grad(f) must be a function"),(e,t)=>{const s=U(e,"x","tf.grad","string_or_numeric"),i=t!=null?U(t,"dy","tf.grad"):null;return K.tidy(()=>{const{value:r,grads:o}=K.gradients(()=>n(s),[s],i);return i!=null&&Js(r.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),KE(o),o[0]})}}function Uae(n){return B(Lu(n),()=>"The f passed in grads(f) must be a function"),(e,t)=>{B(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=m0(e,"args","tf.grads","string_or_numeric"),i=t!=null?U(t,"dy","tf.grads"):null;return K.tidy(()=>{const{value:r,grads:o}=K.gradients(()=>n(...s),s,i);return i!=null&&Js(r.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),KE(o),o})}}function Wae(n){return B(Lu(n),()=>"The f passed in valueAndGrad(f) must be a function"),(e,t)=>{B(e instanceof Kt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),B(t==null||t instanceof Kt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:i}=K.gradients(()=>n(e),[e],t);return KE(s),{grad:s[0],value:i}}}function Hae(n){return B(Lu(n),()=>"The f passed in valueAndGrads(f) must be a function"),(e,t)=>{B(Array.isArray(e)&&e.every(i=>i instanceof Kt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),B(t==null||t instanceof Kt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=K.gradients(()=>n(...e),e,t);return t!=null&&Js(s.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),KE(s.grads),s}}function X6(n,e){B(Lu(n),()=>"The f passed in variableGrads(f) must be a function"),B(e==null||Array.isArray(e)&&e.every(c=>c instanceof p0),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const c in K.registeredVariables)e.push(K.registeredVariables[c])}const s=t?e.filter(c=>!c.trainable):null,i=e.length;e=e.filter(c=>c.trainable),B(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const r=!0,{value:o,grads:a}=K.gradients(n,e,null,r);B(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),B(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((c,h)=>{a[h]!=null&&(l[c.name]=a[h])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function Ja(n){return K.customGrad(n)}function KE(n){if(n.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jae(n){const t={x:U(n,"x","neg")};return K.runKernel(Fv,t)}const gn=X({neg_:jae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gae(n){const t={x:U(n,"x","softplus")};return K.runKernel(mg,t)}const df=X({softplus_:Gae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qae(n){const e=U(n,"x","logSigmoid");return Ja(s=>({value:gn(df(gn(s))),gradFunc:o=>Y(o,Yo(gn(s)))}))(e)}const f$=X({logSigmoid_:qae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kae(n,e){let t=U(n,"a","sub"),s=U(e,"b","sub");[t,s]=$n(t,s);const i={a:t,b:s};return K.runKernel(bg,i)}const Be=X({sub_:Kae});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xae(n,e=-1){const t=U(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Ja((i,r)=>{const a=Fr(i,e,!0),l=Be(i,a),c=Be(De(l,"float32"),br(We(nr(l),e,!0)));return r([c]),{value:c,gradFunc:(f,p)=>{const[g]=p,y=!0,x=nr(g);return Be(f,Y(We(f,e,y),x))}}})(t)}const XE=X({logSoftmax_:Xae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yae(n,e=null,t=!1){const s=U(n,"x","logSumExp"),i=gt(e,s.shape),r=Fr(s,i,!0),o=Be(s,r),a=nr(o),l=We(a,i),c=br(l),h=ke(te(r,c.shape),c);if(t){const f=Xn(h.shape,i);return te(h,f)}return h}const mx=X({logSumExp_:Yae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qae(n,e){const t=U(n,"a","logicalAnd","bool"),s=U(e,"b","logicalAnd","bool");ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(kv,i)}const ea=X({logicalAnd_:Qae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zae(n){const t={x:U(n,"x","logicalNot","bool")};return K.runKernel(Nv,t)}const gx=X({logicalNot_:Zae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jae(n,e){const t=U(n,"a","logicalOr","bool"),s=U(e,"b","logicalOr","bool");ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(Av,i)}const YE=X({logicalOr_:Jae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ele(n,e){const t=U(n,"a","logicalXor","bool"),s=U(e,"b","logicalXor","bool");return ot(t.shape,s.shape),ea(YE(n,e),gx(ea(n,e)))}const p$=X({logicalXor_:ele});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D_=2147483648;function tle(n,e,t="left"){const s=U(n,"sortedSequence","searchSorted"),i=U(e,"values","searchSorted"),r=s.shape[s.shape.length-1],o=i.shape[i.shape.length-1],a=te(s,[-1,r]),l=te(i,[-1,o]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(ye(l.shape)>=D_)throw new Error(`values tensor size must less than ${D_}`);if(a.shape[1]>=D_)throw new Error(`trailing dim_size must less than ${D_} for int32 output type, was ${a.shape[1]}`);const c={sortedSequence:a,values:l},h={side:t};return K.runKernel(TE,c,h)}const QE=X({searchSorted_:tle});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y6(n,e){return QE(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nle(n,e,t,s,i){const r=U(n,"x","maxPool"),o=1;let a=r,l=!1;r.rank===3&&(l=!0,a=te(r,[1,r.shape[0],r.shape[1],r.shape[2]])),B(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),B(ei(t,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),Vi("maxPool",s,i);const c={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:i},f=K.runKernel($v,c,h);return l?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const yx=X({maxPool_:nle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sle(n,e=[1,1,1],t,s,i,r="NDHWC"){const o=U(n,"x","maxPool3d");let a=o,l=!1;o.rank===4&&(l=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),B(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),B(r==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),Vi("maxPool3d",s,i);const c={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:i,dataFormat:r},f=K.runKernel(Ov,c,h);return l?te(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const m$=X({maxPool3d_:sle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ile(n,e,t,s,i=!1){const o={x:U(n,"x","maxPoolWithArgmax")},a={filterSize:e,strides:t,pad:s,includeBatchInIndex:i},l=K.runKernel(cE,o,a);return{result:l[0],indexes:l[1]}}const Q6=X({maxPoolWithArgmax_:ile});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rle(n,e){let t=U(n,"a","maximum"),s=U(e,"b","maximum");[t,s]=$n(t,s),t.dtype==="bool"&&(t=De(t,"int32"),s=De(s,"int32")),ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(eg,i)}const il=X({maximum_:rle});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ole(n,e=null,t=!1){const i={x:U(n,"x","mean")},r={axis:e,keepDims:t};return K.runKernel(Pv,i,r)}const Rn=X({mean_:ole});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qn(n,e="float32"){if(_r(n),e==="complex64"){const s=qn(n,"float32"),i=qn(n,"float32");return nc(s,i)}const t=Zs(ye(n),e);return K.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yi(n,e="float32"){if(_r(n),e==="complex64"){const s=Yi(n,"float32"),i=qn(n,"float32");return nc(s,i)}const t=DS(ye(n),e);return K.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let s=U(n,"x","meshgrid",n instanceof Kt?n.dtype:"float32");if(e===void 0)return[s];let i=U(e,"y","meshgrid",e instanceof Kt?e.dtype:"float32");const r=ye(s.shape),o=ye(i.shape);return t==="xy"?(s=te(s,[1,-1]),i=te(i,[-1,1]),[pt(Yi([o,1],s.dtype),s),pt(i,Yi([1,r],i.dtype))]):(s=te(s,[-1,1]),i=te(i,[1,-1]),[pt(s,Yi([1,o],s.dtype)),pt(Yi([r,1],i.dtype),i)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ale(n,e){let t=U(n,"a","minimum"),s=U(e,"b","minimum");[t,s]=$n(t,s),t.dtype==="bool"&&(t=De(t,"int32"),s=De(s,"int32")),ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(tg,i)}const Bu=X({minimum_:ale});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lle(n,e,t){B(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=U(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");B(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const i=t==="reflect"?1:0;for(let a=0;a<s.rank;a++)B(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),B(e[a][0]>=0&&e[a][0]<=s.shape[a]-i&&e[a][1]>=0&&e[a][1]<=s.shape[a]-i,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-i} or less than 0 for input of shape ${s.shape}`);const r={paddings:e,mode:t},o={x:s};return K.runKernel(Mv,o,r)}const g$=X({mirrorPad_:lle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cle(n,e){let t=U(n,"a","mod"),s=U(e,"b","mod");[t,s]=$n(t,s);const i={a:t,b:s};return K.runKernel(ng,i)}const y$=X({mod_:cle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ule(n,e=null,t=!1){n=U(n,"x","moments");const s=gt(e,n.shape),i=Rn(n,s,t);let r=i.shape;t||(r=Xn(i.shape,s));const o=rn(Be(De(n,"float32"),te(i,r))),a=Rn(o,s,t);return{mean:i,variance:a}}const bx=X({moments_:ule});function hle(n,e,t,s){const i=U(e,"data","multiRNNCell"),r=m0(t,"c","multiRNNCell"),o=m0(s,"h","multiRNNCell");let a=i;const l=[];for(let f=0;f<n.length;f++){const p=n[f](a,r[f],o[f]);l.push(p[0]),l.push(p[1]),a=p[1]}const c=[],h=[];for(let f=0;f<l.length;f+=2)c.push(l[f]),h.push(l[f+1]);return[c,h]}const J6=X({multiRNNCell_:hle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dle(n,e,t,s=!1){const i=U(n,"logits","multinomial"),r=i.size,o=i.rank;if(r<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${r}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);t=t||Math.random();const l={logits:o===1?te(i,[1,-1]):i},c={numSamples:e,seed:t,normalized:s},h=K.runKernel(uE,l,c);return o===1?te(h,[h.size]):h}const e5=X({multinomial_:dle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fle(n,e){let t=U(n,"a","notEqual","string_or_numeric"),s=U(e,"b","notEqual","string_or_numeric");[t,s]=$n(t,s),ot(t.shape,s.shape);const i={a:t,b:s};return K.runKernel(Vv,i)}const Bd=X({notEqual_:fle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ple(n,e,t=1,s=0,i="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:U(n,"indices","oneHot","int32")},a={dtype:i,depth:e,onValue:t,offValue:s};return K.runKernel(Bv,o,a)}const Jp=X({oneHot_:ple});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mle(n){const t={x:U(n,"x","onesLike")};return K.runKernel(zv,t)}const vr=X({onesLike_:mle});function gle(n,e){const t=U(n,"v1","outerProduct"),s=U(e,"v2","outerProduct");B(t.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${s.rank}.`);const i=te(t,[-1,1]),r=te(s,[1,-1]);return pt(i,r)}const t5=X({outerProduct_:gle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(n,e,t=0){const s=U(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:e,constantValue:t},r={x:s};return K.runKernel(Wv,r,i)}const vc=X({pad_:yle});function ble(n,e,t=0){return B(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),vc(n,[e],t)}const n5=X({pad1d_:ble});function vle(n,e,t=0){return B(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),vc(n,e,t)}const s5=X({pad2d_:vle});function xle(n,e,t=0){return B(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),vc(n,e,t)}const i5=X({pad3d_:xle});function wle(n,e,t=0){return B(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),vc(n,e,t)}const r5=X({pad4d_:wle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _le(n,e,t){const s=U(n,"x","spaceToBatchND");B(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),B(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),B(s.shape.reduce((o,a,l)=>l>0&&l<=e.length?o&&(a+t[l-1][0]+t[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const i={x:s},r={blockShape:e,paddings:t};return K.runKernel(Jv,i,r)}const vx=X({spaceToBatchND_:_le});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tle(n,e,t,s,i,r,o){i==null&&(i=[1,1]),r==null&&(r=1),s===0&&(s="valid");const a=U(n,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),B(ei(r,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${r} and dilations '${i}'`);const h=No(l.shape,e,r,i,s),f=[h.dilationHeight,h.dilationWidth];let p;s==="same"?p=Ele([h.filterHeight,h.filterWidth],f):p=[[0,0],[0,0]];const g=f[0]===1&&f[1]===1,[y,x]=Sle([h.inHeight,h.inWidth],f,p),v=g?s:"valid",w=g?l:vx(l,f,y),C=(t==="avg"?()=>cx(w,e,r,v,o):()=>yx(w,e,r,v,o))(),I=g?C:ux(C,f,x);return c?te(I,[I.shape[1],I.shape[2],I.shape[3]]):I}function Sle(n,e,t){const s=t.map(h=>h[0]),i=t.map(h=>h[1]),r=n.concat(s,i),o=e.map((h,f)=>(h-r[f]%h)%h),a=i.map((h,f)=>h+o[f]),l=e.map((h,f)=>[s[f],a[f]]),c=e.map((h,f)=>[0,o[f]]);return[l,c]}function Ele(n,e){const s=n.map((o,a)=>o+(o-1)*(e[a]-1)).map(o=>o-1),i=s.map(o=>Math.floor(o/2)),r=s.map((o,a)=>o-i[a]);return s.map((o,a)=>[i[a],r[a]])}const b$=X({pool_:Tle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cle(n,e){const t=U(n,"x","prelu"),s=U(e,"alpha","prelu"),i={x:t,alpha:s};return K.runKernel(Hv,i)}const xx=X({prelu_:Cle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ile(n,e=null,t=!1){let s=U(n,"x","prod");s.dtype==="bool"&&(s=De(s,"int32"));const i={x:s},r={axis:e,keepDims:t};return K.runKernel(jv,i,r)}const v$=X({prod_:Ile});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kle(n,e,t,s){const i=n.map((h,f)=>U(h,`tensors${f}`,"raggedGather","int32")),r=U(e,"paramsDenseValues","raggedGather"),o=U(t,"indices","raggedGather","int32"),a={paramsNestedSplits:i,paramsDenseValues:r,indices:o},l={outputRaggedRank:s},c=K.runKernel(pE,a,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const o5=X({raggedGather_:kle});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nle(n,e,t){const s=U(n,"starts","raggedRange"),i=U(e,"limits","raggedRange",s.dtype),r=U(t,"deltas","raggedRange",s.dtype),o={starts:s,limits:i,deltas:r},a=K.runKernel(mE,o);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const a5=X({raggedRange_:Nle});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ale(n,e,t,s,i){const r=U(n,"shape","raggedTensorToTensor","int32"),o=U(e,"values","raggedTensorToTensor"),a=U(t,"defaultValue","raggedTensorToTensor",o.dtype),l=s.map((f,p)=>U(f,`tensors${p}`,"raggedTensorToTensor","int32")),c={shape:r,values:o,defaultValue:a,rowPartitionTensors:l},h={rowPartitionTypes:i};return K.runKernel(gE,c,h)}const l5=X({raggedTensorToTensor_:Ale});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(n,e,t){_r(n);const s=ye(n);let i=null;if(t==null||t==="float32")i=new Float32Array(s);else if(t==="int32")i=new Int32Array(s);else if(t==="bool")i=new Uint8Array(s);else throw new Error(`Unknown data type ${t}`);for(let r=0;r<s;r++)i[r]=e();return K.makeTensor(i,n,t)}const c5=X({rand_:Rle});var T1={exports:{}},Dle=T1.exports,J3;function $le(){return J3||(J3=1,function(n){(function(e,t,s){function i(l){var c=this,h=a();c.next=function(){var f=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=f-(c.c=f|0)},c.c=1,c.s0=h(" "),c.s1=h(" "),c.s2=h(" "),c.s0-=h(l),c.s0<0&&(c.s0+=1),c.s1-=h(l),c.s1<0&&(c.s1+=1),c.s2-=h(l),c.s2<0&&(c.s2+=1),h=null}function r(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var h=new i(l),f=c&&c.state,p=h.next;return p.int32=function(){return h.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,f&&(typeof f=="object"&&r(f,h),p.state=function(){return r(h,{})}),p}function a(){var l=4022871197,c=function(h){h=String(h);for(var f=0;f<h.length;f++){l+=h.charCodeAt(f);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return c}t&&t.exports?t.exports=o:this.alea=o})(Dle,n)}(T1)),T1.exports}var S1={exports:{}},Ole=S1.exports,ez;function Ple(){return ez||(ez=1,function(n){(function(e,t,s){function i(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},a===(a|0)?l.x=a:c+=a;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,l.next()}function r(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var c=new i(a),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(typeof h=="object"&&r(h,c),f.state=function(){return r(c,{})}),f}t&&t.exports?t.exports=o:this.xor128=o})(Ole,n)}(S1)),S1.exports}var E1={exports:{}},Lle=E1.exports,tz;function Mle(){return tz||(tz=1,function(n){(function(e,t,s){function i(a){var l=this,c="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,h==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function r(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var c=new i(a),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(typeof h=="object"&&r(h,c),f.state=function(){return r(c,{})}),f}t&&t.exports?t.exports=o:this.xorwow=o})(Lle,n)}(E1)),E1.exports}var C1={exports:{}},Fle=C1.exports,nz;function Vle(){return nz||(nz=1,function(n){(function(e,t,s){function i(a){var l=this;l.next=function(){var h=l.x,f=l.i,p,g;return p=h[f],p^=p>>>7,g=p^p<<24,p=h[f+1&7],g^=p^p>>>10,p=h[f+3&7],g^=p^p>>>3,p=h[f+4&7],g^=p^p<<7,p=h[f+7&7],p=p^p<<13,g^=p^p<<9,h[f]=g,l.i=f+1&7,g};function c(h,f){var p,g=[];if(f===(f|0))g[0]=f;else for(f=""+f,p=0;p<f.length;++p)g[p&7]=g[p&7]<<15^f.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],h.x=g,h.i=0,p=256;p>0;--p)h.next()}c(l,a)}function r(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var c=new i(a),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(h.x&&r(h,c),f.state=function(){return r(c,{})}),f}t&&t.exports?t.exports=o:this.xorshift7=o})(Fle,n)}(C1)),C1.exports}var I1={exports:{}},zle=I1.exports,sz;function Ble(){return sz||(sz=1,function(n){(function(e,t,s){function i(a){var l=this;l.next=function(){var h=l.w,f=l.X,p=l.i,g,y;return l.w=h=h+1640531527|0,y=f[p+34&127],g=f[p=p+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=f[p]=y^g,l.i=p,y+(h^h>>>16)|0};function c(h,f){var p,g,y,x,v,w=[],S=128;for(f===(f|0)?(g=f,f=null):(f=f+"\0",g=0,S=Math.max(S,f.length)),y=0,x=-32;x<S;++x)f&&(g^=f.charCodeAt((x+32)%f.length)),x===0&&(v=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,x>=0&&(v=v+1640531527|0,p=w[x&127]^=g+v,y=p==0?y+1:0);for(y>=128&&(w[(f&&f.length||0)&127]=-1),y=127,x=4*128;x>0;--x)g=w[y+34&127],p=w[y=y+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,w[y]=g^p;h.w=v,h.X=w,h.i=y}c(l,a)}function r(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var c=new i(a),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(h.X&&r(h,c),f.state=function(){return r(c,{})}),f}t&&t.exports?t.exports=o:this.xor4096=o})(zle,n)}(I1)),I1.exports}var k1={exports:{}},Ule=k1.exports,iz;function Wle(){return iz||(iz=1,function(n){(function(e,t,s){function i(a){var l=this,c="";l.next=function(){var f=l.b,p=l.c,g=l.d,y=l.a;return f=f<<25^f>>>7^p,p=p-g|0,g=g<<24^g>>>8^y,y=y-f|0,l.b=f=f<<20^f>>>12^p,l.c=p=p-g|0,l.d=g<<16^p>>>16^y,l.a=y-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var h=0;h<c.length+20;h++)l.b^=c.charCodeAt(h)|0,l.next()}function r(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var c=new i(a),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(typeof h=="object"&&r(h,c),f.state=function(){return r(c,{})}),f}t&&t.exports?t.exports=o:this.tychei=o})(Ule,n)}(k1)),k1.exports}var N1={exports:{}};const Hle={},jle=Object.freeze(Object.defineProperty({__proto__:null,default:Hle},Symbol.toStringTag,{value:"Module"})),Gle=gne(jle);var qle=N1.exports,rz;function Kle(){return rz||(rz=1,function(n){(function(e,t,s){var i=256,r=6,o=52,a="random",l=s.pow(i,r),c=s.pow(2,o),h=c*2,f=i-1,p;function g(I,A,L){var O=[];A=A==!0?{entropy:!0}:A||{};var N=w(v(A.entropy?[I,C(t)]:I??S(),3),O),k=new y(O),$=function(){for(var R=k.g(r),z=l,V=0;R<c;)R=(R+V)*i,z*=i,V=k.g(1);for(;R>=h;)R/=2,z/=2,V>>>=1;return(R+V)/z};return $.int32=function(){return k.g(4)|0},$.quick=function(){return k.g(4)/4294967296},$.double=$,w(C(k.S),t),(A.pass||L||function(R,z,V,ne){return ne&&(ne.S&&x(ne,k),R.state=function(){return x(k,{})}),V?(s[a]=R,z):R})($,N,"global"in A?A.global:this==s,A.state)}function y(I){var A,L=I.length,O=this,N=0,k=O.i=O.j=0,$=O.S=[];for(L||(I=[L++]);N<i;)$[N]=N++;for(N=0;N<i;N++)$[N]=$[k=f&k+I[N%L]+(A=$[N])],$[k]=A;(O.g=function(R){for(var z,V=0,ne=O.i,Q=O.j,G=O.S;R--;)z=G[ne=f&ne+1],V=V*i+G[f&(G[ne]=G[Q=f&Q+z])+(G[Q]=z)];return O.i=ne,O.j=Q,V})(i)}function x(I,A){return A.i=I.i,A.j=I.j,A.S=I.S.slice(),A}function v(I,A){var L=[],O=typeof I,N;if(A&&O=="object")for(N in I)try{L.push(v(I[N],A-1))}catch{}return L.length?L:O=="string"?I:I+"\0"}function w(I,A){for(var L=I+"",O,N=0;N<L.length;)A[f&N]=f&(O^=A[f&N]*19)+L.charCodeAt(N++);return C(A)}function S(){try{var I;return p&&(I=p.randomBytes)?I=I(i):(I=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(I)),C(I)}catch{var A=e.navigator,L=A&&A.plugins;return[+new Date,e,L,e.screen,C(t)]}}function C(I){return String.fromCharCode.apply(0,I)}if(w(s.random(),t),n.exports){n.exports=g;try{p=Gle}catch{}}else s["seed"+a]=g})(typeof self<"u"?self:qle,[],Math)}(N1)),N1.exports}var zN,oz;function Xle(){if(oz)return zN;oz=1;var n=$le(),e=Ple(),t=Mle(),s=Vle(),i=Ble(),r=Wle(),o=Kle();return o.alea=n,o.xor128=e,o.xorwow=t,o.xorshift7=s,o.xor4096=i,o.tychei=r,zN=o,zN}var ZE=Xle();/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yle=.001,u5=.1;function Qle(n,e,t){return t==null&&(t=x$()),pR(n,e,(s,i)=>w$(s,i,t))}function x$(){return K.backend.floatPrecision()===32?Yle:u5}function pR(n,e,t){let s=!0;if((ks(n)||ks(e))&&(s=!1),ks(n)&&ks(e)&&(s=!0),s){const o=n.constructor.name,a=e.constructor.name;if(o!==a)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${a}`)}if(Array.isArray(n)&&Array.isArray(e)){const o=Qa(n),a=Qa(e);if(!_t(o,a))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${a}]`)}const i=ks(n)?n:Ya(n),r=ks(e)?e:Ya(e);if(i.length!==r.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${r.length}.
Actual:   ${i}.
Expected: ${r}.`);for(let o=0;o<r.length;++o){const a=i[o],l=r[o];if(!t(a,l))throw new Error(`Arrays differ: actual[${o}] = ${a}, expected[${o}] = ${l}.
Actual:   ${i}.
Expected: ${r}.`)}typeof expect<"u"&&expect().nothing()}function Zle(n,e){n().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function Jle(n,e){const t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Oa(n)||Oa(n[0])||Oa(e)||Oa(e[0])?pR(n,t,(s,i)=>s==i):pR(n,e,(s,i)=>w$(s,i,0))}function ece(n,e,t){if(t==null&&(t=x$()),!w$(n,e,t))throw new Error(`Numbers differ: actual === ${n}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function w$(n,e,t){return!isFinite(n)&&!isFinite(e)?!0:!(isNaN(n)||isNaN(e)||Math.abs(n-e)>t)}function tce(n,e,t){for(let s=0;s<n.length;s++)if(n[s]<e||n[s]>t)throw new Error(`Value out of range:${n[s]} low: ${e}, high: ${t}`)}function nce(n,e){const t=new Float32Array(n),s=new Float32Array(e);if(t.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${t.length}`);for(let i=0;i<s.length;i++)if(t[i]!==s[i])throw new Error(`Expected ArrayBuffer value at ${i} to be ${s[i]} but got ${t[i]} instead`)}function h5(n){for(let e=0;e<n.length;e++){const t=n[e];Array.isArray(t)?h5(t):n[e]=Fa(t)}return n}function sce(n){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(n),new Promise(t=>{e.addEventListener("loadeddata",s=>t(e)),e.load()})}async function ice(n){await n.play(),"requestVideoFrameCallback"in n&&await new Promise(e=>{n.requestVideoFrameCallback(e)})}const rce=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:u5,createVideoElement:sce,encodeStrings:h5,expectArrayBuffersEqual:nce,expectArraysClose:Qle,expectArraysEqual:Jle,expectNumbersClose:ece,expectPromiseToFail:Zle,expectValuesInRange:tce,play:ice,testEpsilon:x$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _${constructor(e,t,s,i,r){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=r||Math.random();this.random=ZE.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let e,t,s=!1;for(;!s;){let i,r,o;do i=2*this.random()-1,r=2*this.random()-1,o=i*i+r*r;while(o>=1||o===0);const a=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*i*a,t=this.mean+this.stdDev*r*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class oce{constructor(e,t,s,i){this.alpha=e,this.beta=1/t,this.dtype=s;const r=i||Math.random();this.randu=ZE.alea(r.toString()),this.randn=new _$(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,s,i,r,o;for(;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,e=i*i,t=1-.331*e*e,s=.5*e+this.d*(1-o+Math.log(o)),r=this.randu(),r<t||Math.log(r)<s)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class ace{constructor(e=0,t=1,s,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=ZE.alea(i)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(n,e,t=1,s="float32",i){if(_r(n),t==null&&(t=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const r=new oce(e,t,s,i),o=ut(n,s);for(let a=0;a<o.values.length;a++)o.values[a]=r.nextValue();return o.toTensor()}const d5=X({randomGamma_:lce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cce(n,e=0,t=1,s,i){if(_r(n),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const r=new _$(e,t,s,!1,i),o=ut(n,s);for(let a=0;a<o.values.length;a++)o.values[a]=r.nextValue();return o.toTensor()}const JE=X({randomNormal_:cce});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return JE(n,0,1,e,t)}const f5=X({randomStandardNormal_:uce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(n,e=0,t=1,s="float32",i){_r(n);const r=ut(n,s),o=new ace(e,t,null,i);for(let a=0;a<r.values.length;a++)r.values[a]=o.nextValue();return r.toTensor()}const ch=X({randomUniform_:hce});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(n,e,t,s){return ch(n,e,t,"int32",s)}const p5=X({randomUniformInt_:dce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ud(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const i={start:n,stop:e,step:t,dtype:s};return K.runKernel(yE,{},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(n){const t={input:U(n,"input","real")};return K.runKernel(bE,t)}const em=X({real_:fce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(n){const t={x:U(n,"x","reciprocal")};return K.runKernel(rg,t)}const T$=X({reciprocal_:pce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(n){const t={x:U(n,"x","relu")};return K.runKernel(og,t)}const oa=X({relu_:mce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gce(n){const t={x:U(n,"x","relu6")};return K.runKernel(ag,t)}const eC=X({relu6_:gce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(n,e){const s={x:U(n,"x","reverse")},i={dims:e};return K.runKernel(Xv,s,i)}const Wr=X({reverse_:yce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(n){const e=U(n,"x","reverse");return B(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Wr(e,0)}const m5=X({reverse1d_:bce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vce(n,e){const t=U(n,"x","reverse");return B(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),Wr(t,e)}const g5=X({reverse2d_:vce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xce(n,e){const t=U(n,"x","reverse");return B(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),Wr(t,e)}const y5=X({reverse3d_:xce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wce(n,e){const t=U(n,"x","reverse");return B(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),Wr(t,e)}const b5=X({reverse4d_:wce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(n){const t={x:U(n,"x","round")};return K.runKernel(lg,t)}const tC=X({round_:_ce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tce(n){const t={x:U(n,"x","rsqrt","float32")};return K.runKernel(cg,t)}const nC=X({rsqrt_:Tce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sce(n){const t={x:U(n,"x","selu")};return K.runKernel(ug,t)}const sC=X({selu_:Sce});function Ece(n,e,t,s,i,r=[1,1],o="NHWC"){const a=U(n,"x","separableConv2d"),l=U(e,"depthwiseFilter","separableConv2d"),c=U(t,"pointwiseFilter","separableConv2d");let h=a,f=!1;if(a.rank===3&&(f=!0,h=te(a,[1,a.shape[0],a.shape[1],a.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");B(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),B(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),B(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),B(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),B(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const p=l.shape[2],g=l.shape[3];B(c.shape[2]===p*g,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*g}, but got ${c.shape[2]}.`);const y=Sg(h,l,s,i,o,r),v=sc(y,c,1,"valid",o);return f?te(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const iC=X({separableConv2d_:Ece});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Cce(n,e){const t=U(n,"x","setdiff1d"),s=U(e,"y","setdiff1d");B(t.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${s.dtype}).`),B(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),B(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const i=await t.data(),r=await s.data(),o=new Set(r);let a=0;for(let h=0;h<i.length;h++)o.has(i[h])||a++;const l=new as([a],t.dtype),c=new as([a],"int32");for(let h=0,f=0;h<i.length;h++)o.has(i[h])||(l.values[f]=i[h],c.values[f]=h,f++);return[l.toTensor(),c.toTensor()]}const v5=Cce;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(n){const t={x:U(n,"x","sign")};return K.runKernel(fg,t)}const S$=X({sign_:Ice});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kce(n){const t={x:U(n,"x","sin","float32")};return K.runKernel(hg,t)}const rC=X({sin_:kce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nce(n){const t={x:U(n,"x","sinh")};return K.runKernel(dg,t)}const oC=X({sinh_:Nce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ace(n,e,t){const s=U(n,"x","slice1d");return B(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),St(s,[e],[t])}const wx=X({slice1d_:Ace});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(n,e,t){const s=U(n,"x","slice2d");return B(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),St(s,e,t)}const aC=X({slice2d_:Rce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dce(n,e,t){const s=U(n,"x","slice3d");return B(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),St(s,e,t)}const _x=X({slice3d_:Dce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(n,e,t){const s=U(n,"x","slice4d");return B(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),St(s,e,t)}const tm=X({slice4d_:$ce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oce(n,e=-1){const t=U(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},i={dim:e};return K.runKernel(tx,s,i)}const Ng=X({softmax_:Oce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pce(n){B(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return K.runKernel(JS,e)}const Tx=X({fft_:Pce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(n){B(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return K.runKernel(sE,e)}const nm=X({ifft_:Lce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const i=te(n,[t,e]);s=nm(i)}else{const i=[t,2*(e-1)],r=te(em(n),[t,e]),o=te(dx(n),[t,e]),a=Wr(St(r,[0,1],[t,e-2]),1),l=Y(Wr(St(o,[0,1],[t,e-2]),1),Qe(-1)),c=Kn([r,a],1),h=Kn([o,l],1),f=te(nc(c,h),[i[0],i[1]]);s=nm(f)}if(s=em(s),n.rank===3&&n.shape[0]!==0){const i=s,r=n.shape[0];s=te(s,[r,s.shape[0]/r,s.shape[1]]),i.dispose()}return s}const lC=X({irfft_:Mce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fce(n,e,t=0){const i={x:U(n,"x","split")},r={numOrSizeSplits:e,axis:t};return K.runKernel(ex,i,r)}const Zi=X({split_:Fce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(n,e){B(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let i;if(e!=null&&e<t){const y=n.shape.map(v=>0),x=n.shape.map(v=>v);x[n.shape.length-1]=e,i=St(n,y,x),t=e}else if(e!=null&&e>t){const y=n.shape.map(x=>x);y[n.shape.length-1]=e-t,i=Kn([n,qn(y)],n.shape.length-1),t=e}else i=n;const r=kt(i),o=te(nc(i,r),[s,t]),a=Tx(o),l=Math.floor(t/2)+1,c=em(a),h=dx(a),f=Zi(c,[l,t-l],c.shape.length-1),p=Zi(h,[l,t-l],h.shape.length-1),g=i.shape.slice();return g[i.shape.length-1]=l,te(nc(f[0],p[0]),g)}const Sx=X({rfft_:Vce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce(n,e){let t=U(n,"a","squaredDifference"),s=U(e,"b","squaredDifference");[t,s]=$n(t,s),ot(t.shape,s.shape);const i={a:t,b:s},r={};return K.runKernel(yg,i,r)}const cC=X({squaredDifference_:zce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bce(n,e){const t=U(n,"x","squeeze","string_or_numeric");return te(t,pc(t.shape,e).newShape)}const xc=X({squeeze_:Bce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uce(n,e=0){const t=m0(n,"tensors","stack","string_or_numeric");B(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&B(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,i={axis:e};return K.runKernel(Uv,s,i)}const sr=X({stack_:Uce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(n,e=0){const s={x:U(n,"x","step")},i={alpha:e};return K.runKernel(_g,s,i)}const ff=X({step_:Wce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(n,e,t,s,i=0,r=0,o=0,a=0,l=0){const h={x:U(n,"x","stridedSlice","string_or_numeric")},f={begin:e,end:t,strides:s,beginMask:i,endMask:r,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};return K.runKernel(AE,h,f)}const E$=X({stridedSlice_:Hce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jce(n){const t={x:U(n,"x","tan","float32")};return K.runKernel(vg,t)}const C$=X({tan_:jce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fi(n,e){af(n);const t=Qa(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return rh(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mp(n,e,t){if(af(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Qa(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return rh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I$(n,e,t){if(af(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Qa(n,t);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return rh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5(n,e,t){if(af(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Qa(n,t);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return rh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w5(n,e,t){if(af(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Qa(n,t);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return rh(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _5(n,e,t){if(af(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Qa(n,t);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,rh(n,e,s,t)}function k$(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,r=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${i}.`;if(t.rank<i)throw new Error(r+` update.rank < ${i}. `);if(n.length<s+(t.rank-i))throw new Error(r+` Output shape length < ${s+(t.rank-i)}`);if(t.rank!==i+n.length-s)throw new Error(r+` update.rank != ${i+n.length-s}`);for(let o=0;o<i;++o)if(t.shape[o]!==e.shape[o])throw new Error(r+` updates.shape[${o}] (${t.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<t.rank-i;++o)if(t.shape[o+i]!==n[o+s])throw new Error(r+` updates.shape[${o+i}] (${t.shape[o+i]}) != shape[${o+i}] (${n[o+i]})`)}function uC(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}k$(t,e,n)}function uh(n,e,t){const s=e.shape.length,i=s>1?e.shape[s-1]:1,r=t.length;let o=1;for(let f=i;f<r;++f)o*=t[f];const a=i<1?1:i,l=ye(e.shape)/a,c=[...Ye(t.slice(0,i)),1],h=ye(t);return{sliceRank:i,numUpdates:l,sliceSize:o,strides:c,outputSize:h}}const Gce=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:uh,validateInput:uC,validateUpdateShape:k$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qce(n,e,t){const s=U(n,"tensor","tensorScatterupdate"),i=U(e,"indices","tensorScatterupdate","int32"),r=U(t,"updates","tensorScatterupdate");if(uC(r,i,s.shape),s.dtype!==r.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${r.dtype}.`);const o={tensor:s,indices:i,updates:r},a={};return K.runKernel(_E,o,a)}const T5=X({tensorScatterUpdate_:qce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kce(n,e=1,t=!0){const s=U(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${e}`);const r={x:s},o={k:e,sorted:t},[a,l]=K.runKernel(OE,r,o);return{values:a,indices:l}}const N$=X({topk_:Kce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(n,e=0,t=1,s,i){if(_r(n),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const r=new _$(e,t,s,!0,i),o=ut(n,s);for(let a=0;a<o.values.length;a++)o.values[a]=r.nextValue();return o.toTensor()}const hC=X({truncatedNormal_:Xce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(n,e=0){const t=U(n,"x","unique","string_or_numeric");B(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},i={axis:e},[r,o]=K.runKernel(LE,s,i);return{values:r,indices:o}}const A$=X({unique_:Yce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qce(n,e,t){const s=U(n,"x","unsortedSegmentSum"),i=U(e,"segmentIds","unsortedSegmentSum","int32");B(Od(t),()=>"numSegments must be of dtype int");const r={x:s,segmentIds:i},o={numSegments:t};return K.runKernel(ix,r,o)}const dC=X({unsortedSegmentSum_:Qce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zce(n,e=0){const t=U(n,"x","unstack","string_or_numeric");B(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},i={axis:e};return K.runKernel(sx,s,i)}const Hr=X({unstack_:Zce});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S5(n,e){return QE(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R$(n,e=!0,t,s){return K.makeVariable(n,e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fC(n,e){const t=[];for(let r=0;r<e.length;r++)e[r]&&t.push(r);const s=ut(n,"int32"),i=ut([t.length,n.length],"int32");for(let r=0;r<t.length;r++){const o=s.indexToLoc(t[r]),a=r*n.length;i.values.set(o,a)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Jce(n){const e=U(n,"condition","whereAsync","bool"),t=await e.data(),s=fC(e.shape,t);return n!==e&&e.dispose(),s}const D$=Jce;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function eue(n,e,t){const s=U(n,"tensor","boolMask"),i=U(e,"mask","boolMask","bool"),r=t??0,o=i.rank,a=s.shape;B(o>0,()=>"mask cannot be scalar"),Js(a.slice(r,r+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let x=r;x<r+o;x++)l*=a[x];const c=a.slice(0,r).concat([l],a.slice(r+o)),h=te(s,c),f=te(i,[-1]),p=await D$(f),g=xc(p,[1]),y=kg(h,g,r);return n!==s&&s.dispose(),e!==i&&i.dispose(),g.dispose(),h.dispose(),f.dispose(),p.dispose(),y}const E5=eue;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tue(n,e,t){const s=U(n,"x","transpose");if(e==null&&(e=s.shape.map((o,a)=>a).reverse()),B(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{B(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const i={x:s},r={perm:e};return s.dtype==="complex64"?ce(()=>{let o=em(s),a=dx(s);return o=K.runKernel(Ed,{x:o},r),a=K.runKernel(Ed,{x:a},r),t&&(a=gn(a)),nc(o,a)}):K.runKernel(Ed,i,r)}const Et=X({transpose_:tue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(n,e,t,s,i=!0){const r=U(n,"v","movingAverage"),o=U(e,"x","movingAverage"),a=U(t,"decay","movingAverage");x6(r,o),B(_t(r.shape,o.shape),()=>"Shape mismatch in v and x");const l=Qe(1),c=Be(l,a);let h=Y(Be(o,r),c);if(i){B(s!=null,()=>"When using zeroDebias: true, step is required.");const f=U(s,"step","movingAverage");h=qe(h,Be(l,Za(a,f)))}return ke(r,h)}const C5=X({movingAverage_:nue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sue(n,e,t){_r(t);const s=U(n,"indices","scatterND","int32"),i=U(e,"updates","scatterND");uC(i,s,t);const r={indices:s,updates:i},o={shape:t};return K.runKernel(wE,r,o)}const I5=X({scatterND_:sue});function iue(n,e,t,s){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const i=n.rank>0?n.shape[0]:1,r=n.rank>1?n.shape[1]:1;if(t.length!==r)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${r}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===i))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${i}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(n,e,t,s=0){_r(t);const i=U(n,"sparseIndices","sparseToDense","int32"),r=U(e,"sparseValues","sparseToDense","string_or_numeric"),o=U(s,"defaultValue","sparseToDense",r.dtype);iue(i,r,t,o);const a={sparseIndices:i,sparseValues:r,defaultValue:o},l={outputShape:t};return K.runKernel(kE,a,l)}const k5=X({sparseToDense_:rue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oue(n,e){const t=U(e,"indices","gatherND","int32"),i={params:U(n,"x","gatherND","string_or_numeric"),indices:t};return K.runKernel(nE,i)}const N5=X({gatherND_:oue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aue(n,e){if(e==null)return n.shape.slice();if(_t(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(n,e,t,s){const i=U(n,"x","dropout");if(B(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),B(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Kt?i.clone():i;const r=aue(i,t),o=1-e,a=qe(Ig(ke(ch(r,0,1,"float32",s),o)),o);return Y(i,a)}const $$=X({dropout_:lue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O$(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function pC(n,e,t){const s=1-n%2,i=new Float32Array(n);for(let r=0;r<n;++r){const o=2*Math.PI*r/(n+s-1);i[r]=e-t*Math.cos(o)}return fi(i,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function cue(n,e,t=1){const s=U(n,"predictions","inTopK"),i=U(e,"targets","inTopK");B(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),B(s.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${i.rank}`),Js(s.shape.slice(0,s.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const r=s.shape[s.shape.length-1];B(t>0&&t<=r,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${r}), but got ${t}`);const o=await s.data(),a=await i.data(),[l,c]=[o.length/r,r],h=$s("bool",l);for(let f=0;f<l;f++){const p=f*c,g=o.subarray(p,p+c),y=[];for(let x=0;x<g.length;x++)y.push({value:g[x],index:x});y.sort((x,v)=>v.value-x.value),h[f]=0;for(let x=0;x<t;x++)if(y[x].index===a[f]){h[f]=1;break}}return n!==s&&s.dispose(),e!==i&&i.dispose(),_o(h,i.shape,"bool")}const A5=cue;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uue(n,e,t,s,i,r="NHWC",o){let a=n;n.rank===3&&(a=te(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]])),B(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),B(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),B(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const c=r==="NHWC"?a.shape[3]:a.shape[1],h=r==="NHWC"?l.shape[3]:l.shape[1];B(c===t[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${t[2]}.`),B(h===t[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${t[3]}).`),Vi("conv2dDerFilter",i,o);const f={x:a,dy:l},p={strides:s,pad:i,dataFormat:r,dimRoundingMode:o,filterShape:t};return K.runKernel(zS,f,p)}const P$=X({conv2DBackpropFilter_:uue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mC(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return Y(n,ff(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function gC(n,e){let t=e;const s=ls(n.shape,e.shape);return s.length>0&&(t=We(t,s)),te(t,n.shape)}function yC(n,e,t,s){if(e==="linear")return n;if(e==="relu")return oa(n);if(e==="elu")return Eg(n);if(e==="relu6")return eC(n);if(e==="prelu")return xx(n,t);if(e==="leakyrelu")return fx(n,s);if(e==="sigmoid")return Yo(n);throw new Error(`Unknown fused activation ${e}.`)}const bC=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hue({x:n,filter:e,strides:t,pad:s,dataFormat:i="NHWC",dilations:r=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:h}){if(l=l||"linear",bC(K.state.gradientDepth,l)===!1){B(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let L=sc(n,e,t,s,i,r,o);return a!=null&&(L=ke(L,a)),yC(L,l,c,h)}const f=U(n,"x","conv2d","float32"),p=U(e,"filter","conv2d","float32");let g=f,y=!1;f.rank===3&&(y=!0,g=te(f,[1,f.shape[0],f.shape[1],f.shape[2]])),B(g.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${g.rank}.`),B(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Vi("fused conv2d",s,o);const x=i==="NHWC"?g.shape[3]:g.shape[1];B(p.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${p.shape[2]}.`),B(ei(t,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${r}'`);const v=Ps(g.shape,p.shape,t,r,s,o);let w;a!=null&&(w=U(a,"bias","fused conv2d"),[w]=$n(w,f),i==="NHWC"?ot(v.outShape,w.shape):(B(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),B(w.shape.length===0||w.shape[0]===v.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let S;if(c!=null){const L=c.shape;if(B(L.length<=1||L.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${L.length}.`),L.length===1)B(L[0]===1||L[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${L}) is not compatible with the number of output channels (${v.outChannels}).`);else if(L.length===3)try{ot(L,v.outShape)}catch{const N=`Error in fused conv2d: PReLU activation weights (${L}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(N)}S=U(c,"prelu weights","fused conv2d")}const C=(L,O)=>{B(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[N,k,$,R]=O,z=mC(L,$,l);B(Vu(r),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const V=JD(k.shape,z,N,t,s),ne=P$(k,z,N.shape,t,s),Q=[V,ne];if(R!=null){const G=gC(R,z);Q.push(G)}return Q},I={x:g,filter:p,bias:w,preluActivationWeights:S},A={strides:t,pad:s,dataFormat:i,dilations:r,dimRoundingMode:o,activation:l,leakyreluAlpha:h};return a==null?Ja((O,N,k)=>{let $=K.runKernel(u0,I,A);return k([N,O,$]),y&&($=te($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:C}})(g,p):Ja((O,N,k,$)=>{let R=K.runKernel(u0,I,A);return $([N,O,R,k]),y&&(R=te(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:C}})(g,p,w)}const R5=X({fusedConv2d_:hue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function due(n,e,t,s,i,r=[1,1],o){let a=n;n.rank===3&&(a=te(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},h={strides:s,pad:i,dimRoundingMode:o,dilations:r,filterShape:t};return K.runKernel(qS,c,h)}const D5=X({depthwiseConv2dNativeBackpropFilter_:due});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(n,e,t,s,i,r=[1,1],o){let a=e,l=!1;e.rank===3&&(l=!0,a=te(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:t},h={strides:s,pad:i,dimRoundingMode:o,dilations:r,inputShape:n},f=K.runKernel(KS,c,h);return l?te(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const $5=X({depthwiseConv2dNativeBackpropInput_:fue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue({x:n,filter:e,strides:t,pad:s,dataFormat:i="NHWC",dilations:r=[1,1],dimRoundingMode:o,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:h}){if(bC(K.state.gradientDepth,l)===!1){let A=Sg(n,e,t,s,i,r,o);return a!=null&&(A=ke(A,a)),yC(A,l,c,h)}const f=U(n,"x","depthwiseConv2d","float32"),p=U(e,"filter","depthwiseConv2d","float32");let g=f,y=!1;f.rank===3&&(y=!0,g=te(f,[1,f.shape[0],f.shape[1],f.shape[2]])),B(g.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${g.rank}.`),B(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),B(g.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${g.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),r==null&&(r=[1,1]),B(ei(t,r),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${r}'`),Vi("fused depthwiseConv2d",s,o);const x=Ps(g.shape,p.shape,t,r,s,o,!0);let v;a!=null&&(v=U(a,"bias","fused conv2d"),[v]=$n(v,f),ot(x.outShape,v.shape));let w;c!=null&&(w=U(c,"prelu weights","fused depthwiseConv2d"));const S=(A,L)=>{B(Vu(r),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${r}'`);const[O,N,k,$]=L,R=mC(A,k,l),z=$5(N.shape,R,O,t,s,r,o),V=D5(N,R,O.shape,t,s,r,o);if($!=null){const ne=gC(v,R);return[z,V,ne]}return[z,V]},C={x:g,filter:p,bias:v,preluActivationWeights:w},I={strides:t,pad:s,dataFormat:i,dilations:r,dimRoundingMode:o,activation:l,leakyreluAlpha:h};return a==null?Ja((L,O,N)=>{let k=K.runKernel(h0,C,I);return N([O,L,k]),y&&(k=te(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:S}})(g,p):Ja((L,O,N,k)=>{let $=K.runKernel(h0,C,I);return k([O,L,$,N]),y&&($=te($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:S}})(g,p,v)}const mue=X({fusedDepthwiseConv2d_:pue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gue({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:i,activation:r="linear",preluActivationWeights:o,leakyreluAlpha:a=.2}){if(bC(K.state.gradientDepth,r)===!1){let R=pt(n,e,t,s);return i!=null&&(R=ke(R,i)),yC(R,r,o,a)}let l=U(n,"a","fused matMul"),c=U(e,"b","fused matMul");[l,c]=$n(l,c);const h=t?l.shape[l.rank-2]:l.shape[l.rank-1],f=s?c.shape[c.rank-1]:c.shape[c.rank-2],p=t?l.shape[l.rank-1]:l.shape[l.rank-2],g=s?c.shape[c.rank-2]:c.shape[c.rank-1],y=l.shape.slice(0,-2),x=c.shape.slice(0,-2),v=ye(y),w=ye(x);B(h===f,()=>`Error in fused matMul: inner shapes (${h}) and (${f}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${t} and transposeB=${s} must match.`);const C=ot(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,g]),I=t?te(l,[v,h,p]):te(l,[v,p,h]),A=s?te(c,[w,g,f]):te(c,[w,f,g]);let L;i!=null&&(L=U(i,"bias","fused matMul"),[L]=$n(L,l),ot(C,L.shape));let O;o!=null&&(O=U(o,"prelu weights","fused matMul"));const N=(R,z)=>{const[V,ne,Q,G]=z,J=mC(te(R,Q.shape),Q,r);let Z,le;if(!t&&!s?(Z=pt(J,ne,!1,!0),le=pt(V,J,!0,!1)):!t&&s?(Z=pt(J,ne,!1,!1),le=pt(J,V,!0,!1)):t&&!s?(Z=pt(ne,J,!1,!0),le=pt(V,J,!1,!1)):(Z=pt(ne,J,!0,!0),le=pt(J,V,!0,!0)),i!=null){const H=gC(G,J);return[Z,le,H]}else return[Z,le]},k={a:I,b:A,bias:L,preluActivationWeights:O},$={transposeA:t,transposeB:s,activation:r,leakyreluAlpha:a};return i==null?Ja((z,V,ne)=>{const Q=K.runKernel(c0,k,$);return ne([z,V,Q]),{value:te(Q,C),gradFunc:N}})(I,A):Ja((z,V,ne,Q)=>{const G=K.runKernel(c0,k,$);return Q([z,V,G,ne]),{value:te(G,C),gradFunc:N}})(I,A,L)}const mR=X({fusedMatMul_:gue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O5=Object.freeze(Object.defineProperty({__proto__:null,conv2d:R5,depthwiseConv2d:mue,matMul:mR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(n){return pC(n,.54,.46)}const bue=X({hammingWindow_:yue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(n){return pC(n,.5,.5)}const P5=X({hannWindow_:vue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xue(n,e,t,s=!1,i=0){let r=0;const o=[];for(;r+e<=n.size;)o.push(St(n,r,e)),r+=t;if(s)for(;r<n.size;){const a=r+e-n.size,l=Kn([St(n,r,e-a),hf([a],i)]);o.push(l),r+=t}return o.length===0?Mp([],[0,e]):te(Kn(o),[o.length,e])}const L5=X({frame_:xue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(n,e,t,s,i=P5){s==null&&(s=O$(e));const r=L5(n,e,t),o=Y(r,i(e));return Sx(o,s)}const _ue=X({stft_:wue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tue(n,e,t,s,i="bilinear",r=0){const o=U(n,"image","cropAndResize"),a=U(e,"boxes","cropAndResize","float32"),l=U(t,"boxInd","cropAndResize","int32"),c=a.shape[0];B(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),B(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),B(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),B(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),B(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),B(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const h={image:o,boxes:a,boxInd:l},f={method:i,extrapolationValue:r,cropSize:s};return K.runKernel(HS,h,f)}const Sue=X({cropAndResize_:Tue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eue(n){const e=U(n,"image","flipLeftRight","float32");B(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return K.runKernel(tE,t,{})}const Cue=X({flipLeftRight_:Eue});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(n){const e=U(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];B(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),B(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const i=new Array(e.rank);return i.fill(1,0,t),i[t]=3,Or(e,i)}const kue=X({grayscaleToRGB_:Iue});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(n){const e=U(n,"image","RGBToGrayscale"),t=e.rank-1,s=e.shape[t];B(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),B(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const i=e.dtype,r=De(e,"float32"),o=fi([.2989,.587,.114]);let a;switch(e.rank){case 2:a=hd("ij,j->i",r,o);break;case 3:a=hd("ijk,k->ij",r,o);break;case 4:a=hd("ijkl,l->ijk",r,o);break;case 5:a=hd("ijklm,m->ijkl",r,o);break;case 6:a=hd("ijklmn,n->ijklm",r,o);break;default:throw new Error("Not a valid tensor rank.")}return a=ui(a,-1),De(a,i)}const Aue=X({rgbToGrayscale_:Nue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(n,e,t=0,s=.5){const i=U(n,"image","rotateWithOffset","float32");B(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const r={image:i},o={radians:e,fillValue:t,center:s};return K.runKernel(ME,r,o)}const Due=X({rotateWithOffset_:Rue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ag(n,e,t,s,i,r){s==null&&(s=.5),i==null&&(i=Number.NEGATIVE_INFINITY),r==null&&(r=0);const o=n.shape[0];return t=Math.min(t,o),B(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),B(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),B(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),B(e.rank===1,()=>"scores must be a 1D tensor"),B(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),B(0<=r&&r<=1,()=>`softNmsSigma must be in [0, 1], but was '${r}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:i,softNmsSigma:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(n,e,t,s=.5,i=Number.NEGATIVE_INFINITY){const r=U(n,"boxes","nonMaxSuppression","float32"),o=U(e,"scores","nonMaxSuppression","float32"),a=Ag(r,o,t,s,i);t=a.maxOutputSize,s=a.iouThreshold,i=a.scoreThreshold;const l={maxOutputSize:t,iouThreshold:s,scoreThreshold:i};return K.runKernel(hE,{boxes:r,scores:o},l)}const Oue=X({nonMaxSuppression_:$ue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(n,e,t){const s=Lue(n,e,t),i=s<0?-(s+1):s;n.splice(i,0,e)}function Lue(n,e,t){return Fue(n,e,t||Mue)}function Mue(n,e){return n>e?1:n<e?-1:0}function Fue(n,e,t){let s=0,i=n.length,r=0,o=!1;for(;s<i;){r=s+(i-s>>>1);const a=t(e,n[r]);a>0?s=r+1:(i=r,o=!a)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vC(n,e,t,s,i){return L$(n,e,t,s,i,0)}function xC(n,e,t,s,i,r){return L$(n,e,t,s,i,0,!1,r,!0)}function wC(n,e,t,s,i,r){return L$(n,e,t,s,i,r,!0)}function L$(n,e,t,s,i,r,o=!1,a=!1,l=!1){const c=[];for(let v=0;v<e.length;v++)e[v]>i&&c.push({score:e[v],boxIndex:v,suppressBeginIndex:0});c.sort(az);const h=r>0?-.5/r:0,f=[],p=[];for(;f.length<t&&c.length>0;){const v=c.pop(),{score:w,boxIndex:S,suppressBeginIndex:C}=v;if(w<i)break;let I=!1;for(let A=f.length-1;A>=C;--A){const L=Vue(n,S,f[A]);if(L>=s){I=!0;break}if(v.score=v.score*zue(s,h,L),v.score<=i)break}v.suppressBeginIndex=f.length,I||(v.score===w?(f.push(S),p.push(v.score)):v.score>i&&Pue(c,v,az))}const g=f.length,y=t-g;a&&y>0&&(f.push(...new Array(y).fill(0)),p.push(...new Array(y).fill(0)));const x={selectedIndices:f};return o&&(x.selectedScores=p),l&&(x.validOutputs=g),x}function Vue(n,e,t){const s=n.subarray(e*4,e*4+4),i=n.subarray(t*4,t*4+4),r=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(i[0],i[2]),h=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),g=(a-r)*(l-o),y=(f-c)*(p-h);if(g<=0||y<=0)return 0;const x=Math.max(r,c),v=Math.max(o,h),w=Math.min(a,f),S=Math.min(l,p),C=Math.max(w-x,0)*Math.max(S-v,0);return C/(g+y-C)}function zue(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function az(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Bue(n,e,t,s=.5,i=Number.NEGATIVE_INFINITY){const r=U(n,"boxes","nonMaxSuppressionAsync"),o=U(e,"scores","nonMaxSuppressionAsync"),a=Ag(r,o,t,s,i);t=a.maxOutputSize,s=a.iouThreshold,i=a.scoreThreshold;const l=await Promise.all([r.data(),o.data()]),c=l[0],h=l[1],{selectedIndices:f}=vC(c,h,t,s,i);return r!==n&&r.dispose(),o!==e&&o.dispose(),fi(f,"int32")}const Uue=Bue;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(n,e,t,s=.5,i=Number.NEGATIVE_INFINITY,r=0){const o=U(n,"boxes","nonMaxSuppression"),a=U(e,"scores","nonMaxSuppression"),l=Ag(o,a,t,s,i,r);t=l.maxOutputSize,s=l.iouThreshold,i=l.scoreThreshold,r=l.softNmsSigma;const c={boxes:o,scores:a},h={maxOutputSize:t,iouThreshold:s,scoreThreshold:i,softNmsSigma:r},f=K.runKernel(fE,c,h);return{selectedIndices:f[0],selectedScores:f[1]}}const Hue=X({nonMaxSuppressionWithScore_:Wue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function jue(n,e,t,s=.5,i=Number.NEGATIVE_INFINITY,r=0){const o=U(n,"boxes","nonMaxSuppressionAsync"),a=U(e,"scores","nonMaxSuppressionAsync"),l=Ag(o,a,t,s,i,r);t=l.maxOutputSize,s=l.iouThreshold,i=l.scoreThreshold,r=l.softNmsSigma;const c=await Promise.all([o.data(),a.data()]),h=c[0],f=c[1],{selectedIndices:p,selectedScores:g}=wC(h,f,t,s,i,r);return o!==n&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:fi(p,"int32"),selectedScores:fi(g)}}const Gue=jue;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function que(n,e,t,s=.5,i=Number.NEGATIVE_INFINITY,r=!1){const o=U(n,"boxes","nonMaxSuppression"),a=U(e,"scores","nonMaxSuppression"),l=Ag(o,a,t,s,i,null),c=l.maxOutputSize,h=l.iouThreshold,f=l.scoreThreshold,p={boxes:o,scores:a},g={maxOutputSize:c,iouThreshold:h,scoreThreshold:f,padToMaxOutputSize:r},y=K.runKernel(dE,p,g);return{selectedIndices:y[0],validOutputs:y[1]}}const Kue=X({nonMaxSuppressionPadded_:que});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Xue(n,e,t,s=.5,i=Number.NEGATIVE_INFINITY,r=!1){const o=U(n,"boxes","nonMaxSuppressionAsync"),a=U(e,"scores","nonMaxSuppressionAsync"),l=Ag(o,a,t,s,i,null),c=l.maxOutputSize,h=l.iouThreshold,f=l.scoreThreshold,[p,g]=await Promise.all([o.data(),a.data()]),{selectedIndices:y,validOutputs:x}=xC(p,g,c,h,f,r);return o!==n&&o.dispose(),a!==e&&a.dispose(),{selectedIndices:fi(y,"int32"),validOutputs:Qe(x,"int32")}}const Yue=Xue;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Que(n,e,t=!1,s=!1){const i=U(n,"images","resizeBilinear");B(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),B(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),B(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let r=i,o=!1;i.rank===3&&(o=!0,r=te(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:r},l={alignCorners:t,halfPixelCenters:s,size:e},c=K.runKernel(Kv,a,l);return o?te(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const M5=X({resizeBilinear_:Que});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zue(n,e,t=!1,s=!1){const i=U(n,"images","resizeNearestNeighbor");B(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),B(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),B(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),B(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let r=i,o=!1;i.rank===3&&(o=!0,r=te(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:r},l={alignCorners:t,halfPixelCenters:s,size:e},c=K.runKernel(qv,a,l);return o?te(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const F5=X({resizeNearestNeighbor_:Zue});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jue(n,e="binary",t=!1,s=.5){const i=U(n,"image","threshold"),r=.2989,o=.587,a=.114,l=i.shape[0]*i.shape[1];let c=Y(fi([s]),255),h,f,p,g;if(B(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),B(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),B(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),B(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),i.shape[2]===3){[h,f,p]=Zi(i,[1,1,1],-1);const v=Y(h,r),w=Y(f,o),S=Y(p,a);g=ke(ke(v,w),S)}else g=n;if(e==="otsu"){const v=qD(De(tC(g),"int32"),_o([]),256);c=ehe(v,l)}const y=t?lh(g,c):rr(g,c);return De(Y(y,255),"int32")}function ehe(n,e){let t=fi([-1]),s=fi([0]),i=fi([0]),r,o,a,l,c,h;for(let f=0;f<n.size-1;f++){r=St(n,0,f+1),o=St(n,f+1),c=qe(We(r),e),h=qe(We(o),e);const p=We(Y(r,Ud(0,r.size)));a=qe(p,We(r));const g=hf(o.shape,r.size),y=ke(Ud(0,o.size),g),x=Y(o,y);l=qe(We(x),We(o));const v=Be(a,l),w=Be(a,l),S=Y(c,h);i=Y(Y(S,v),w);const C=rr(i,s);s=Qs(C,i,s),t=Qs(C,fi([f]),t)}return t}const the=X({threshold_:Jue});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(n,e,t="nearest",s="constant",i=0,r){const o=U(n,"image","transform","float32"),a=U(e,"transforms","transform","float32");B(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),B(a.rank===2&&(a.shape[0]===o.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),B(r==null||r.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${r}.`);const l={image:o,transforms:a},c={interpolation:t,fillMode:s,fillValue:i,outputShape:r};return K.runKernel(PE,l,c)}const she=X({transform_:nhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ihe(n,e,t){const s=U(n,"a","bandPart");B(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const i=s.shape,[r,o]=s.shape.slice(-2);let a,l;typeof e=="number"?(B(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),B(e<=r,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${r}).`),a=U(e<0?r:e,"numLower","bandPart")):(B(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Qs(Zp(e,0),r,Bu(e,r))),typeof t=="number"?(B(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),B(t<=o,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${o}).`),l=U(t<0?o:t,"numUpper","bandPart")):(B(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Qs(Zp(t,0),o,Bu(t,o)));const c=te(Ud(0,r,1,"int32"),[-1,1]),h=Ud(0,o,1,"int32"),f=Be(c,h),p=ea(lh(f,a),bc(f,gn(l))),g=qn([r,o],s.dtype);return te(sr(Hr(te(s,[-1,r,o])).map(y=>Qs(p,y,g))),i)}const rhe=X({bandPart_:ihe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ohe(n){let e;if(Array.isArray(n)){e=!1,B(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=n[0].shape[0];for(let r=1;r<n.length;++r)B(n[r].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[r].shape[0]} vs. ${i})`)}else e=!0,n=Zi(n,n.shape[0],0).map(i=>xc(i,[0]));B(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let i=0;i<n.length;++i)t.push(K.tidy(()=>{let r=s[i];if(i>0)for(let o=0;o<i;++o){const a=Y(We(Y(t[o],r)),t[o]);r=Be(r,a)}return qe(r,Cg(r,"euclidean"))}));return e?sr(t,0):t}const ahe=X({gramSchmidt_:ohe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lhe(n,e=!1){if(B(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return lz(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,c)=>l*c),s=Hr(te(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],r=[];s.forEach(l=>{const[c,h]=lz(l,e);i.push(c),r.push(h)});const o=te(sr(i,0),n.shape),a=te(sr(r,0),n.shape);return[o,a]}}function lz(n,e=!1){return K.tidy(()=>{B(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let i=qE(t),r=Va(n);const o=Mp([[1]],[1,1]);let a=Va(o);const l=t>=s?s:t;for(let c=0;c<l;++c){const h=r,f=a,p=i;[a,r,i]=K.tidy(()=>{const g=St(r,[c,c],[t-c,1]),y=Cg(g),x=St(r,[c,c],[1,1]),v=Qs(rr(x,0),Mp([[-1]]),Mp([[1]])),w=Be(x,Y(v,y)),S=qe(g,w);S.shape[0]===1?a=Va(o):a=Kn([o,St(S,[1,0],[S.shape[0]-1,S.shape[1]])],0);const C=gn(qe(pt(v,w),y)),I=St(r,[c,0],[t-c,s]),A=Y(C,a),L=Et(a);if(c===0)r=Be(I,pt(A,pt(L,I)));else{const k=Be(I,pt(A,pt(L,I)));r=Kn([St(r,[0,0],[c,s]),k],0)}const O=Et(A),N=St(i,[0,c],[t,i.shape[1]-c]);if(c===0)i=Be(N,pt(pt(N,a),O));else{const k=Be(N,pt(pt(N,a),O));i=Kn([St(i,[0,0],[t,c]),k],1)}return[a,r,i]}),mt([h,f,p])}return!e&&t>s&&(i=St(i,[0,0],[t,s]),r=St(r,[0,0],[s,s])),[i,r]})}const che=X({qr_:lhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ai;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ai||(Ai={}));function uhe(n,e,t=Ai.SUM_BY_NONZERO_WEIGHTS){const s=U(n,"losses","computeWeightedLoss");let i=null;e!=null&&(i=U(e,"weights","computeWeightedLoss"));const r=i==null?s:Y(s,i);if(t===Ai.NONE)return r;if(t===Ai.SUM)return We(r);if(t===Ai.MEAN){if(i==null)return Rn(r);{const o=s.size/i.size,a=qe(We(r),We(i));return o>1?qe(a,Qe(o)):a}}if(t===Ai.SUM_BY_NONZERO_WEIGHTS){if(i==null)return qe(We(r),Qe(s.size));{const o=Y(i,Yi(s.shape)),a=De(We(Bd(o,Qe(0))),"float32");return qe(We(r),a)}}throw Error(`Unknown reduction: ${t}`)}const wc=X({computeWeightedLoss_:uhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hhe(n,e,t,s=Ai.SUM_BY_NONZERO_WEIGHTS){const i=U(n,"labels","absoluteDifference"),r=U(e,"predictions","absoluteDifference");let o=null;t!=null&&(o=U(t,"weights","absoluteDifference")),Js(i.shape,r.shape,"Error in absoluteDifference: ");const a=is(Be(i,r));return wc(a,o,s)}const dhe=X({absoluteDifference_:hhe});function fhe(n,e,t,s,i=Ai.SUM_BY_NONZERO_WEIGHTS){const r=U(n,"labels","cosineDistance"),o=U(e,"predictions","cosineDistance");let a=null;s!=null&&(a=U(s,"weights","cosineDistance")),Js(r.shape,o.shape,"Error in cosineDistance: ");const l=Qe(1),c=Be(l,We(Y(r,o),t,!0));return wc(c,a,i)}const phe=X({cosineDistance_:fhe});function mhe(n,e,t,s=Ai.SUM_BY_NONZERO_WEIGHTS){let i=U(n,"labels","hingeLoss");const r=U(e,"predictions","hingeLoss");let o=null;t!=null&&(o=U(t,"weights","hingeLoss")),Js(i.shape,r.shape,"Error in hingeLoss: ");const a=Qe(1);i=Be(Y(Qe(2),i),a);const l=oa(Be(a,Y(i,r)));return wc(l,o,s)}const ghe=X({hingeLoss_:mhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yhe(n,e,t,s=1,i=Ai.SUM_BY_NONZERO_WEIGHTS){const r=U(n,"labels","huberLoss"),o=U(e,"predictions","huberLoss");let a=null;t!=null&&(a=U(t,"weights","huberLoss")),Js(r.shape,o.shape,"Error in huberLoss: ");const l=Qe(s),c=is(Be(o,r)),h=Bu(c,l),f=Be(c,h),p=ke(Y(Qe(.5),rn(h)),Y(l,f));return wc(p,a,i)}const bhe=X({huberLoss_:yhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vhe(n,e,t,s=1e-7,i=Ai.SUM_BY_NONZERO_WEIGHTS){const r=U(n,"labels","logLoss"),o=U(e,"predictions","logLoss");let a=null;t!=null&&(a=U(t,"weights","logLoss")),Js(r.shape,o.shape,"Error in logLoss: ");const l=Qe(1),c=Qe(s),h=gn(Y(r,br(ke(o,c)))),f=Y(Be(l,r),br(ke(Be(l,o),c))),p=Be(h,f);return wc(p,a,i)}const xhe=X({logLoss_:vhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function whe(n,e,t,s=Ai.SUM_BY_NONZERO_WEIGHTS){const i=U(n,"labels","meanSquaredError"),r=U(e,"predictions","meanSquaredError");let o=null;t!=null&&(o=U(t,"weights","meanSquaredError")),Js(i.shape,r.shape,"Error in meanSquaredError: ");const a=cC(i,r);return wc(a,o,s)}const _he=X({meanSquaredError_:whe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function The(n,e){const t=U(n,"labels","sigmoidCrossEntropyWithLogits"),s=U(e,"logits","sigmoidCrossEntropyWithLogits");Js(t.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=oa(s),r=Y(s,t),o=px(nr(gn(is(s))));return ke(Be(i,r),o)}function She(n,e,t,s=0,i=Ai.SUM_BY_NONZERO_WEIGHTS){let r=U(n,"multiClassLabels","sigmoidCrossEntropy");const o=U(e,"logits","sigmoidCrossEntropy");let a=null;if(t!=null&&(a=U(t,"weights","sigmoidCrossEntropy")),Js(r.shape,o.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=Qe(s),h=Qe(1),f=Qe(.5);r=ke(Y(r,Be(h,c)),Y(f,c))}const l=The(r,o);return wc(l,a,i)}const Ehe=X({sigmoidCrossEntropy_:She});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Che(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Ja((i,r,o)=>{const l=mx(r,[t],!0),c=Be(De(r,"float32"),l);o([i,c]);const h=gn(Y(c,i));return{value:We(h,[t]),gradFunc:(g,y)=>{const[x,v]=y,w=Xn(g.shape,[t]);return[Y(te(g,w),Be(De(x,"float32"),nr(v))),Y(te(g,w),Be(nr(v),De(x,"float32")))]}}})(n,e)}function Ihe(n,e,t,s=0,i=Ai.SUM_BY_NONZERO_WEIGHTS){let r=U(n,"onehotLabels","softmaxCrossEntropy");const o=U(e,"logits","softmaxCrossEntropy");let a=null;if(t!=null&&(a=U(t,"weights","softmaxCrossEntropy")),Js(r.shape,o.shape,"Error in softmaxCrossEntropy: "),s>0){const c=Qe(s),h=Qe(1),f=Qe(r.shape[1]);r=ke(Y(r,Be(h,c)),qe(c,f))}const l=Che(r,o);return wc(l,a,i)}const khe=X({softmaxCrossEntropy_:Ihe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nhe(n,e,t,s){const i=U(n,"indices","sparseFillEmptyRows","int32"),r=U(e,"values","sparseFillEmptyRows"),o=U(t,"denseShape","sparseFillEmptyRows","int32"),a=U(s,"defaultValue","sparseFillEmptyRows",r.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(r.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${r.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:i,values:r,denseShape:o,defaultValue:a},c=K.runKernel(SE,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const Ahe=X({sparseFillEmptyRows_:Nhe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rhe(n,e,t){const s=U(n,"inputIndices","sparseReshape","int32"),i=U(e,"inputShape","sparseReshape","int32"),r=U(t,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(r.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${r.shape}`);const o={inputIndices:s,inputShape:i,newShape:r},a=K.runKernel(EE,o);return{outputIndices:a[0],outputShape:a[1]}}const Dhe=X({sparseReshape_:Rhe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $he(n,e,t){const s=U(n,"data","sparseSegmentMean"),i=U(e,"indices","sparseSegmentMean","int32"),r=U(t,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(r.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${r.shape}`);const o={data:s,indices:i,segmentIds:r};return K.runKernel(CE,o)}const Ohe=X({sparseSegmentMean_:$he});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Phe(n,e,t){const s=U(n,"data","sparseSegmentSum"),i=U(e,"indices","sparseSegmentSum","int32"),r=U(t,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(r.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${r.shape}`);const o={data:s,indices:i,segmentIds:r};return K.runKernel(IE,o)}const Lhe=X({sparseSegmentSum_:Phe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mhe(n,e,t,s,i,r,o,a){const l=U(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=U(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const h={separator:t,nGramWidths:s,leftPad:i,rightPad:r,padWidth:o,preserveShortSequences:a},f={data:l,dataSplits:c},p=K.runKernel(RE,f,h);return{nGrams:p[0],nGramsSplits:p[1]}}const Fhe=X({stringNGrams_:Mhe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(n,e,t=!0){const s=U(n,"input","stringSplit","string"),i=U(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const r={skipEmpty:t},o={input:s,delimiter:i},a=K.runKernel(DE,o,r);return{indices:a[0],values:a[1],shape:a[2]}}const zhe=X({stringSplit_:Vhe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bhe(n,e){const t=U(n,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const i={input:t};return K.runKernel($E,i,s)}const Uhe=X({stringToHashBucketFast_:Bhe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Whe(n,e,t,s=!0){const i=U(n,"input","staticRegexReplace","string"),r={pattern:e,rewrite:t,replaceGlobal:s};return K.runKernel(nx,{x:i},r)}const Hhe=X({staticRegexReplace_:Whe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V5={fft:Tx,ifft:nm,rfft:Sx,irfft:lC},z5={hammingWindow:bue,hannWindow:P5,frame:L5,stft:_ue},yo={flipLeftRight:Cue,grayscaleToRGB:kue,resizeNearestNeighbor:F5,resizeBilinear:M5,rgbToGrayscale:Aue,rotateWithOffset:Due,cropAndResize:Sue,nonMaxSuppression:Oue,nonMaxSuppressionAsync:Uue,nonMaxSuppressionWithScore:Hue,nonMaxSuppressionWithScoreAsync:Gue,nonMaxSuppressionPadded:Kue,nonMaxSuppressionPaddedAsync:Yue,threshold:the,transform:she},M$={bandPart:rhe,gramSchmidt:ahe,qr:che},B5={absoluteDifference:dhe,computeWeightedLoss:wc,cosineDistance:phe,hingeLoss:ghe,huberLoss:bhe,logLoss:xhe,meanSquaredError:_he,sigmoidCrossEntropy:Ehe,softmaxCrossEntropy:khe},U5={sparseFillEmptyRows:Ahe,sparseReshape:Dhe,sparseSegmentMean:Ohe,sparseSegmentSum:Lhe},W5={stringNGrams:Fhe,stringSplit:zhe,stringToHashBucketFast:Uhe,staticRegexReplace:Hhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jhe=new Map,gR=new Map;class pf{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class $r{constructor(){this.classNameMap={}}static getMap(){return $r.instance==null&&($r.instance=new $r),$r.instance}static register(e){$r.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ne(n,e,t){B(n.className!=null,()=>"Class being registered does not have the static className property defined."),B(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),B(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const s=t,i=e+">"+s;return $r.register(n),jhe.set(i,n),gR.set(n,i),n}function Ghe(n){return gR.has(n)?gR.get(n):n.className}const qhe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:pf,SerializationMap:$r,getRegisteredName:Ghe,registerClass:Ne},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _c extends pf{minimize(e,t=!1,s){const{value:i,grads:r}=this.computeGradients(e,s);if(s!=null){const o=s.map(a=>({name:a.name,tensor:r[a.name]}));this.applyGradients(o)}else this.applyGradients(r);return mt(r),t?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return X6(e,t)}dispose(){this.iterations_!=null&&mt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Qe(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(_c,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F$ extends _c{static get className(){return"Adadelta"}constructor(e,t,s=null){super(),this.learningRate=e,this.rho=t,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=K.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,i)=>{const r=K.registeredVariables[s],o=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${s}/accum_grad`,variable:ce(()=>kt(r).variable(o))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${s}/accum_var`,variable:ce(()=>kt(r).variable(o))});const a=Array.isArray(e)?e[i].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[i].variable,c=this.accumulatedUpdates[i].variable;ce(()=>{const h=ke(Y(l,this.rho),Y(rn(a),1-this.rho)),f=Y(qe(Os(ke(c,this.epsilon)),Os(ke(l,this.epsilon))),a),p=ke(Y(c,this.rho),Y(rn(f),1-this.rho));l.assign(h),c.assign(p);const g=ke(Y(f,-this.learningRate),r);r.assign(g)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(mt(this.accumulatedGrads.map(e=>e.variable)),mt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,t).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.accumulatedUpdates=e.slice(t,t*2).map(i=>({originalName:i.name,variable:i.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V$ extends _c{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,i)=>{const r=K.registeredVariables[s];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${s}/accumulator`,variable:ce(()=>hf(r.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[i].tensor:e[s];if(o==null)return;const a=this.accumulatedGrads[i].variable;ce(()=>{const l=ke(a,rn(o));a.assign(l);const c=ke(Y(qe(o,Os(ke(l,K.backend.epsilon()))),-this.learningRate),r);r.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&mt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z$ extends _c{static get className(){return"Adam"}constructor(e,t,s,i=null){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ce(()=>{this.accBeta1=Qe(t).variable(),this.accBeta2=Qe(s).variable()}),i==null&&(this.epsilon=K.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ce(()=>{const s=Be(1,this.accBeta1),i=Be(1,this.accBeta2);t.forEach((r,o)=>{const a=K.registeredVariables[r],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${r}/m`,variable:ce(()=>kt(a).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${r}/v`,variable:ce(()=>kt(a).variable(l))});const c=Array.isArray(e)?e[o].tensor:e[r];if(c==null)return;const h=this.accumulatedFirstMoment[o].variable,f=this.accumulatedSecondMoment[o].variable,p=ke(Y(h,this.beta1),Y(c,1-this.beta1)),g=ke(Y(f,this.beta2),Y(rn(c),1-this.beta2)),y=qe(p,s),x=qe(g,i);h.assign(p),f.assign(g);const v=ke(Y(qe(y,ke(Os(x),this.epsilon)),-this.learningRate),a);a.assign(v)}),this.accBeta1.assign(Y(this.accBeta1,this.beta1)),this.accBeta2.assign(Y(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&mt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&mt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),ce(()=>{this.accBeta1.assign(Za(this.beta1,this.iterations_+1)),this.accBeta2.assign(Za(this.beta2,this.iterations_+1))});const t=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,t).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(i=>({originalName:i.name,variable:i.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B$ extends _c{static get className(){return"Adamax"}constructor(e,t,s,i=null,r=0){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=i,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ce(()=>{this.iteration=Qe(0).variable(),this.accBeta1=Qe(t).variable()}),i==null&&(this.epsilon=K.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ce(()=>{const s=Be(1,this.accBeta1),i=qe(-this.learningRate,ke(Y(this.iteration,this.decay),1));t.forEach((r,o)=>{const a=K.registeredVariables[r],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${r}/m`,variable:kt(a).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${r}/v`,variable:kt(a).variable(l)});const c=Array.isArray(e)?e[o].tensor:e[r];if(c==null)return;const h=this.accumulatedFirstMoment[o].variable,f=this.accumulatedWeightedInfNorm[o].variable,p=ke(Y(h,this.beta1),Y(c,1-this.beta1)),g=Y(f,this.beta2),y=is(c),x=il(g,y);h.assign(p),f.assign(x);const v=ke(Y(qe(i,s),qe(p,ke(x,this.epsilon))),a);a.assign(v)}),this.iteration.assign(ke(this.iteration,1)),this.accBeta1.assign(Y(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&mt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&mt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _C extends _c{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,i)=>{const r=Array.isArray(e)?e[i].tensor:e[s];if(r==null)return;const o=K.registeredVariables[s];ce(()=>{const a=ke(Y(this.c,r),o);o.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=ms(Qe(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U$ extends _C{static get className(){return"Momentum"}constructor(e,t,s=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=s,this.accumulations=[],this.m=Qe(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,i)=>{const r=K.registeredVariables[s];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${s}/momentum`,variable:ce(()=>kt(r).variable(!1))});const o=this.accumulations[i].variable,a=Array.isArray(e)?e[i].tensor:e[s];a!=null&&ce(()=>{let l;const c=ke(Y(this.m,o),a);this.useNesterov?l=ke(Y(this.c,ke(a,Y(c,this.m))),r):l=ke(Y(this.c,c),r),o.assign(c),r.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&mt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W$ extends _c{static get className(){return"RMSProp"}constructor(e,t=.9,s=0,i=null,r=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=s,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,i==null&&(this.epsilon=K.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,i)=>{const r=K.registeredVariables[s],o=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${s}/rms`,variable:ce(()=>kt(r).variable(o))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${s}/momentum`,variable:ce(()=>kt(r).variable(o))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${s}/mg`,variable:ce(()=>kt(r).variable(o))});const a=Array.isArray(e)?e[i].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[i].variable,c=this.accumulatedMoments[i].variable;ce(()=>{const h=ke(Y(l,this.decay),Y(rn(a),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[i].variable,p=ke(Y(f,this.decay),Y(a,1-this.decay)),g=qe(Y(a,this.learningRate),Os(Be(h,ke(rn(p),this.epsilon)))),y=ke(Y(c,this.momentum),g);l.assign(h),f.assign(p),c.assign(y);const x=Be(r,y);r.assign(x)}else{const f=ke(Y(l,this.decay),Y(rn(a),1-this.decay)),p=ke(Y(c,this.momentum),qe(Y(a,this.learningRate),Os(ke(f,this.epsilon))));l.assign(f),c.assign(p);const g=Be(r,p);r.assign(g)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&mt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&mt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&mt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,t).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.accumulatedMoments=e.slice(t,t*2).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Khe=[F$,V$,z$,B$,U$,W$,_C];function Xhe(){for(const n of Khe)Ne(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yhe="model",Qhe=".json",Zhe=".weights.bin";function cz(n){return new Promise(e=>setTimeout(e)).then(n)}class Wd{constructor(e){if(!de().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Wd.URL_SCHEME)&&(e=e.slice(Wd.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Yhe),this.modelJsonFileName=e+Qhe,this.weightDataFileName=e+Zhe}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=ra.join(e.weightData),s=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const i=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r=N6(e,i),o=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=o,await cz(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await cz(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:ax(e)}}}}Wd.URL_SCHEME="downloads://";class Jhe{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const s=new FileReader;s.onload=i=>{const r=JSON.parse(i.target.result),o=r.modelTopology;if(o==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(r.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const l=DD(r,c=>this.loadWeights(c));e(l)},s.onerror=i=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const t=[],s=[];for(const o of e)t.push(...o.weights),s.push(...o.paths);const i=this.checkManifestAndWeightFiles(e),r=s.map(o=>this.loadWeightsFile(o,i[o]));return Promise.all(r).then(o=>[t,o])}loadWeightsFile(e,t){return new Promise((s,i)=>{const r=new FileReader;r.onload=o=>{const a=o.target.result;s(a)},r.onerror=o=>i(`Failed to weights data from file of path '${e}'.`),r.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],s=this.weightsFiles.map(r=>Z3(r.name)),i={};for(const r of e)r.paths.forEach(o=>{const a=Z3(o);if(t.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(t.push(a),s.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);i[o]=this.weightsFiles[s.indexOf(a)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}const ede=n=>de().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Wd.URL_SCHEME)?tde(n.slice(Wd.URL_SCHEME.length)):null;An.registerSaveRouter(ede);function tde(n="model"){return new Wd(n)}function nde(n){return new Jhe(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uz(n,e,t,s){o(n),t=t??0,s=s??1,a(t,s);let i=0;const r=l=>(l.then(c=>{const h=t+ ++i/n.length*(s-t);return e(h),c}),l);function o(l){B(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){B(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),B(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),B(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(n.map(r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function H5(n,e){e==null&&(e={});const t=e.fetchFunc==null?de().platform.fetch:e.fetchFunc,s=n.map(f=>t(f,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(s):await uz(s,e.onProgress,0,.5)).map(f=>f.arrayBuffer());return e.onProgress==null?await Promise.all(a):await uz(a,e.onProgress,.5,1)}function sde(n,e){var t;const s=e.fetchFunc==null?de().platform.fetch:e.fetchFunc;let i=0,r;return(t=e.onProgress)===null||t===void 0||t.call(e,0),new ReadableStream({pull:async o=>{for(var a;i<n.length;){r||(r=(await s(n[i],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await r.read();if(l){i++,r=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,i/n.length);continue}o.enqueue(c);return}o.close()}})}async function ide(n,e="",t,s){return j5(o=>H5(o,{requestInit:s}))(n,e,t)}function j5(n){return async(e,t="",s)=>{const i=e.map(()=>!1),r={},o=s!=null?s.map(()=>!1):[],a=[];if(e.forEach((g,y)=>{let x=0;g.weights.forEach(v=>{const w="quantization"in v?v.quantization.dtype:v.dtype,S=Pd[w]*ye(v.shape),C=()=>{i[y]=!0,r[y]==null&&(r[y]=[]),r[y].push({manifestEntry:v,groupOffset:x,sizeBytes:S})};s!=null?s.forEach((I,A)=>{I===v.name&&(C(),o[A]=!0)}):C(),a.push(v.name),x+=S})}),!o.every(g=>g)){const g=s.filter((y,x)=>!o[x]);throw new Error(`Could not find weights in manifest with names: ${g.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=i.reduce((g,y,x)=>(y&&g.push(x),g),[]),c=[];l.forEach(g=>{e[g].paths.forEach(y=>{const x=t+(t.endsWith("/")?"":"/")+y;c.push(x)})});const h=await n(c),f={};let p=0;return l.forEach(g=>{const y=e[g].paths.length,x=new ra(h.slice(p,p+y));r[g].forEach(w=>{const S=x.slice(w.groupOffset,w.groupOffset+w.sizeBytes),C=E6(S,[w.manifestEntry]);for(const I in C)f[I]=C[I]}),p+=y}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rde="application/octet-stream",ode="application/json";class H${constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(B(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=de().platform.fetch,B(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&B(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],i=N6(e,s);if(t.body.append("model.json",new Blob([JSON.stringify(i)],{type:ode}),"model.json"),e.weightData!=null){const o=ra.join(e.weightData);t.body.append("model.weights.bin",new Blob([o],{type:rde}),"model.weights.bin")}const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:ax(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=t.modelTopology,i=t.weightsManifest;if(s==null&&i==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return DD(e,t=>this.loadWeights(t))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),s=cR(e.weightsManifest),i=()=>sde(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:i})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[s,i]=ade(t),r=this.weightPathPrefix||s,o=[],a=[];for(const l of e)for(const c of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(c)):o.push(r+c+i);return this.weightUrlConverter&&o.push(...await Promise.all(a)),o}async loadWeights(e){const t=await this.getWeightUrls(e),s=cR(e),i=await H5(t,this.loadOptions);return[s,i]}}H$.URL_SCHEME_REGEX=/^https?:\/\//;function ade(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),s=n.substring(0,e),i=t>e?n.substring(t):"";return[s+"/",i]}function yR(n){return n.match(H$.URL_SCHEME_REGEX)!=null}const G5=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(s=>yR(s)):t=yR(n),t)return j$(n,e)}return null};An.registerSaveRouter(G5);An.registerLoadRouter(G5);function j$(n,e){return new H$(n,e)}function lde(n,e){return j$(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BN{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class q5{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class cde{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function ude(n,e,t,s){const i=arguments;return new cde(K5(...i))}function K5(n,e,t,s){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new BN(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new BN({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new BN({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:s}))}function hde(n){return new q5(n)}function dde(n){return new q5(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:ra,browserFiles:nde,browserHTTPRequest:lde,concatenateArrayBuffers:k6,copyModel:Ure,decodeWeights:E6,decodeWeightsStream:I6,encodeWeights:lR,fromMemory:ude,fromMemorySync:K5,getLoadHandlers:kre,getModelArtifactsForJSON:DD,getModelArtifactsForJSONSync:A6,getModelArtifactsInfoForJSON:ax,getSaveHandlers:R6,getWeightSpecs:cR,http:j$,isHTTPScheme:yR,listModels:zre,loadWeights:ide,moveModel:Wre,registerLoadRouter:Ire,registerSaveRouter:Cre,removeModel:Bre,weightsLoaderFactory:j5,withSaveHandler:hde,withSaveHandlerSync:dde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fde(n,e,t){const s=U(n,"labels","confusionMatrix"),i=U(e,"predictions","confusionMatrix");B(t==null||t>0&&Number.isInteger(t),()=>`If provided, numClasses must be a positive integer, but got ${t}`),B(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),B(i.rank===1,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),B(s.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),B(t>0&&Number.isInteger(t),()=>`numClasses is required to be a positive integer, but got ${t}`);const r=Jp(De(s,"int32"),t),o=Jp(De(i,"int32"),t),a=Et(r),l=pt(a,o);return De(l,"int32")}const pde=X({confusionMatrix_:fde});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mde=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:pde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Yh,hz=!1;function X5(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,s=!1,i=!1,r=!1,o=!1,a=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)r=!0;else if(n.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(f0(lT,K.backendName)!=null){const y={pixels:n},x={numChannels:e};return K.runKernel(lT,y,x)}const[c,h]=i?[n.videoWidth,n.videoHeight]:[n.width,n.height];let f;if(o)f=n.getContext("2d").getImageData(0,0,c,h).data;else if(s||t)f=n.data;else if(r||i||a){if(Yh==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Yh=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Yh=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Yh.canvas.width=c,Yh.canvas.height=h,Yh.drawImage(n,0,0,c,h),f=Yh.getImageData(0,0,c,h).data}let p;if(e===4)p=new Int32Array(f);else{const y=c*h;p=new Int32Array(y*e);for(let x=0;x<y;x++)for(let v=0;v<e;++v)p[x*e+v]=f[x*4+v]}return I$(p,[h,c,e],"int32")}function gde(n){return n!=null&&n.data instanceof Uint8Array}function yde(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function bde(n){return n!=null&&n.width!==0&&n.height!==0}function vde(n){return yde()&&!(n instanceof ImageBitmap)&&bde(n)&&!gde(n)}async function xde(n,e=3){let t=null;if(de().getBool("WRAP_TO_IMAGEBITMAP")&&vde(n)){let s;try{s=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===n.width&&s.height===n.height?t=s:t=n}else t=n;return X5(t,e)}function Y5(n){if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const e=n.rank===2?1:n.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`)}function wde(n){const e=(n==null?void 0:n.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function _de(n,e){let t=U(n,"img","toPixels");if(!(n instanceof Kt)){const c=t;t=De(c,"int32"),c.dispose()}Y5(t);const[s,i]=t.shape.slice(0,2),r=t.rank===2?1:t.shape[2],o=await t.data(),a=t.dtype==="float32"?255:1,l=new Uint8ClampedArray(i*s*4);for(let c=0;c<s*i;++c){const h=[0,0,0,255];for(let p=0;p<r;p++){const g=o[c*r+p];if(t.dtype==="float32"){if(g<0||g>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${g}.`)}else if(t.dtype==="int32"&&(g<0||g>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${g}.`);r===1?(h[0]=g*a,h[1]=g*a,h[2]=g*a):h[p]=g*a}const f=c*4;l[f+0]=Math.round(h[0]),l[f+1]=Math.round(h[1]),l[f+2]=Math.round(h[2]),l[f+3]=Math.round(h[3])}if(e!=null){hz||f0(YS,K.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),hz=!0),e.width=i,e.height=s;const c=e.getContext("2d"),h=new ImageData(l,i,s);c.putImageData(h,0,0)}return t!==n&&t.dispose(),l}function Tde(n,e,t){let s=U(n,"img","draw");if(!(n instanceof Kt)){const o=s;s=De(o,"int32"),o.dispose()}Y5(s),wde(t==null?void 0:t.imageOptions);const i={image:s},r={canvas:e,options:t};K.runKernel(YS,i,r)}const Q5=X({fromPixels_:X5}),Sde=Object.freeze(Object.defineProperty({__proto__:null,draw:Tde,fromPixels:Q5,fromPixelsAsync:xde,toPixels:_de},Symbol.toStringTag,{value:"Module"}));function TC(n,e){const t=n.shape.length,s=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${t}`);if(ye(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const i=e.shape,r=i[i.length-1];let o=1;for(let f=0;f<i.length-1;++f)o*=i[f];const a=n.shape,l=i.slice();l.pop();let c=1;for(let f=r;f<t;++f)c*=a[f],l.push(a[f]);const h=[...Ye(n.shape).map(f=>f/c),1].slice(0,r);return[l,o,c,h]}const Ede=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:TC},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bR=-2,Cde=-1;function q$(n,e,t){const s=n.shape.length;B(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),B(s===t.length,()=>`Error in slice${s}D: Length of size ${t} must match the rank of the array (${s}).`);for(let i=0;i<s;++i)B(e[i]+t[i]<=n.shape[i],()=>`Error in slice${s}D: begin[${i}] + size[${i}] (${e[i]+t[i]}) would overflow input.shape[${i}] (${n.shape[i]})`)}function Ide(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function K$(n,e,t){const s=[];for(let i=0;i<n.length;i++)s[i]=Math.ceil((e[i]-n[i])/t[i]);return s}function Z5(n,e,t,s){const i=[...n];for(let r=i.length;r<s.length;r++)i.push(1);for(let r=0;r<t;r++)r===0?i[e]=1:(i.splice(e,0,1),i.pop());return i}function J5(n,e,t){return t<=n?t:t-(e-1)}function eG(n,e){const t=[];for(let s=0;s<n;s++)t.push(e+s);return t}function kde(n,e,t,s,i,r,o,a,l){const c=n.length;let h=new Array(c),f=new Array(c),p=new Array(c);if(e.length&&t>0){const g=e[0],y=t+1;h=tG(o,g,y,s,n),f=nG(a,g,y,i,n),p=Z5(r,g,y,n)}else for(let g=0;g<c;g++)h[g]=iG(o,s,r,n,g,l),f[g]=rG(a,i,r,n,g,l),p[g]=sG(r,g,l);return{begin:h,end:f,strides:p}}function tG(n,e,t,s,i){const r=[...i],o=eG(t,e);for(let a=0;a<r.length;a++)if(o.indexOf(a)>-1)r[a]=0;else{const l=J5(e,t,a);let c=s[l];n&1<<l&&(c=0),r[a]=c}return r}function nG(n,e,t,s,i){const r=[...i],o=eG(t,e);for(let a=0;a<r.length;a++)if(o.indexOf(a)>-1)r[a]=Number.MAX_SAFE_INTEGER;else{const l=J5(e,t,a);let c=s[l];n&1<<l&&(c=Number.MAX_SAFE_INTEGER),r[a]=c}for(let a=0;a<r.length;a++){const l=i[a];r[a]<0&&(r[a]+=l),r[a]=Pu(0,r[a],i[a])}return r}function sG(n,e,t){let s=n[e];return(t&1<<e||s==null)&&(s=1),s}function iG(n,e,t,s,i,r){let o=e[i];const a=t[i]||1;(n&1<<i||r&1<<i||o==null)&&(a>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[i];return o<0&&(o+=l),o=Pu(0,o,l-1),o}function rG(n,e,t,s,i,r){let o=e[i];const a=t[i]||1;(n&1<<i||r&1<<i||o==null)&&(a>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[i];return o<0&&(o+=l),a>0?o=Pu(0,o,l):o=Pu(-1,o,l-1),o}function X$(n,e,t){let s=t.length;for(let i=0;i<t.length;i++)if(t[i]>1){s=i;break}for(let i=s+1;i<t.length;i++)if(e[i]>0||t[i]!==n[i])return!1;return!0}function Y$(n,e){let t=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)t+=n[s]*e[s];return t}function SC(n,e,t){let s;const i=n.shape.length;typeof e=="number"?s=[e,...new Array(i-1).fill(0)]:e.length<i?s=e.concat(new Array(i-e.length).fill(0)):s=e.slice(),s.forEach(o=>{B(o!==-1,()=>"slice() does not support negative begin indexing.")});let r;return t==null?r=new Array(i).fill(-1):typeof t=="number"?r=[t,...new Array(i-1).fill(-1)]:t.length<i?r=t.concat(new Array(i-t.length).fill(-1)):r=t,r=r.map((o,a)=>o>=0?o:(B(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${a}.`),n.shape[a]-s[a])),[s,r]}function Q$(n,e,t,s,i,r,o,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const f={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:c.slice(),beginMask:i,endMask:r,ellipsisMask:o,newAxisMask:a,shrinkAxisMask:l};for(let C=0;C<f.dims;C++)h&&1<<C&a&&f.numAddAxisAfterEllipsis++,1<<C&o&&(h=!0);h||(f.ellipsisMask|=1<<f.dims,f.dims++);const p={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Nde(f,p);let g=!0,y=!0,x=!0;const v=[],w=[];for(let C=0;C<n.length;++C){if(p.strides[C]===0)throw Error(`strides[${C}] must be non-zero`);const I=!!(p.shrinkAxisMask&1<<C),A=n[C];if(A===-1){v.push(I?1:-1);continue}const L=[p.beginMask&1<<C,p.endMask&1<<C],O=[p.strides[C]>0?0:-1,p.strides[C]>0?A:A-1];if(I&&p.strides[C]<=0)throw Error("only stride 1 allowed on non-range indexing.");x=x&&p.strides[C]===1;const N=!!(p.beginMask&1<<C&&p.endMask&1<<C);if(p.beginValid&&p.endValid){if(I){const z=p.begin[C]<0?A+p.begin[C]:p.begin[C];if(p.begin[C]=z,p.end[C]=p.begin[C]+1,z<0||z>=A)throw Error(`slice index ${p.begin[C]} of dimension ${C} out of bounds.`)}else p.begin[C]=dz(p.begin[C],0,p.strides[C],A,L,O),p.end[C]=dz(p.end[C],1,p.strides[C],A,L,O);const R=p.strides[C]===1&&p.begin[C]===0&&p.end[C]===A;g=g&&R,y=y&&(C===0&&p.strides[C]===1||R)}else g=g&&p.strides[C]===1&&N,y=y&&(C===0&&p.strides[C]===1||N);let k,$=!1;if(p.beginValid&&p.endValid?(k=p.end[C]-p.begin[C],$=!0):I?(k=1,$=!0):N&&A>=0&&(p.strides[C]<0?k=-A:k=A,$=!0),$){let R;k===0||k<0!=p.strides[C]<0?R=0:R=Math.trunc(k/p.strides[C])+(k%p.strides[C]!==0?1:0),v.push(R)}else v.push(-1)}for(let C=0;C<p.finalShapeGatherIndices.length;++C){const I=p.finalShapeGatherIndices[C];I>=0?w.push(v[I]):I===bR&&w.push(1)}return{finalShapeSparse:w.filter((C,I)=>p.finalShapeGatherIndices[I]!==bR),finalShape:w,isIdentity:g,sliceDim0:y,isSimpleSlice:x,begin:p.begin,end:p.end,strides:p.strides}}function Nde(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const i=Math.min(e.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<i;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=s}else if(1<<s&n.newAxisMask)e.finalShapeGatherIndices.push(bR),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[s]),n.end!=null&&(e.end[t]=n.end[s]),e.strides[t]=n.strides[s],n.beginMask&1<<s&&(e.beginMask|=1<<t),n.endMask&1<<s&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(Cde),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[t]=s,t++}}function dz(n,e,t,s,i,r){if(i[e])return t>0?r[e]:r[e+1&1];{const o=n<0?s+n:n;return o<r[0]?r[0]:o>r[1]?r[1]:o}}const oG=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:q$,computeFlatOffset:Y$,computeOutShape:K$,getNormalizedAxes:kde,isSliceContinous:X$,maskToAxes:Ide,parseSliceParams:SC,sliceInfo:Q$,startForAxis:iG,startIndicesWithElidedDims:tG,stopForAxis:rG,stopIndicesWithElidedDims:nG,stridesForAxis:sG,stridesWithElidedDims:Z5},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const Ade="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aG{static sgd(e){return new _C(e)}static momentum(e,t,s=!1){return new U$(e,t,s)}static rmsprop(e,t=.9,s=0,i=null,r=!1){return new W$(e,t,s,i,r)}static adam(e=.001,t=.9,s=.999,i=null){return new z$(e,t,s,i)}static adadelta(e=.001,t=.95,s=null){return new F$(e,t,s)}static adamax(e=.002,t=.9,s=.999,i=null,r=0){return new B$(e,t,s,i,r)}static adagrad(e,t=.1){return new V$(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rd=aG;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rde=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function Z$(){return new Promise(n=>Rde(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$(n,e){const t=n[0].length;n.forEach((i,r)=>{B(i.length===t,()=>`Error in concat${t}D: rank of tensors[${r}] must be the same as the rank of the rest (${t})`)}),B(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const s=n[0];n.forEach((i,r)=>{for(let o=0;o<t;o++)B(o===e||i[o]===s[o],()=>`Error in concat${t}D: Shape of tensors[${r}] (${i}) does not match the shape of the rest (${s}) along the non-concatenated axis ${r}.`)})}function za(n,e){const t=n[0].slice();for(let s=1;s<n.length;s++)t[e]+=n[s][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Wo;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Wo||(Wo={}));function lG(n,e,t){let s=new Array;if(t==null&&e==null)return s;if(e==null)for(;s.length<n+t.length;)s.push(-1);else s=e.slice();if(t==null)return s;if(n+t.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${s.length}`);for(let i=1;i<t.length;++i){const r=t[i],o=s[s.length-t.length+i],a=s[o];if(r>=0)if(a>=0){if(a!==r)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${i+n}] = ${r} but shape[${i+n}] = ${a}`)}else s[o]=r}return s}function cG(n){const e={FIRST_DIM_SIZE:Wo.FIRST_DIM_SIZE,VALUE_ROWIDS:Wo.VALUE_ROWIDS,ROW_LENGTHS:Wo.ROW_LENGTHS,ROW_SPLITS:Wo.ROW_SPLITS,ROW_LIMITS:Wo.ROW_LIMITS,ROW_STARTS:Wo.ROW_STARTS},t=[];for(const s of n)if(s in e)t.push(e[s]);else break;return t}function uG(n){return n.length===0?0:n[0]===Wo.FIRST_DIM_SIZE?n.length-1:n.length}function hG(n,e){if(n==null||e==null)return;const t=n.length,s=e.length;if(t>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${s})`);for(let i=0;i<Math.min(t,s-1);++i){const r=n[i],o=e[i+1];if(r>=0&&o>=0&&r!==1&&r!==o)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${i-n.length}] = ${r} but ragged tensor input.flatValues.shape[${i-n.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eO=30;function EC(n){return n<=eO?n:rT(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tO(n,e,t){const s=t*(typeof n=="number"?n:n[0]),i=e*(typeof n=="number"?n:n[1]);return[s,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ex(n,e,t,s=!0){let i=[];if(s)i=i.concat(e.slice(0)),i.push(n[0]/t),i=i.concat(n.slice(1));else{i=i.concat(n[0]);const r=e.length;for(let o=0;o<r;++o)i=i.concat([n[o+1]/e[o],e[o]]);i=i.concat(n.slice(r+1))}return i}function Cx(n,e,t=!0){const s=[];if(t){s.push(e);for(let i=e+1;i<n;++i)i<=2*e?(s.push(i),s.push(i-(e+1))):s.push(i)}else{const i=[],r=[];for(let o=1;o<n;++o)o>=e*2+1||o%2===1?r.push(o):i.push(o);s.push(...i),s.push(0),s.push(...r)}return s}function Ix(n,e,t,s=!0){const i=[];s?i.push(n[0]/t):i.push(n[0]*t);for(let r=1;r<n.length;++r)r<=e.length?s?i.push(e[r-1]*n[r]):i.push(n[r]/e[r-1]):i.push(n[r]);return i}function nO(n,e){const t=[0];for(let s=0;s<e;++s)t.push(n[s][0]);return t}function sO(n,e,t){const s=n.slice(0,1);for(let i=0;i<t;++i)s.push(n[i+1]-e[i][0]-e[i][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CC=1.7580993408473768,IC=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iO=.3275911,rO=.254829592,oO=-.284496736,aO=1.421413741,lO=-1.453152027,cO=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ic(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let s=0;s<t.length;s+=2)t[s]=n[s/2],t[s+1]=e[s/2];return t}function dG(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)e[s/2]=n[s],t[s/2]=n[s+1];return{real:e,imag:t}}function fG(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let i=0;i<n.length;i+=4)t[Math.floor(i/4)]=n[i],s[Math.floor(i/4)]=n[i+1];return{real:t,imag:s}}function pG(n){const e=Math.floor(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let i=2;i<n.length;i+=4)t[Math.floor(i/4)]=n[i],s[Math.floor(i/4)]=n[i+1];return{real:t,imag:s}}function uO(n,e){const t=n[e*2],s=n[e*2+1];return{real:t,imag:s}}function mG(n,e,t,s){n[s*2]=e,n[s*2+1]=t}function gG(n,e){const t=new Float32Array(n/2),s=new Float32Array(n/2);for(let i=0;i<Math.ceil(n/2);i++){const r=(e?2:-2)*Math.PI*(i/n);t[i]=Math.cos(r),s[i]=Math.sin(r)}return{real:t,imag:s}}function yG(n,e,t){const s=(t?2:-2)*Math.PI*(n/e),i=Math.cos(s),r=Math.sin(s);return{real:i,imag:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UN="->",Dde=/->/g,fz=",",pz="...";function hO(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(Dde,"").length)/UN.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${UN}").`);const[s,i]=n.split(UN);B(s.indexOf(pz)===-1,()=>`The ellipsis notation ("${pz}") is not supported yet.`);const r=s.split(fz),o=r.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let p=0;p<i.length;++p){const g=i[p];if(!r.some(y=>y.indexOf(g)!==-1))throw new Error(`Output subscripts contain the label ${g} not present in the input subscripts.`);a.indexOf(g)===-1&&a.push(g)}for(let p=0;p<s.length;++p){const g=s[p];a.indexOf(g)===-1&&g!==fz&&a.push(g)}const l=new Array(r.length);for(let p=0;p<o;++p){if(new Set(r[p].split("")).size!==r[p].length)throw new Error(`Found duplicate axes in input component ${r[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let g=0;g<r[p].length;++g)l[p].push(a.indexOf(r[p][g]))}const c=a.length,h=i.length,f=[];for(let p=h;p<c;++p)f.push(p);return{allDims:a,summedDims:f,idDims:l}}function dO(n,e){let t=new Array(n);t.fill(-1);for(let i=0;i<e.length;++i)t[e[i]]=i;const s=[];for(let i=0;i<n;++i)t[i]===-1&&s.push(i);return t=t.filter(i=>i!==-1),{permutationIndices:t,expandDims:s}}function fO(n,e,t){const s=new Array(n);for(let i=0;i<t.length;++i){const r=t[i].shape;for(let o=0;o<e[i].length;++o)s[e[i][o]]===void 0?s[e[i][o]]=r[o]:B(s[e[i][o]]===r[o],()=>`Expected dimension ${s[e[i][o]]} at axis ${o} of input shaped ${JSON.stringify(r)}, but got dimension ${r[o]}`)}}function pO(n,e){const t=n,s=[];let i=0;n.length===0&&t.push(-1),i=n.length+1;for(let o=0;o<i;++o)s.push([]);const r=[];for(let o=0;o<t.length;++o){const a=t[o],l=$de(e,a);for(const c of l)r.indexOf(c)===-1&&(s[o].push(c),r.push(c))}return{path:t,steps:s}}function mO(n){return n.every((e,t)=>e===t)}function $de(n,e){const t=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(e)!==-1||e===-1)&&t.push(s);return t}function gO(n,e,t=0){let s=[];if(typeof e=="number")B(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(n.shape[t]/e);else{const i=e.reduce((o,a)=>(a===-1&&(o+=1),o),0);B(i<=1,()=>"There should be only one negative value in split array.");const r=e.indexOf(-1);if(r!==-1){const o=e.reduce((a,l)=>l>0?a+l:a);e[r]=n.shape[t]-o}B(n.shape[t]===e.reduce((o,a)=>o+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function vG(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function xG(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function _G(n,e){return`size ${n} must be non-negative, not ${e}`}function TG(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function SG(n,e){const t=ye(n),s=ye(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${e}`}function EG(n,e){const t=ye(n),s=ye(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vR(){return"segment ids must be >= 0"}function CG(){return"segment ids are not increasing"}function IG(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function kG(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(n,e){let t=!1,s;for(n<=eO?(s=n,t=!0):s=rT(n,Math.floor(Math.sqrt(n)));!t;)s>e||s===n?t=!0:s=rT(n,s+1);return s}function AG(n,e,t){const s=[],i=n.length;for(let r=0;r<i;r++)r!==e?s.push(n[r]):s.push(t);return s}function yO(n,e,t,s){const i=e.shape.length,r=n.shape.length;if(s!==0&&(s<-i||s>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${s}`);if(s<0&&(s+=i),s>r)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${r}).`);if(t<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${t}).`);for(let f=0;f<s;++f)if(n.shape[f]!==e.shape[f])throw new Error(`x.shape[${f}]: ${n.shape[f]} should be equal to indices.shape[${f}]: ${e.shape[f]}.`);const o=n.shape[t],a=[];let l=1,c=1,h=1;for(let f=0;f<s;++f)a.push(n.shape[f]),l*=n.shape[f];for(let f=s;f<t;f++)a.push(n.shape[f]),c*=n.shape[f];for(let f=s;f<i;f++)a.push(e.shape[f]);for(let f=t+1;f<r;f++)a.push(n.shape[f]),h*=n.shape[f];return{batchSize:l,sliceSize:h,outerSize:c,dimSize:o,outputShape:a}}const Ode=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:yO,computeOutShape:AG,segOpComputeOptimalWindowSize:NG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rc(n){try{return n.map(e=>tc(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function RG(n){return n.map(e=>Fa(e))}const DG=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:rO,ERF_A2:oO,ERF_A3:aO,ERF_A4:lO,ERF_A5:cO,ERF_P:iO,PARALLELIZE_THRESHOLD:eO,get RowPartitionType(){return Wo},SELU_SCALE:IC,SELU_SCALEALPHA:CC,applyActivation:yC,assertAndGetBroadcastShape:ot,assertAxesAreInnerMostDims:ti,assertParamsConsistent:J$,assignToTypedArray:mG,axesAreInnerMostDims:o$,calculateShapes:uh,checkEinsumDimSizes:fO,checkPadOnDimRoundingMode:Vi,combineLocations:G6,combineRaggedTensorToTensorShapes:lG,complexWithEvenIndex:fG,complexWithOddIndex:pG,computeConv2DInfo:Ps,computeConv3DInfo:oh,computeDefaultPad:UD,computeDilation2DInfo:lx,computeOptimalWindowSize:EC,computeOutAndReduceShapes:Ls,computeOutShape:za,computePool2DInfo:No,computePool3DInfo:gc,convertConv2DDataFormat:yc,decodeEinsumEquation:hO,eitherStridesOrDilationsAreOne:ei,expandShapeToKeepDim:Xn,exponent:yG,exponents:gG,fromStringArrayToUint8:RG,fromUint8ToStringArray:rc,getAxesPermutation:On,getBroadcastDims:zd,getComplexWithIndex:uO,getEinsumComputePath:pO,getEinsumPermutation:dO,getFusedBiasGradient:gC,getFusedDyActivation:mC,getImageCenter:tO,getInnerMostAxes:Qn,getPermuted:Cx,getRaggedRank:uG,getReductionAxes:ls,getReshaped:Ex,getReshapedPermuted:Ix,getRowPartitionTypesHelper:cG,getSliceBeginCoords:nO,getSliceSize:sO,getSparseFillEmptyRowsIndicesDenseShapeMismatch:bG,getSparseFillEmptyRowsNegativeIndexErrorMessage:vG,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:xG,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:TG,getSparseReshapeInputOutputMismatchErrorMessage:EG,getSparseReshapeInputOutputMultipleErrorMessage:SG,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:wG,getSparseReshapeNegativeOutputDimErrorMessage:_G,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:kG,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:vR,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:CG,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:IG,getUndoAxesPermutation:ah,isIdentityPermutation:mO,log:Eie,mergeRealAndImagArrays:ic,prepareAndValidate:TC,prepareSplitSize:gO,segment_util:Ode,shouldFuse:bC,slice_util:oG,splitRealAndImagArrays:dG,stridesOrDilationsArePositive:Vd,tupleValuesAreOne:Vu,upcastType:Ji,validateDefaultValueShape:hG,validateInput:uC,validateUpdateShape:k$,warn:Dr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pde=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:vC,nonMaxSuppressionV4Impl:xC,nonMaxSuppressionV5Impl:wC,whereImpl:fC},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Xhe();const Lde=Object.freeze(Object.defineProperty({__proto__:null,Abs:sv,Acos:km,Acosh:Nm,AdadeltaOptimizer:F$,AdagradOptimizer:V$,AdamOptimizer:z$,AdamaxOptimizer:B$,Add:uf,AddN:iv,All:$S,Any:OS,ArgMax:rv,ArgMin:ov,Asin:Am,Asinh:Rm,Atan:Dm,Atan2:Om,Atanh:$m,AvgPool:av,AvgPool3D:lv,AvgPool3DGrad:LS,AvgPoolGrad:PS,BatchMatMul:cv,BatchToSpaceND:uv,Bincount:MS,BitwiseAnd:hv,BroadcastArgs:FS,BroadcastTo:l6,Cast:Pm,Ceil:Lm,ClipByValue:Mm,Complex:VS,ComplexAbs:dv,Concat:fv,Conv2D:pv,Conv2DBackpropFilter:zS,Conv2DBackpropInput:mv,Conv3D:gv,Conv3DBackpropFilterV2:BS,Conv3DBackpropInputV2:US,Cos:Fm,Cosh:Vm,CropAndResize:HS,Cumprod:WS,Cumsum:yv,DataStorage:yD,DenseBincount:jS,DepthToSpace:GS,DepthwiseConv2dNative:bv,DepthwiseConv2dNativeBackpropFilter:qS,DepthwiseConv2dNativeBackpropInput:KS,Diag:XS,Dilation2D:vv,Dilation2DBackpropFilter:aT,Dilation2DBackpropInput:oT,Draw:YS,get ENV(){return _D},Einsum:QS,Elu:Bm,EluGrad:ZS,Environment:o6,Equal:xv,Erf:Um,Exp:Wm,ExpandDims:wv,Expm1:Hm,FFT:JS,Fill:eE,FlipLeftRight:tE,Floor:jm,FloorDiv:Gm,FromPixels:lT,FusedBatchNorm:_v,FusedConv2D:u0,FusedDepthwiseConv2D:h0,GatherNd:nE,GatherV2:Tv,Greater:Sv,GreaterEqual:qm,IFFT:sE,Identity:Km,Imag:iE,IsFinite:Xm,IsInf:Ym,IsNan:Qm,KernelBackend:AS,LRN:Rv,LRNGrad:oE,LeakyRelu:Ev,Less:Cv,LessEqual:Iv,LinSpace:rE,Log:Zm,Log1p:Jm,LogSoftmax:c6,LogicalAnd:kv,LogicalNot:Nv,LogicalOr:Av,LogicalXor:xie,LowerBound:wie,MatrixBandPart:_ie,Max:Dv,MaxPool:$v,MaxPool3D:Ov,MaxPool3DGrad:lE,MaxPoolGrad:aE,MaxPoolWithArgmax:cE,Maximum:eg,Mean:Pv,Min:Lv,Minimum:tg,MirrorPad:Mv,Mod:ng,MomentumOptimizer:U$,Multinomial:uE,Multiply:sg,Neg:Fv,NonMaxSuppressionV3:hE,NonMaxSuppressionV4:dE,NonMaxSuppressionV5:fE,NotEqual:Vv,OP_SCOPE_SUFFIX:kD,OneHot:Bv,OnesLike:zv,Optimizer:_c,OptimizerConstructors:aG,Pack:Uv,PadV2:Wv,Pool:Tie,Pow:ig,Prelu:Hv,Prod:jv,RMSPropOptimizer:W$,RaggedGather:pE,RaggedRange:mE,RaggedTensorToTensor:gE,Range:yE,get Rank(){return tR},Real:bE,RealDiv:zm,Reciprocal:rg,get Reduction(){return Ai},Relu:og,Relu6:ag,Reshape:Gv,ResizeBilinear:Kv,ResizeBilinearGrad:xE,ResizeNearestNeighbor:qv,ResizeNearestNeighborGrad:vE,Reverse:Xv,RotateWithOffset:ME,Round:lg,Rsqrt:cg,SGDOptimizer:_C,ScatterNd:wE,SearchSorted:TE,Select:Yv,Selu:ug,Sigmoid:pg,Sign:fg,Sin:hg,Sinh:dg,Slice:Qv,Softmax:tx,Softplus:mg,SpaceToBatchND:Jv,SparseFillEmptyRows:SE,SparseReshape:EE,SparseSegmentMean:CE,SparseSegmentSum:IE,SparseToDense:kE,SplitV:ex,Sqrt:gg,Square:NE,SquaredDifference:yg,StaticRegexReplace:nx,Step:_g,StridedSlice:AE,StringNGrams:RE,StringSplit:DE,StringToHashBucketFast:$E,Sub:bg,Sum:Zv,Tan:vg,Tanh:xg,Tensor:Kt,TensorBuffer:as,TensorScatterUpdate:_E,Tile:wg,TopK:OE,Transform:PE,Transpose:Ed,Unique:LE,Unpack:sx,UnsortedSegmentSum:ix,UpperBound:Sie,Variable:p0,ZerosLike:rx,_FusedMatMul:c0,abs:is,acos:OD,acosh:PD,add:ke,addN:V6,all:BE,any:g0,argMax:Fd,argMin:LD,asin:MD,asinh:FD,atan:VD,atan2:zD,atanh:BD,avgPool:cx,avgPool3d:WD,backend:AD,backend_util:DG,basicLSTMCell:z6,batchNorm:Tg,batchNorm2d:HD,batchNorm3d:jD,batchNorm4d:GD,batchToSpaceND:ux,bincount:qD,bitwiseAnd:B6,booleanMaskAsync:E5,broadcastArgs:U6,broadcastTo:Cd,broadcast_util:iae,browser:Sde,buffer:ut,cast:De,ceil:KD,clipByValue:tr,clone:Va,complex:nc,concat:Kn,concat1d:XD,concat2d:YD,concat3d:QD,concat4d:ZD,conv1d:UE,conv2d:sc,conv2dTranspose:WE,conv3d:e$,conv3dTranspose:t$,copyRegisteredKernels:kie,cos:hx,cosh:HE,cosineWindow:pC,cumprod:v0,cumsum:jE,customGrad:Ja,denseBincount:uT,deprecationWarn:are,depthToSpace:n$,depthwiseConv2d:Sg,device_util:tre,diag:H6,dilation2d:s$,disableDeprecationWarnings:ore,dispose:mt,disposeVariables:lre,div:qe,divNoNan:i$,dot:r$,dropout:$$,einsum:hd,elu:Eg,enableDebugMode:rre,enableProdMode:ire,enclosingPowerOfTwo:O$,engine:Bo,ensureShape:j6,env:de,equal:So,erf:GE,euclideanNorm:a$,exp:nr,expandDims:ui,expm1:l$,eye:qE,fft:Tx,fill:hf,findBackend:pre,findBackendFactory:mre,floor:Ig,floorDiv:zE,fused:O5,gather:kg,gatherND:N5,gather_util:Ede,getBackend:S6,getGradient:JA,getKernel:f0,getKernelsForBackend:cT,grad:Bae,grads:Uae,greater:rr,greaterEqual:bc,ifft:nm,imag:dx,image:yo,inTopKAsync:A5,io:G$,irfft:lC,isFinite:c$,isInf:u$,isNaN:h$,keep:ms,kernel_impls:Pde,leakyRelu:fx,less:Zp,lessEqual:lh,linalg:M$,linspace:K6,localResponseNormalization:d$,log:br,log1p:px,logSigmoid:f$,logSoftmax:XE,logSumExp:mx,logicalAnd:ea,logicalNot:gx,logicalOr:YE,logicalXor:p$,losses:B5,lowerBound:Y6,matMul:pt,math:mde,max:Fr,maxPool:yx,maxPool3d:m$,maxPoolWithArgmax:Q6,maximum:il,mean:Rn,memory:aR,meshgrid:Z6,min:Qp,minimum:Bu,mirrorPad:g$,mod:y$,moments:bx,movingAverage:C5,mul:Y,multiRNNCell:J6,multinomial:e5,neg:gn,nextFrame:Z$,norm:Cg,notEqual:Bd,oneHot:Jp,ones:Yi,onesLike:vr,op:X,outerProduct:t5,pad:vc,pad1d:n5,pad2d:s5,pad3d:i5,pad4d:r5,pool:b$,pow:Za,prelu:xx,print:$D,prod:v$,profile:cre,raggedGather:o5,raggedRange:a5,raggedTensorToTensor:l5,rand:c5,randomGamma:d5,randomNormal:JE,randomStandardNormal:f5,randomUniform:ch,randomUniformInt:p5,range:Ud,ready:dre,real:em,reciprocal:T$,registerBackend:ND,registerGradient:u6,registerKernel:FE,relu:oa,relu6:eC,removeBackend:fre,reshape:te,reverse:Wr,reverse1d:m5,reverse2d:g5,reverse3d:y5,reverse4d:b5,rfft:Sx,round:tC,rsqrt:nC,scalar:Qe,scatterND:I5,scatter_util:Gce,searchSorted:QE,selu:sC,separableConv2d:iC,serialization:qhe,setBackend:hre,setPlatform:gre,setdiff1dAsync:v5,sigmoid:Yo,sign:S$,signal:z5,sin:rC,sinh:oC,slice:St,slice1d:wx,slice2d:aC,slice3d:_x,slice4d:tm,slice_util:oG,softmax:Ng,softplus:df,spaceToBatchND:vx,sparse:U5,sparseToDense:k5,spectral:V5,split:Zi,sqrt:Os,square:rn,squaredDifference:cC,squeeze:xc,stack:sr,step:ff,stridedSlice:E$,string:W5,sub:Be,sum:We,sumOutType:VE,tan:C$,tanh:zu,tensor:_o,tensor1d:fi,tensor2d:Mp,tensor3d:I$,tensor4d:x5,tensor5d:w5,tensor6d:_5,tensorScatterUpdate:T5,tensor_util:Yie,test_util:rce,tidy:ce,tile:Or,time:ure,topk:N$,train:rd,transpose:Et,truncatedNormal:hC,unique:A$,unregisterGradient:Iie,unregisterKernel:Cie,unsortedSegmentSum:dC,unstack:Hr,upcastType:Ji,upperBound:S5,util:Mie,valueAndGrad:Wae,valueAndGrads:Hae,variable:R$,variableGrads:X6,version_core:Ade,where:Qs,whereAsync:D$,zeros:qn,zerosLike:kt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mde=de();Mde.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var hr;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(hr||(hr={}));var mz;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(mz||(mz={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fde={};function $G(n){return Fde[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P(n,e,t,s,i){const r=e.inputParams[n];if(r&&r.inputIndexStart!==void 0){const a=r.inputIndexStart,l=r.inputIndexEnd===0?void 0:r.inputIndexEnd===void 0?a+1:r.inputIndexEnd,c=a<0?e.inputNames.length+a:a;if(r.type==="tensor")return Ks(e.inputNames[c],t,s,i);if(r.type==="tensors"){const p=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((y,x)=>{var v;return((v=p[x])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(y=>Ks(y,t,s,i))}const h=Ks(e.inputNames[c],t,s,i),f=h.dataSync();return r.type==="number"?f[0]:Mr(h.shape,f)}const o=e.attrParams[n];return o&&o.value}function Ks(n,e,t,s){const[i,r]=dr(n,t);if(s!=null){const a=s.getHashTableHandleByName(i);if(a!=null)return a}const o=t.currentContextIds.find(a=>!!e[hT(i,a)]);return o!==void 0?e[hT(i,o)][r]:void 0}function gz(n,e,t){return e[hT(n,t.currentContextId)]}function Ml(n,e){const[t,s,i]=dr(n,e);return[hT(t,e&&e.currentContextId),s,i]}function hT(n,e){return e?`${n}-${e}`:n}function dr(n,e){if(n==="")return["",0,void 0];const t=e!=null&&e.parseNodeNameCache!=null;if(t){const r=e.parseNodeNameCache.get(n);if(r!=null)return r}const s=n.split(":");let i;if(s.length===1)i=[n,0,void 0];else{const r=s[0],o=s.length===3?s[1]:void 0,a=Number(s[s.length-1]);i=[r,a,o]}return t&&e.parseNodeNameCache.set(n,i),i}function A1(n,e,t){let s=P("pad",n,e,t);if(s==="explicit"){s=P("explicitPaddings",n,e,t);const i=[[0,0],[0,0],[0,0],[0,0]];for(let r=0;r<4;r++)i[r][0]=s[r*2],i[r][1]=s[r*2+1];return i}return s}function Fl(n){return n.kept?n:Va(n)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vde=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],zde=Object.freeze(Object.defineProperty({__proto__:null,json:Vde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bde=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Ude=Object.freeze(Object.defineProperty({__proto__:null,json:Bde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wde=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Hde=Object.freeze(Object.defineProperty({__proto__:null,json:Wde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jde=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Gde=Object.freeze(Object.defineProperty({__proto__:null,json:jde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qde=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Kde=Object.freeze(Object.defineProperty({__proto__:null,json:qde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xde=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Yde=Object.freeze(Object.defineProperty({__proto__:null,json:Xde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qde=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Zde=Object.freeze(Object.defineProperty({__proto__:null,json:Qde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jde=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],efe=Object.freeze(Object.defineProperty({__proto__:null,json:Jde},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tfe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],nfe=Object.freeze(Object.defineProperty({__proto__:null,json:tfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sfe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],ife=Object.freeze(Object.defineProperty({__proto__:null,json:sfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rfe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],ofe=Object.freeze(Object.defineProperty({__proto__:null,json:rfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const afe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],lfe=Object.freeze(Object.defineProperty({__proto__:null,json:afe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cfe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],ufe=Object.freeze(Object.defineProperty({__proto__:null,json:cfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hfe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],dfe=Object.freeze(Object.defineProperty({__proto__:null,json:hfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ffe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],pfe=Object.freeze(Object.defineProperty({__proto__:null,json:ffe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mfe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],gfe=Object.freeze(Object.defineProperty({__proto__:null,json:mfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yfe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],bfe=Object.freeze(Object.defineProperty({__proto__:null,json:yfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vfe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],xfe=Object.freeze(Object.defineProperty({__proto__:null,json:vfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wfe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],_fe=Object.freeze(Object.defineProperty({__proto__:null,json:wfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yz{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[zde,Ude,Hde,Gde,Kde,Yde,Zde,efe,nfe,ife,ofe,lfe,ufe,dfe,pfe,gfe,bfe,xfe,_fe],t=[].concat(...e.map(s=>s.json));this.opMappers=t.reduce((s,i)=>(s[i.tfOpName]=i,s),{})}transformGraph(e,t={}){const s=e.node,i=[],r=[],o=[],a=s.reduce((x,v)=>(x[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?i.push(x[v.name]):v.op==="Const"?r.push(x[v.name]):(v.input==null||v.input.length===0)&&o.push(x[v.name]),x),{});let l=[];const c=[];let h={},f={};t!=null&&(h=this.mapSignatureEntries(t.inputs),f=this.mapSignatureEntries(t.outputs));const p=Object.keys(a);p.forEach(x=>{const v=a[x];v.inputNames.forEach((w,S)=>{const[C,,I]=Ml(w),A=a[C];if(A.outputs!=null){const L=A.outputs.indexOf(I);if(L!==-1){const O=`${C}:${L}`;v.inputNames[S]=O}}v.inputs.push(A),A.children.push(v)})}),Object.keys(f).length===0?p.forEach(x=>{const v=a[x];v.children.length===0&&c.push(v)}):Object.keys(f).forEach(x=>{const[v]=Ml(x),w=a[v];w!=null&&(w.signatureKey=f[x],c.push(w))}),Object.keys(h).length>0?Object.keys(h).forEach(x=>{const[v]=Ml(x),w=a[v];w&&(w.signatureKey=h[x],l.push(w))}):l=i;let g={};e.library!=null&&e.library.function!=null&&(g=e.library.function.reduce((x,v)=>(x[v.signature.name]=this.mapFunction(v),x),{}));const y={nodes:a,inputs:l,outputs:c,weights:r,placeholders:i,signature:t,functions:g};return o.length>0&&(y.initNodes=o),y}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,s)=>(t[e[s].name]=s,t),{})}mapNode(e){const t=$G(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(i=>i.startsWith("^")?i.slice(1):i),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(s.inputParams=t.inputs.reduce((i,r)=>(i[r.name]={type:r.type,inputIndexStart:r.start,inputIndexEnd:r.end},i),{})),t.attrs!=null&&(s.attrParams=t.attrs.reduce((i,r)=>{const o=r.type;let a;switch(r.type){case"string":a=xR(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=xR(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"string[]":a=IR(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=IR(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"number":a=_R(e.attr,r.tfName,r.defaultValue||0),a===void 0&&r.tfDeprecatedName&&(a=_R(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"number[]":a=CR(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=CR(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool":a=wR(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=wR(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool[]":a=NR(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=NR(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape":a=ER(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=ER(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape[]":a=kR(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=kR(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype":a=TR(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=TR(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype[]":a=SR(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=SR(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"func":a=bz(e.attr,r.tfName,r.defaultValue),a===void 0&&r.tfDeprecatedName&&(a=bz(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${r.type} for op: ${e.op}`)}return i[r.name]={value:a,type:o},i},{})),s}mapFunction(e){const t=e.nodeDef,s=[],i=[];let r={};t!=null&&(r=t.reduce((f,p)=>(f[p.name]=this.mapNode(p),p.op==="Const"&&i.push(f[p.name]),f),{}));const o=[],a=[];e.signature.inputArg.forEach(f=>{const[p]=Ml(f.name),g={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:bO(f.type),type:"dtype"}},children:[]};g.signatureKey=f.name,o.push(g),r[p]=g}),Object.keys(r).forEach(f=>{const p=r[f];p.inputNames.forEach((g,y)=>{const[x,,v]=Ml(g),w=r[x];if(w.outputs!=null){const S=w.outputs.indexOf(v);if(S!==-1){const C=`${x}:${S}`;p.inputNames[y]=C}}p.inputs.push(w),w.children.push(p)})});const c=e.ret;e.signature.outputArg.forEach(f=>{const[p,g]=Ml(c[f.name]),y=r[p];y!=null&&(y.defaultOutput=g,a.push(y))});const h=this.mapArgsToSignature(e);return{nodes:r,inputs:o,outputs:a,weights:i,placeholders:s,signature:h}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s),t),{}),outputs:e.signature.outputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s,e.ret),t),{})}}mapArgToTensorInfo(e,t){let s=e.name;return t!=null&&(s=t[s]),{name:s,dtype:e.type}}}function Tfe(n){const e=de().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function OG(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):Tfe(n);return e?t:t.toLowerCase()}function xR(n,e,t,s=!1){const i=n[e];return i!=null?OG(i.s,s):t}function wR(n,e,t){const s=n[e];return s?s.b:t}function _R(n,e,t){const s=n[e]||{},i=s.i!=null?s.i:s.f!=null?s.f:t;return typeof i=="number"?i:parseInt(i,10)}function bO(n){switch(typeof n=="string"&&(n=hr[n]),n){case hr.DT_FLOAT:case hr.DT_HALF:return"float32";case hr.DT_INT32:case hr.DT_INT64:case hr.DT_INT8:case hr.DT_UINT8:return"int32";case hr.DT_BOOL:return"bool";case hr.DT_DOUBLE:return"float32";case hr.DT_STRING:return"string";case hr.DT_COMPLEX64:case hr.DT_COMPLEX128:return"complex64";default:return null}}function bz(n,e,t){const s=n[e];return s&&s.func?s.func.name:t}function TR(n,e,t){const s=n[e];return s&&s.type?bO(s.type):t}function SR(n,e,t){const s=n[e];return s&&s.list&&s.list.type?s.list.type.map(i=>bO(i)):t}function PG(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function ER(n,e,t){const s=n[e];return s&&s.shape?PG(s.shape):t}function CR(n,e,t){const s=n[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(i=>typeof i=="number"?i:parseInt(i,10)):t}function IR(n,e,t,s=!1){const i=n[e];return i&&i.list&&i.list.s?i.list.s.map(r=>OG(r,s)):t}function kR(n,e,t){const s=n[e];return s&&s.list&&s.list.shape?s.list.shape.map(i=>PG(i)):t}function NR(n,e,t){const s=n[e];return s&&s.list&&s.list.b?s.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sfe{constructor(e,t,s){this.node=e,this.tensorMap=t,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(i=>this.getInput(i)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((i,r)=>(i[r]=this.getAttr(r),i),{}))}getInput(e){return Ks(e,this.tensorMap,this.context)}getAttr(e,t){const s=this.node.rawAttrs[e];if(s.tensor!=null)return Ks(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return _R(this.node.rawAttrs,e,t);if(s.s!=null)return xR(this.node.rawAttrs,e,t);if(s.b!=null)return wR(this.node.rawAttrs,e,t);if(s.shape!=null)return ER(this.node.rawAttrs,e,t);if(s.type!=null)return TR(this.node.rawAttrs,e,t);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return CR(this.node.rawAttrs,e,t);if(s.list.s!=null)return IR(this.node.rawAttrs,e,t);if(s.list.shape!=null)return kR(this.node.rawAttrs,e,t);if(s.list.b!=null)return NR(this.node.rawAttrs,e,t);if(s.list.type!=null)return SR(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ni=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:kD,abs:is,acos:OD,acosh:PD,add:ke,addN:V6,all:BE,any:g0,argMax:Fd,argMin:LD,asin:MD,asinh:FD,atan:VD,atan2:zD,atanh:BD,avgPool:cx,avgPool3d:WD,basicLSTMCell:z6,batchNorm:Tg,batchNorm2d:HD,batchNorm3d:jD,batchNorm4d:GD,batchToSpaceND:ux,bincount:qD,bitwiseAnd:B6,booleanMaskAsync:E5,broadcastArgs:U6,broadcastTo:Cd,buffer:ut,cast:De,ceil:KD,clipByValue:tr,clone:Va,complex:nc,concat:Kn,concat1d:XD,concat2d:YD,concat3d:QD,concat4d:ZD,conv1d:UE,conv2d:sc,conv2dTranspose:WE,conv3d:e$,conv3dTranspose:t$,cos:hx,cosh:HE,cosineWindow:pC,cumprod:v0,cumsum:jE,denseBincount:uT,depthToSpace:n$,depthwiseConv2d:Sg,diag:H6,dilation2d:s$,div:qe,divNoNan:i$,dot:r$,dropout:$$,einsum:hd,elu:Eg,enclosingPowerOfTwo:O$,ensureShape:j6,equal:So,erf:GE,euclideanNorm:a$,exp:nr,expandDims:ui,expm1:l$,eye:qE,fft:Tx,fill:hf,floor:Ig,floorDiv:zE,fused:O5,gather:kg,gatherND:N5,greater:rr,greaterEqual:bc,ifft:nm,imag:dx,image:yo,inTopKAsync:A5,irfft:lC,isFinite:c$,isInf:u$,isNaN:h$,leakyRelu:fx,less:Zp,lessEqual:lh,linalg:M$,linspace:K6,localResponseNormalization:d$,log:br,log1p:px,logSigmoid:f$,logSoftmax:XE,logSumExp:mx,logicalAnd:ea,logicalNot:gx,logicalOr:YE,logicalXor:p$,losses:B5,lowerBound:Y6,matMul:pt,max:Fr,maxPool:yx,maxPool3d:m$,maxPoolWithArgmax:Q6,maximum:il,mean:Rn,meshgrid:Z6,min:Qp,minimum:Bu,mirrorPad:g$,mod:y$,moments:bx,movingAverage:C5,mul:Y,multiRNNCell:J6,multinomial:e5,neg:gn,norm:Cg,notEqual:Bd,oneHot:Jp,ones:Yi,onesLike:vr,op:X,outerProduct:t5,pad:vc,pad1d:n5,pad2d:s5,pad3d:i5,pad4d:r5,pool:b$,pow:Za,prelu:xx,print:$D,prod:v$,raggedGather:o5,raggedRange:a5,raggedTensorToTensor:l5,rand:c5,randomGamma:d5,randomNormal:JE,randomStandardNormal:f5,randomUniform:ch,randomUniformInt:p5,range:Ud,real:em,reciprocal:T$,relu:oa,relu6:eC,reshape:te,reverse:Wr,reverse1d:m5,reverse2d:g5,reverse3d:y5,reverse4d:b5,rfft:Sx,round:tC,rsqrt:nC,scalar:Qe,scatterND:I5,searchSorted:QE,selu:sC,separableConv2d:iC,setdiff1dAsync:v5,sigmoid:Yo,sign:S$,signal:z5,sin:rC,sinh:oC,slice:St,slice1d:wx,slice2d:aC,slice3d:_x,slice4d:tm,softmax:Ng,softplus:df,spaceToBatchND:vx,sparse:U5,sparseToDense:k5,spectral:V5,split:Zi,sqrt:Os,square:rn,squaredDifference:cC,squeeze:xc,stack:sr,step:ff,stridedSlice:E$,string:W5,sub:Be,sum:We,tan:C$,tanh:zu,tensor:_o,tensor1d:fi,tensor2d:Mp,tensor3d:I$,tensor4d:x5,tensor5d:w5,tensor6d:_5,tensorScatterUpdate:T5,tile:Or,topk:N$,transpose:Et,truncatedNormal:hC,unique:A$,unsortedSegmentSum:dC,unstack:Hr,upperBound:S5,variable:R$,where:Qs,whereAsync:D$,zeros:qn,zerosLike:kt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Efe=(n,e,t,s=ni)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(P("a",n,e,t),P("b",n,e,t))];case"AddN":return[s.addN(P("tensors",n,e,t))];case"FloorMod":case"Mod":return[s.mod(P("a",n,e,t),P("b",n,e,t))];case"Mul":return[s.mul(P("a",n,e,t),P("b",n,e,t))];case"RealDiv":case"Div":return[s.div(P("a",n,e,t),P("b",n,e,t))];case"DivNoNan":return[s.divNoNan(P("a",n,e,t),P("b",n,e,t))];case"FloorDiv":return[s.floorDiv(P("a",n,e,t),P("b",n,e,t))];case"Sub":return[s.sub(P("a",n,e,t),P("b",n,e,t))];case"Minimum":return[s.minimum(P("a",n,e,t),P("b",n,e,t))];case"Maximum":return[s.maximum(P("a",n,e,t),P("b",n,e,t))];case"Pow":return[s.pow(P("a",n,e,t),P("b",n,e,t))];case"SquaredDifference":return[s.squaredDifference(P("a",n,e,t),P("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cfe=(n,e,t,s=ni)=>{switch(n.op){case"Abs":case"ComplexAbs":return[s.abs(P("x",n,e,t))];case"Acos":return[s.acos(P("x",n,e,t))];case"Acosh":return[s.acosh(P("x",n,e,t))];case"Asin":return[s.asin(P("x",n,e,t))];case"Asinh":return[s.asinh(P("x",n,e,t))];case"Atan":return[s.atan(P("x",n,e,t))];case"Atan2":return[s.atan2(P("x",n,e,t),P("y",n,e,t))];case"Atanh":return[s.atanh(P("x",n,e,t))];case"Ceil":return[s.ceil(P("x",n,e,t))];case"Complex":return[s.complex(P("real",n,e,t),P("imag",n,e,t))];case"Cos":return[s.cos(P("x",n,e,t))];case"Cosh":return[s.cosh(P("x",n,e,t))];case"Elu":return[s.elu(P("x",n,e,t))];case"Erf":return[s.erf(P("x",n,e,t))];case"Exp":return[s.exp(P("x",n,e,t))];case"Expm1":return[s.expm1(P("x",n,e,t))];case"Floor":return[s.floor(P("x",n,e,t))];case"Log":return[s.log(P("x",n,e,t))];case"Log1p":return[s.log1p(P("x",n,e,t))];case"Imag":return[s.imag(P("x",n,e,t))];case"Neg":return[s.neg(P("x",n,e,t))];case"Reciprocal":return[s.reciprocal(P("x",n,e,t))];case"Real":return[s.real(P("x",n,e,t))];case"Relu":return[s.relu(P("x",n,e,t))];case"Round":return[s.round(P("x",n,e,t))];case"Selu":return[s.selu(P("x",n,e,t))];case"Sigmoid":return[s.sigmoid(P("x",n,e,t))];case"Sin":return[s.sin(P("x",n,e,t))];case"Sign":return[s.sign(P("x",n,e,t))];case"Sinh":return[s.sinh(P("x",n,e,t))];case"Softplus":return[s.softplus(P("x",n,e,t))];case"Sqrt":return[s.sqrt(P("x",n,e,t))];case"Square":return[s.square(P("x",n,e,t))];case"Tanh":return[s.tanh(P("x",n,e,t))];case"Tan":return[s.tan(P("x",n,e,t))];case"ClipByValue":return[s.clipByValue(P("x",n,e,t),P("clipValueMin",n,e,t),P("clipValueMax",n,e,t))];case"Relu6":return[s.relu6(P("x",n,e,t))];case"Rsqrt":return[s.rsqrt(Ks(n.inputNames[0],e,t))];case"LeakyRelu":return[s.leakyRelu(P("x",n,e,t),P("alpha",n,e,t))];case"Prelu":return[s.prelu(P("x",n,e,t),P("alpha",n,e,t))];case"IsNan":return[s.isNaN(Ks(n.inputNames[0],e,t))];case"IsInf":return[s.isInf(Ks(n.inputNames[0],e,t))];case"IsFinite":return[s.isFinite(Ks(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mo(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){B(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let s=0;s<n.length;s++){const i=n[s],r=e[s];B(i<0||r<0||i===r,()=>t+` Shapes ${n} and ${e} must match`)}}}function vz(n){return!(typeof n=="number"||n.some(e=>e<0))}function ub(n,e,t){let s=AR(n,t);const i=!vz(s);if(i&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(i&&e.forEach(r=>{s=AR(r.shape,s)}),!vz(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function AR(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let s=0;s<n.length;++s){const i=n[s],r=e[s];if(i>=0&&r>=0&&i!==r)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[s]=i>=0?i:r}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ife{constructor(e,t,s,i,r,o,a){this.name=e,this.dtype=t,this.maxSize=s,this.elementShape=i,this.identicalElementShapes=r,this.dynamicSize=o,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=Qe(0),ms(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),mo(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=t,ms(t),s.written=!0,this.tensors[e]=s}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((s,i)=>this.write(s,t[i]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let i=0;i<this.size();i++)e.push(i)}if(e.length===0)return _o([],[0].concat(this.elementShape));const s=this.readMany(e);return mo(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),sr(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return _o([],[0].concat(this.elementShape));const t=[];for(let i=0;i<this.size();i++)t.push(i);const s=this.readMany(t);return mo(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Kn(s,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,Hr(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let s=0;const i=e.map(l=>(s+=l,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const r=s===0?0:t.size/s,o=[];ce(()=>{t=te(t,[1,s,r]);for(let l=0;l<e.length;++l){const h=[0,l===0?0:i[l-1],0],f=[1,e[l],r];o[l]=te(St(t,h,f),this.elementShape)}return o});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hd{get id(){return this.idTensor.id}constructor(e,t,s,i=-1){this.tensors=e,this.elementShape=t,this.elementDtype=s,e!=null&&e.forEach(r=>{if(s!==r.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${r.dtype}`);mo(t,r.shape,"TensorList shape mismatch: "),ms(r)}),this.idTensor=Qe(0),this.maxNumElements=i,ms(this.idTensor)}copy(){return new Hd([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,s=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);mo(e,this.elementShape,"TensorList shape mismatch: ");const i=ub(this.elementShape,this.tensors,e);return ce(()=>{const r=this.tensors.map(o=>te(o,i));return sr(r,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=ub(this.elementShape,this.tensors,e),i=this.tensors.pop();return i.kept=!1,mo(i.shape,e,"TensorList shape mismatch: "),te(i,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(mo(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");ms(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new Hd([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)t.tensors[s]=this.tensors[s];return t}getItem(e,t,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);mo(this.tensors[e].shape,t,"TensorList shape mismatch: ");const i=ub(this.elementShape,this.tensors,t);return te(this.tensors[e],i)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);mo(this.elementShape,t.shape,"TensorList shape mismatch: "),ms(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,s){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);mo(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const i=ub(this.elementShape,this.tensors,s);return e.length===0?_o([],[0].concat(i)):ce(()=>{const r=e.map(o=>te(this.tensors[o],i));return sr(r,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);mo(this.elementShape,t,"TensorList shape mismatch: ");const s=ub(this.elementShape,this.tensors,t);return this.size()===0?_o([],[0].concat(s)):ce(()=>{const i=this.tensors.map(r=>te(r,s));return Kn(i,0)})}}function kfe(n,e,t){const s=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const i=n.shape.slice(1);mo(i,e,"TensorList shape mismatch: ");const r=Hr(n);return new Hd(r,e,s)}function Nfe(n,e,t,s){return new Hd([],n,e,s)}function Afe(n,e,t,s){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const i=Math.max(...e);if(s!=null&&s!==-1&&i>=s)throw new Error(`Max index must be < array size (${i}  vs. ${s})`);const r=new Hd([],t,n.dtype,s),o=Hr(n,0);return e.forEach((a,l)=>{r.setItem(a,o[l])}),r}function Rfe(n,e,t){let s=0;const i=e.map(h=>(s+=h,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);const r=n.shape.slice(1),o=AR(r,t),a=s===0?0:n.size/s,l=ce(()=>{const h=[];n=te(n,[1,s,a]);for(let f=0;f<e.length;++f){const g=[0,f===0?0:i[f-1],0],y=[1,e[f],a];h[f]=te(St(n,g,y),o)}return n.dispose(),h}),c=new Hd([],t,n.dtype,e.length);for(let h=0;h<l.length;h++)c.setItem(h,l[h]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dfe=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const s=P("thenBranch",n,e,t),i=P("elseBranch",n,e,t),r=P("cond",n,e,t),o=P("args",n,e,t);return(await r.data())[0]?t.functionMap[s].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap):t.functionMap[i].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const s=P("body",n,e,t),i=P("cond",n,e,t),r=P("args",n,e,t),o=await t.functionMap[i].executeFunctionAsync(r,t.tensorArrayMap,t.tensorListMap),a=r.map(h=>h.id);let l=await o[0].data();o.forEach(h=>{!h.kept&&a.indexOf(h.id)===-1&&h.dispose()});let c=r;for(;l[0];){const h=c;c=await t.functionMap[s].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);const f=c.map(g=>g.id);h.forEach(g=>{!g.kept&&a.indexOf(g.id)===-1&&f.indexOf(g.id)===-1&&g.dispose()});const p=await t.functionMap[i].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);l=await p[0].data(),p.forEach(g=>{!g.kept&&a.indexOf(g.id)===-1&&f.indexOf(g.id)===-1&&g.dispose()})}return c}case"LoopCond":{const s=P("pred",n,e,t);return[Fl(s)]}case"Switch":{const s=P("pred",n,e,t);let i=P("data",n,e,t);return i.kept||(i=Fl(i)),(await s.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const s=n.inputNames.find(i=>Ks(i,e,t)!==void 0);if(s){const i=Ks(s,e,t);return[Fl(i)]}return}case"Enter":{const s=P("frameName",n,e,t),i=P("tensor",n,e,t);return t.enterFrame(s),[Fl(i)]}case"Exit":{const s=P("tensor",n,e,t);return t.exitFrame(),[Fl(s)]}case"NextIteration":{const s=P("tensor",n,e,t);return t.nextIteration(),[Fl(s)]}case"TensorArrayV3":{const s=P("size",n,e,t),i=P("dtype",n,e,t),r=P("elementShape",n,e,t),o=P("dynamicSize",n,e,t),a=P("clearAfterRead",n,e,t),l=P("identicalElementShapes",n,e,t),c=P("name",n,e,t),h=new Ife(c,i,s,r,l,o,a);return t.addTensorArray(h),[h.idTensor,Qe(1)]}case"TensorArrayWriteV3":{const s=P("tensorArrayId",n,e,t),i=P("index",n,e,t),r=P("tensor",n,e,t),o=t.getTensorArray(s.id);return o.write(i,r),[o.idTensor]}case"TensorArrayReadV3":{const s=P("tensorArrayId",n,e,t),i=P("index",n,e,t);return[t.getTensorArray(s.id).read(i)]}case"TensorArrayGatherV3":{const s=P("tensorArrayId",n,e,t),i=P("indices",n,e,t),r=P("dtype",n,e,t);return[t.getTensorArray(s.id).gather(i,r)]}case"TensorArrayScatterV3":{const s=P("tensorArrayId",n,e,t),i=P("indices",n,e,t),r=P("tensor",n,e,t),o=t.getTensorArray(s.id);return o.scatter(i,r),[o.idTensor]}case"TensorArrayConcatV3":{const s=P("tensorArrayId",n,e,t),i=t.getTensorArray(s.id),r=P("dtype",n,e,t);return[i.concat(r)]}case"TensorArraySplitV3":{const s=P("tensorArrayId",n,e,t),i=P("tensor",n,e,t),r=P("lengths",n,e,t),o=t.getTensorArray(s.id);return o.split(r,i),[o.idTensor]}case"TensorArraySizeV3":{const s=P("tensorArrayId",n,e,t),i=t.getTensorArray(s.id);return[Qe(i.size(),"int32")]}case"TensorArrayCloseV3":{const s=P("tensorArrayId",n,e,t),i=t.getTensorArray(s.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const s=P("tensorListId",n,e,t),i=P("index",n,e,t),r=P("tensor",n,e,t),o=t.getTensorList(s.id);return o.setItem(i,r),[o.idTensor]}case"TensorListGetItem":{const s=P("tensorListId",n,e,t),i=P("index",n,e,t),r=P("elementShape",n,e,t),o=P("elementDType",n,e,t);return[t.getTensorList(s.id).getItem(i,r,o)]}case"TensorListScatterV2":case"TensorListScatter":{const s=P("indices",n,e,t),i=P("tensor",n,e,t),r=P("elementShape",n,e,t),o=P("numElements",n,e,t),a=Afe(i,s,r,o);return t.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=P("elementShape",n,e,t),i=P("elementDType",n,e,t);let r;n.op==="TensorListReserve"?r="numElements":r="maxNumElements";const o=P(r,n,e,t),a=n.op==="TensorListReserve"?-1:o,l=Nfe(s,i,o,a);return t.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=P("tensorListId",n,e,t),i=P("indices",n,e,t),r=P("elementShape",n,e,t),o=P("elementDType",n,e,t);return[t.getTensorList(s.id).gather(i,o,r)]}case"TensorListStack":{const s=P("tensorListId",n,e,t),i=P("elementShape",n,e,t),r=P("elementDType",n,e,t),o=P("numElements",n,e,t);return[t.getTensorList(s.id).stack(i,r,o)]}case"TensorListFromTensor":{const s=P("tensor",n,e,t),i=P("elementShape",n,e,t),r=P("elementDType",n,e,t),o=kfe(s,i,r);return t.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=P("tensorListId",n,e,t),i=t.getTensorList(s.id),r=P("dtype",n,e,t),o=P("elementShape",n,e,t);return[i.concat(r,o)]}case"TensorListPushBack":{const s=P("tensorListId",n,e,t),i=P("tensor",n,e,t),r=t.getTensorList(s.id);return r.pushBack(i),[r.idTensor]}case"TensorListPopBack":{const s=P("tensorListId",n,e,t),i=P("elementShape",n,e,t),r=P("elementDType",n,e,t);return[t.getTensorList(s.id).popBack(i,r)]}case"TensorListSplit":{const s=P("tensor",n,e,t),i=P("elementShape",n,e,t),r=P("lengths",n,e,t),o=Rfe(s,r,i);return t.addTensorList(o),[o.idTensor]}case"TensorListLength":{const s=P("tensorListId",n,e,t),i=t.getTensorList(s.id);return[Qe(i.size(),"int32")]}case"TensorListResize":{const s=P("tensorListId",n,e,t),i=P("size",n,e,t),o=t.getTensorList(s.id).resize(i);return t.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(n,e,t){const[s,i]=P("fusedOps",n,e,t),r=s==="biasadd",o=!r,a=i==="prelu",l=s==="fusedbatchnorm",c=P("numArgs",n,e,t);if(r){if(a&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&r&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const h=P("strides",n,e,t),f=A1(n,e,t),p=P("dataFormat",n,e,t).toUpperCase(),g=P("dilations",n,e,t);let[y,x]=P("args",n,e,t);o&&(x=y,y=void 0);const v=P("leakyreluAlpha",n,e,t);return{stride:h,pad:f,dataFormat:p,dilations:g,biasArg:y,preluArg:x,activationFunc:i,leakyreluAlpha:v}}const $fe=(n,e,t,s=ni)=>{switch(n.op){case"Conv1D":{const i=P("stride",n,e,t),r=P("pad",n,e,t),o=P("dataFormat",n,e,t).toUpperCase(),a=P("dilation",n,e,t);return[s.conv1d(P("x",n,e,t),P("filter",n,e,t),i,r,o,a)]}case"Conv2D":{const i=P("strides",n,e,t),r=A1(n,e,t),o=P("dataFormat",n,e,t).toUpperCase(),a=P("dilations",n,e,t);return[s.conv2d(P("x",n,e,t),P("filter",n,e,t),[i[1],i[2]],r,o,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:i,pad:r,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:h,leakyreluAlpha:f}=xz(n,e,t);return[s.fused.conv2d({x:P("x",n,e,t),filter:P("filter",n,e,t),strides:[i[1],i[2]],pad:r,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:h,preluActivationWeights:c,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:r,dataFormat:o,dilations:a,biasArg:l,preluArg:c,activationFunc:h,leakyreluAlpha:f}=xz(n,e,t);return[s.fused.depthwiseConv2d({x:P("x",n,e,t),filter:P("filter",n,e,t),strides:[i[1],i[2]],pad:r,dataFormat:o,dilations:[a[1],a[2]],bias:l,activation:h,preluActivationWeights:c,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=P("outputShape",n,e,t),r=P("strides",n,e,t),o=A1(n,e,t);return[s.conv2dTranspose(P("x",n,e,t),P("filter",n,e,t),i,[r[1],r[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=P("strides",n,e,t),r=A1(n,e,t),o=P("dilations",n,e,t),a=P("dataFormat",n,e,t).toUpperCase();return[s.depthwiseConv2d(P("input",n,e,t),P("filter",n,e,t),[i[1],i[2]],r,a,[o[1],o[2]])]}case"Conv3D":{const i=P("strides",n,e,t),r=P("pad",n,e,t),o=P("dataFormat",n,e,t).toUpperCase(),a=P("dilations",n,e,t);return[s.conv3d(P("x",n,e,t),P("filter",n,e,t),[i[1],i[2],i[3]],r,o,[a[1],a[2],a[3]])]}case"AvgPool":{const i=P("strides",n,e,t),r=P("pad",n,e,t),o=P("kernelSize",n,e,t);return[s.avgPool(P("x",n,e,t),[o[1],o[2]],[i[1],i[2]],r)]}case"MaxPool":{const i=P("strides",n,e,t),r=P("pad",n,e,t),o=P("kernelSize",n,e,t);return[s.maxPool(P("x",n,e,t),[o[1],o[2]],[i[1],i[2]],r)]}case"MaxPoolWithArgmax":{const i=P("strides",n,e,t),r=P("pad",n,e,t),o=P("kernelSize",n,e,t),a=P("includeBatchInIndex",n,e,t),{result:l,indexes:c}=s.maxPoolWithArgmax(P("x",n,e,t),[o[1],o[2]],[i[1],i[2]],r,a);return[l,c]}case"AvgPool3D":{const i=P("strides",n,e,t),r=P("pad",n,e,t),o=P("kernelSize",n,e,t);return[s.avgPool3d(P("x",n,e,t),[o[1],o[2],o[3]],[i[1],i[2],i[3]],r)]}case"MaxPool3D":{const i=P("strides",n,e,t),r=P("pad",n,e,t),o=P("kernelSize",n,e,t);return[s.maxPool3d(P("x",n,e,t),[o[1],o[2],o[3]],[i[1],i[2],i[3]],r)]}case"Dilation2D":{const i=P("strides",n,e,t),r=P("pad",n,e,t),o=P("dilations",n,e,t),a=i[1],l=i[2],c=o[1],h=o[2];return[s.dilation2d(P("x",n,e,t),P("filter",n,e,t),[a,l],r,[c,h],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ofe=(n,e,t,s=ni)=>{switch(n.op){case"Fill":{const i=P("shape",n,e,t),r=P("dtype",n,e,t),o=P("value",n,e,t);return[s.fill(i,o,r)]}case"LinSpace":{const i=P("start",n,e,t),r=P("stop",n,e,t),o=P("num",n,e,t);return[s.linspace(i,r,o)]}case"Multinomial":{const i=P("logits",n,e,t),r=P("numSamples",n,e,t),o=P("seed",n,e,t);return[s.multinomial(i,r,o)]}case"OneHot":{const i=P("indices",n,e,t),r=P("depth",n,e,t),o=P("onValue",n,e,t),a=P("offValue",n,e,t),l=P("dtype",n,e,t);return[s.oneHot(i,r,o,a,l)]}case"Ones":return[s.ones(P("shape",n,e,t),P("dtype",n,e,t))];case"OnesLike":return[s.onesLike(P("x",n,e,t))];case"RandomStandardNormal":return[s.randomStandardNormal(P("shape",n,e,t),P("dtype",n,e,t),P("seed",n,e,t))];case"RandomUniform":return[s.randomUniform(P("shape",n,e,t),P("minval",n,e,t),P("maxval",n,e,t),P("dtype",n,e,t))];case"RandomUniformInt":return[s.randomUniformInt(P("shape",n,e,t),P("minval",n,e,t),P("maxval",n,e,t),P("seed",n,e,t))];case"Range":{const i=P("start",n,e,t),r=P("stop",n,e,t),o=P("step",n,e,t);return[s.range(i,r,o,P("dtype",n,e,t))]}case"TruncatedNormal":{const i=P("shape",n,e,t),r=P("mean",n,e,t),o=P("stdDev",n,e,t),a=P("seed",n,e,t);return[s.truncatedNormal(i,r,o,P("dtype",n,e,t),a)]}case"Zeros":return[s.zeros(P("shape",n,e,t),P("dtype",n,e,t))];case"ZerosLike":return[s.zerosLike(P("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WN(n,e,t){const s=P("boxes",n,e,t),i=P("scores",n,e,t),r=P("maxOutputSize",n,e,t),o=P("iouThreshold",n,e,t),a=P("scoreThreshold",n,e,t),l=P("softNmsSigma",n,e,t);return{boxes:s,scores:i,maxOutputSize:r,iouThreshold:o,scoreThreshold:a,softNmsSigma:l}}const Pfe=async(n,e,t,s,i=ni)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c,softNmsSigma:h}=WN(n,e,t),f=await i.image.nonMaxSuppressionWithScoreAsync(r,o,a,l,c,h);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=WN(n,e,t),h=P("padToMaxOutputSize",n,e,t),f=await i.image.nonMaxSuppressionPaddedAsync(r,o,a,l,c,h);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:o,maxOutputSize:a,iouThreshold:l,scoreThreshold:c}=WN(n,e,t);return[await i.image.nonMaxSuppressionAsync(r,o,a,l,c)]}case"Where":{const r=i.cast(P("condition",n,e,t),"bool"),o=[await i.whereAsync(r)];return r.dispose(),o}case"ListDiff":return i.setdiff1dAsync(P("x",n,e,t),P("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lfe=(n,e,t,s=ni)=>{switch(n.op){case"LowerBound":{const i=P("sortedSequence",n,e,t),r=P("values",n,e,t);return[s.lowerBound(i,r)]}case"TopKV2":{const i=P("x",n,e,t),r=P("k",n,e,t),o=P("sorted",n,e,t),a=s.topk(i,r,o);return[a.values,a.indices]}case"UpperBound":{const i=P("sortedSequence",n,e,t),r=P("values",n,e,t);return[s.upperBound(i,r)]}case"Unique":{const i=P("x",n,e,t),r=s.unique(i);return[r.values,r.indices]}case"UniqueV2":{const i=P("x",n,e,t),r=P("axis",n,e,t),o=s.unique(i,r);return[o.values,o.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mfe=(n,e,t,s=ni)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const i=P("default",n,e,t);return[Ks(n.name,e,t)||i];case"Placeholder":return[Ks(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const h=P("x",n,e,t);return[Fl(h)]}case"IdentityN":return P("x",n,e,t).map(h=>Fl(h));case"Snapshot":const r=P("x",n,e,t);return[Fl(r)];case"Shape":return[s.tensor1d(P("x",n,e,t).shape,"int32")];case"ShapeN":return P("x",n,e,t).map(h=>s.tensor1d(h.shape));case"Size":return[s.scalar(P("x",n,e,t).size,"int32")];case"Rank":return[s.scalar(P("x",n,e,t).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const o=P("x",n,e,t),a=P("data",n,e,t),l=P("message",n,e,t),c=P("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let h=0;h<a.length;h++)console.log(Array.prototype.slice.call(a[h].dataSync()).slice(0,c));return[o];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ffe{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Qe(0),this.tensorMap=new Map,ms(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Qe(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return this.tensorMap.forEach(i=>i.dispose()),this.tensorMap.clear(),ce(()=>{const i=Hr(t),r=s.length,o=i.length;B(r===o,()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${o} elements.`);for(let a=0;a<r;a++){const l=s[a],c=i[a];ms(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return ce(()=>{const i=[];for(let r=0;r<s.length;r++){const o=s[r],a=this.findWithDefault(o,t);i.push(a)}return sr(i)})}findWithDefault(e,t){const s=this.tensorMap.get(e);return s??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vfe=async(n,e,t,s)=>{switch(n.op){case"HashTable":case"HashTableV2":{const i=s.getHashTableHandleByName(n.name);if(i!=null)return[i];{const r=P("keyDType",n,e,t),o=P("valueDType",n,e,t),a=new Ffe(r,o);return s.addHashTable(n.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const i=P("tableHandle",n,e,t,s),r=P("keys",n,e,t),o=P("values",n,e,t);return[await s.getHashTableById(i.id).import(r,o)]}case"LookupTableFind":case"LookupTableFindV2":{const i=P("tableHandle",n,e,t,s),r=P("keys",n,e,t),o=P("defaultValue",n,e,t);return[await s.getHashTableById(i.id).find(r,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const i=P("tableHandle",n,e,t,s);return[s.getHashTableById(i.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zfe=(n,e,t,s=ni)=>{switch(n.op){case"ResizeBilinear":{const i=P("images",n,e,t),r=P("size",n,e,t),o=P("alignCorners",n,e,t),a=P("halfPixelCenters",n,e,t);return[s.image.resizeBilinear(i,[r[0],r[1]],o,a)]}case"ResizeNearestNeighbor":{const i=P("images",n,e,t),r=P("size",n,e,t),o=P("alignCorners",n,e,t),a=P("halfPixelCenters",n,e,t);return[s.image.resizeNearestNeighbor(i,[r[0],r[1]],o,a)]}case"CropAndResize":{const i=P("image",n,e,t),r=P("boxes",n,e,t),o=P("boxInd",n,e,t),a=P("cropSize",n,e,t),l=P("method",n,e,t),c=P("extrapolationValue",n,e,t);return[s.image.cropAndResize(i,r,o,a,l,c)]}case"ImageProjectiveTransformV3":{const i=P("images",n,e,t),r=P("transforms",n,e,t),o=P("outputShape",n,e,t),a=P("fillValue",n,e,t),l=P("interpolation",n,e,t),c=P("fillMode",n,e,t);return[s.image.transform(i,r,l.toLowerCase(),c.toLowerCase(),a,o)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe=(n,e,t,s=ni)=>{switch(n.op){case"Equal":return[s.equal(P("a",n,e,t),P("b",n,e,t))];case"NotEqual":return[s.notEqual(P("a",n,e,t),P("b",n,e,t))];case"Greater":return[s.greater(P("a",n,e,t),P("b",n,e,t))];case"GreaterEqual":return[s.greaterEqual(P("a",n,e,t),P("b",n,e,t))];case"Less":return[s.less(P("a",n,e,t),P("b",n,e,t))];case"LessEqual":return[s.lessEqual(P("a",n,e,t),P("b",n,e,t))];case"LogicalAnd":return[s.logicalAnd(P("a",n,e,t),P("b",n,e,t))];case"LogicalNot":return[s.logicalNot(P("a",n,e,t))];case"LogicalOr":return[s.logicalOr(P("a",n,e,t),P("b",n,e,t))];case"Select":case"SelectV2":return[s.where(P("condition",n,e,t),P("a",n,e,t),P("b",n,e,t))];case"BitwiseAnd":return[s.bitwiseAnd(P("a",n,e,t),P("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ufe=(n,e,t,s=ni)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(P("a",n,e,t),P("b",n,e,t),P("transposeA",n,e,t),P("transposeB",n,e,t))];case"Einsum":return[s.einsum(P("equation",n,e,t),...P("tensors",n,e,t))];case"Transpose":return[s.transpose(P("x",n,e,t),P("perm",n,e,t))];case"_FusedMatMul":const[i,r]=P("fusedOps",n,e,t),o=i==="biasadd",a=r==="prelu",l=P("numArgs",n,e,t),c=P("leakyreluAlpha",n,e,t);if(o){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[h,f]=P("args",n,e,t);return[s.fused.matMul({a:P("a",n,e,t),b:P("b",n,e,t),transposeA:P("transposeA",n,e,t),transposeB:P("transposeB",n,e,t),bias:h,activation:r,preluActivationWeights:f,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(P("a",n,e,t),P("numLower",n,e,t),P("numUpper",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wfe=(n,e,t,s=ni)=>{switch(n.op){case"EuclideanNorm":return[s.euclideanNorm(P("x",n,e,t),P("axis",n,e,t),P("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(P("x",n,e,t),P("mean",n,e,t),P("variance",n,e,t),P("offset",n,e,t),P("scale",n,e,t),P("epsilon",n,e,t))];case"FusedBatchNormV3":return[s.batchNorm(P("x",n,e,t),P("mean",n,e,t),P("variance",n,e,t),P("offset",n,e,t),P("scale",n,e,t),P("epsilon",n,e,t))];case"LRN":return[s.localResponseNormalization(P("x",n,e,t),P("radius",n,e,t),P("bias",n,e,t),P("alpha",n,e,t),P("beta",n,e,t))];case"Softmax":return[s.softmax(P("x",n,e,t))];case"LogSoftmax":return[s.logSoftmax(P("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hfe=(n,e,t,s=ni)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:i,outputDenseValues:r}=s.raggedGather(P("paramsNestedSplits",n,e,t),P("paramsDenseValues",n,e,t),P("indices",n,e,t),P("outputRaggedRank",n,e,t));return i.concat(r)}case"RaggedRange":{const{rtNestedSplits:i,rtDenseValues:r}=s.raggedRange(P("starts",n,e,t),P("limits",n,e,t),P("splits",n,e,t));return[i,r]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(P("shape",n,e,t),P("values",n,e,t),P("defaultValue",n,e,t),P("rowPartitionTensors",n,e,t),P("rowPartitionTypes",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jfe=(n,e,t,s=ni)=>{switch(n.op){case"Max":{const a=P("axis",n,e,t),l=P("keepDims",n,e,t);return[s.max(P("x",n,e,t),a,l)]}case"Mean":{const a=P("axis",n,e,t),l=P("keepDims",n,e,t);return[s.mean(P("x",n,e,t),a,l)]}case"Min":{const a=P("axis",n,e,t),l=P("keepDims",n,e,t);return[s.min(P("x",n,e,t),a,l)]}case"Sum":{const a=P("axis",n,e,t),l=P("keepDims",n,e,t);return[s.sum(P("x",n,e,t),a,l)]}case"All":{const a=P("axis",n,e,t),l=P("keepDims",n,e,t);return[s.all(P("x",n,e,t),a,l)]}case"Any":{const a=P("axis",n,e,t),l=P("keepDims",n,e,t);return[s.any(P("x",n,e,t),a,l)]}case"ArgMax":{const a=P("axis",n,e,t);return[s.argMax(P("x",n,e,t),a)]}case"ArgMin":{const a=P("axis",n,e,t);return[s.argMin(P("x",n,e,t),a)]}case"Prod":{const a=P("axis",n,e,t),l=P("keepDims",n,e,t);return[s.prod(P("x",n,e,t),a,l)]}case"Cumprod":{const a=P("axis",n,e,t),l=P("exclusive",n,e,t),c=P("reverse",n,e,t);return[s.cumprod(P("x",n,e,t),a,l,c)]}case"Cumsum":{const a=P("axis",n,e,t),l=P("exclusive",n,e,t),c=P("reverse",n,e,t);return[s.cumsum(P("x",n,e,t),a,l,c)]}case"Bincount":const i=P("x",n,e,t),r=P("weights",n,e,t),o=P("size",n,e,t);return[s.bincount(i,r,o)];case"DenseBincount":{const a=P("x",n,e,t),l=P("weights",n,e,t),c=P("size",n,e,t),h=P("binaryOutput",n,e,t);return[s.denseBincount(a,l,c,h)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gfe=(n,e,t,s=ni)=>{switch(n.op){case"ConcatV2":case"Concat":{const i=P("n",n,e,t),r=P("axis",n,e,t);let o=P("tensors",n,e,t);return o=o.slice(0,i),[s.concat(o,r)]}case"Gather":{const i=P("x",n,e,t),r=P("indices",n,e,t);return[s.gather(i,s.cast(r,"int32"),0)]}case"GatherV2":{const i=P("axis",n,e,t),r=P("batchDims",n,e,t),o=P("x",n,e,t),a=P("indices",n,e,t);return[s.gather(o,s.cast(a,"int32"),i,r)]}case"Reverse":{const i=P("dims",n,e,t),r=[];for(let a=0;a<i.length;a++)i[a]&&r.push(a);const o=P("x",n,e,t);return[s.reverse(o,r)]}case"ReverseV2":{const i=P("axis",n,e,t),r=P("x",n,e,t);return[s.reverse(r,i)]}case"Slice":{const i=P("begin",n,e,t),r=P("size",n,e,t);return[s.slice(P("x",n,e,t),i,r)]}case"StridedSlice":{const i=P("begin",n,e,t),r=P("end",n,e,t),o=P("strides",n,e,t),a=P("beginMask",n,e,t),l=P("endMask",n,e,t),c=P("ellipsisMask",n,e,t),h=P("newAxisMask",n,e,t),f=P("shrinkAxisMask",n,e,t),p=P("x",n,e,t);return[s.stridedSlice(p,i,r,o,a,l,c,h,f)]}case"Pack":return ce(()=>{const i=P("axis",n,e,t),r=P("tensors",n,e,t),o=r[0].shape,a=s.squeeze(r[0]).shape,l=r.map(c=>{const h=_t(c.shape,o);if(!h&&!_t(s.squeeze(c).shape,a))throw new Error("the input tensors shape does not match");return h?c:s.reshape(c,o)});return[s.stack(l,i)]});case"Unpack":{const i=P("axis",n,e,t),r=P("tensor",n,e,t);return s.unstack(r,i)}case"Tile":{const i=P("reps",n,e,t);return[s.tile(P("x",n,e,t),i)]}case"Split":case"SplitV":{const i=P("axis",n,e,t),r=P("numOrSizeSplits",n,e,t),o=P("x",n,e,t);return s.split(o,r,i)}case"ScatterNd":{const i=P("indices",n,e,t),r=P("values",n,e,t),o=P("shape",n,e,t);return[s.scatterND(i,r,o)]}case"GatherNd":{const i=P("x",n,e,t),r=P("indices",n,e,t);return[s.gatherND(i,r)]}case"SparseToDense":{const i=P("sparseIndices",n,e,t),r=P("outputShape",n,e,t),o=P("sparseValues",n,e,t),a=P("defaultValue",n,e,t);return[s.sparseToDense(i,o,r,o.dtype===a.dtype?a:s.cast(a,o.dtype))]}case"TensorScatterUpdate":{const i=P("indices",n,e,t),r=P("values",n,e,t),o=P("tensor",n,e,t);return[s.tensorScatterUpdate(o,i,r)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qfe=(n,e,t,s=ni)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:i,outputValues:r,emptyRowIndicator:o,reverseIndexMap:a}=s.sparse.sparseFillEmptyRows(P("indices",n,e,t),P("values",n,e,t),P("denseShape",n,e,t),P("defaultValue",n,e,t));return[i,r,o,a]}case"SparseReshape":{const{outputIndices:i,outputShape:r}=s.sparse.sparseReshape(P("inputIndices",n,e,t),P("inputShape",n,e,t),P("newShape",n,e,t));return[i,r]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(P("data",n,e,t),P("indices",n,e,t),P("segmentIds",n,e,t))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(P("data",n,e,t),P("indices",n,e,t),P("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe=(n,e,t,s=ni)=>{switch(n.op){case"FFT":return[s.fft(P("x",n,e,t))];case"IFFT":return[s.ifft(P("x",n,e,t))];case"RFFT":return[s.rfft(P("x",n,e,t))];case"IRFFT":return[s.irfft(P("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xfe=(n,e,t,s=ni)=>{switch(n.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(P("input",n,e,t),P("pattern",n,e,t),P("rewrite",n,e,t),P("replaceGlobal",n,e,t))];case"StringNGrams":{const{nGrams:i,nGramsSplits:r}=s.string.stringNGrams(P("data",n,e,t),P("dataSplits",n,e,t),P("separator",n,e,t),P("nGramWidths",n,e,t),P("leftPad",n,e,t),P("rightPad",n,e,t),P("padWidth",n,e,t),P("preserveShortSequences",n,e,t));return[i,r]}case"StringSplit":{const{indices:i,values:r,shape:o}=s.string.stringSplit(P("input",n,e,t),P("delimiter",n,e,t),P("skipEmpty",n,e,t));return[i,r,o]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(P("input",n,e,t),P("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yfe=(n,e,t,s=ni)=>{switch(n.op){case"Cast":return[s.cast(P("x",n,e,t),P("dtype",n,e,t))];case"ExpandDims":{const i=P("axis",n,e,t);return[s.expandDims(P("x",n,e,t),i)]}case"Squeeze":{const i=P("axis",n,e,t);return[s.squeeze(P("x",n,e,t),i)]}case"Reshape":return[s.reshape(P("x",n,e,t),P("shape",n,e,t))];case"EnsureShape":return[s.ensureShape(P("x",n,e,t),P("shape",n,e,t))];case"MirrorPad":return[s.mirrorPad(P("x",n,e,t),P("padding",n,e,t),P("mode",n,e,t))];case"PadV2":case"Pad":return[s.pad(P("x",n,e,t),P("padding",n,e,t),P("constantValue",n,e,t))];case"SpaceToBatchND":{const i=P("blockShape",n,e,t),r=P("paddings",n,e,t);return[s.spaceToBatchND(P("x",n,e,t),i,r)]}case"BatchToSpaceND":{const i=P("blockShape",n,e,t),r=P("crops",n,e,t);return[s.batchToSpaceND(P("x",n,e,t),i,r)]}case"DepthToSpace":{const i=P("blockSize",n,e,t),r=P("dataFormat",n,e,t).toUpperCase();return[s.depthToSpace(P("x",n,e,t),i,r)]}case"BroadcastTo":return[s.broadcastTo(P("x",n,e,t),P("shape",n,e,t))];case"BroadcastArgs":return[s.broadcastArgs(P("s0",n,e,t),P("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(n,e,t,s,i=ce){const r=((o,a,l)=>{switch(o.category){case"arithmetic":return i(()=>Efe(o,a,l));case"basic_math":return i(()=>Cfe(o,a,l));case"control":return Dfe(o,a,l);case"convolution":return i(()=>$fe(o,a,l));case"creation":return i(()=>Ofe(o,a,l));case"dynamic":return Pfe(o,a,l);case"evaluation":return i(()=>Lfe(o,a,l));case"image":return i(()=>zfe(o,a,l));case"graph":return i(()=>Mfe(o,a,l));case"logical":return i(()=>Bfe(o,a,l));case"matrices":return i(()=>Ufe(o,a,l));case"normalization":return i(()=>Wfe(o,a,l));case"ragged":return i(()=>Hfe(o,a,l));case"reduction":return i(()=>jfe(o,a,l));case"slice_join":return i(()=>Gfe(o,a,l));case"sparse":return i(()=>qfe(o,a,l));case"spectral":return i(()=>Kfe(o,a,l));case"string":return i(()=>Xfe(o,a,l));case"transformation":return i(()=>Yfe(o,a,l));case"hash_table":return Vfe(o,a,l,s);case"custom":const c=$G(o.op);if(c&&c.customExecutor)return c.customExecutor(new Sfe(o,a,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return Mu(r)?r.then(o=>[].concat(o)):[].concat(r)}class _z{constructor(e={},t={},s={},i={},r){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=s,this.functionMap=i,this.parseNodeNameCache=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const s=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tz(n,e,t,s){const i=new Set,r=[];let o=null,a=null;const l=new Set,c=new Set(Object.keys(n).map(p=>dr(p)[0]));s=s||[];const h=new Set(s.map(p=>dr(p.name)[0])),f=[...e];for(;f.length>0;){const p=f.pop();if((dd(p)||ipe(p)||rpe(p))&&o==null&&(o=p,a=o.children.map(g=>g.name).filter(g=>i.has(g))),i.add(p.name),t[p.name]==null&&!c.has(p.name)&&!h.has(p.name)){if(p.inputs.length===0){r.push(p.name);continue}p.inputs.forEach(g=>{l.has(g.name)||(l.add(g.name),f.push(g))})}}return{inputs:n,outputs:e,usedNodes:i,missingInputs:r,dynamicNode:o,syncInputs:a}}function Qfe(n,e){const{usedNodes:t,inputs:s}=e,i=Object.keys(s).map(v=>dr(v)[0]).map(v=>n.nodes[v]),r=n.initNodes||[],o=v=>t.has(typeof v=="string"?v:v.name);function a(v){return[...new Map(v.map(w=>[w.name,w])).values()]}const l=a([...i,...n.weights,...r]).filter(o),c=a([...l,...Object.values(n.nodes)]).filter(o),h=new Map(c.map(v=>[v.name,v])),f={};for(const v of c){f[v.name]=f[v.name]||0;for(const w of v.children)o(w)||(f[w.name]=Number.POSITIVE_INFINITY),f[w.name]=(f[w.name]||0)+1}const p=Object.entries(f).filter(([,v])=>v===0).map(([v])=>v),g=[...p];for(;p.length>0;){const v=p.pop(),w=h.get(v);for(const S of w.children.filter(o))--f[S.name]===0&&(g.push(S.name),p.push(S.name))}const y=g.map(v=>h.get(v)),x=Zfe(y,l);return Jfe(x,l),x}function Zfe(n,e){const t=new Map(n.map(o=>[o.name,o])),s=e.map(o=>o.name),i=new Set(s);for(;s.length>0;){const o=s.pop(),a=t.get(o);for(const l of a.children)!t.has(l.name)||i.has(l.name)||(i.add(l.name),s.push(l.name))}return n.filter(o=>i.has(o.name))}class $_ extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function Jfe(n,e){const t=new Map(n.map((a,l)=>[a.name,l])),s=new Set(e.map(a=>a.name)),i=a=>s.has(typeof a=="string"?a:a.name),r=new Set(n.map(a=>a.name)),o=a=>r.has(typeof a=="string"?a:a.name);for(const a of n){for(const l of a.children.filter(o)){if(!t.has(l.name))throw new $_(`Child ${l.name} of node ${a.name} is unreachable.`);if(t.get(a.name)>t.get(l.name))throw new $_(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!i(a))for(const l of a.inputs){if(!t.has(l.name))throw new $_(`Input ${l.name} of node ${a.name} is unreachable.`);if(t.get(l.name)>t.get(a.name))throw new $_(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function epe(n){const e=new Map(n.map((a,l)=>[a.name,l])),t=Number.MAX_SAFE_INTEGER,s=n.map((a,l)=>dd(a)?t:l),i=a=>{const l=s[e.get(a.name)];return l??-1},r=n.map((a,l)=>a.children.map(i).reduce((c,h)=>Math.max(c,h),s[l])),o=new Map;for(let a=0;a<n.length;++a){const l=r[a];if(l===t)continue;const c=n[a],h=n[l];o.has(h.name)||o.set(h.name,[]),o.get(h.name).push(c)}return o}const tpe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),npe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),spe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function dd(n){return tpe.has(n.op)}function ipe(n){return npe.has(n.op)}function rpe(n){return spe.has(n.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dT{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(s=>e[s].map(i=>i.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new dT(e.functions[s],this)})}getCompilationKey(e,t){const s=e.map(r=>r.name).sort(),i=t.map(r=>r.name).sort();return s.join(this.SEPARATOR)+"--"+i.join(this.SEPARATOR)}compile(e,t){const s=Tz(e,t,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:r,syncInputs:o}=s;if(r!=null)throw new Error(`This execution contains the node '${r.name}', which has the dynamic op '${r.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(i.length>0){const c=t.map(f=>f.name),h=Object.keys(e);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${h}]. Missing the following inputs: [${i}]`)}const a=Qfe(this.graph,s),l=epe(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const t=e.clone();return ms(t),t}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,s])=>[t,this.cloneTensorList(s)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const i=s.map(p=>this.graph.nodes[dr(p)[0]]),r=t.map(p=>dr(p)[0]),o=new Set(r);let a=r.map(p=>this.graph.nodes[p]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(i,a);let c=this.compiledMap.get(l);c==null&&(c=this.compile(e,a),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=de().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const h={},f={};return ce(()=>{const p=new _z(this.weightMap,h,f,this.functionExecutorMap,this.parseNodeNameCache),g=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(w=>{const[S,C]=dr(w,p),I=[];I[C]=e[w],g[S]=I,this.keepIntermediateTensors&&(this.clonedTensorsMap[S]=this.cloneTensorList(I))});const y=this.getFrozenTensorIds(g),{orderedNodes:x,nodeLiveUntilMap:v}=c;for(const w of x){if(g[w.name])continue;const S=wz(w,g,p,this._resourceManager);if(Mu(S))throw new Error(`The execution of the op '${w.op}' returned a promise. Please use model.executeAsync() instead.`);g[w.name]=S,this.keepIntermediateTensors&&(this.clonedTensorsMap[w.name]=this.cloneTensorList(S)),this.checkTensorForDisposalWithNodeLiveUntilInfo(w,g,p,y,o,v.get(w.name))}return this.parent==null&&p.dispose(y),t.map(w=>Ks(w,g,p))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(i=>i.id)));return new Set(t)}checkTensorForDisposal(e,t,s,i,r,o,a){if(!(dd(t)||o.has(e))){for(const l of s[e])l!=null&&(a[l.id]=(a[l.id]||0)+t.children.length);for(const l of t.inputs){if(dd(l))continue;const c=gz(l.name,s,i);if(c!=null)for(const h of c){if(!h||h.kept||r.has(h.id))continue;const f=a[h.id];f===1?(h.dispose(),delete a[h.id]):f!=null&&a[h.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,s,i,r,o){function a(l){return dd(l)||r.has(l.name)}if(!(dd(e)||o==null))for(const l of o){if(a(l))continue;const c=gz(l.name,t,s);for(const h of c)!h||h.kept||i.has(h.id)||h.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,s=!1,i={},r={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=de().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const o=new _z(this.weightMap,i,r,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,o,t,s),l=t.map(p=>Ks(p,a,o)),c=l.map(p=>p.id),h=Object.keys(e).map(p=>e[p].id),f=new Set([...c,...h,...this.weightIds]);return Object.values(a).forEach(p=>{p.forEach(g=>{g&&!g.isDisposed&&!f.has(g.id)&&g.dispose()})}),this.parent==null&&o.dispose(f),l}async executeFunctionAsync(e,t,s){const i=e.reduce((r,o,a)=>(r[this.inputs[a].name]=o,r),{});return this._executeAsync(i,this.outputNodes,!0,t,s)}async executeWithControlFlow(e,t,s,i){const r=Object.keys(e),o=r.map(I=>this.graph.nodes[dr(I)[0]]),a=s.map(I=>dr(I)[0]),l=new Set(a);let c=a.map(I=>this.graph.nodes[I]);c.length===0&&(c=this._outputs);const{usedNodes:h,missingInputs:f,dynamicNode:p,syncInputs:g}=Tz(e,c,this.weightMap,this._initNodes),y=[...o,...this.graph.weights,...this._initNodes||[]].map(I=>({node:I,contexts:t.currentContext})),x=Object.assign({},this.weightMap);Object.keys(e).forEach(I=>{const[A,L]=dr(I),O=[];O[L]=e[I],x[A]=O});const v={},w=this.getFrozenTensorIds(x),S={};for(;y.length>0;){const I=this.processStack(o,y,t,x,S,w,l,v,h);await Promise.all(I)}p==null&&!i&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const C=c.filter(I=>!dd(I)&&!Ks(I.name,x,t)).map(I=>I.name);if(C.length>0){let I="";throw p!=null&&(I=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${g}]`),new Error(`Cannot compute the outputs [${C}] from the provided inputs [${r}]. Consider providing the following inputs: [${f}]. ${I}`)}return x}processStack(e,t,s,i,r,o,a,l,c){const h=[];for(;t.length>0;){const f=t.pop();s.currentContext=f.contexts;let p="";if(f.node.op==="Enter"&&P("isConstant",f.node,i,s)&&([p]=Ml(f.node.name,s)),i[f.node.name]==null){const g=wz(f.node,i,s,this._resourceManager);p||([p]=Ml(f.node.name,s));const y=s.currentContext;Mu(g)?h.push(g.then(x=>(i[p]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(x)),s.currentContext=y,this.checkTensorForDisposal(p,f.node,i,s,o,a,l),this.processChildNodes(f.node,t,s,i,r,c),x))):(i[p]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(g)),this.checkTensorForDisposal(p,f.node,i,s,o,a,l),this.processChildNodes(f.node,t,s,i,r,c))}else this.processChildNodes(f.node,t,s,i,r,c)}return h}processChildNodes(e,t,s,i,r,o){e.children.forEach(a=>{const[l]=Ml(a.name,s);r[l]||!o.has(a.name)||(a.op==="Merge"?a.inputNames.some(c=>!!Ks(c,i,s))&&(r[l]=!0,t.push({contexts:s.currentContext,node:a})):a.inputNames.every(c=>!!Ks(c,i,s))&&(r[l]=!0,t.push({contexts:s.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const s=e[t],[i]=dr(t),r=this.graph.nodes[i];if(r.attrParams.shape&&r.attrParams.shape.value){const o=r.attrParams.shape.value,a=o.length===s.shape.length&&s.shape.every((l,c)=>o[c]===-1||o[c]===l);B(a,()=>`The shape of dict['${r.name}'] provided in model.execute(dict) must be [${o}], but was [${s.shape}]`)}r.attrParams.dtype&&r.attrParams.dtype.value&&B(s.dtype===r.attrParams.dtype.value,()=>`The dtype of dict['${r.name}'] provided in model.execute(dict) must be ${r.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var t,s;const i={};for(const r in e){const o=(s=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||s===void 0?void 0:s[r];o!=null?i[o.name]=e[r]:i[r]=e[r]}return i}checkInputs(e){const t=Object.keys(e).filter(s=>{const[i]=dr(s);return this.graph.nodes[i]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>{var s,i;const r=(i=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||i===void 0?void 0:i[t];return r!=null?r.name:t},{})}checkOutputs(e){e.forEach(t=>{const[s]=dr(t);if(!this.graph.nodes[s])throw new Error(`The output '${t}' is not found in the graph`)})}}class ope{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape="?tfjs-format=file",lpe="model.json";class cpe{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},s=G$){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=s,t==null&&(this.loadOptions={}),this.resourceManager=new ope}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Mu(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const t=await I6(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const s=this.artifacts.modelTopology;let i=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const r=this.artifacts.userDefinedMetadata;r.signature!=null&&(i=r.signature),r.structuredOutputKeys!=null&&(this.structuredOutputKeys=r.structuredOutputKeys)}if(this.signature=i,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new dT(yz.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const r=yz.Instance.transformGraph(e.modelInitializer);this.initializer=new dT(r),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t=e instanceof Kt?[e]:e,s={};return t.forEach((i,r)=>s[this.structuredOutputKeys[r]]=i),s}return e}predict(e,t){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,t){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var t;if(!(e instanceof Kt)&&!Array.isArray(e)){const r=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(r!=null)for(const o in r){const a=r[o];a.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let i=0;return this.inputNodes.reduce((r,o)=>{var a,l,c;const h=(c=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[o])===null||c===void 0?void 0:c.resourceId;return h!=null?r[o]=this.resourceIdToCapturedInput[h]:r[o]=e[i++],r},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,s=Object.keys(t);for(let i=0;i<s.length;i++){const r=s[i],o=t[r];this.resourceIdToCapturedInput[o.resourceId]=e[i]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=this.executor.execute(e,t);return s.length>1?s:s[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=await this.executor.executeAsync(e,t);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,s)=>(t[s]=[e[s]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&mt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Sz(n,e={},t=G$){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=upe(n));const s=new cpe(n,e,t);return await s.load(),s}function upe(n){return n.endsWith("/")||(n=n+"/"),`${n}${lpe}${ape}`}/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */function fT(n,e,t,s){return new(t||(t=Promise))(function(i,r){function o(c){try{l(s.next(c))}catch(h){r(h)}}function a(c){try{l(s.throw(c))}catch(h){r(h)}}function l(c){var h;c.done?i(c.value):(h=c.value,h instanceof t?h:new t(function(f){f(h)})).then(o,a)}l((s=s.apply(n,[])).next())})}function pT(n,e){var t,s,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(l){return function(c){return function(h){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,s&&(i=2&h[0]?s.return:h[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,h[1])).done)return i;switch(s=0,i&&(h=[2&h[0],i.value]),h[0]){case 0:case 1:i=h;break;case 4:return o.label++,{value:h[1],done:!1};case 5:o.label++,s=h[1],h=[0];continue;case 7:h=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(h[0]===6||h[0]===2)){o=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){o.label=h[1];break}if(h[0]===6&&o.label<i[1]){o.label=i[1],i=h;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(h);break}i[2]&&o.ops.pop(),o.trys.pop();continue}h=e.call(n,o)}catch(f){h=[6,f],s=0}finally{t=i=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([l,c])}}}var hpe={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},ou=224,dpe={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},wp={"1.00":{.25:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1",inputRange:[0,1]},"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1",inputRange:[0,1]}},"2.00":{"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2",inputRange:[0,1]}}};function fpe(n){return n===void 0&&(n={version:1,alpha:1}),fT(this,void 0,void 0,function(){var e,t,s,i,r,o,a;return pT(this,function(l){switch(l.label){case 0:if(Lde==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(e=n.version.toFixed(2),t=n.alpha?n.alpha.toFixed(2):"",s=-1,i=1,n.modelUrl==null){if(!(e in wp))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys(wp));if(!(t in wp[e]))throw new Error("MobileNet constructed with invalid alpha "+n.alpha+". Valid multipliers for this version are: "+Object.keys(wp[e])+".");o=wp[e][t].inputRange,s=o[0],i=o[1]}return n.inputRange!=null&&(a=n.inputRange,s=a[0],i=a[1]),[4,(r=new ppe(e,t,n.modelUrl,s,i)).load()];case 1:return l.sent(),[2,r]}})})}var ppe=function(){function n(e,t,s,i,r){i===void 0&&(i=-1),r===void 0&&(r=1),this.version=e,this.alpha=t,this.modelUrl=s,this.inputMin=i,this.inputMax=r,this.normalizationConstant=(r-i)/255}return n.prototype.load=function(){return fT(this,void 0,void 0,function(){var e,t,s,i,r=this;return pT(this,function(o){switch(o.label){case 0:return this.modelUrl?(e=this,[4,Sz(this.modelUrl)]):[3,2];case 1:return e.model=o.sent(),[3,4];case 2:return t=wp[this.version][this.alpha].url,s=this,[4,Sz(t,{fromTFHub:!0})];case 3:s.model=o.sent(),o.label=4;case 4:return[4,(i=ce(function(){return r.model.predict(qn([1,ou,ou,3]))})).data()];case 5:return o.sent(),i.dispose(),[2]}})})},n.prototype.infer=function(e,t){var s=this;return t===void 0&&(t=!1),ce(function(){e instanceof Kt||(e=Q5(e));var i=ke(Y(De(e,"float32"),s.normalizationConstant),s.inputMin),r=i;(e.shape[0]!==ou||e.shape[1]!==ou)&&(r=yo.resizeBilinear(i,[ou,ou],!0));var o,a=te(r,[-1,ou,ou,3]);if(t){var l=dpe[s.version],c=s.model.execute(a,l);o=xc(c,[1,2])}else{var h=s.model.predict(a);o=St(h,[0,1],[-1,1e3])}return o})},n.prototype.classify=function(e,t){return t===void 0&&(t=3),fT(this,void 0,void 0,function(){var s,i;return pT(this,function(r){switch(r.label){case 0:return[4,mpe(s=this.infer(e),t)];case 1:return i=r.sent(),s.dispose(),[2,i]}})})},n}();function mpe(n,e){return fT(this,void 0,void 0,function(){var t,s,i,r,o,a,l;return pT(this,function(c){switch(c.label){case 0:return[4,(t=Ng(n)).data()];case 1:for(s=c.sent(),t.dispose(),i=[],l=0;l<s.length;l++)i.push({value:s[l],index:l});for(i.sort(function(h,f){return f.value-h.value}),r=new Float32Array(e),o=new Int32Array(e),l=0;l<e;l++)r[l]=i[l].value,o[l]=i[l].index;for(a=[],l=0;l<o.length;l++)a.push({className:hpe[o[l]],probability:r[l]});return[2,a]}})})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LG={kernelName:sv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(n,ff(De(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gpe={kernelName:km,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=rn(De(t,"float32")),i=Os(Be(Qe(1),s));return gn(qe(n,i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ype={kernelName:Nm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Os(Be(rn(De(t,"float32")),1));return qe(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bpe={kernelName:uf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,i=ot(t.shape,s.shape);return{a:()=>{let a=n;const l=ls(t.shape,i);return l.length>0&&(a=We(a,l)),te(a,t.shape)},b:()=>{let a=n;const l=ls(s.shape,i);return l.length>0&&(a=We(a,l)),te(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vpe={kernelName:iv,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((s,i)=>{t[i]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xpe={kernelName:rv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wpe={kernelName:ov,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>kt(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _pe={kernelName:Am,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qe(n,Os(Be(Qe(1),rn(De(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tpe={kernelName:Rm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Os(ke(Qe(1),rn(De(t,"float32"))));return qe(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Spe={kernelName:Om,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,i=ot(t.shape,s.shape);return{a:()=>{const a=ke(rn(t),rn(s));let l=Y(n,qe(s,a));const c=ls(t.shape,i);return c.length>0&&(l=We(l,c)),te(l,t.shape)},b:()=>{const a=ke(rn(t),rn(s));let l=gn(Y(n,qe(t,a)));const c=ls(s.shape,i);return c.length>0&&(l=We(l,c)),te(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Epe={kernelName:Dm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qe(n,ke(rn(De(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpe={kernelName:$m,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qe(n,Be(Qe(1),rn(De(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ipe(n,e,t,s,i,r){const o=U(n,"dy","avgPool3dGrad"),a=U(e,"input","avgPool3dGrad");let l=o,c=a,h=!1;a.rank===4&&(h=!0,l=te(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=te(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),B(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Vi("avgPool3dGrad",i,r);const f={dy:l,input:c},p={filterSize:t,strides:s,pad:i,dimRoundingMode:r},g=K.runKernel(LS,f,p);return h?te(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const kpe=X({avgPool3dGrad_:Ipe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npe={kernelName:lv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:i,strides:r,pad:o,dimRoundingMode:a}=t;return{x:()=>kpe(n,s,i,r,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ape(n,e,t,s,i){const r=U(n,"dy","avgPoolGrad"),o=U(e,"input","avgPoolGrad");B(o.rank===r.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${r.rank})`);let a=o,l=r,c=!1;o.rank===3&&(c=!0,a=te(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=te(r,[1,r.shape[0],r.shape[1],r.shape[2]])),B(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),B(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const h={dy:l,input:a},f={filterSize:t,strides:s,pad:i},p=K.runKernel(PS,h,f);return c?te(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Rpe=X({avgPoolGrad_:Ape});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dpe={kernelName:av,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:i,strides:r,pad:o}=t;return{x:()=>Rpe(n,s,i,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $pe={kernelName:cv,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[s,i]=e,{transposeA:r,transposeB:o}=t;return!r&&!o?{a:()=>pt(n,i,!1,!0),b:()=>pt(s,n,!0,!1)}:!r&&o?{a:()=>pt(n,i,!1,!1),b:()=>pt(n,s,!0,!1)}:r&&!o?{a:()=>pt(i,n,!1,!0),b:()=>pt(s,n,!1,!1)}:{a:()=>pt(i,n,!0,!0),b:()=>pt(n,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ope={kernelName:uv,gradFunc:(n,e,t)=>{const{blockShape:s,crops:i}=t;return{x:()=>vx(n,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ppe={kernelName:l6,gradFunc:(n,e,t)=>{const s=t,i=s.inputShape,r=s.shape,o=Array.from(r);for(let l=i.length-1;l>=0;l--)if(i[l]===r[l])o[l]=1;else if(i[l]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${r}].`);const a=[];for(let l=0;l<o.length;l++)o[l]>1&&a.push(l);return{x:()=>We(n,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lpe={kernelName:Pm,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mpe={kernelName:Lm,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fpe={kernelName:Mm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{clipValueMin:i,clipValueMax:r}=t;return{x:()=>Qs(ea(bc(s,i),lh(s,r)),n,kt(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vpe={kernelName:dv,inputsToSave:["x"],gradFunc:LG.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zpe={kernelName:fv,saveAllInputs:!0,gradFunc:(n,e,t)=>{const s=e.map(l=>l.shape),{axis:i}=t,r=gt(i,e[0].shape)[0],o=s.map(l=>l[r]);return Zi(n,o,r).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bpe={kernelName:pv,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,i]=e,{dilations:r,strides:o,pad:a,dataFormat:l}=t;return B(Vu(r),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`),{x:()=>JD(s.shape,n,i,o,a,l),filter:()=>P$(s,n,i.shape,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Upe={kernelName:mv,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[s,i]=e,{strides:r,pad:o,dataFormat:a,dimRoundingMode:l}=t;return{dy:()=>sc(n,i,r,o,a,1,l),filter:()=>P$(n,s,i.shape,r,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wpe(n,e,t,s,i){let r=n;n.rank===4&&(r=te(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let o=e;o.rank===4&&(o=te(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),B(r.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${r.shape}.`),B(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),B(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),B(r.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${r.shape[4]}) must match input depth in filter (${t[3]}.`),B(o.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${t[4]}).`);const a={x:r,dy:o},l={strides:s,pad:i,filterShape:t};return K.runKernel(BS,a,l)}const Hpe=X({conv3DBackpropFilter_:Wpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jpe={kernelName:gv,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:i,pad:r}=t;B(Vu(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,a]=e;return{x:()=>W6(o.shape,n,a,i,r),filter:()=>Hpe(o,n,a.shape,i,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gpe={kernelName:Fm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(gn(rC(De(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qpe={kernelName:Vm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(oC(De(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kpe={kernelName:yv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:i,exclusive:r,reverse:o}=t;return{x:()=>{const a=On([i],s.rank);let l=jE(n,i,r,!o);return a!=null&&(l=Et(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xpe={kernelName:bv,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:i,pad:r,dimRoundingMode:o}=t,a=s??[1,1];B(Vu(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return B(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),B(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),B(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),B(ei(i,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${a}'.`),Vi("depthwiseConv2d",r,o),{x:()=>$5(l.shape,n,c,i,r,a,o),filter:()=>D5(l,n,c.shape,i,r,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ype={kernelName:vv,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,i]=e,r={x:s,filter:i,dy:n},o={x:s,filter:i,dy:n};return{x:()=>K.runKernel(oT,r,t),filter:()=>K.runKernel(aT,o,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qpe={kernelName:Bm,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,s={dy:n,y:t};return{x:()=>K.runKernel(ZS,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zpe={kernelName:Um,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=Y(nr(gn(rn(t))),2/Math.sqrt(Math.PI));return{x:()=>Y(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jpe={kernelName:Wm,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eme={kernelName:wv,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>te(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tme={kernelName:Hm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(n,nr(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nme={kernelName:jm,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sme={kernelName:Gm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,i=ot(t.shape,s.shape);return{a:()=>{const a=qe(n,De(s,"float32")),l=ls(t.shape,i);return l.length>0?te(We(a,l),t.shape):a},b:()=>{let a=Y(n,De(t,"float32"));const l=ls(s.shape,i);l.length>0&&(a=te(We(a,l),s.shape));const c=rn(s);return gn(qe(a,De(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ime={kernelName:_v,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:s}=t,[i,r,o,a]=e,l=a??Qe(1),c=ls(r.shape,i.shape),h=[];if(r.rank===1){for(let I=0;I<i.shape.length-1;++I)h.push(i.shape[I]);h.push(1)}const f=Be(i,r),p=Y(n,l),g=nC(ke(o,Qe(s))),y=Y(Y(Y(g,g),g),Qe(-.5));return{x:()=>r.rank===1?te(Y(Y(n,Or(te(g,[1,1,1,r.shape[0]]),h)),l),i.shape):te(Y(Y(n,g),l),i.shape),mean:()=>{let I=Y(Y(g,Qe(-1)),p);return r.rank===1&&(I=We(I,c)),te(I,r.shape)},variance:()=>{let I=Y(Y(y,f),p);return r.rank===1&&(I=We(I,c)),te(I,r.shape)},scale:()=>{const I=Y(f,g);let A=Y(n,I);return r.rank===1&&(A=We(A,c)),te(A,r.shape)},offset:()=>{let I=n;return r.rank===1&&(I=We(I,c)),te(I,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rme={kernelName:Tv,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[s,i]=e,{axis:r,batchDims:o}=t,a=gt(r,s.shape)[0],l=(c,h,f)=>()=>{const p=c.shape,g=h.size,y=p.slice(0,a),x=y.length,v=p.slice(r,p.length).slice(1),w=v.length,S=Ez(0,x),C=Ez(x+1,x+1+w),I=Cz([y,[g],v]),A=te(f,I),L=te(h,[g]),O=Cz([[x],S,C]),N=Et(A,O);let k=dC(N,L,c.shape[a]);const $=ah(O);return k=Et(k,$),k};if(o===1){const c=s.shape[0],h=s.split(c,0);return{x:()=>sr(h.map((g,y)=>l(g,i.slice(y,1),n.slice(y,1))())).reshape(s.shape),indices:()=>i}}else return{x:l(s,i,n),indices:()=>i}}};function Ez(n,e){const t=[];for(let s=n;s<e;++s)t.push(s);return t}function Cz(n){const e=[];for(let t=0;t<n.length;++t)for(let s=0;s<n[t].length;++s)e.push(n[t][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ome={kernelName:qm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>kt(t),b:()=>kt(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ame={kernelName:Km,gradFunc:n=>({x:()=>De(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lme={kernelName:Xm,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cme={kernelName:Ym,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ume={kernelName:Qm,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hme={kernelName:Ev,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{alpha:i}=t,r=rr(s,0);return{x:()=>Qs(r,n,Y(n,i))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dme={kernelName:Jm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qe(n,ke(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fme={kernelName:Zm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qe(n,De(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pme={kernelName:c6,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{axis:i}=t;return{logits:()=>{const o=nr(s);return Be(n,Y(We(n,i,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mme(n,e,t,s=5,i=1,r=1,o=.5){const a={x:n,y:e,dy:t},l={depthRadius:s,bias:i,alpha:r,beta:o};return K.runKernel(oE,a,l)}const gme=X({localResponseNormalizationBackprop_:mme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yme={kernelName:Rv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,i]=e,{depthRadius:r,bias:o,alpha:a,beta:l}=t;return{x:()=>gme(s,i,n,r,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MG(n,e,t,s){return e.rank<t.rank&&(e=te(e,Xn(e.shape,s))),n.rank<t.rank&&(n=te(n,Xn(n.shape,s))),{x:()=>Y(n,De(So(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iz={kernelName:Dv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{reductionIndices:i}=s,r=e[0],o=e[1],a=gt(i,r.shape),l=MG(n,o,r,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bme={kernelName:eg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>Y(n,De(bc(t,s),"float32")),b:()=>Y(n,De(Zp(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vme(n,e,t,s,i,r,o){const a=U(n,"dy","maxPool3dGrad"),l=U(e,"input","maxPool3dGrad"),c=U(t,"output","maxPool3dGrad");let h=a,f=l,p=c,g=!1;l.rank===4&&(g=!0,h=te(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),f=te(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=te(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),B(h.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${h.rank}.`),B(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),B(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),Vi("maxPool3dGrad",r,o);const y={dy:h,input:f,output:p},x={filterSize:s,strides:i,pad:r,dimRoundingMode:o},v=K.runKernel(lE,y,x);return g?te(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const xme=X({maxPool3dGrad_:vme});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wme={kernelName:Ov,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,i]=e,{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=t;return{x:()=>xme(n,s,i,r,o,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _me(n,e,t,s,i,r,o){const a=U(n,"dy","maxPoolGrad"),l=U(e,"input","maxPoolGrad"),c=U(t,"output","maxPoolGrad");B(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),B(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),B(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Vi("maxPoolGrad",r,o);const h={dy:a,input:l,output:c},f={filterSize:s,strides:i,pad:r,dimRoundingMode:o};return K.runKernel(aE,h,f)}const Tme=X({maxPoolGrad_:_me});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sme={kernelName:$v,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,i]=e,{filterSize:r,strides:o,pad:a}=t;return{x:()=>Tme(n,s,i,r,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eme={kernelName:Pv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:i}=t,r=gt(i,s.shape),a=Ls(s.shape,r)[1],l=ye(a);return{x:()=>{const h=s.shape.slice();r.forEach(g=>{h[g]=1});const f=te(n,h);return qe(Y(f,Yi(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cme={kernelName:Lv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{axis:i}=s,[r,o]=e,a=gt(i,r.shape),l=MG(n,o,r,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ime={kernelName:tg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>Y(n,De(lh(t,s),"float32")),b:()=>Y(n,De(rr(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kme={kernelName:Mv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:i}=t,r=i.map(o=>o[0]);return{x:()=>St(n,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nme={kernelName:ng,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,i=ot(t.shape,s.shape);return{a:()=>{const a=ls(t.shape,i);return a.length>0?te(We(n,a),t.shape):n},b:()=>{const a=Y(n,gn(Ig(qe(t,s)))),l=ls(s.shape,i);return l.length>0?te(We(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ame={kernelName:sg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,i=ot(t.shape,s.shape);return{a:()=>{const a=Y(n,De(s,"float32")),l=ls(t.shape,i);return l.length>0?te(We(a,l),t.shape):a},b:()=>{const a=Y(n,De(t,"float32")),l=ls(s.shape,i);return l.length>0?te(We(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rme={kernelName:Fv,gradFunc:n=>({x:()=>gn(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dme={kernelName:Bv,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>qn(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $me={kernelName:zv,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ome={kernelName:Uv,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:s}=t;return Hr(n,s).map(r=>()=>r)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kz={kernelName:Wv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:i}=t,r=i.map(o=>o[0]);return{x:()=>St(n,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pme={kernelName:ig,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,s,i]=e,r=t,o=s,a=ot(r.shape,o.shape);return{a:()=>{const h=De(o,"float32");let f=Y(n,Y(h,Za(r,Be(h,Qe(1)))));const p=ls(r.shape,a);return p.length>0&&(f=We(f,p)),te(f,r.shape)},b:()=>{const h=rr(r,0),f=Qs(h,br(r),kt(r));let p=Y(n,Y(i,f));const g=ls(o.shape,a);return g.length>0&&(p=We(p,g)),te(p,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lme={kernelName:Hv,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,s]=e,i=rr(t,0);return{x:()=>Qs(i,n,Y(n,s)),alpha:()=>{let r=Qs(i,kt(n),Y(n,t));const o=ls(s.shape,n.shape);return o.length>0&&(r=We(r,o)),te(r,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mme(n,e,t){const s=n.shape.slice();s[t]=1;const i=te(e,s),r=v0(n,t,!0,!1),o=v0(n,t,!0,!0),a=Y(r,o);return Y(i,a)}function Fme(n,e,t){const s=n.shape.length,i=s-t.length,r=On(t,s);let o=n;r!=null&&(o=Et(n,r));const a=o.shape.slice(),c=a.splice(s-t.length,t.length).reduce((p,g)=>p*g,1);a.push(c);const h=o.reshape(a);let f=Mme(h,e,i);if(f=f.reshape(o.shape),r!=null){const p=ah(r);f=Et(f,p)}return f}const Vme={kernelName:jv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:i}=t;let r=[];return i==null?r=s.shape.map((o,a)=>a):typeof i=="number"?r=[i]:r=i,{x:()=>Fme(s,n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zme={kernelName:zm,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,i=ot(t.shape,s.shape);return{a:()=>{const a=qe(n,De(s,"float32")),l=ls(t.shape,i);return l.length>0?te(We(a,l),t.shape):a},b:()=>{let a=Y(n,De(t,"float32"));const l=ls(s.shape,i);l.length>0&&(a=te(We(a,l),s.shape));const c=rn(s);return gn(qe(a,De(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bme={kernelName:rg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qe(n,gn(rn(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ume={kernelName:ag,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=Y(lh(t,6),ff(t));return{x:()=>Y(n,De(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wme={kernelName:og,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(n,De(ff(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hme={kernelName:Gv,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>te(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jme={kernelName:Kv,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,i={dy:n,images:s};return{images:()=>K.runKernel(xE,i,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gme={kernelName:qv,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,i={dy:n,images:s};return{images:()=>K.runKernel(vE,i,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qme={kernelName:Xv,gradFunc:(n,e,t)=>{const{dims:s}=t,i=gt(s,n.shape);return{x:()=>Wr(n,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kme={kernelName:lg,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xme={kernelName:cg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>gn(qe(n,Y(Za(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yme={kernelName:Yv,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>De(kt(t),"float32"),t:()=>Y(n,De(t,n.dtype)),e:()=>Y(n,De(gx(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qme={kernelName:ug,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=rr(t,Qe(0)),i=Qe(CC),r=Qe(IC),o=Y(n,r),a=Y(Y(n,i),nr(De(t,"float32")));return Qs(s,o,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zme={kernelName:pg,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(n,Y(t,Be(Qe(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jme={kernelName:fg,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ege={kernelName:hg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(hx(De(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tge={kernelName:dg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(HE(De(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nge={kernelName:Qv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{begin:i,size:r}=t,o=s.shape,[a,l]=SC(s,i,r),c=[];for(let h=0;h<n.rank;h++)c.push([a[h],o[h]-a[h]-l[h]]);return{x:()=>vc(n,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sge={kernelName:tx,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{dim:i}=t,r=!0,o=Y(n,s);return{logits:()=>Be(o,Y(We(o,[i],r),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ige={kernelName:mg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(n,Yo(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nz={kernelName:Jv,gradFunc:(n,e,t)=>{const{blockShape:s,paddings:i}=t;return{x:()=>ux(n,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Az={kernelName:ex,gradFunc:(n,e,t)=>{const{axis:s}=t;return{x:()=>Kn(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rge={kernelName:gg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qe(n,Y(Os(De(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oge={kernelName:NE,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(n,Y(De(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const age={kernelName:yg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,i=Qe(2);return{a:()=>Y(n,Y(i,Be(t,s))),b:()=>Y(n,Y(i,Be(s,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lge={kernelName:_g,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cge={kernelName:bg,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,i=ot(t.shape,s.shape);return{a:()=>{let a=n;const l=ls(t.shape,i);return l.length>0&&(a=We(a,l)),te(a,t.shape)},b:()=>{let a=n;const l=ls(s.shape,i);return l.length>0&&(a=We(a,l)),te(gn(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uge={kernelName:Zv,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,i=s.shape.slice(),{axis:r}=t;gt(r,s.shape).forEach(c=>{i[c]=1});const a=te(n,i),l=Y(a,Yi(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hge={kernelName:vg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>qe(n,rn(hx(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dge={kernelName:xg,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Y(Be(Qe(1),rn(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fge={kernelName:wg,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{reps:i}=t;return{x:()=>{let o=kt(s);if(s.rank===1)for(let a=0;a<i[0];++a)o=ke(o,St(n,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<i[0];++a)for(let l=0;l<i[1];++l)o=ke(o,St(n,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<i[0];++a)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)o=ke(o,St(n,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<i[0];++a)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)for(let h=0;h<i[3];++h)o=ke(o,St(n,[a*s.shape[0],l*s.shape[1],c*s.shape[2],h*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pge={kernelName:Ed,gradFunc:(n,e,t)=>{const s=t,{perm:i}=s,r=ah(i);return{x:()=>Et(n,r)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mge={kernelName:sx,gradFunc:(n,e,t)=>{const s=t,{axis:i}=s;return{value:()=>sr(n,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gge={kernelName:ix,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>yge(n,t)}}};function yge(n,e){const t=il(e,kt(e)),s=kg(n,t);let i=bc(e,Qe(0,"int32"));const r=s.rank-i.rank;for(let a=0;a<r;++a)i=ui(i,a+1);i=ea(i,Yi(s.shape,"bool"));const o=kt(s);return Qs(i,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bge={kernelName:rx,gradFunc:n=>({x:()=>kt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vge=[LG,gpe,ype,bpe,vpe,xpe,wpe,_pe,Tpe,Spe,Epe,Cpe,Npe,Dpe,$pe,Ope,Ppe,Lpe,Mpe,Fpe,Vpe,zpe,Upe,Bpe,jpe,Gpe,qpe,Kpe,Xpe,Ype,zme,Qpe,Zpe,Jpe,eme,tme,sme,nme,ime,rme,ome,ame,lme,cme,ume,hme,dme,fme,pme,yme,Iz,Iz,bme,wme,Sme,Eme,Cme,Ime,kme,Nme,Ame,Rme,Dme,$me,Ome,kz,kz,Pme,Lme,Vme,Bme,Ume,Wme,Hme,jme,Gme,qme,Kme,Xme,Yme,Qme,Zme,Jme,ege,tge,nge,sge,ige,Nz,Nz,Az,Az,rge,age,oge,lge,cge,uge,hge,dge,fge,pge,mge,gge,bge];for(const n of vge)u6(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.abs=function(){return this.throwIfDisposed(),is(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.acos=function(){return this.throwIfDisposed(),OD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.acosh=function(){return this.throwIfDisposed(),PD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.add=function(n){return this.throwIfDisposed(),ke(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.all=function(n,e){return this.throwIfDisposed(),BE(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.any=function(n,e){return this.throwIfDisposed(),g0(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.argMax=function(n){return this.throwIfDisposed(),Fd(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.argMin=function(n){return this.throwIfDisposed(),LD(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.asScalar=function(){return this.throwIfDisposed(),B(this.size===1,()=>"The array must have only 1 element."),te(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.asType=function(n){return this.throwIfDisposed(),De(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as1D=function(){return this.throwIfDisposed(),te(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as2D=function(n,e){return this.throwIfDisposed(),te(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),te(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as4D=function(n,e,t,s){return this.throwIfDisposed(),te(this,[n,e,t,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.as5D=function(n,e,t,s,i){return this.throwIfDisposed(),te(this,[n,e,t,s,i])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.asin=function(){return this.throwIfDisposed(),MD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.asinh=function(){return this.throwIfDisposed(),FD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.atan=function(){return this.throwIfDisposed(),VD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.atan2=function(n){return this.throwIfDisposed(),zD(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.atanh=function(){return this.throwIfDisposed(),BD(this)};ve().prototype.avgPool=function(n,e,t,s){return this.throwIfDisposed(),cx(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),ux(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.batchNorm=function(n,e,t,s,i){return this.throwIfDisposed(),Tg(this,n,e,t,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.broadcastTo=function(n){return this.throwIfDisposed(),Cd(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cast=function(n){return this.throwIfDisposed(),De(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.ceil=function(){return this.throwIfDisposed(),KD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),tr(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof Kt&&(n=[n]),Kn([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.conv1d=function(n,e,t,s,i,r){return this.throwIfDisposed(),UE(this,n,e,t,s,i,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.conv2dTranspose=function(n,e,t,s,i){return this.throwIfDisposed(),WE(this,n,e,t,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.conv2d=function(n,e,t,s,i,r){return this.throwIfDisposed(),sc(this,n,e,t,s,i,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cos=function(){return this.throwIfDisposed(),hx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cosh=function(){return this.throwIfDisposed(),HE(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),v0(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),jE(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),n$(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.depthwiseConv2d=function(n,e,t,s,i,r){return this.throwIfDisposed(),Sg(this,n,e,t,s,i,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.dilation2d=function(n,e,t,s,i){return this.throwIfDisposed(),s$(this,n,e,t,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.divNoNan=function(n){return this.throwIfDisposed(),i$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.div=function(n){return this.throwIfDisposed(),qe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.dot=function(n){return this.throwIfDisposed(),r$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.elu=function(){return this.throwIfDisposed(),Eg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.equal=function(n){return this.throwIfDisposed(),So(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.erf=function(){return this.throwIfDisposed(),GE(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),a$(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.exp=function(){return this.throwIfDisposed(),nr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.expandDims=function(n){return this.throwIfDisposed(),ui(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.expm1=function(){return this.throwIfDisposed(),l$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.fft=function(){return this.throwIfDisposed(),Tx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.flatten=function(){return this.throwIfDisposed(),te(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.floor=function(){return this.throwIfDisposed(),Ig(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.floorDiv=function(n){return this.throwIfDisposed(),zE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.gather=function(n,e,t){return this.throwIfDisposed(),kg(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.greaterEqual=function(n){return this.throwIfDisposed(),bc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.greater=function(n){return this.throwIfDisposed(),rr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.ifft=function(){return this.throwIfDisposed(),nm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.irfft=function(){return this.throwIfDisposed(),lC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.isFinite=function(){return this.throwIfDisposed(),c$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.isInf=function(){return this.throwIfDisposed(),u$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.isNaN=function(){return this.throwIfDisposed(),h$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.leakyRelu=function(n){return this.throwIfDisposed(),fx(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.lessEqual=function(n){return this.throwIfDisposed(),lh(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.less=function(n){return this.throwIfDisposed(),Zp(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.localResponseNormalization=function(n,e,t,s){return this.throwIfDisposed(),d$(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logSigmoid=function(){return this.throwIfDisposed(),f$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logSoftmax=function(n){return this.throwIfDisposed(),XE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),mx(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.log=function(){return this.throwIfDisposed(),br(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.log1p=function(){return this.throwIfDisposed(),px(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logicalAnd=function(n){return this.throwIfDisposed(),ea(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logicalNot=function(){return this.throwIfDisposed(),gx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logicalOr=function(n){return this.throwIfDisposed(),YE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.logicalXor=function(n){return this.throwIfDisposed(),p$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),pt(this,n,e,t)};ve().prototype.maxPool=function(n,e,t,s){return this.throwIfDisposed(),yx(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.max=function(n,e){return this.throwIfDisposed(),Fr(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.maximum=function(n){return this.throwIfDisposed(),il(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.mean=function(n,e){return this.throwIfDisposed(),Rn(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.min=function(n,e){return this.throwIfDisposed(),Qp(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.minimum=function(n){return this.throwIfDisposed(),Bu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),g$(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.mod=function(n){return this.throwIfDisposed(),y$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.mul=function(n){return this.throwIfDisposed(),Y(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.neg=function(){return this.throwIfDisposed(),gn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.norm=function(n,e,t){return this.throwIfDisposed(),Cg(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.notEqual=function(n){return this.throwIfDisposed(),Bd(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),Jp(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.onesLike=function(){return this.throwIfDisposed(),vr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.pad=function(n,e){return this.throwIfDisposed(),vc(this,n,e)};ve().prototype.pool=function(n,e,t,s,i,r){return this.throwIfDisposed(),b$(this,n,e,t,s,i,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.pow=function(n){return this.throwIfDisposed(),Za(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.prelu=function(n){return this.throwIfDisposed(),xx(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.prod=function(n,e){return this.throwIfDisposed(),v$(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.reciprocal=function(){return this.throwIfDisposed(),T$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.relu=function(){return this.throwIfDisposed(),oa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.relu6=function(){return this.throwIfDisposed(),eC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.reshapeAs=function(n){return this.throwIfDisposed(),te(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.reshape=function(n){return this.throwIfDisposed(),te(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),M5(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),F5(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.reverse=function(n){return this.throwIfDisposed(),Wr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.rfft=function(){return this.throwIfDisposed(),Sx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.round=function(){return this.throwIfDisposed(),tC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.rsqrt=function(){return this.throwIfDisposed(),nC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.selu=function(){return this.throwIfDisposed(),sC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.separableConv2d=function(n,e,t,s,i,r){return this.throwIfDisposed(),iC(this,n,e,t,s,i,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sigmoid=function(){return this.throwIfDisposed(),Yo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sign=function(){return this.throwIfDisposed(),S$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sin=function(){return this.throwIfDisposed(),rC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sinh=function(){return this.throwIfDisposed(),oC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.slice=function(n,e){return this.throwIfDisposed(),St(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.softmax=function(n){return this.throwIfDisposed(),Ng(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.softplus=function(){return this.throwIfDisposed(),df(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),vx(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.split=function(n,e){return this.throwIfDisposed(),Zi(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sqrt=function(){return this.throwIfDisposed(),Os(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.square=function(){return this.throwIfDisposed(),rn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.squaredDifference=function(n){return this.throwIfDisposed(),cC(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.squeeze=function(n){return this.throwIfDisposed(),xc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof Kt?[this,n]:[this,...n];return sr(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.step=function(n){return this.throwIfDisposed(),ff(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.stridedSlice=function(n,e,t,s,i,r,o,a){return this.throwIfDisposed(),E$(this,n,e,t,s,i,r,o,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sub=function(n){return this.throwIfDisposed(),Be(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.sum=function(n,e){return this.throwIfDisposed(),We(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.tan=function(){return this.throwIfDisposed(),C$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.tanh=function(){return this.throwIfDisposed(),zu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.tile=function(n){return this.throwIfDisposed(),Or(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.toBool=function(){return this.throwIfDisposed(),De(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.toFloat=function(){return this.throwIfDisposed(),De(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.toInt=function(){return this.throwIfDisposed(),De(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.topk=function(n,e){return this.throwIfDisposed(),N$(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.transpose=function(n){return this.throwIfDisposed(),Et(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.unique=function(n){return this.throwIfDisposed(),A$(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),dC(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.unstack=function(n){return this.throwIfDisposed(),Hr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.where=function(n,e){return this.throwIfDisposed(),Qs(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ve().prototype.zerosLike=function(){return this.throwIfDisposed(),kt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ra extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ra.prototype)}}class bo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,bo.prototype)}}class se extends Error{constructor(e){super(e),Object.setPrototypeOf(this,se.prototype)}}class dt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,dt.prototype)}}class vO extends Error{constructor(e){super(e),Object.setPrototypeOf(this,vO.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FG{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jd(n,e){if(Array.isArray(n)){let t=[];for(let s=0;s<e;s++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function Da(n,e){if(!n)throw new vO(e)}function Rz(n,e){let t=0;for(const s of n)s===e&&t++;return t}function Ki(n){return n.length===1?n[0]:n}function Zt(n){return Array.isArray(n)?n:[n]}function Vl(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function fd(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let lo={};function xO(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function RR(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>RR(e));else{const e=Object.keys(n);for(const t of e){const s=n[t];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[t]=s.value:RR(s))}}}function kx(n,e={},t={},s="object",i=!1){if(typeof n=="string"){const r=n;let o;if(r in t)o=t[r];else if(r in lo)o=lo[r];else if(o=e[r],o==null)throw new se(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const r=n;if(r.className==null||r.config==null)throw new se(`${s}: Improper config format: ${JSON.stringify(r)}.
'className' and 'config' must set.`);const o=r.className;let a,l;if(o in t?[a,l]=t[o]:o in lo?[a,l]=lo.className:o in e&&([a,l]=e[o]),a==null)throw new se(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const g of Object.keys(lo))c[g]=lo[g];for(const g of Object.keys(t))c[g]=t[g];const h=r.config;h.customObjects=c;const f=Object.assign({},lo);for(const g of Object.keys(t))lo[g]=t[g];RR(r.config);const p=l(a,r.config,t,i);return lo=Object.assign({},f),p}else{const c=Object.assign({},lo);for(const f of Object.keys(t))lo[f]=t[f];const h=new a(r.config);return lo=Object.assign({},c),h}}}function xge(n,e){return n<e?-1:n>e?1:0}function O_(n,e){return-1*xge(n,e)}function Tu(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function wge(n){if(n==null)throw new se(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function mf(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new se(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function wO(n,e,t=0,s=1/0){return Da(t>=0),Da(s>=t),Array.isArray(n)&&n.length>=t&&n.length<=s&&n.every(i=>typeof i===e)}function As(n,e){Array.isArray(n)?(B(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,s)=>As(t,`element ${s+1} of ${e}`))):B(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${VG(n)}.`)}function VG(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>VG(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function _ge(n,e,t){let s=t!=null?t():Si(),i;return(...o)=>{const a=t!=null?t():Si();return a-s<e||(s=a,i=n(...o)),i}}function zG(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Tge=0;function BG(){return Tge++}const P_={};function kC(n=""){return n in P_||(P_[n]=0),P_[n]+=1,n+P_[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Sge=["channelsFirst","channelsLast"],Ege=["nearest","bilinear"],Cge=["valid","same","causal"],Ige=["max","avg"],kge=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mp=new Map;function Zn(n){mf(Sge,"DataFormat",n)}function Nge(n){mf(Ege,"InterpolationFormat",n)}function jr(n){mf(Cge,"PaddingMode",n)}function UG(n){mf(Ige,"PoolMode",n)}const Ub=[],Dz="/";function Id(n,e){Ub.push(n);try{const t=e();return Ub.pop(),t}catch(t){throw Ub.pop(),t}}function Age(){return Ub.length===0?"":Ub.join(Dz)+Dz}function WG(n){if(!jG(n))throw new Error("Not a valid tensor name: '"+n+"'");return Age()+n}function HG(n){if(!jG(n))throw new Error("Not a valid tensor name: '"+n+"'");mp.has(n)||mp.set(n,0);const e=mp.get(n);if(mp.set(n,mp.get(n)+1),e>0){const t=`${n}_${e}`;return mp.set(t,1),t}else return n}const Rge=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function jG(n){return!!n.match(Rge)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dge(n){return n===parseInt(n.toString(),10)}function Su(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let s=1;for(let i=e;i<t;++i)s*=n[i];return s}function sm(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s<e&&(e=s)}return e}function Uu(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s>e&&(e=s)}return e}function ta(n,e){if(e<n)throw new se(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let s=n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let HN;function gs(){return HN==null&&(HN=AD().epsilon()),HN}function na(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ba(n,e){return De(n,e)}function Nx(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),te(n,t)}function $ge(n,e){return ce(()=>{if(n.shape.length!==2)throw new se(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=Nx(n,1);return DR(t,[1,e,1])})}function Oge(n){const e=[Su(n.shape)];return te(n,e)}function Pge(n){if(n.rank<=1)throw new se(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],Su(n.shape,1)];return te(n,e)}function kd(n,e,t){return ce(()=>{switch(n.rank){case 1:return wx(n,e,t);case 2:return aC(n,[e,0],[t,n.shape[1]]);case 3:return _x(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return tm(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return St(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return St(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new se(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function jN(n,e,t){return ce(()=>{switch(n.rank){case 1:return wx(n,e,t);case 2:return aC(n,[0,e],[n.shape[0],t]);case 3:return _x(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return tm(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new se(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function L_(n,e,t,s){return ce(()=>{switch(n.rank){case 1:return wx(n,e,t);case 2:switch(s){case 1:return kd(n,e,t);case 2:return jN(n,e,t);default:throw new se(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return kd(n,e,t);case 2:return _x(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return jN(n,e,t);default:throw new se(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return kd(n,e,t);case 2:return tm(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return tm(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return jN(n,e,t);default:throw new se(`The axis is not within the rank of the tensor ${s}`)}default:throw new se(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function _O(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),Kn(n,e)}function $z(n,e){switch(n.rank){case 1:return XD([n,e]);case 2:return YD([n,e],0);case 3:return QD([n,e],0);case 4:return ZD([n,e],0);default:throw new se(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function DR(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new se(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return Or(n,e)}function NC(n,e=0,t=1,s,i){return JE(n,e,t,s,i)}function Ua(n,e,t,s){if(n.rank<2||e.rank<2)throw new dt(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const i=n.shape.slice(-1)[0],r=e.shape.slice(-2)[0];if(i!==r)throw new dt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return mR({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?$R(n.rank,s,na()):null,activation:t});{const i=n.shape.slice(),r=i.pop();n=te(n,[-1,r]);const o=e.shape.slice(),a=o.pop(),l=o.pop(),c=[...o,a],h=Array.from({length:e.rank},(y,x)=>x===0?e.rank-2:x<=e.rank-2?x-1:x);e=te(Et(e,h),[l,-1]);const f=[...i,...c];return te(mR({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?$R(n.rank,s,na()):null,activation:t}),f)}}function GG(n,e,t){return ce(()=>(Array.isArray(e)?e=fi(e,"int32"):e=De(e,"int32"),kg(n,e,t)))}function Ax(n){return Y(n,n)}function $R(n,e,t){const s=e.shape;if(e.rank!==1&&e.rank!==n)throw new se(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return s.length===1?te(e,[1,s[0],1,1,1]):te(e,[1,s[3],s[0],s[1],s[2]]);if(t==="channelsLast")return s.length===1?te(e,[1,1,1,1,s[0]]):te(e,[1].concat(s))}else if(n===4){if(t==="channelsFirst")return s.length===1?te(e,[1,s[0],1,1]):te(e,[1,s[2],s[0],s[1]]);if(t==="channelsLast")return s.length===1?te(e,[1,1,1,s[0]]):te(e,[1].concat(s))}else if(n===3){if(t==="channelsFirst")return s.length===1?te(e,[1,s[0],1]):te(e,[1,s[1],s[0]]);if(t==="channelsLast")return s.length===1?te(e,[1,1,s[0]]):te(e,[1].concat(s))}else if(n<3)return e;throw new se(`Unsupported input rank by biasAdd: ${e.rank}`)}function aa(n,e,t){return ce(()=>(t==null&&(t=na()),Zn(t),ke(n,$R(n.rank,e,t))))}function Lge(n,e=1){if(e!==1)throw new dt(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Eg(n)}function Mge(n){return ce(()=>qe(n,ke(is(n),1)))}function qG(n,e,t,s){return ce(()=>$$(n,e,t,s))}function Fge(n){return ce(()=>{const e=ke(.5,Y(.2,n));return tr(e,0,1)})}function Rx(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Vge=["fanIn","fanOut","fanAvg"],zge=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bge(n){mf(Vge,"FanMode",n)}function Uge(n){mf(zge,"Distribution",n)}class Ao extends pf{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class KG extends Ao{apply(e,t){return qn(e,t)}}KG.className="Zeros";Ne(KG);class TO extends Ao{apply(e,t){return Yi(e,t)}}TO.className="Ones";Ne(TO);class XG extends Ao{constructor(e){if(super(),typeof e!="object")throw new se(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new se(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return ce(()=>Y(Qe(this.value),Yi(e,t)))}getConfig(){return{value:this.value}}}XG.className="Constant";Ne(XG);class YG extends Ao{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return ch(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}YG.className="RandomUniform";Ne(YG);class QG extends Ao{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new dt(`randomNormal does not support dType ${t}.`);return NC(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}QG.className="RandomNormal";Ne(QG);class ZG extends Ao{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new dt(`truncatedNormal does not support dType ${t}.`);return hC(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}ZG.className="TruncatedNormal";Ne(ZG);class JG extends Ao{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return ce(()=>{if(e.length!==2||e[0]!==e[1])throw new se("Identity matrix initializer can only be used for 2D square matrices.");return Y(this.gain,qE(e[0]))})}getConfig(){return{gain:this.gain}}}JG.className="Identity";Ne(JG);function Wge(n,e="channelsLast"){let t,s;if(Zn(e),n.length===2)t=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const i=Su(n,2);t=n[1]*i,s=n[0]*i}else if(e==="channelsLast"){const i=Su(n,0,n.length-2);t=n[n.length-2]*i,s=n[n.length-1]*i}}else{const i=Su(n);t=Math.sqrt(i),s=Math.sqrt(i)}return[t,s]}class xr extends Ao{constructor(e){if(super(),e.scale<0)throw new se(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Bge(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Uge(this.distribution),this.seed=e.seed}apply(e,t){const s=Wge(e),i=s[0],r=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,i):this.mode==="fanOut"?o/=Math.max(1,r):o/=Math.max(1,(i+r)/2),this.distribution==="normal"){const a=Math.sqrt(o);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new dt(`${this.getClassName()} does not support dType ${t}.`);return hC(e,0,a,t,this.seed)}else{const a=Math.sqrt(3*o);return ch(e,-a,a,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}xr.className="VarianceScaling";Ne(xr);class SO extends xr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return xr.className}}SO.className="GlorotUniform";Ne(SO);class EO extends xr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return xr.className}}EO.className="GlorotNormal";Ne(EO);class CO extends xr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return xr.className}}CO.className="HeNormal";Ne(CO);class IO extends xr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return xr.className}}IO.className="HeUniform";Ne(IO);class kO extends xr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return xr.className}}kO.className="LeCunNormal";Ne(kO);class NO extends xr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return xr.className}}NO.className="LeCunUniform";Ne(NO);class eq extends Ao{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return ce(()=>{if(e.length<2)throw new dt("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const s=ye(e.slice(0,-1)),i=e[e.length-1],r=s*i;r>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${r}) elements: Slowness may result.`);const o=[Math.max(i,s),Math.min(i,s)],a=NC(o,0,1,t,this.seed),l=M$.qr(a,!1);let c=l[0];const f=l[1].flatten().stridedSlice([0],[Math.min(i,s)*Math.min(i,s)],[Math.min(i,s)+1]);return c=Y(c,f.sign()),s<i&&(c=c.transpose()),Y(Qe(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}eq.className="Orthogonal";Ne(eq);const Oz={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Pz(n,e={}){return kx(n,$r.getMap().classNameMap,e,"initializer")}function Dn(n){return xO(n)}function In(n){if(typeof n=="string"){const e=n in Oz?Oz[n]:n;if(e==="GlorotNormal")return new EO;if(e==="GlorotUniform")return new SO;if(e==="HeNormal")return new CO;if(e==="HeUniform")return new IO;if(e==="LeCunNormal")return new kO;if(e==="LeCunUniform")return new NO;{const t={};return t.className=e,t.config={},Pz(t)}}else return n instanceof Ao?n:Pz(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function OR(n){return Array.isArray(n)&&Array.isArray(n[0])}function mT(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function st(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new se(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function Bt(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new se(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gT(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((s,i)=>s*i);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Lz="Variable";class Hge{constructor(e,t="float32",s=Lz,i=!0,r=null){this.dtype=t??"float32",this.shape=e.shape,this.id=BG(),s=s??Lz,this.originalName=WG(s),this.name=HG(this.originalName),this.trainable_=i,this.constraint=r,this.val=R$(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),jge(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function jge(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function PR(n){return n.map(e=>e.read())}function AO(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ys{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class el{constructor(e,t,s,i,r,o,a){this.dtype=e,this.shape=t,this.sourceLayer=s,this.inputs=i,this.callArgs=r,this.outputTensorIndex=a,this.id=BG(),o!=null&&(this.originalName=WG(o),this.name=HG(this.originalName)),this.rank=t.length}}let Gge=0;class AC{constructor(e,t){this.callArgs=t,this.id=Gge++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let qge=0;class vt extends pf{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=qge++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const s=this.getClassName();t=Vl(s)+"_"+kC(s)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let r=null;e.batchSize!=null&&(r=e.batchSize),s=[r].concat(e.inputShape)}this.batchInputShape=s;let i=e.dtype;i==null&&(i=e.inputDType),i==null&&(i="float32"),this.dtype=i}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new bo(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new se(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Ki(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Ki(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Ra(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Ra(`Layer ${this.name} is not connected, no input to return.`);return Ki(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Ra(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Ra(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ki(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=Zt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Zt(this.inputSpec);if(t.length!==s.length)throw new se(`Layer ${this.name} expects ${s.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let i=0;i<t.length;i++){const r=t[i],o=s[i];if(o==null)continue;const a=r.rank;if(o.ndim!=null&&a!==o.ndim)throw new se(`Input ${i} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${a}`);if(o.maxNDim!=null&&a>o.maxNDim)throw new se(`Input ${i} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${a}`);if(o.minNDim!=null&&a<o.minNDim)throw new se(`Input ${i} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${a}.`);if(o.dtype!=null&&r.dtype!==o.dtype)throw new se(`Input ${i} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${r.dtype}.`);if(o.axes){const l=r.shape;for(const c in o.axes){const h=Number(c),f=o.axes[c],p=h>=0?l[h]:l[l.length+h];if(f!=null&&[f,null].indexOf(p)===-1)throw new se(`Input ${i} is incompatible with layer ${this.name}: expected axis ${h} of input shape to have value ${f} but got shape ${l}.`)}}if(o.shape!=null)for(let l=0;l<o.shape.length;++l){const c=o.shape[l],h=r.shape[l];if(c!=null&&h!=null&&c!==h)throw new se(`Input ${i} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${r.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const s=Zt(e),i=Yge(e),r=Qge(e);if(i===r)throw new se("Arguments to apply() must be all SymbolicTensors or all Tensors");return Id(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const a of Zt(e))o.push(a.shape);this.build(Ki(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&r&&(this._refCount=1)}if(this.assertInputCompatibility(e),r){let o=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,o);const a=Zt(o),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=Ki(l),this.activityRegularizer!=null)throw new dt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=Kge(e),a=this.computeOutputShape(o);let l;const c=Xge(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((h,f)=>new el(c,h,this,Zt(e),t,this.name,f)):l=new el(c,a,this,Zt(e),t,this.name),this.addInboundNode(e,l,null,null,o,a,t),this._refCount++,this.activityRegularizer!=null)throw new dt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((s,i)=>{s!=null&&e[i]!=null&&e[i]!==s&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Ra(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const s=JSON.stringify(t.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new Ra(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new bo(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return gT(this.weights)}build(e){this.built=!0}getWeights(e=!1){return PR(e?this.trainableWeights:this.weights)}setWeights(e){ce(()=>{const t=this.weights;if(t.length!==e.length)throw new se(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const s=[],i=PR(t);for(let r=0;r<i.length;++r){const o=i[r],a=t[r],l=e[r];if(!_t(o.shape,l.shape))throw new se(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}AO(s)})}addWeight(e,t,s,i,r,o,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new se(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(i=l!=null?l():In("zeros"));const c=i.apply(t,s),h=new Hge(c,s,e,o,a);return c.dispose(),r!=null&&this.addLoss(()=>r.apply(h.read())),o==null&&(o=!0),o?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Zt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,s){if(!this.supportsMasking)return;const i=this.computeMask(e,s),r=Zt(t),o=Zt(i);if(r.length!==o.length)throw new Error(`${this.name} outputs ${r.length} tensors but ${r.length} masks for those tensors`);for(let a=0;a<r.length;a++)r[a].kerasMask=o[a]}addInboundNode(e,t,s,i,r,o,a=null){const l=Zt(e);t=Zt(t),s=Zt(s),i=Zt(i),r=mT(r),o=mT(o);const c=[],h=[],f=[];for(const p of l)c.push(p.sourceLayer),h.push(p.nodeIndex),f.push(p.tensorIndex);new AC({outboundLayer:this,inboundLayers:c,nodeIndices:h,tensorIndices:f,inputTensors:l,outputTensors:t,inputMasks:s,outputMasks:i,inputShapes:r,outputShapes:o},a);for(let p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Kge(n){n=Zt(n);const e=[];for(const t of n)e.push(t.shape);return Ki(e)}function Xge(n){return"float32"}function tq(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const s=e.inboundNodes[t];if(s.inboundLayers.length===0)return s.inputTensors;{const i=[];for(let r=0;r<s.inboundLayers.length;r++){const o=s.inputTensors[r],a=s.inboundLayers[r],l=s.nodeIndices[r],c=tq(o,a,l);for(const h of c)i.indexOf(h)===-1&&i.push(h)}return i}}}function Yge(n){let e=!0;for(const t of Zt(n))if(!(t instanceof el)){e=!1;break}return e}function Qge(n){let e=!0;for(const t of Zt(n))if(t instanceof el){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Dx extends vt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:kC("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new se("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new se("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new se("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=t,this.dtype=s,this.inputSpec=[{shape:t}];const i=new el(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new AC({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new se(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Dx.className="InputLayer";Ne(Dx);function Zge(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new se("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new Dx({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jge(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return De(e,n.dtype)}catch{throw new se(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class yu{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof yu)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=Jge(e,t),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new se(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof el){if(this.id2Value[e.id]==null)throw new se(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new se(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof el){if(this.id2Value[e.id]==null)throw new se(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new se(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&mt(this.id2Mask)}}const yT=new FG,bT=new FG;function eye(n){yT!=null&&yT.setMaxEntries(n),bT!=null&&bT.setMaxEntries(n)}function Ib(n,e,t,s){const i=t==null?!1:t.training,r=Array.isArray(n),o=r?n:[n],a=o.map(y=>y.name),l=[],c=e.names();for(const y of a)c.indexOf(y)!==-1?l.push(e.getValue(y)):l.push(null);const h=a.join(",")+"|"+e.names().sort().join(",");let f=yT.get(h),p;if(f==null){const y=tye(o,e);f=y.sorted,p=y.recipientCounts,yT.put(h,f),bT.put(h,p)}p={},i||Object.assign(p,bT.get(h));const g=new yu(e);for(let y=0;y<f.length;++y){const x=f[y],v=x.sourceLayer;if(v instanceof Dx)continue;const w=[],S=[],C=[];let I=!1;for(const k of x.inputs){const $=g.getValue(k),R=g.getMask(k);w.push($),S.push(R),R!=null&&(I=!0),i||(p[k.name]--,p[k.name]===0&&!e.hasKey(k)&&a.indexOf(k.name)===-1&&!$.isDisposed&&k.sourceLayer.stateful!==!0&&C.push($))}I&&(t=t||{},t.mask=S[0]);const A=Zt(v.apply(w,t));let L=null;v.supportsMasking&&(L=v.computeMask(w,S));const O=sye(x),N=Array.isArray(O)?O:[O];for(let k=0;k<N.length;++k){g.hasKey(N[k])||g.add(N[k],A[k],Array.isArray(L)?L[0]:L);const $=a.indexOf(N[k].name);$!==-1&&(l[$]=A[k])}i||mt(C)}return g.disposeMasks(),r?l:l[0]}function tye(n,e){B(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],s={};if(n.length===1){const i=Mz(n[0],e);t=i.sorted,s=i.recipientMap}else{const i=new Set;for(const r of n){const{sorted:o,recipientMap:a}=Mz(r,e);for(const l of o)i.has(l.name)||(t.push(l),i.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:t,recipientCounts:nye(s)}}function nye(n){const e={};for(const t in n)e[t]=n[t].size;return e}function Mz(n,e){const t=new Set,s=[],i={};for(const a of e.names())t.add(a);const r=[],o=[];for(r.push(n);r.length>0;){const a=r[r.length-1];if(t.has(a.name)){r.pop();continue}const l=o[o.length-1]===r.length-1;if(a.inputs.length===0||l)r.pop(),s.push(a),t.add(a.name),l&&o.pop();else{o.push(r.length-1);for(const c of a.inputs)i[c.name]==null&&(i[c.name]=new Set),i[c.name].add(a.name),!t.has(c.name)&&r.push(c)}}return{sorted:s,recipientMap:i}}function sye(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const i of n.sourceLayer.inboundNodes[s].outputTensors)if(i.id===n.id){t=s;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iye=de();iye.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,eye);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RO(n,e){return ce(()=>Os(We(Y(n,n),e,!0)))}class $x extends pf{getConfig(){return{}}}class nq extends $x{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ce(()=>{const t=RO(e,this.axis),s=tr(t,0,this.maxValue);return Y(e,qe(s,ke(gs(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}nq.className="MaxNorm";Ne(nq);class sq extends $x{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ce(()=>qe(e,ke(gs(),RO(e,this.axis))))}getConfig(){return{axis:this.axis}}}sq.className="UnitNorm";Ne(sq);class iq extends $x{apply(e){return oa(e)}}iq.className="NonNeg";Ne(iq);class rq extends $x{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ce(()=>{const t=RO(e,this.axis),s=ke(Y(this.rate,tr(t,this.minValue,this.maxValue)),Y(1-this.rate,t));return Y(e,qe(s,ke(gs(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}rq.className="MinMaxNorm";Ne(rq);const Fz={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function bs(n){return xO(n)}function Vz(n,e={}){return kx(n,$r.getMap().classNameMap,e,"constraint")}function vs(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in Fz?Fz[n]:n,config:{}};return Vz(t)}else return n instanceof $x?n:Vz(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Qh(n){if(n==null)return;const e=[],t=[],s=[];for(const i in n){const r=n[i];if(typeof r!="number"){const o=r;e.push(o.data()),t.push(i),s.push(o)}}if(e.length>0){const i=await Promise.all(e);for(let r=0;r<i.length;++r)n[t[r]]=i[r][0];mt(s)}}function oq(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var zz;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(zz||(zz={}));const rye=125;class x0{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class oye{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class aye extends x0{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const s=t.size==null?0:t.size;this.seen+=s;for(const i in t){const r=t[i];if(typeof r=="number")this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+r*s;else{let o;i in this.totals?o=this.totals[i]:this.totals[i]=0;const a=ce(()=>ke(this.totals[i],Y(r,s)));this.totals[i]=a,o!=null&&o.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?t[s]=this.totals[s]/this.seen:ce(()=>{const i=Y(qe(1,this.seen),this.totals[s]);t[s]=i,this.totals[s].dispose(),ms(t[s])}))}}class lye extends x0{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const s in t)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(t[s])}async syncData(){const e=[],t=[],s=[];for(const r in this.history){const o=this.history[r];for(let a=0;a<o.length;++a)if(typeof o[a]!="number"){const l=o[a];e.push(l.data()),t.push(r),s.push(a)}}const i=await Promise.all(e);for(let r=0;r<i.length;++r)this.history[t[r]][s[r]].dispose(),this.history[t[r]][s[r]]=i[r][0]}}class cye extends x0{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||Z$,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=rye),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");iT(this.yieldEvery)&&(this.maybeWait=_ge(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,s){const i=[];this.yield!=null&&(await Qh(s),i.push(this.yield(e,t,s))),i.push(this.nextFrameFunc()),await Promise.all(i)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Qh(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const s=[];this.epochEnd!=null&&(await Qh(t),s.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Qh(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const s=[];this.batchEnd!=null&&(await Qh(t),s.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):iT(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await Qh(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Qh(e),await this.trainEnd(e))}}function aq(n,e){return n==null&&(n={}),n instanceof x0?[n]:Array.isArray(n)&&n[0]instanceof x0?n:Zt(n).map(s=>new cye(s,e))}class po{constructor(){}static registerCallbackConstructor(e,t){B(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),po.checkForDuplicate(t),po.constructors[e]==null&&(po.constructors[e]=[]),po.constructors[e].push(t)}static checkForDuplicate(e){for(const t in po.constructors)po.constructors[+t].forEach(i=>{if(i===e)throw new se("Duplicate callback constructor.")})}static clear(){po.constructors={}}static createCallbacks(e){const t=[];for(const s in po.constructors){const i=+s;e>=i&&t.push(...po.constructors[i])}return t.map(s=>new s)}}po.constructors={};function lq(n,e,t,s,i,r,o,a,l){const c=new lye,h=[new aye,...po.createCallbacks(e)];n!=null&&h.push(...n),h.push(c);const f=new oye(h);return f.setParams({epochs:t,initialEpoch:s,samples:i,steps:r,batchSize:o,verbose:e,doValidation:a,metrics:l}),{callbackList:f,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yl(n,e={},t=!1){return kx(n,$r.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vT(n,e){return ce(()=>{n.dtype!=="float32"&&(n=De(n,"float32"));const t=We(Ax(n),e,!0),s=hf(t.shape,gs()),i=Os(il(t,s));return qe(n,i)})}function RC(n,e){return ce(()=>Rn(Ax(Be(e,n)),-1))}function DO(n,e){return ce(()=>Rn(is(Be(e,n)),-1))}function $O(n,e){return ce(()=>{const t=Be(n,e),s=tr(is(n),gs(),Number.MAX_VALUE),i=is(qe(t,s));return Y(100,Rn(i,-1))})}function uye(n,e){return ce(()=>{const t=tr(e,gs(),Number.MAX_VALUE),s=br(ke(1,t)),i=tr(n,gs(),Number.MAX_VALUE),r=br(ke(1,i));return Rn(Ax(Be(s,r)),-1)})}function hye(n,e){return ce(()=>{const t=il(0,Be(1,Y(n,e)));return Rn(Ax(t),-1)})}function dye(n,e){return ce(()=>{const t=il(0,Be(1,Y(n,e)));return Rn(t,-1)})}function fye(n,e){return ce(()=>{const t=We(Y(n,e),-1),s=Fr(Y(Be(1,n),e),-1);return il(0,ke(1,Be(s,t)))})}function pye(n,e){return ce(()=>{const t=Math.log(2),s=Be(e,n),i=Be(ke(s,df(Y(-2,s))),t);return Rn(i,-1)})}function w0(n,e,t=!1){return ce(()=>{if(t)e=Ng(e);else{const s=We(e,e.shape.length-1,!0);e=qe(e,s)}return e=tr(e,gs(),1-gs()),gn(We(Y(De(n,"float32"),br(e)),e.shape.length-1))})}function xT(n,e,t=!1){return ce(()=>{const s=De(Ig(Oge(n)),"int32");e=tr(e,gs(),1-gs());const i=e.shape,r=te(Jp(s,i[i.length-1]),i);return w0(r,e,t)})}function mye(n,e){if(!_t(n.shape,e.shape))throw new se(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return ce(()=>{const t=oa(e),s=gn(is(e));return ke(Be(t,Y(e,n)),px(nr(s)))})}function DC(n,e){return ce(()=>{let t;return t=tr(e,gs(),1-gs()),t=br(qe(t,Be(1,t))),Rn(mye(n,t),-1)})}function gye(n,e){return ce(()=>{const t=tr(n,gs(),1),s=tr(e,gs(),1);return We(Y(n,br(qe(t,s))),-1)})}function yye(n,e){return ce(()=>{const t=br(ke(gs(),e));return Rn(Be(e,Y(n,t)),-1)})}function cq(n,e){return ce(()=>{const t=vT(n,-1),s=vT(e,-1),i=Y(t,s);return gn(We(i,-1))})}const wT={meanSquaredError:RC,meanAbsoluteError:DO,meanAbsolutePercentageError:$O,meanSquaredLogarithmicError:uye,squaredHinge:hye,hinge:dye,categoricalHinge:fye,logcosh:pye,categoricalCrossentropy:w0,sparseCategoricalCrossentropy:xT,binaryCrossentropy:DC,kullbackLeiblerDivergence:gye,poisson:yye,cosineProximity:cq};function GN(n){if(typeof n=="string"){if(n in wT)return wT[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new se(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uq(n,e){return ce(()=>{const t=Y(.5,vr(e)),s=Ba(rr(e,t),n.dtype);return Rn(So(n,s),-1)})}function hq(n,e){return ce(()=>Ba(So(Fd(n,-1),Fd(e,-1)),"float32"))}function bye(n,e){return ce(()=>De(We(ea(So(n,1),So(e,1))),"float32"))}function vye(n,e){return ce(()=>De(We(ea(So(n,0),So(e,1))),"float32"))}function xye(n,e){return ce(()=>{const t=bye(n,e),s=vye(n,e),i=ke(t,s);return De(Qs(rr(i,0),qe(t,i),0),"float32")})}function wye(n,e){return DC(n,e)}function _ye(n,e){return n.rank===e.rank&&(n=xc(n,[n.rank-1])),e=Fd(e,-1),e.dtype!==n.dtype&&(e=De(e,n.dtype)),De(So(n,e),"float32")}const Tye=RC,Sye=RC,Eye=DO,Cye=DO,Iye=$O,kye=$O,dq=w0,Nye=cq,fq=xT,_T={binaryAccuracy:uq,categoricalAccuracy:hq,precision:xye,categoricalCrossentropy:dq,sparseCategoricalCrossentropy:fq,mse:Tye,MSE:Sye,mae:Eye,MAE:Cye,mape:Iye,MAPE:kye,cosine:Nye};function Aye(n){if(typeof n=="string"&&n in _T)return _T[n];if(typeof n!="string"&&n!=null)return n;throw new se(`Unknown metric ${n}`)}function M_(n){if(Da(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(wT))if(wT[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(_T))if(_T[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rye(n){const e={Adagrad:()=>rd.adagrad(.01),Adadelta:()=>rd.adadelta(1,.95,gs()),Adam:()=>rd.adam(.001,.9,.999,gs()),Adamax:()=>rd.adamax(.002,.9,.999,gs(),0),RMSProp:()=>rd.rmsprop(.001,.9,0,gs()),SGD:()=>rd.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new se(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Bz=1*1024*1024;function Uz(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!LR(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const s=JSON.stringify(n);s.length>Bz&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${Bz}.`)}}function LR(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!LR(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!LR(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dye(n,e,t,s=console.log){const i=Oye(n),r=["Layer (type)","Input Shape","Output shape","Param #"];i?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(h=>Math.floor(e*h)));let o;if(!i){r.push("Receives inputs"),o=[];for(const h in n.nodesByDepth)o.push(...n.nodesByDepth[h])}s("_".repeat(e)),TT(r,t,s),s("=".repeat(e));const a=n.layers;for(let h=0;h<a.length;++h)i?Pye(a[h],t,s):Lye(a[h],t,o,s),s((h===a.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const l=$ye(n),c=gT(n.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function $ye(n){let e;return n.collectedTrainableWeights!=null?e=gT(n.collectedTrainableWeights):e=gT(n.trainableWeights),e}function Oye(n){let e=!0;const t=[],s=[];for(const i in n.nodesByDepth)t.push(n.nodesByDepth[i]);for(const i of t){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){e=!1;break}s.push(...i)}if(e)for(const i of n.layers){let r=!1;for(const o of i.inboundNodes)if(s.indexOf(o)!==-1)if(r){e=!1;break}else r=!0;if(!e)break}return e}function TT(n,e,t=console.log){let s="";for(let i=0;i<n.length;++i)i>0&&(s=s.slice(0,s.length-1)+" "),s+=n[i],s=s.slice(0,e[i]),s+=" ".repeat(e[i]-s.length);t(s)}function Pye(n,e,t){let s,i;try{i=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const r=n.name,o=n.getClassName(),a=[`${r} (${o})`,i,s,n.countParams().toString()];TT(a,e,t)}function Lye(n,e,t,s){let i,r;try{r=n.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{r="multiple"}try{i=JSON.stringify(n.outputShape)}catch{i="multiple"}const o=[];for(const f of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(f)===-1))for(let p=0;p<f.inboundLayers.length;++p){const g=f.inboundLayers[p].name,y=f.nodeIndices[p],x=f.tensorIndices[p];o.push(`${g}[${y}][${x}]`)}const a=n.name,l=n.getClassName(),c=o.length===0?"":o[0],h=[`${a} (${l})`,r,i,n.countParams().toString(),c];TT(h,e,s);for(let f=1;f<o.length;++f)TT(["","","","",o[f]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pq(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function MR(n,e){if(n===null)return null;if(typeof n=="string")return fd(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let i=0;i<s;++i){const r=n[i];pq(e,i,r)?t.push(r):t.push(MR(r,e))}return t}else{const t={};for(const s of Object.keys(n)){const i=n[s];if(s==="name"&&typeof i=="string")t[s]=i;else{const r=fd(s);t[r]=MR(i,r)}}return t}}function FR(n,e){if(n==null)return null;if(typeof n=="string")return Vl(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let i=0;i<s;++i){const r=n[i];pq(e,i,r)?t.push(r):t.push(FR(r,e))}return t}else{const t={};for(const s of Object.keys(n)){const i=n[s],r=Vl(s);(s==="name"||s==="className")&&typeof i=="string"?t[r]=i:t[r]=FR(i,s)}return t}}/** @license See the LICENSE file. */const mq="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Mye=n=>{const e=Object.keys(n);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class Vo extends vt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const S=this.getClassName().toLowerCase();this.name=kC(S)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Tu(this.inputs).length!==this.inputs.length)throw new se(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(S=>S.name)}`);Tu(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(S=>S.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const S of this.outputs){const C=S.sourceLayer,I=S.nodeIndex,A=S.tensorIndex;this.outputLayers.push(C),this.outputLayersNodeIndices.push(I),this.outputLayersTensorIndices.push(A)}for(const S of this.inputs){const C=S.sourceLayer,I=S.nodeIndex,A=S.tensorIndex;Da(I===0,"input layer has >1 nodes"),Da(A===0,"input layer has >1 tensors"),this.inputLayers.push(C),this.inputLayersNodeIndices.push(I),this.inputLayersTensorIndices.push(A)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let S=0;S<this.inputLayers.length;S++){const C=this.inputLayers[S];if(!(C instanceof Dx))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${S} (0-based) originates from layer type ${C.getClassName()}.`);this.inputNames.push(C.name),this.feedInputShapes.push(C.batchInputShape),this.feedInputNames.push(C.name)}for(const S of this.outputLayers)this.outputNames.push(S.name);this.internalInputShapes=this.inputs.map(S=>S.shape),this.internalOutputShapes=this.outputs.map(S=>S.shape);const t={},s={},i={},r={},o={},a=[],l=(S,C,I,A,L,O)=>{(A==null||L==null||O==null)&&(A=S.sourceLayer,L=S.nodeIndex,O=S.tensorIndex);const N=A.inboundNodes[L];if(I.indexOf(N)!==-1)throw new bo(`The tensor ${S.name} at layer "${A.name}" is part of a cycle.`);if(C.indexOf(N)!==-1)return;this.containerNodes.add(Vo.nodeKey(A,L)),A.id in o||(o[A.id]=Object.keys(o).length),I.indexOf(N)===-1&&I.push(N);const k=N.inboundLayers.length;for(let $=0;$<k;$++){const R=N.inputTensors[$],z=N.inboundLayers[$],V=N.nodeIndices[$],ne=N.tensorIndices[$];l(R,C,I,z,V,ne)}for(C.push(N);I.indexOf(N)>=0;)I.splice(I.indexOf(N),1);a.push(N)},c=[],h=[];for(const S of this.outputs)l(S,c,h);const f=a.slice().reverse();for(const S of f){s[S.id]=S,S.id in t||(t[S.id]=0);let C=t[S.id];const I=i[S.outboundLayer.id]==null?0:i[S.outboundLayer.id];C=Math.max(C,I),i[S.outboundLayer.id]=C,r[S.outboundLayer.id]=S.outboundLayer,t[S.id]=C;for(let A=0;A<S.inboundLayers.length;A++){const L=S.inboundLayers[A],O=S.nodeIndices[A],N=L.inboundNodes[O],k=t[N.id]==null?0:t[N.id];t[N.id]=Math.max(C+1,k),s[N.id]=N}}const p={};for(const S in t){const C=t[S];C in p||(p[C]=[]),p[C].push(s[S])}const g={};for(const S in i){const C=i[S];C in g||(g[C]=[]),g[C].push(r[S])}let y=Object.keys(g).map(S=>parseInt(S,10)).sort(O_);this.layers=[];for(const S of y){const C=g[S];C.sort((I,A)=>{const L=o[I.id],O=o[A.id];return L<O?-1:L>O?1:0});for(const I of C)I instanceof Vo&&this.internalContainerRefs.push(I),this.layers.push(I)}this.layersByDepth=g,y=Object.keys(p).map(S=>parseInt(S,10)).sort(O_);const x=this.inputs.slice(),v=[];for(const S of y)for(const C of p[S]){const I=C.outboundLayer;if(I!=null){for(const A of C.inputTensors)if(x.indexOf(A)===-1)throw new bo(`Graph disconnected: cannot obtain value for tensor ${A} at layer "${I.name}". The following previous layers were accessed without issue: ${v}`);for(const A of C.outputTensors)x.push(A);v.push(I.name)}}this.nodesByDepth=p;const w=this.layers.map(S=>S.name);for(const S of w){const C=w.filter(I=>I===S).length;if(C!==1)throw new bo(`The name "${S}" is used ${C} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new AC({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(S=>null),outputMasks:this.outputs.map(S=>null),inputShapes:this.inputs.map(S=>S.shape),outputShapes:this.outputs.map(S=>S.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new se("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.layers)t.push(...s.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const s={};let i=0;const r=Mye(e);r&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const h=r?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[h]!=null)throw new se(`Duplicate weight name: ${h}`);s[h]=c,i++}const o=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)o.push([s[l],e[a]]);else if(t)throw new se(`Provided weight data has no target variable: ${a}`);delete s[l]}if(t){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new se(`${a.length} of ${i} weights are not set: ${a}`)}AO(o)}parseWeights(e){for(const t in Object.keys(e)){const s=t.split("/"),i=["vars","layer_checkpoint_dependencies"],r=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!i.includes(o)).join("/");r!==t&&(e[r]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${mq}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const s=FR(this.updatedConfig());return t?JSON.stringify(s):s}call(e,t){return ce(()=>{e=Zt(e);const s=new yu;for(let i=0;i<this.inputs.length;++i)s.add(this.inputs[i],e[i]);return Ib(this.outputs,s,t)})}computeMask(e,t){return ce(()=>{e=Zt(e);let s;return t==null?s=jd(null,e.length):s=Zt(t),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const t=mT(e);if(t.length!==this.inputLayers.length)throw new se(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<t.length;a++){const l=this.inputLayers[a],c=t[a],h=l.name+"_0_0";s[h]=c}const i=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(O_);if(i.length>1)for(const a of i){const l=this.nodesByDepth[a];for(const c of l){const h=c.outboundLayer;if(this.inputLayers.map(x=>x.id).indexOf(h.id)!==-1)continue;const f=[];for(let x=0;x<c.inboundLayers.length;x++){const v=c.inboundLayers[x],w=c.nodeIndices[x],S=c.tensorIndices[x],C=`${v.name}_${w}_${S}`,I=s[C];f.push(I)}const p=h.computeOutputShape(Ki(f)),g=mT(p),y=h.inboundNodes.indexOf(c);for(let x=0;x<g.length;x++){const v=`${h.name}_${y}_${x}`;s[v]=g[x]}}}const r=[],o=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],h=this.outputLayersTensorIndices[a],f=`${l.name}_${c}_${h}`;o.push(f)}for(let a=0;a<o.length;a++){const l=o[a];Da(l in s),r.push(s[l])}return Ki(r)}runInternalGraph(e,t){t==null&&(t=jd(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],h=e[l],f=t[l];s[c.id]=[h,f]}const i=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(O_);for(const l of i){const c=this.nodesByDepth[l];for(const h of c){const f=h.outboundLayer,p=h.inputTensors,g=h.outputTensors,y=new Array;for(const x of p)x.id in s&&y.push(s[x.id]);if(y.length===p.length){let x={},v,w,S,C;if(h.callArgs!=null&&(x=h.callArgs),y.length===1){const[I,A]=y[0];x.mask==null&&(x.mask=A),S=Zt(f.call(I,x)),C=Zt(f.computeMask(I,A)),v=[I],w=[A]}else v=y.map(I=>I[0]),w=y.map(I=>I[1]),x.mask==null&&(x.mask=w),S=Zt(f.call(v,x)),C=Zt(f.computeMask(v,w));if(f.activityRegularizer)throw new dt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let I=0;I<g.length;++I){const A=g[I],L=S[I],O=C[I];s[A.id]=[L,O]}}}}const r=[],o=[],a=[];for(const l of this.outputs){Da(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,h]=s[l.id];a.push(c.shape),r.push(c),o.push(h)}return[r,o,a]}buildNodeConversionMap(e){const t={};let s;for(const i of this.layers){s=i instanceof Vo?1:0;for(let r=0;r<i.inboundNodes.length;r++){const o=Vo.nodeKey(i,r);this.containerNodes.has(o)&&(t[o]=s,s+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new se("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new se(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new se(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return ce(()=>{const e=[];for(const t of this.layers)for(let s=0;s<t.inboundNodes.length;++s){const i=Vo.nodeKey(t,s);this.containerNodes.has(i)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const a=o.getClassName(),l=o.getConfig(),c=[];for(let f=0;f<o.inboundNodes.length;f++){const p=o.inboundNodes[f],g=Vo.nodeKey(o,f);let y={};if(this.containerNodes.has(g)){if(p.callArgs)try{JSON.stringify(p.callArgs),y=p.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),y={}}if(p.inboundLayers.length>0){const x=[];for(let v=0;v<p.inboundLayers.length;v++){const w=p.inboundLayers[v],S=p.nodeIndices[v],C=p.tensorIndices[v],I=Vo.nodeKey(w,S);let A=t[I];A==null&&(A=0),x.push([w.name,A,C,y])}c.push(x)}}}const h={};h.name=o.name,h.className=a,h.config=l,h.inboundNodes=c,s.push(h)}e.layers=s;const i=[];for(let o=0;o<this.inputLayers.length;o++){const a=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=Vo.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let h=t[c];h==null&&(h=0);const f=this.inputLayersTensorIndices[o];i.push([a.name,h,f])}e.inputLayers=i;const r=[];for(let o=0;o<this.outputLayers.length;o++){const a=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=Vo.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let h=t[c];h==null&&(h=0);const f=this.outputLayersTensorIndices[o];r.push([a.name,h,f])}return e.outputLayers=r,e}static fromConfig(e,t,s={},i=!1){const r={},o={};function a(v,w){v.name in o?o[v.name].push(w):o[v.name]=[w]}function l(v,w){const S=[];let C;for(const I of w){const A=I[0],L=I[1],O=I[2];if(C=I[3]==null?{}:I[3],!(A in r)){a(v,w);return}const N=r[A];if(N.inboundNodes.length<=L){a(v,w);return}const k=N.inboundNodes[L];S.push(k.outputTensors[O])}S.length>0&&v.apply(Ki(S),C)}function c(v){const w=v.name,S=Yl(v,t.customObjects!=null?t.customObjects:{});S.setFastWeightInitDuringBuild(i),r[w]=S,v.inboundNodes.forEach(I=>{if(!(I instanceof Array))throw new se(`Corrupted configuration, expected array for nodeData: ${I}`);a(S,I)})}const h=t.name,f=t.layers;for(const v of f)c(v);for(;!wge(o);)for(const v of f){const w=r[v.name];if(w.name in o){const S=o[w.name];delete o[w.name];for(const C of S)l(w,C)}}const p=[],g=[],y=t.inputLayers;for(const v of y){const w=v[0],S=v[1],C=v[2];Da(w in r);const A=r[w].inboundNodes[S].outputTensors;p.push(A[C])}const x=t.outputLayers;for(const v of x){const w=v[0],S=v[1],C=v[2];Da(w in r);const A=r[w].inboundNodes[S].outputTensors;g.push(A[C])}return new e({inputs:p,outputs:g,name:h})}get stateful(){if(this._stateful)throw new se("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){ce(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Fye(n,e,t){const s=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(i=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const i=[];return e.forEach(r=>{r in n?i.push(n[r]):i.push(null)}),i}else throw new Error(`The model has multiple (${s}) outputs, so ${t} must be either an array with ${s} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function gq(n,e){return Fye(n,e,"classWeight")}async function yq(n,e,t,s){if(t!=null){const i=ce(()=>{if(n.shape.length===1)return Va(n);if(n.shape.length===2){if(n.shape[1]>1)return Fd(n,1);if(n.shape[1]===1)return te(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(await i.data());mt(i);const o=[];return r.forEach(a=>{if(t[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);o.push(t[a])}),fi(o,"float32")}else return null}function Vye(n,e){return Y(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zye=32;function bq(n,e){let t,s;const i=e;t=i.xs,s=i.ys,B(t!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const r=Wz("input",n.inputNames,t),o=Wz("output",n.outputNames,s),a=r[0].shape[0];B(r.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${r.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),B(o.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<r.length;l++)B(r[l].shape[0]===a,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${r[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);for(let l=0;l<o.length;l++)B(o[l].shape[0]===a,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);return{xs:r,ys:o}}function Wz(n,e,t){if(t instanceof Kt)return[t];if(Array.isArray(t))return B(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const s=[];for(const i of e){if(t[i]==null)throw new se(`The feature data generated by the dataset lacks the required ${n} key '${i}'.`);s.push(t[i])}return s}}function Bye(n){if(n.length===3)throw new dt("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function Uye(n,e,t){const s=t.batchesPerEpoch!=null;if(B(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),B(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),B(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),B(!s||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),B(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const i=t.validationData!=null;let r,o;if(i)if(Hz(t.validationData))B(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const v=Bye(t.validationData);r=v.xs,o=v.ys}const a=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let c;i?c=l.slice().concat(l.map(v=>"val_"+v)):c=l.slice();const h=aq(t.callbacks,t.yieldEvery),f=t.verbose==null?1:t.verbose,{callbackList:p,history:g}=lq(h,f,t.epochs,null,null,Wye(e,t),null,i,c);p.setModel(n),n.history=g,await p.onTrainBegin(),n.stopTraining_=!1;let y=t.initialEpoch==null?0:t.initialEpoch,x=await e.iterator();for(;y<t.epochs;){const v={};await p.onEpochBegin(y);let w=0,S=0;for(s||(x=await e.iterator());!s||w<t.batchesPerEpoch;){const C=await x.next();if(s&&C.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(C.value!=null){const{xs:I,ys:A}=bq(n,C.value),L={};L.batch=S,L.size=I[0].shape[0],await p.onBatchBegin(S,L);const O=[];if(t.classWeight!=null){const $=gq(t.classWeight,n.outputNames);for(let R=0;R<$.length;++R)O.push(await yq(A[R],null,$[R]))}const N=I.concat(A).concat(O),k=a(N);mt(N);for(let $=0;$<l.length;++$){const R=l[$],z=k[$];L[R]=z,ms(z)}await p.onBatchEnd(S,L),oq(L),S++,w++}if(s?w>=t.batchesPerEpoch:C.done){if(i){let I;Hz(t.validationData)?I=Zt(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):I=Zt(n.evaluate(r,o,{batchSize:t.validationBatchSize==null?zye:t.validationBatchSize,verbose:0}));for(let A=0;A<n.metricsNames.length;++A)v[`val_${n.metricsNames[A]}`]=I[A]}break}if(n.stopTraining_)break}if(await p.onEpochEnd(y,v),y++,n.stopTraining_)break}return await p.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function Wye(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function Hz(n){return typeof n.iterator=="function"}function Hye(n){return typeof n.next=="function"}async function jye(n,e,t){t=t||{};const s=t.batches!=null,i=n.testFunction;let r=[];if(t.verbose>0)throw new dt("Verbose mode is not implemented yet.");B(!s||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const o=Hye(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<t.batches;){const c=await o.next();if(r=ce(()=>{if(c.value){const{xs:h,ys:f}=bq(n,c.value),p=h.concat(f),g=ce(()=>i(p));if(mt(p),l===0)for(let x=0;x<g.length;++x)r.push(Qe(0));const y=p[0].shape[0];for(let x=0;x<g.length;++x){const v=g[x],w=r[x];r[x]=ce(()=>ke(r[x],Y(y,v))),l>0&&mt(w)}mt(g),a+=y,++l}return r}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<r.length;++c){const h=r[c];r[c]=qe(r[c],a),mt(h)}return Ki(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qN(n){B(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function hb(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(s=>kd(s,e,t-e)):kd(n,e,t-e)}function VR(n,e){return ce(()=>n==null?null:Array.isArray(n)?n.map(t=>VR(t,e)):GG(n,e.dtype==="int32"?e:De(e,"int32")))}function KN(n,e){const t=[];let s=0,i=null;for(;s<n;)i=s+e,i>=n&&(i=n),t.push([s,i]),s=i;return t}function vq(n){const e=[];n instanceof Kt&&(n=[n]);for(let t=0;t<n.length;++t){const s=n[t];if(s.rank===1)e.push(Nx(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Fo(n,e){if(n==null)return;const t=[];if(e instanceof Kt)t.push(e.id);else if(Array.isArray(e))e.forEach(i=>t.push(i.id));else if(e!=null)for(const i in e){const r=e[i];t.push(r.id)}const s=[];if(n instanceof Kt)t.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(i=>{t.indexOf(i.id)===-1&&s.push(i)});else if(n!=null)for(const i in n){const r=n[i];t.indexOf(r.id)===-1&&s.push(r)}s.forEach(i=>{i.isDisposed||i.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gye(n){return n instanceof Kt}function zR(n){return Array.isArray(n)}function jz(n){return!Gye(n)&&!zR(n)}function Gz(n,e,t,s=!0,i=""){if(e==null||e.length===0){if(n!=null){let o=!1;if(zR(n)&&n.length>0)o=!0;else if(jz(n)){for(const a in n)if(n.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new se(`Error when checking model ${i} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(o=>null);let r;if(jz(n)){n=n,r=[];for(const o of e){if(n[o]==null)throw new se(`No data provided for "${o}". Need data for each key in: ${e}`);r.push(n[o])}}else if(zR(n)){if(n=n,n.length!==e.length)throw new se(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);r=n}else{if(n=n,e.length>1)throw new se(`The model ${i} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);r=[n]}if(r=vq(r),t!=null)for(let o=0;o<e.length;++o){if(t[o]==null)continue;const a=r[o];if(a.shape.length!==t[o].length)throw new se(`Error when checking ${i}: expected ${e[o]} to have ${t[o].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<t[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],h=t[o][l];if(h!=null&&h>=0&&c!==h)throw new se(`${i} expected a batch of elements where each example has shape [${t[o].slice(1,t[o].length)}] (i.e.,tensor shape [*,${t[o].slice(1,t[o].length)}]) but the ${i} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return r}function qye(n,e,t){const s=Tu(n.map(r=>r.shape[0]));s.sort();const i=Tu(e.map(r=>r.shape[0]));if(i.sort(),s.length>1)throw new se(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(r=>r.shape))}`);if(i.length>1)throw new se(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(r=>r.shape))}`);if(s.length>0&&i.length>0&&!_t(s,i))throw new se(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${i[0]} target sample(s).`)}function Kye(n,e,t){const s=[RC,DC,w0];for(let i=0;i<n.length;++i){const r=n[i],o=e[i],a=t[i];if(o!=null){if(o===w0&&r.shape[r.shape.length-1]===1)throw new se(`You are passing a target array of shape ${r.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=r.shape.slice(1),c=a.slice(1);for(let h=0;h<l.length;++h){const f=l[h],p=c[h];if(p!=null&&f!==p)throw new se(`A target Tensor with shape ${r.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function qz(n,e,t,s=!0,i=""){let r;if(Array.isArray(n)){if(n.length!==e.length)throw new se(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);r=n}else{if(e.length>1)throw new se(`The model expects ${e.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);r=[n]}if(t!=null)for(let o=0;o<e.length;++o){if(t[o]==null)continue;const a=r[o];if(a.shape.length!==t[o].length)throw new se(`Error when checking ${i}: expected ${e[o]} to have ${t[o].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<t[o].length;++l){if(l===0&&!s)continue;const c=a.shape[l],h=t[o][l];if(h!=null&&h!==c)throw new se(`Error when checking ${i}: expected ${e[o]} to have shape ${JSON.stringify(t[o])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function Xye(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(s=>t);{const s=[];for(const i of e){let r=t.hasOwnProperty(i)?t[i]:[];Array.isArray(r)||(r=[r]),s.push(r)}return s}}const Yye="layers-model";class Fp extends Vo{constructor(e){super(e),this.isTraining=!1}summary(e,t,s=console.log){if(!this.built)throw new se("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Dye(this,e,t,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Rye(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof _c))throw new se("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new se(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),t.push(GN(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new se(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(a=>GN(a))}else{const o=GN(e.loss);this.outputs.forEach(a=>{t.push(o)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const a=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Id("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([a,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const i=Xye(e.metrics,this.outputNames),r=(o,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[o]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,o])};Id("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const a=i[o];(c=>{const h="";let f,p,g;for(const y of c){if(typeof y=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(y)!==-1){const v=this.internalOutputShapes[o];v[v.length-1]===1||this.lossFunctions[o]===DC?["accuracy","acc"].indexOf(y)!==-1?p=uq:["crossentropy","ce"].indexOf(y)!==-1&&(p=wye):this.lossFunctions[o]===xT?["accuracy","acc"].indexOf(y)!==-1?p=_ye:["crossentropy","ce"].indexOf(y)!==-1&&(p=fq):["accuracy","acc"].indexOf(y)!==-1?p=hq:["crossentropy","ce"].indexOf(y)!==-1&&(p=dq);let w;["accuracy","acc"].indexOf(y)!==-1?w="acc":["crossentropy","ce"].indexOf(y)!==-1&&(w="ce"),g=p,f=h+w}else g=Aye(y),f=h+M_(y);let x;Id(f,()=>{x=g}),r(o,f,x)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,s={}){const i=s.batchSize==null?32:s.batchSize;qN(i);const o=this.standardizeUserDataXY(e,t,!0,i);try{const a=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,i,s.verbose,s.steps);return Ki(c)}finally{Fo(o[0],e),Fo(o[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),jye(this,e,t)}checkNumSamples(e,t,s,i="steps"){let r;if(s!=null){if(r=null,t!=null)throw new se(`If ${i} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?r=e[0].shape[0]:r=e.shape[0];else throw new se(`Either the input data should have a defined shape, or ${i} shoud be specified.`);return r}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new se("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(t),i=s?t:[t],r=this.retrieveSymbolicTensors(i),o=new yu;if(e instanceof Kt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new se(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new se(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const a=Ib(r,o);return s?a:a[0]}retrieveSymbolicTensors(e){const t=jd(null,e.length);let s=e.length;for(const i of this.layers){const r=Array.isArray(i.output)?i.output:[i.output],o=r.map(a=>a.name);for(let a=0;a<e.length;++a){const l=o.indexOf(e[a]);if(l!==-1&&(t[a]=r[l],s--),s===0)break}if(s===0)break}if(s>0){const i=[];throw t.forEach((r,o)=>{r==null&&i.push(e[o])}),new se(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(i)}`)}return t}predictLoop(e,t=32,s=!1){return ce(()=>{const i=this.checkNumSamples(e);if(s)throw new dt("Verbose predictLoop() is not implemented yet.");const r=KN(i,t),o=this.outputs.map(a=>[]);for(let a=0;a<r.length;++a)ce(()=>{const c=r[a][0],h=r[a][1],f=hb(e,c,h),p=[];if(Array.isArray(f))for(let y=0;y<f.length;++y)p.push({key:this.inputs[y],value:f[y]});else p.push({key:this.inputs[0],value:f});const g=new yu(p);return Ib(this.outputs,g)}).forEach((c,h)=>o[h].push(c));return Ki(o.map(a=>Kn(a,0)))})}predict(e,t={}){const s=vq(e);qz(s,this.inputNames,this.feedInputShapes,!1);try{const i=t.batchSize==null?32:t.batchSize;return qN(i),this.predictLoop(s,i)}finally{Fo(s,e)}}predictOnBatch(e){qz(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,s=!0,i){if(this.optimizer_==null)throw new bo("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let o=0;o<this.feedOutputShapes.length;++o){const a=this.feedOutputShapes[o];this.feedLossFns[o]===xT?r.push(a.slice(0,a.length-1).concat([1])):r.push(a)}if(e=Gz(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=Gz(t,this.feedOutputNames,r,!1,"target"),qye(e,t),Kye(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&e[0].shape[0]%i!==0)throw new se(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${i}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,s,i,r=!0,o){const[a,l]=this.standardizeUserDataXY(e,t,r,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(i!=null){const h=gq(i,this.outputNames);c=[];for(let f=0;f<h.length;++f)c.push(await yq(l[f],null,h[f]))}return[a,l,c]}testLoop(e,t,s,i=0,r){return ce(()=>{const o=this.checkNumSamples(t,s,r,"steps"),a=[];if(i>0)throw new dt("Verbose mode is not implemented yet.");if(r!=null)throw new dt("steps mode in testLoop() is not implemented yet");{const l=KN(o,s),c=fi(ta(0,o));for(let h=0;h<l.length;++h){const f=l[h][0],p=l[h][1],g=kd(c,f,p-f),y=VR(t,g),x=e(y);if(h===0)for(let v=0;v<x.length;++v)a.push(Qe(0));for(let v=0;v<x.length;++v){const w=x[v];a[v]=ke(a[v],Y(p-f,w))}}for(let h=0;h<a.length;++h)a[h]=qe(a[h],o)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let s=0;s<e.length;++s){const i=e[s];let r=i;if(Rz(e,i)>1){const o=Rz(e.slice(0,s),i);r+=`_${o}`}t.push(r)}return t}makeTrainFunction(){return e=>{const t=[],s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],a=()=>{const f=[];for(let x=0;x<this.inputs.length;++x)f.push({key:this.inputs[x],value:s[x]});const p=new yu(f),g=Ib(this.outputs,p,{training:!0});let y;for(let x=0;x<this.lossFunctions.length;++x){const v=this.lossFunctions[x];let w=v(i[x],g[x]);r[x]!=null&&(w=Vye(w,r[x]));const S=Rn(w);t.push(S),x===0?y=w:y=ke(y,w)}for(let x=0;x<this.metricsTensors.length;++x){let v;if(this.outputs.length>1&&x<this.outputs.length)v=t[x];else{const w=this.metricsTensors[x][0],S=this.metricsTensors[x][1];v=Rn(w(i[S],g[S]))}ms(v),o.push(v)}return y=Rn(y),this.calculateLosses().forEach(x=>{y=ke(y,x)}),y},l=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(a,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=e=>ce(()=>{const t=[];let s;const i=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:i[c]});const a=new yu(o),l=Ib(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const h=this.lossFunctions[c],f=Rn(h(r[c],l[c]));c===0?s=f:s=ke(s,f),t.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const h=this.metricsTensors[c][0],f=this.metricsTensors[c][1],p=Rn(h(r[f],l[f]));t.push(p)}return t})}async fit(e,t,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let i,r,o,a,l,c,h,f,p;try{const g=s.batchSize==null?32:s.batchSize;qN(g);const x=await this.standardizeUserData(e,t,s.sampleWeight,s.classWeight,!1,g);i=x[0],r=x[1],p=x[2];let v=!1,w;if(s.validationData!=null&&s.validationData.length>0){if(v=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new dt("validationData including sample weights is not supported yet."):new se(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const $=await this.standardizeUserData(l,c,null,null,!0,g);h=$[0],f=$[1],w=h.concat(f)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){v=!0;const k=Math.floor(i[0].shape[0]*(1-s.validationSplit)),$=i[0].shape[0];h=hb(i,k,$),o=i,i=hb(i,0,k),f=hb(r,k,$),a=r,r=hb(r,0,k),w=h.concat(f)}else s.validationSteps!=null&&(v=!0);const S=i.concat(r).concat(p);this.checkTrainableWeightsConsistency();const C=this.makeTrainFunction(),I=this.getDedupedMetricsNames();let A,L;v?(this.makeTestFunction(),A=this.testFunction,L=I.slice().concat(I.map(k=>"val_"+k))):(A=null,w=[],L=I.slice());const O=aq(s.callbacks,s.yieldEvery);return await this.fitLoop(C,S,I,g,s.epochs,s.verbose,O,A,w,s.shuffle,L,s.initialEpoch,null,null)}finally{this.isTraining=!1,Fo(i,e),Fo(r,t),Fo(o,e),Fo(a,t),Fo(h,l),Fo(f,c),p!=null&&mt(p)}}async fitLoop(e,t,s,i,r,o,a,l,c,h,f,p,g,y){i==null&&(i=32),r==null&&(r=1),h==null&&(h=!0),p==null&&(p=0);let x=!1;if(l!=null&&c!=null&&(x=!0),y!=null&&(x=!0,g==null))throw new se("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(t,i,g,"steps_per_epoch");let w;v!=null&&(w=ta(0,v)),o==null&&(o=1);const{callbackList:S,history:C}=lq(a,o,r,p,v,g,i,x,f);S.setModel(this),this.history=C,await S.onTrainBegin(),this.stopTraining_=!1;for(let I=p;I<r;++I){await S.onEpochBegin(I);const A={};if(g!=null)throw new dt("stepsPerEpoch mode is not implemented yet.");{if(h==="batch")throw new dt("batch shuffling is not implemneted yet");h&&bD(w);const L=fi(w),O=KN(v,i);for(let N=0;N<O.length;++N){const k={};if(await S.onBatchBegin(N,k),ce(()=>{const $=O[N][0],R=O[N][1],z=kd(L,$,R-$);k.batch=N,k.size=R-$;const V=VR(t,z),ne=e(V);for(let Q=0;Q<s.length;++Q){const G=s[Q],J=ne[Q];k[G]=J,ms(J)}if(N===O.length-1&&x){const Q=this.testLoop(l,c,i);for(let G=0;G<s.length;++G){const J=s[G],Z=Q[G];ms(Z),A["val_"+J]=Z}}}),await S.onBatchEnd(N,k),oq(k),this.stopTraining_)break}L.dispose()}if(await S.onEpochEnd(I,A),this.stopTraining_)break}return await S.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return Uye(this,e,t)}async trainOnBatch(e,t){const s=await this.standardizeUserData(e,t),i=s[0],r=s[1],a=this.makeTrainFunction()(i.concat(r)),l=[];for(const c of a){const h=await c.data();l.push(h[0])}return mt(a),Fo(s[0],e),Fo(s[1],t),Ki(l)}getNamedWeights(e){const t=[],s=e!=null&&e.trainableOnly,i=s?this.trainableWeights:this.weights,r=this.getWeights(s);for(let o=0;o<i.length;++o)s&&!i[o].trainable||t.push({name:i[o].originalName,tensor:r[o]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=aR().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-aR().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Vl(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>Vl(t))}else{const t=Object.keys(this.loss);e={};const s=this.loss;for(const i of t)if(typeof s[i]=="string")e[i]=Vl(s[i]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Vl(M_(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Vl(M_(e)));{const e={};for(const t in this.metrics)e[t]=Vl(M_(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=MR(e.optimizer_config),s=Yl(t);let i;if(typeof e.loss=="string")i=fd(e.loss);else if(Array.isArray(e.loss))i=e.loss.map(o=>fd(o));else if(e.loss!=null){i={};for(const o in e.loss)i[o]=fd(e.loss[o])}let r;if(Array.isArray(e.metrics))r=e.metrics.map(o=>fd(o));else if(e.metrics!=null){r={};for(const o in e.metrics)r[o]=fd(e.metrics[o])}this.compile({loss:i,metrics:r,optimizer:s})}async save(e,t){if(typeof e=="string"){const c=R6(e);if(c.length===0)throw new se(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new se(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new se("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await lR(this.getNamedWeights(t)),a={modelTopology:this.toJSON(null,!1),format:Yye,generatedBy:`TensorFlow.js tfjs-layers v${mq}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:h,specs:f}=await lR(await this.optimizer.getWeights(),c);s.specs.push(...f),s.data=k6([s.data,h])}return this.userDefinedMetadata!=null&&(Uz(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){Uz(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Fp.className="Model";Ne(Fp);class xq extends Fp{}xq.className="Functional";Ne(xq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _0 extends Fp{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:kC("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new se(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof _0||e instanceof Fp;let s;if(t){if(s=e,s.outputs.length!==1)throw new se("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new se("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new se("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const i=Zge({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(i)}if(t)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new se(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new se("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=tq(this.outputs[0])}this.inboundNodes=[],new AC({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:jd(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(i=>i.shape),outputShapes:this.outputs[0].shape})}else{const i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(Bt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Fp({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,s=console.log){this.built||this.build(),super.summary(e,t,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,s={}){if(!this.built)throw new bo("The model needs to be compiled before being used.");return this.model.evaluate(e,t,s)}async evaluateDataset(e,t){if(!this.built)throw new bo("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,s={}){if(!this.built)throw new bo("The model needs to be compiled before being used.");return this.model.fit(e,t,s)}async fitDataset(e,t){if(!this.built)throw new bo("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,s={},i=!1){let r,o={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new se("Legacy serialization format not supported yet.");r=t}else B(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),r=t.layers,delete t.layers,o=t;const a=new e(o);if(!(a instanceof _0))throw new dt(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of r){const h=Yl(l,void 0,i);i&&h.setFastWeightInitDuringBuild(!0),a.add(h)}return a}set stopTraining(e){if(this.model==null)throw new se("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new se("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const s={};s.className=t.getClassName(),s.config=t.getConfig(),e.push(s)}return{name:this.name,layers:e}}}_0.className="Sequential";Ne(_0);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let mi=class extends pf{getConfig(){return{}}};class wq extends mi{apply(e,t=1){return Lge(e,t)}}wq.className="elu";Ne(wq);class _q extends mi{apply(e){return sC(e)}}_q.className="selu";Ne(_q);class Tq extends mi{apply(e){return oa(e)}}Tq.className="relu";Ne(Tq);class Sq extends mi{apply(e){return ce(()=>Bu(6,oa(e)))}}Sq.className="relu6";Ne(Sq);class Eq extends mi{apply(e){return e}}Eq.className="linear";Ne(Eq);class Cq extends mi{apply(e){return Yo(e)}}Cq.className="sigmoid";Ne(Cq);class Iq extends mi{apply(e){return Fge(e)}}Iq.className="hardSigmoid";Ne(Iq);class kq extends mi{apply(e){return df(e)}}kq.className="softplus";Ne(kq);class Nq extends mi{apply(e){return Mge(e)}}Nq.className="softsign";Ne(Nq);class Aq extends mi{apply(e){return zu(e)}}Aq.className="tanh";Ne(Aq);let OO=class extends mi{apply(e,t=-1){return Ng(e,t)}};OO.className="softmax";Ne(OO);class Rq extends mi{apply(e,t=-1){return XE(e,t)}}Rq.className="logSoftmax";Ne(Rq);class Dq extends mi{apply(e){return ce(()=>ce(()=>{const t=Math.sqrt(2),s=Y(.5,ke(1,GE(qe(e,t))));return Y(e,s)}))}}Dq.className="gelu";Ne(Dq);class $q extends mi{apply(e){return ce(()=>Y(.5,Y(e,ke(1,zu(Y(Os(qe(2,Math.PI)),ke(e,Y(.044715,Za(e,3)))))))))}}$q.className="gelu_new";Ne($q);class Oq extends mi{apply(e){return ce(()=>Y(e,zu(df(e))))}}Oq.className="mish";Ne(Oq);class Pq extends mi{apply(e,t=1){return ce(()=>Y(Yo(Y(e,t)),e))}}Pq.className="swish";Ne(Pq);function Wu(n){return n.getClassName()}function XN(n,e={}){return kx(n,$r.getMap().classNameMap,e,"activation")}function Hu(n){if(n==null){const e={};return e.className="linear",e.config={},XN(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},XN(e)}else return n instanceof mi?n:XN(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qye(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class Lq extends pf{}class Mq extends Lq{constructor(e){super(),Qye(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ce(()=>{let t=qn([1]);return this.hasL1&&(t=ke(t,We(Y(this.l1,is(e))))),this.hasL2&&(t=ke(t,We(Y(this.l2,Ax(e))))),te(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}Mq.className="L1L2";Ne(Mq);const Kz={l1l2:"L1L2"};function hn(n){return xO(n)}function Xz(n,e={}){return kx(n,$r.getMap().classNameMap,e,"regularizer")}function kn(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in Kz?Kz[n]:n,config:{}};return Xz(t)}else return n instanceof Lq?n:Xz(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fq extends vt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=st(e);let s=oa(e);return this.maxValue!=null&&(s=tr(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}Fq.className="ReLU";Ne(Fq);class Vq extends vt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=st(e);return fx(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}Vq.className="LeakyReLU";Ne(Vq);class zq extends vt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=In(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=kn(e.alphaRegularizer),this.alphaConstraint=vs(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new se(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Bt(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const i of this.sharedAxes)t[i-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let i=1;i<e.length;++i)s[i]=e[i];this.inputSpec=[new ys({ndim:e.length,axes:s})],this.built=!0}call(e,t){return e=st(e),xx(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Dn(this.alphaInitializer),alphaRegularizer:hn(this.alphaRegularizer),alphaConstraint:bs(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}zq.className="PReLU";Ne(zq);let Bq=class extends vt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new dt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=st(e);return Eg(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};Bq.className="ELU";Ne(Bq);class Uq extends vt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const s=st(e);return Y(s,De(rr(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}Uq.className="ThresholdedReLU";Ne(Uq);class Wq extends vt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new OO().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return ce(()=>{let s=st(e);const i=t.mask;if(i!=null){const r=Y(Be(Yi(s.shape),De(i,s.dtype)),Qe(-1e9));s=ke(s,r)}return this.axis instanceof Array?this.axis.length>1?nr(Be(s,mx(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}Wq.className="Softmax";Ne(Wq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vp(n,e,t){if(typeof n=="number")return jd(n,e);if(n.length!==e)throw new se(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let s=0;s<e;++s){const i=n[s];if(!Dge(i))throw new se(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${i}`)}return n}function Qo(n,e,t,s,i=1){if(n==null)return n;const r=e+(e-1)*(i-1);let o;return t==="same"?o=n:o=n-r+1,Math.floor((o+s-1)/s)}function $a(n,e,t,s){if(n==null)return null;if(s==="valid")n=n*e+Uu([t-e,0]);else if(s==="same")n=n*e;else throw new se(`Unsupport padding mode: ${s}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function PO(n,e){return ce(()=>(Zn(e),e==="channelsFirst"?Et(n,[0,2,3,1]):n))}function Hq(n,e){return ce(()=>(Zn(e),e==="channelsFirst"?Et(n,[0,2,3,4,1]):n))}function Zye(n,e,t,s=1,i="valid",r,o=1){return ce(()=>{if(r==null&&(r=na()),Zn(r),n.shape.length!==3)throw new se(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new se(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new se(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(r==="channelsFirst"&&(n=Et(n,[0,2,1])),i==="causal")throw new dt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=UE(n,e,s,i==="same"?"same":"valid","NWC",o);return t!=null&&(a=aa(a,t)),a})}function Yz(n,e,t,s=[1,1],i="valid",r,o,a=null){return ce(()=>{if(r==null&&(r=na()),Zn(r),n.rank!==3&&n.rank!==4)throw new se(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new se(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=PO(n,r);if(i==="causal")throw new dt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=R5({x:l,filter:e,strides:s,pad:i==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:t,activation:a}),r==="channelsFirst"&&(l=Et(l,[0,3,1,2])),l})}function Jye(n,e,t,s=[1,1,1],i="valid",r,o){return ce(()=>{if(r==null&&(r=na()),Zn(r),n.rank!==4&&n.rank!==5)throw new se(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new se(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let a=Hq(n,r);if(i==="causal")throw new dt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=e$(a,e,s,i==="same"?"same":"valid","NDHWC",o),t!=null&&(a=aa(a,t)),r==="channelsFirst"&&(a=Et(a,[0,4,1,2,3])),a})}class $C extends vt{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",$C.verifyArgs(t),this.rank=e,As(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new dt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Vp(t.kernelSize,e,"kernelSize"),this.strides=Vp(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,jr(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Zn(this.dataFormat),this.activation=Hu(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=In(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=vs(t.biasConstraint),this.biasRegularizer=kn(t.biasRegularizer),this.activityRegularizer=kn(t.activityRegularizer),this.dilationRate=Vp(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new se(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new se(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new se(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Da("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!wO(e.kernelSize,"number",1,3))throw new se(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Wu(this.activation),useBias:this.useBias,biasInitializer:Dn(this.biasInitializer),biasRegularizer:hn(this.biasRegularizer),activityRegularizer:hn(this.activityRegularizer),biasConstraint:bs(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class Rg extends $C{constructor(e,t){super(e,t),this.kernel=null,Rg.verifyArgs(t),this.filters=t.filters,As(this.filters,"filters"),this.kernelInitializer=In(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=vs(t.kernelConstraint),this.kernelRegularizer=kn(t.kernelRegularizer)}build(e){e=Bt(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new se(`The channel dimension of the input should be defined. Found ${e[t]}`);const s=e[t],i=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:s}}],this.built=!0}call(e,t){return ce(()=>{e=st(e);let s;const i=this.bias==null?null:this.bias.read(),r=zG(this.activation.getClassName());if(r!=null&&this.rank===2)s=Yz(e,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(this.rank===1)s=Zye(e,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=Yz(e,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Jye(e,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new dt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Bt(e);const t=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let r=0;r<s.length;++r){const o=Qo(s[r],this.kernelSize[r],this.padding,this.strides[r],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[r]);t.push(o)}let i=[e[0]];return this.dataFormat==="channelsLast"?(i=i.concat(t),i.push(this.filters)):(i.push(this.filters),i=i.concat(t)),i}getConfig(){const e={filters:this.filters,kernelInitializer:Dn(this.kernelInitializer),kernelRegularizer:hn(this.kernelRegularizer),kernelConstraint:bs(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new se(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Ox extends Rg{constructor(e){super(2,e),Ox.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!wO(e.kernelSize,"number",1,2))throw new se(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Ox.className="Conv2D";Ne(Ox);class Px extends Rg{constructor(e){super(3,e),Px.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new se(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Px.className="Conv3D";Ne(Px);class jq extends Ox{constructor(e){if(super(e),this.inputSpec=[new ys({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new se(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Bt(e),e.length!==4)throw new se("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new se("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],i=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ys({ndim:4,axes:{[t]:s}})],this.built=!0}call(e,t){return ce(()=>{let s=st(e);if(s.shape.length!==4)throw new se(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const i=s.shape,r=i[0];let o,a;this.dataFormat==="channelsFirst"?(o=2,a=3):(o=1,a=2);const l=i[o],c=i[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.strides[0],g=this.strides[1],y=$a(l,p,h,this.padding),x=$a(c,g,f,this.padding),v=[r,y,x,this.filters];this.dataFormat!=="channelsLast"&&(s=Et(s,[0,2,3,1]));let w=WE(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=Et(w,[0,3,1,2])),this.bias!=null&&(w=aa(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=Bt(e);const t=e.slice();let s,i,r;this.dataFormat==="channelsFirst"?(s=1,i=2,r=3):(s=3,i=1,r=2);const o=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return t[s]=this.filters,t[i]=$a(t[i],l,o,this.padding),t[r]=$a(t[r],c,a,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}jq.className="Conv2DTranspose";Ne(jq);class Gq extends Px{constructor(e){if(super(e),this.inputSpec=[new ys({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new se(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Bt(e),e.length!==5)throw new se("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new se("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],i=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ys({ndim:5,axes:{[t]:s}})],this.built=!0}call(e,t){return ce(()=>{let s=st(e);if(s.shape.length!==5)throw new se(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const i=s.shape,r=i[0];let o,a,l;this.dataFormat==="channelsFirst"?(l=2,o=3,a=4):(l=1,o=2,a=3);const c=i[l],h=i[o],f=i[a],p=this.kernelSize[0],g=this.kernelSize[1],y=this.kernelSize[2],x=this.strides[0],v=this.strides[1],w=this.strides[2],S=$a(c,x,p,this.padding),C=$a(h,v,g,this.padding),I=$a(f,w,y,this.padding),A=[r,S,C,I,this.filters];this.dataFormat!=="channelsLast"&&(s=Et(s,[0,2,3,4,1]));let L=t$(s,this.kernel.read(),A,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(L=Et(L,[0,4,1,2,3])),this.bias!==null&&(L=aa(L,this.bias.read(),this.dataFormat)),this.activation!==null&&(L=this.activation.apply(L)),L})}computeOutputShape(e){e=Bt(e);const t=e.slice();let s,i,r,o;this.dataFormat==="channelsFirst"?(s=1,i=2,r=3,o=4):(s=4,i=1,r=2,o=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],h=this.strides[0],f=this.strides[1],p=this.strides[2];return t[s]=this.filters,t[i]=$a(t[i],h,a,this.padding),t[r]=$a(t[r],f,l,this.padding),t[o]=$a(t[o],p,c,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}Gq.className="Conv3DTranspose";Ne(Gq);class qq extends Rg{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new se("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new se("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new se(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=In(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=kn(t.depthwiseRegularizer),this.depthwiseConstraint=vs(t.depthwiseConstraint),this.pointwiseInitializer=In(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=kn(t.pointwiseRegularizer),this.pointwiseConstraint=vs(t.pointwiseConstraint)}build(e){if(e=Bt(e),e.length<this.rank+2)throw new se(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new se(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const s=e[t],i=this.kernelSize.concat([s,this.depthMultiplier]),r=[];for(let a=0;a<this.rank;++a)r.push(1);r.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new ys({ndim:this.rank+2,axes:{[t]:s}})],this.built=!0}call(e,t){return ce(()=>{e=st(e);let s;if(this.rank===1)throw new dt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Et(e,[0,2,3,1])),s=iC(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=aa(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Et(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Dn(this.depthwiseInitializer),e.pointwiseInitializer=Dn(this.pointwiseInitializer),e.depthwiseRegularizer=hn(this.depthwiseRegularizer),e.pointwiseRegularizer=hn(this.pointwiseRegularizer),e.depthwiseConstraint=bs(this.depthwiseConstraint),e.pointwiseConstraint=bs(this.pointwiseConstraint),e}}qq.className="SeparableConv";class Kq extends qq{constructor(e){super(2,e)}}Kq.className="SeparableConv2D";Ne(Kq);class OC extends Rg{constructor(e){super(1,e),OC.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!wO(e.kernelSize,"number",1,1))throw new se(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}OC.className="Conv1D";Ne(OC);class Xq extends vt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return ce(()=>{if(e=st(e),this.dataFormat==="channelsLast"){const s=L_(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return L_(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=L_(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return L_(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}Xq.className="Cropping2D";Ne(Xq);class Yq extends vt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Zn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Nge(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,s]}else{const t=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],t,s,e[3]]}}call(e,t){return ce(()=>{let s=st(e);const i=s.shape;if(this.dataFormat==="channelsFirst"){s=Et(s,[0,2,3,1]);const r=this.size[0]*i[2],o=this.size[1]*i[3],a=this.interpolation==="nearest"?yo.resizeNearestNeighbor(s,[r,o]):yo.resizeBilinear(s,[r,o]);return Et(a,[0,3,1,2])}else{const r=this.size[0]*i[1],o=this.size[1]*i[2];return this.interpolation==="nearest"?yo.resizeNearestNeighbor(s,[r,o]):yo.resizeBilinear(s,[r,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}Yq.className="UpSampling2D";Ne(Yq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ebe(n,e,t=[1,1],s="valid",i,r){return ce(()=>{i==null&&(i=na()),Zn(i);let o=PO(n,i);if(n.rank!==4)throw new se(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new se(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=Sg(o,e,t,s==="same"?"same":"valid","NHWC",r),i==="channelsFirst"&&(o=Et(o,[0,3,1,2])),o})}class Qq extends $C{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=In(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=vs(e.depthwiseConstraint),this.depthwiseRegularizer=kn(e.depthwiseRegularizer)}build(e){if(e=Bt(e),e.length<4)throw new se(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new se(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const s=e[t],i=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ce(()=>{e=st(e);let s=ebe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=aa(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Bt(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],i=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=Qo(t,this.kernelSize[0],this.padding,this.strides[0]),o=Qo(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],i,r,o]:[e[0],r,o,i]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Dn(this.depthwiseInitializer),e.depthwiseRegularizer=hn(this.depthwiseRegularizer),e.depthwiseConstraint=bs(this.depthwiseRegularizer),e}}Qq.className="DepthwiseConv2D";Ne(Qq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zq(n,e,t,s){if(Array.isArray(n)){if(e!=null||t!=null)throw new se("When inputs is an array, neither initialState or constants should be provided");s!=null&&(t=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function i(r){return r==null||Array.isArray(r)?r:[r]}return e=i(e),t=i(t),{inputs:n,initialState:e,constants:t}}function Jq(n,e,t,s=!1,i,r,o=!1,a=!1){return ce(()=>{const l=e.shape.length;if(l<3)throw new se(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(ta(2,l));e=Et(e,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=De(De(i,"bool"),"float32"),i.rank===l-1&&(i=ui(i,-1)),i=Et(i,c)),s&&(e=Wr(e,0),i!=null&&(i=Wr(i,0)));const h=[];let f,p=t;const g=e.shape[0],y=Hr(e);let x;i!=null&&(x=Hr(i));for(let w=0;w<g;++w){const S=y[w],C=ce(()=>n(S,p));if(i==null)f=C[0],p=C[1];else{const I=ce(()=>{const A=x[w],L=Be(vr(A),A),O=ke(Y(C[0],A),Y(p[0],L)),N=p.map((k,$)=>ke(Y(C[1][$],A),Y(k,L)));return{output:O,newStates:N}});f=I.output,p=I.newStates}a&&h.push(f)}let v;return a&&(v=sr(h,1)),[f,v,p]})}class hh extends vt{constructor(e){super(e);let t;if(e.cell==null)throw new se("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new FO({cells:e.cell}):t=e.cell,t.stateSize==null)throw new se("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new ys({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ta(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){OR(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const s=t[0];let i;if(this.returnSequences?i=[e[0],e[1],s]:i=[e[0],s],this.returnState){const r=[];for(const o of t)r.push([e[0],o]);return[i].concat(r)}else return i}computeMask(e,t){return ce(()=>{Array.isArray(t)&&(t=t[0]);const s=this.returnSequences?t:null;if(this.returnState){const i=this.states.map(r=>null);return[s].concat(i)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let s=0;s<e;++s)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new dt("Constants support is not implemented in RNN yet.");OR(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new ys({shape:[t,null,...s]});const i=[e[0]].concat(e.slice(2));this.cell.build(i);let r;if(Array.isArray(this.cell.stateSize)?r=this.cell.stateSize:r=[this.cell.stateSize],this.stateSpec!=null){if(!_t(this.stateSpec.map(o=>o.shape[o.shape.length-1]),r))throw new se(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=r.map(o=>new ys({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){ce(()=>{if(!this.stateful)throw new Ra("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new se("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>qn([s,i])):this.states_=[qn([s,this.cell.stateSize])];else if(e==null)mt(this.states_),this.keptStates!=null&&(mt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>qn([s,i])):this.states_[0]=qn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new se(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):mt(this.states_);for(let i=0;i<this.states_.length;++i){const r=e[i],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,a=[s,o];if(!_t(r.shape,a))throw new se(`State ${i} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${r.shape}`);this.states_[i]=r}}this.states_=this.states_.map(i=>ms(i.clone()))})}apply(e,t){let s=t==null?null:t.initialState,i=t==null?null:t.constants;t==null&&(t={});const r=Zq(e,s,i,this.numConstants);e=r.inputs,s=r.initialState,i=r.constants;let o=[],a=[];if(s!=null){t.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new ys({shape:c.shape}));a=a.concat(this.stateSpec)}if(i!=null&&(t.constants=i,o=o.concat(i),this.numConstants=i.length),o[0]instanceof el){const c=[e].concat(o),h=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=h;const p=super.apply(c,t);return this.inputSpec=f,p}else return super.apply(e,t)}call(e,t){return ce(()=>{const s=t==null?null:t.mask,i=t==null?null:t.training;let r=t==null?null:t.initialState;e=st(e),r==null&&(this.stateful?r=this.states_:r=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==o)throw new se(`RNN Layer has ${o} state(s) but was passed ${r.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:i},c=Jq((y,x)=>{const v=this.cell.call([y].concat(x),a);return[v[0],v.slice(1)]},e,r,this.goBackwards,s,null,this.unroll,this.returnSequences),h=c[0],f=c[1],p=c[2];this.stateful&&this.resetStates(p,i);const g=this.returnSequences?f:h;return this.returnState?[g].concat(p):g})}getInitialState(e){return ce(()=>{let t=qn(e.shape);return t=We(t,[1,2]),t=Nx(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?DR(t,[1,s]):t):this.cell.stateSize>1?[DR(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===hh.className&&(t.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),t)}static fromConfig(e,t,s={}){const i=t.cell,r=Yl(i,s);return new e(Object.assign(t,{cell:r}))}}hh.className="RNN";Ne(hh);class PC extends vt{}class LO extends PC{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,As(this.units,"units"),this.activation=Hu(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=In(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=In(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=In(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=kn(e.kernelRegularizer),this.recurrentRegularizer=kn(e.recurrentRegularizer),this.biasRegularizer=kn(e.biasRegularizer),this.kernelConstraint=vs(e.kernelConstraint),this.recurrentConstraint=vs(e.recurrentConstraint),this.biasConstraint=vs(e.biasConstraint),this.dropout=sm([1,Uu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=sm([1,Uu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Bt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ce(()=>{if(e=e,e.length!==2)throw new se(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const i=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ju({ones:()=>vr(e),rate:this.dropout,training:i,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ju({ones:()=>vr(s),rate:this.recurrentDropout,training:i,dropoutFunc:this.dropoutFunc}));let r;const o=this.dropoutMask,a=this.recurrentDropoutMask;o!=null?r=Ua(Y(e,o),this.kernel.read()):r=Ua(e,this.kernel.read()),this.bias!=null&&(r=aa(r,this.bias.read())),a!=null&&(s=Y(s,a));let l=ke(r,Ua(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Wu(this.activation),useBias:this.useBias,kernelInitializer:Dn(this.kernelInitializer),recurrentInitializer:Dn(this.recurrentInitializer),biasInitializer:Dn(this.biasInitializer),kernelRegularizer:hn(this.kernelRegularizer),recurrentRegularizer:hn(this.recurrentRegularizer),biasRegularizer:hn(this.biasRegularizer),activityRegularizer:hn(this.activityRegularizer),kernelConstraint:bs(this.kernelConstraint),recurrentConstraint:bs(this.recurrentConstraint),biasConstraint:bs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}LO.className="SimpleRNNCell";Ne(LO);class e9 extends hh{constructor(e){e.cell=new LO(e),super(e)}call(e,t){return ce(()=>{this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,i=t==null?null:t.training,r=t==null?null:t.initialState;return super.call(e,{mask:s,training:i,initialState:r})})}static fromConfig(e,t){return new e(t)}}e9.className="SimpleRNN";Ne(e9);class MO extends PC{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new se("GRUCell does not support reset_after parameter set to true.");this.units=e.units,As(this.units,"units"),this.activation=Hu(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Hu(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=In(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=In(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=In(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=kn(e.kernelRegularizer),this.recurrentRegularizer=kn(e.recurrentRegularizer),this.biasRegularizer=kn(e.biasRegularizer),this.kernelConstraint=vs(e.kernelConstraint),this.recurrentConstraint=vs(e.recurrentConstraint),this.biasConstraint=vs(e.biasConstraint),this.dropout=sm([1,Uu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=sm([1,Uu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Bt(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ce(()=>{if(e=e,e.length!==2)throw new se(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training==null?!1:t.training;let i=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ju({ones:()=>vr(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ju({ones:()=>vr(i),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const r=this.dropoutMask,o=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=Y(e,r[0]));let h=Ua(e,this.kernel.read());this.useBias&&(h=aa(h,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=Y(i,o[0]));const f=this.recurrentKernel.read(),[p,g]=Zi(f,[2*this.units,this.units],f.rank-1),y=Ua(i,p),[x,v,w]=Zi(h,3,h.rank-1),[S,C]=Zi(y,2,y.rank-1);a=this.recurrentActivation.apply(ke(x,S)),l=this.recurrentActivation.apply(ke(v,C));const I=Ua(Y(l,i),g);c=this.activation.apply(ke(w,I));const A=ke(Y(a,i),Y(ke(1,gn(a)),c));return[A,A]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Wu(this.activation),recurrentActivation:Wu(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Dn(this.kernelInitializer),recurrentInitializer:Dn(this.recurrentInitializer),biasInitializer:Dn(this.biasInitializer),kernelRegularizer:hn(this.kernelRegularizer),recurrentRegularizer:hn(this.recurrentRegularizer),biasRegularizer:hn(this.biasRegularizer),activityRegularizer:hn(this.activityRegularizer),kernelConstraint:bs(this.kernelConstraint),recurrentConstraint:bs(this.recurrentConstraint),biasConstraint:bs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}MO.className="GRUCell";Ne(MO);class t9 extends hh{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new MO(e),super(e)}call(e,t){return ce(()=>{this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,i=t==null?null:t.training,r=t==null?null:t.initialState;return super.call(e,{mask:s,training:i,initialState:r})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}t9.className="GRU";Ne(t9);class LC extends PC{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,As(this.units,"units"),this.activation=Hu(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Hu(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=In(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=In(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=In(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=kn(e.kernelRegularizer),this.recurrentRegularizer=kn(e.recurrentRegularizer),this.biasRegularizer=kn(e.biasRegularizer),this.kernelConstraint=vs(e.kernelConstraint),this.recurrentConstraint=vs(e.recurrentConstraint),this.biasConstraint=vs(e.biasConstraint),this.dropout=sm([1,Uu([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=sm([1,Uu([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=Bt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let i;if(this.useBias){if(this.unitForgetBias){const r=this.biasInitializer,o=this.units;i=new(t=class extends Ao{apply(l,c){const h=r.apply([o]),f=new TO().apply([o]),p=r.apply([o*2]);return $z($z(h,f),p)}},t.className="CustomInit",t)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return ce(()=>{const s=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new se(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let i=e[1];const r=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ju({ones:()=>vr(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ju({ones:()=>vr(i),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,h,f;0<this.dropout&&this.dropout<1&&(e=Y(e,o[0]));let p=Ua(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=Y(i,a[0])),p=ke(p,Ua(i,this.recurrentKernel.read())),this.useBias&&(p=aa(p,this.bias.read()));const[g,y,x,v]=Zi(p,4,p.rank-1);l=this.recurrentActivation.apply(g),c=this.recurrentActivation.apply(y),h=ke(Y(c,r),Y(l,this.activation.apply(x))),f=this.recurrentActivation.apply(v);const w=Y(f,this.activation.apply(h));return[w,w,h]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Wu(this.activation),recurrentActivation:Wu(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Dn(this.kernelInitializer),recurrentInitializer:Dn(this.recurrentInitializer),biasInitializer:Dn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:hn(this.kernelRegularizer),recurrentRegularizer:hn(this.recurrentRegularizer),biasRegularizer:hn(this.biasRegularizer),activityRegularizer:hn(this.activityRegularizer),kernelConstraint:bs(this.kernelConstraint),recurrentConstraint:bs(this.recurrentConstraint),biasConstraint:bs(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}LC.className="LSTMCell";Ne(LC);class n9 extends hh{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new LC(e),super(e)}call(e,t){return ce(()=>{this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,i=t==null?null:t.training,r=t==null?null:t.initialState;return super.call(e,{mask:s,training:i,initialState:r})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}n9.className="LSTM";Ne(n9);class FO extends PC{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return ce(()=>{e=e;let s=e.slice(1);const i=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?i.push(s.splice(0,a.stateSize.length)):i.push(s.splice(0,1));i.reverse();const r=[];let o;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=i[a],a===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,t),r.push(o.slice(1))}s=[];for(const a of r.slice().reverse())s.push(...a);return[o[0]].concat(s)})}build(e){OR(e)&&(e=e[0]),e=e;let t;this.cells.forEach((s,i)=>{Id(`RNNCell_${i}`,()=>{s.build(e),Array.isArray(s.stateSize)?t=s.stateSize[0]:t=s.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=r=>({className:r.getClassName(),config:r.getConfig()}),i={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),i)}static fromConfig(e,t,s={}){const i=[];for(const r of t.cells)i.push(Yl(r,s));return new e({cells:i})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.cells)t.push(...s.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return PR(e)}setWeights(e){const t=[];for(const s of this.cells){const i=s.weights.length,r=e.splice(i);for(let o=0;o<s.weights.length;++o)t.push([s.weights[o],r[o]])}AO(t)}}FO.className="StackedRNNCells";Ne(FO);function ju(n){const{ones:e,rate:t,training:s=!1,count:i=1,dropoutFunc:r}=n,o=()=>r!=null?r(e(),t):qG(e(),t),a=()=>Rx(o,e,s);return!i||i<=1?ms(a().clone()):Array(i).fill(void 0).map(a).map(c=>ms(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var tbe=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};class s9 extends hh{constructor(e){if(e.unroll)throw new dt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new dt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new ys({ndim:5})]}call(e,t){return ce(()=>{if(this.cell.dropoutMask!=null&&(mt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(mt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new se("ConvRNN2D cell does not support constants");const s=t==null?null:t.mask,i=t==null?null:t.training,r=t==null?null:t.initialState;return super.call(e,{mask:s,training:i,initialState:r})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return ce(()=>{const{stateSize:t}=this.cell,s=e.shape,i=this.computeSingleOutputShape(s),r=[i[0],...i.slice(2)],o=qn(r);return Array.isArray(t)?Array(t.length).fill(o):[o]})}resetStates(e,t=!1){ce(()=>{if(!this.stateful)throw new Ra("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,i=this.computeSingleOutputShape(s),r=[i[0],...i.slice(2)];if(s[0]==null)throw new se("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>qn(r)):this.states_=[qn(r)];else if(e==null)mt(this.states_),this.keptStates!=null&&(mt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>qn(r)):this.states_[0]=qn(r);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new se(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):mt(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=r;if(!_t(l.shape,c))throw new se(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>ms(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:s,kernelSize:i,padding:r,strides:o,dilationRate:a}=this.cell,l=t==="channelsFirst",c=e[l?3:2],h=e[l?4:3],f=Qo(c,i[0],r,o[0],a[0]),p=Qo(h,i[1],r,o[1],a[1]);return[...e.slice(0,2),...l?[s,f,p]:[f,p,s]]}}s9.className="ConvRNN2D";class VO extends LC{constructor(e){const{filters:t,kernelSize:s,strides:i,padding:r,dataFormat:o,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,As(this.filters,"filters"),this.kernelSize=Vp(s,2,"kernelSize"),this.kernelSize.forEach(l=>As(l,"kernelSize")),this.strides=Vp(i||1,2,"strides"),this.strides.forEach(l=>As(l,"strides")),this.padding=r||"valid",jr(this.padding),this.dataFormat=o||"channelsLast",Zn(this.dataFormat),this.dilationRate=Vp(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>As(l,"dilationRate"))}build(e){var t;e=Bt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new se(`The channel dimension of the input should be defined. Found ${e[s]}`);const i=e[s],r=4,o=this.kernelSize.concat([i,this.filters*r]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*r]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,h=this.filters;l=new(t=class extends Ao{apply(p,g){const y=c.apply([h]),x=Yi([h]),v=c.apply([h*2]);return _O([y,x,v])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*r],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return ce(()=>{if(e.length!==3)throw new se(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training||!1,i=e[0],r=e[1],o=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ju({ones:()=>vr(i),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(H,ee,he)=>!ee||!ee[he]?H:Y(ee[he],H);let h=c(i,l,0),f=c(i,l,1),p=c(i,l,2),g=c(i,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ju({ones:()=>vr(r),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const y=this.recurrentDropoutMask;let x=c(r,y,0),v=c(r,y,1),w=c(r,y,2),S=c(r,y,3);const C=3,[I,A,L,O]=Zi(this.kernel.read(),a,C),[N,k,$,R]=this.useBias?Zi(this.bias.read(),a):[null,null,null,null];h=this.inputConv(h,I,N,this.padding),f=this.inputConv(f,A,k,this.padding),p=this.inputConv(p,L,$,this.padding),g=this.inputConv(g,O,R,this.padding);const[z,V,ne,Q]=Zi(this.recurrentKernel.read(),a,C);x=this.recurrentConv(x,z),v=this.recurrentConv(v,V),w=this.recurrentConv(w,ne),S=this.recurrentConv(S,Q);const G=this.recurrentActivation.apply(ke(h,x)),J=this.recurrentActivation.apply(ke(f,v)),Z=ke(Y(J,o),Y(G,this.activation.apply(ke(p,w)))),le=Y(this.recurrentActivation.apply(ke(g,S)),this.activation.apply(Z));return[le,le,Z]})}getConfig(){const e=super.getConfig(),{units:t}=e,s=tbe(e,["units"]),i={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),i)}inputConv(e,t,s,i){const r=sc(e,t,this.strides,i||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?aa(r,s,this.dataFormat):r}recurrentConv(e,t){return sc(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}VO.className="ConvLSTM2DCell";Ne(VO);class i9 extends s9{constructor(e){const t=new VO(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}i9.className="ConvLSTM2D";Ne(i9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zO extends vt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,s=[];for(let i=0;i<this.noiseShape.length;++i)s.push(this.noiseShape[i]==null?t[i]:this.noiseShape[i]);return s}call(e,t){return ce(()=>{this.invokeCallHook(e,t);const s=st(e);if(0<this.rate&&this.rate<1){const i=t.training==null?!1:t.training,r=this.getNoiseShape(s);return Rx(()=>qG(s,this.rate,r,this.seed),()=>s,i)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}zO.className="Dropout";Ne(zO);class r9 extends zO{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}r9.className="SpatialDropout1D";Ne(r9);class o9 extends vt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,As(this.units,"units"),this.activation=Hu(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=In(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=In(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=vs(e.kernelConstraint),this.biasConstraint=vs(e.biasConstraint),this.kernelRegularizer=kn(e.kernelRegularizer),this.biasRegularizer=kn(e.biasRegularizer),this.activityRegularizer=kn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Bt(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=Bt(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return ce(()=>{this.invokeCallHook(e,t);const s=st(e),i=zG(this.activation.getClassName());let r;return i!=null?r=Ua(s,this.kernel.read(),i,this.bias?this.bias.read():null):(r=Ua(s,this.kernel.read()),this.bias!=null&&(r=aa(r,this.bias.read())),this.activation!=null&&(r=this.activation.apply(r))),r})}getConfig(){const e={units:this.units,activation:Wu(this.activation),useBias:this.useBias,kernelInitializer:Dn(this.kernelInitializer),biasInitializer:Dn(this.biasInitializer),kernelRegularizer:hn(this.kernelRegularizer),biasRegularizer:hn(this.biasRegularizer),activityRegularizer:hn(this.activityRegularizer),kernelConstraint:bs(this.kernelConstraint),biasConstraint:bs(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}o9.className="Dense";Ne(o9);class a9 extends vt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Bt(e);for(const t of e.slice(1))if(t==null)throw new se(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Su(e,1)]}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let s=st(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const i=[0];for(let r=2;r<s.rank;++r)i.push(r);i.push(1),s=Et(s,i)}return Pge(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}a9.className="Flatten";Ne(a9);class l9 extends vt{constructor(e){super(e),this.supportsMasking=!0,this.activation=Hu(e.activation)}call(e,t){return ce(()=>{this.invokeCallHook(e,t);const s=st(e);return this.activation.apply(s)})}getConfig(){const e={activation:Wu(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}l9.className="Activation";Ne(l9);class c9 extends vt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return ce(()=>(e=st(e),$ge(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}c9.className="RepeatVector";Ne(c9);class u9 extends vt{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const s="Total size of new array must be unchanged.",i=t.slice();let r=1,o=null;for(let l=0;l<i.length;++l){const c=i[l];if(this.isUnknown(c))if(o===null)o=l;else throw new se("Can only specifiy one unknown dimension.");else r*=c}const a=Su(e);if(o!==null){if(r===0||a%r!==0)throw new se(s);i[o]=a/r}else if(a!==r)throw new se(s);return i}computeOutputShape(e){let t=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return ce(()=>{this.invokeCallHook(e,t);const s=st(e),i=s.shape,r=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return te(s,r)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}u9.className="Reshape";Ne(u9);class h9 extends vt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=ta(1,e.dims.length+1);if(!_t(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new ys({ndim:this.dims.length+1})]}computeOutputShape(e){e=Bt(e);const t=e.slice();return this.dims.forEach((s,i)=>{t[i+1]=e[s]}),t}call(e,t){return Et(st(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}h9.className="Permute";Ne(h9);class d9 extends vt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const s=st(e);return g0(Bd(s,this.maskValue),-1)}call(e,t){return ce(()=>{this.invokeCallHook(e,t);const s=st(e),o=g0(Bd(s,this.maskValue),-1,!0);return Y(s,De(o,s.dtype))})}}d9.className="Masking";Ne(d9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class f9 extends vt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Zt(e.inputLength))}this.inputDim=e.inputDim,As(this.inputDim,"inputDim"),this.outputDim=e.outputDim,As(this.outputDim,"outputDim"),this.embeddingsInitializer=In(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=kn(e.embeddingsRegularizer),this.activityRegularizer=kn(e.activityRegularizer),this.embeddingsConstraint=vs(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return ce(()=>this.maskZero?(e=st(e),Bd(e,kt(e))):null)}computeOutputShape(e){if(e=Bt(e),this.inputLength==null)return[...e,this.outputDim];const t=Zt(this.inputLength);if(t.length!==e.length-1)throw new se(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let i=0;i<t.length;++i){const r=t[i],o=e[i+1];if(r!=null&&o!=null&&r!==o)throw new se(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);r==null&&(t[s]=o),s++}}return[e[0],...t,this.outputDim]}call(e,t){return ce(()=>{this.invokeCallHook(e,t);let s=st(e);s.dtype!=="int32"&&(s=Ba(s,"int32"));const i=GG(this.embeddings.read(),te(s,[s.size]));return te(i,Bt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Dn(this.embeddingsInitializer),embeddingsRegularizer:hn(this.embeddingsRegularizer),activityRegularizer:hn(this.activityRegularizer),embeddingsConstraint:bs(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}f9.className="Embedding";Ne(f9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let gf=class extends vt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new dt}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const s=e.slice(0,e.length-t.length);for(let i=0;i<t.length;++i){const r=e[e.length-t.length+i],o=t[i];if(r==null||o==null||r<0||o<0)s.push(null);else if(r===1)s.push(o);else if(o===1)s.push(r);else{if(r!==o)throw new se("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));s.push(r)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Bt(e)]),e=e,e.length<2)throw new se(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const r of e)r!=null&&r[0]!==null&&t.push(r[0]);if(t=Tu(t),t.length>1)throw new se(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let r=1;r<e.length;++r){const o=e[r]==null?null:e[r].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const i=e.map(r=>r.length);e.indexOf(null)===-1&&Tu(i).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return ce(()=>{if(e=e,this.reshapeRequired){const s=[],i=e.map(r=>r.rank);if(i.indexOf(null)===-1){const r=Uu(i);for(let o of e){const a=o.rank;for(let l=0;l<r-a;++l)o=Nx(o,1);s.push(o)}return this.mergeFunction(s)}else{let r=!1;for(const l of e){const c=l.rank;if(c==null){const h=l.shape,f=h[0],p=h.slice(1).concat([f]);let g=te(l,[f].concat(Su(h.slice(1))));g=Et(g,[1,0]),g=te(g,p),s.push(g),r=!0}else if(c>1){const h=ta(1,c).concat([0]);s.push(Et(l,h)),r=!0}else s.push(l)}let o=this.mergeFunction(s);const a=o.rank;if(r){if(a==null){const l=o.shape,c=l.length,h=l[c-1],f=[h].concat(l.slice(0,l.length-1));o=te(Et(te(o,[-1,h]),[1,0]),f)}else if(a>1){const l=[a-1].concat(ta(0,a-1));o=Et(o,l)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let i=1;i<e.length;++i){const r=e[i]==null?null:e[i].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}let s=[];for(const i of e)i!=null&&i[0]!==null&&s.push(i[0]);return s=Tu(s),s.length===1?t=s.concat(t):t=[null].concat(t),t}computeMask(e,t){return ce(()=>{if(t==null)return null;if(!Array.isArray(t))throw new se("`mask` should be an Array");if(!Array.isArray(e))throw new se("`inputs` should be an Array");if(t.length!==e.length)throw new se(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(i=>i==null))return null;t=t.map(i=>i==null?i:ui(i,0));let s=t[0];for(let i=1;i<t.length-1;++i)s=ea(s,t[i]);return s})}};class p9 extends gf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=ke(t,e[s]);return t})}}p9.className="Add";Ne(p9);class m9 extends gf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=Y(t,e[s]);return t})}}m9.className="Multiply";Ne(m9);class g9 extends gf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=ke(t,e[s]);return Y(1/e.length,t)})}}g9.className="Average";Ne(g9);class y9 extends gf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=il(t,e[s]);return t})}}y9.className="Maximum";Ne(y9);class b9 extends gf{constructor(e){super(e)}mergeFunction(e){return ce(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=Bu(t,e[s]);return t})}}b9.className="Minimum";Ne(b9);class v9 extends gf{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new se("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const i of e)if(i!=null){t=!1;break}if(t)return;const s=[];for(let i=0;i<e.length;++i){const r=e[i].slice();r.splice(this.axis,1);let o=!1;for(const a of s)if(_t(a,r)){o=!0;break}o||s.push(r)}if(s.length>1)throw new se("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ce(()=>_O(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new se("A `Concatenate` layer should be called on a list of inputs.");const t=e,s=t[0].slice(),i=this.axis<0?s.length+this.axis:this.axis;for(const r of t.slice(1)){if(s[i]==null||r[i]==null){s[i]=null;break}s[i]+=r[i]}return s}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new se("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new se("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new se(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return ce(()=>{let s=!0;if(t.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const i=[];for(let o=0;o<e.length;++o)t[o]==null?i.push(De(vr(e[o]),"bool")):t[o].rank<e[o].rank?i.push(ui(t[o],-1)):i.push(t[o]);const r=Kn(i,this.axis);return BE(r,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}v9.className="Concatenate";Ne(v9);function db(n,e){for(;n<0;)n+=e;return n}function nbe(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new dt("batchDot is not implemented for tensors of 4D or higher rank yet");if(B(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),B(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new dt("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,i=e.shape.length;t==null&&(t=[s-1,i-2]);const r=t;return ce(()=>{let o;if(s>i){o=s-i;const l=[];for(let c=0;c<o;++c)l.push(1);e=te(e,e.shape.concat(l))}else if(i>s){o=i-s;const l=[];for(let c=0;c<o;++c)l.push(1);n=te(n,n.shape.concat(l))}else o=0;let a;if(n.shape.length===2&&e.shape.length===2)r[0]===r[1]?a=We(Y(n,e),r[0]):a=We(Y(Et(n,[1,0]),e),r[1]);else{const l=r[0]!==n.shape.length-1,c=r[1]===e.shape.length-1;a=pt(n,e,l,c)}if(o>0){let l;s>i?l=s+i-3:l=s-1;const c=[];for(let h=l;h<l+o;++h)c.push(h);a=xc(a,c)}return a.shape.length===1&&(a=ui(a,1)),a})}class x9 extends gf{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){B(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],s=e[1];if(t.length>3||s.length>3)throw new dt("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(t,s);if(t[i[0]]!==s[i[1]])throw new se(`Dimension incompatibility: ${t[i[0]]} !== ${s[i[1]]}`)}mergeFunction(e){if(e.length!==2)throw new se(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],s=e[1],i;return Array.isArray(this.axes)?i=this.axes.map((r,o)=>db(r,e[o].shape.length)):i=[db(this.axes,t.shape.length),db(this.axes,s.shape.length)],this.normalize&&(t=vT(t,i[0]),s=vT(s,i[1])),nbe(t,s,i)}interpretAxes(e,t){let s;return Array.isArray(this.axes)?s=this.axes:s=[db(this.axes,e.length),db(this.axes,t.length)],s}computeOutputShape(e){B(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),s=e[1].slice();if(t.length>3||s.length>3)throw new dt("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(t,s);t.splice(i[0],1),s.splice(i[1],1),s.splice(0,1);const r=t.concat(s);return r.length===1&&r.push(1),r}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}x9.className="Dot";Ne(x9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class w9 extends vt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return ce(()=>{this.invokeCallHook(e,t);const s=st(e);return Rx(()=>ke(NC(s.shape,0,this.stddev),s),()=>s,t.training||!1)})}}w9.className="GaussianNoise";Ne(w9);class _9 extends vt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ce(()=>{this.invokeCallHook(e,t);const s=st(e);return this.rate>0&&this.rate<1?Rx(()=>{const r=Math.sqrt(this.rate/(1-this.rate));return Y(s,NC(s.shape,1,r))},()=>s,t.training||!1):s})}}_9.className="GaussianDropout";Ne(_9);class T9 extends vt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||st(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ce(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return Rx(()=>{const r=st(e),a=-1.6732632423543772*1.0507009873554805;let l=bc(ch(s),this.rate);l=Ba(l,"float32");const c=((1-this.rate)*(1+this.rate*a**2))**-.5,h=-c*a*this.rate,f=ke(Y(r,l),Y(ke(l,-1),a));return ke(Y(f,c),h)},()=>st(e),t.training||!1)}return e})}}T9.className="AlphaDropout";Ne(T9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function T0(n,e,t,s,i,r=.001){let o;if(n.rank===2)o=HD(n,e,t,s,i,r);else if(n.rank===3)o=jD(n,e,t,s,i,r);else if(n.rank===4)o=GD(n,e,t,s,i,r);else throw new dt(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return o}function sbe(n,e,t,s,i=.001){return ce(()=>{const r=bx(n,s),o=r.mean,a=r.variance;return[T0(n,o,a,t,e,i),o,a]})}function ibe(n,e,t,s,i=.001){return ce(()=>{const r=bx(n,s),o=r.mean,a=r.variance,l=[];for(const y of ta(0,n.rank))s.indexOf(y)!==-1?l.push(1):l.push(n.shape[y]);const c=te(o,l),h=te(a,l),f=e==null?null:te(e,l),p=t==null?null:te(t,l);return[T0(n,c,h,p,f,i),o,a]})}function rbe(n,e,t,s,i=.001){return _t(s.slice().sort(),ta(0,n.rank-1))?sbe(n,e,t,s,i):ibe(n,e,t,s,i)}class S9 extends vt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=In(e.betaInitializer||"zeros"),this.gammaInitializer=In(e.gammaInitializer||"ones"),this.movingMeanInitializer=In(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=In(e.movingVarianceInitializer||"ones"),this.betaConstraint=vs(e.betaConstraint),this.gammaConstraint=vs(e.gammaConstraint),this.betaRegularizer=kn(e.betaRegularizer),this.gammaRegularizer=kn(e.gammaRegularizer)}build(e){e=Bt(e);const t=this.axis>=0?this.axis:this.axis+e.length,s=e[t];if(s==null)throw new se(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new ys({ndim:e.length,axes:{[t]:s}})];const i=[s];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return ce(()=>{const s=t.training==null?!1:t.training,i=st(e),r=i.shape,o=r.length,a=ta(0,o),l=this.axis>=0?this.axis:this.axis+o;a.splice(l,1);const c=jd(1,o);c[l]=r[l];const h=a.slice();h.sort();const f=!_t(h,ta(0,o).slice(0,o-1)),p=()=>{if(f){const S=te(this.movingMean.read(),c),C=te(this.movingVariance.read(),c),I=this.center?te(this.beta.read(),c):null,A=this.scale?te(this.gamma.read(),c):null;return T0(i,S,C,I,A,this.epsilon)}else return T0(i,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return p();const[g,y,x]=rbe(i,this.gamma.read(),this.beta.read(),a,this.epsilon),v=(S,C,I)=>{ce(()=>{const A=1-I,L=S.read(),O=Y(Be(L,C),A);S.write(Be(L,O))})};return(()=>{v(this.movingMean,y,this.momentum),v(this.movingVariance,x,this.momentum)})(),g})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Dn(this.betaInitializer),gammaInitializer:Dn(this.gammaInitializer),movingMeanInitializer:Dn(this.movingMeanInitializer),movingVarianceInitializer:Dn(this.movingVarianceInitializer),betaRegularizer:hn(this.betaRegularizer),gammaRegularizer:hn(this.gammaRegularizer),betaConstraint:bs(this.betaConstraint),gammaConstraint:bs(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}S9.className="BatchNormalization";Ne(S9);class E9 extends vt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=In(e.betaInitializer||"zeros"),this.gammaInitializer=In(e.gammaInitializer||"ones"),this.betaRegularizer=kn(e.betaRegularizer),this.gammaRegularizer=kn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Bt(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=t);for(const r of this.axis)if(r<0||r>=t)throw new Error(`Invalid axis: ${r}`);if(this.axis.length!==Tu(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(r=>e[r]),i=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,i):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,i):this.beta=null,this.built=!0}call(e,t){const s=st(e),i=s.shape,r=i.length;return ce(()=>{let{mean:a,variance:l}=bx(s,this.axis,!0);const c=jd(1,r);for(const x of this.axis)c[x]=i[x];const h=x=>x!=null&&x.shape.length!==r?te(x,c):x;let f=this.scale?h(this.gamma.read()):null,p=this.center?h(this.beta.read()):null;const g=[],y=[];for(let x=0;x<r;++x)this.axis.indexOf(x)!==-1?(g.push(i[x]),y.push(1)):(g.push(1),y.push(i[x]));return a=Or(a,g),l=Or(l,g),f!=null&&(f=Or(f,y)),p!=null&&(p=Or(p,y)),T0(s,a,l,p,f,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Dn(this.betaInitializer),gammaInitializer:Dn(this.gammaInitializer),betaRegularizer:hn(this.betaRegularizer),gammaRegularizer:hn(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}E9.className="LayerNormalization";Ne(E9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function obe(n,e,t){return ce(()=>{if(n.rank!==4)throw new se(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new se("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=na()),t!=="channelsLast"&&t!=="channelsFirst")throw new se(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return t==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],vc(n,s)})}class C9 extends vt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?na():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new se(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,s;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new se(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new se(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[t,s]}this.inputSpec=[new ys({ndim:4})]}computeOutputShape(e){e=Bt(e);let t,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],t,s]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],t,s,e[3]])}call(e,t){return ce(()=>obe(st(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}C9.className="ZeroPadding2D";Ne(C9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MC(n,e,t,s,i,r){return ce(()=>{Zn(i),UG(r),jr(s),t==null&&(t=[1,1]),s==null&&(s="valid"),i==null&&(i=na()),r==null&&(r="max"),n=PO(n,i);let o;const a=s==="same"?"same":"valid";return r==="max"?o=yx(n,e,t,a):o=cx(n,e,t,a),i==="channelsFirst"&&(o=Et(o,[0,3,1,2])),o})}function I9(n,e,t,s,i,r){return ce(()=>{Zn(i),UG(r),jr(s),t==null&&(t=[1,1,1]),s==null&&(s="valid"),i==null&&(i=na()),r==null&&(r="max"),n=Hq(n,i);let o;const a=s==="same"?"same":"valid";return r==="max"?o=m$(n,e,t,a):o=WD(n,e,t,a),i==="channelsFirst"&&(o=Et(o,[0,4,1,2,3])),o})}class k9 extends vt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new se(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(As(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new se(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);As(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,jr(this.padding),this.inputSpec=[new ys({ndim:3})]}computeOutputShape(e){e=Bt(e);const t=Qo(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return ce(()=>{this.invokeCallHook(e,t),e=Nx(st(e),2);const s=this.poolingFunction(st(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return xc(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class N9 extends k9{constructor(e){super(e)}poolingFunction(e,t,s,i,r){return Zn(r),jr(i),MC(e,t,s,i,r,"max")}}N9.className="MaxPooling1D";Ne(N9);class A9 extends k9{constructor(e){super(e)}poolingFunction(e,t,s,i,r){return Zn(r),jr(i),MC(e,t,s,i,r,"avg")}}A9.className="AveragePooling1D";Ne(A9);class R9 extends vt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new se(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];As(this.poolSize,"poolSize"),As(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Zn(this.dataFormat),jr(this.padding),this.inputSpec=[new ys({ndim:4})]}computeOutputShape(e){e=Bt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Qo(t,this.poolSize[0],this.padding,this.strides[0]),s=Qo(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s]:[e[0],t,s,e[3]]}call(e,t){return ce(()=>(this.invokeCallHook(e,t),this.poolingFunction(st(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class D9 extends R9{constructor(e){super(e)}poolingFunction(e,t,s,i,r){return Zn(r),jr(i),MC(e,t,s,i,r,"max")}}D9.className="MaxPooling2D";Ne(D9);class $9 extends R9{constructor(e){super(e)}poolingFunction(e,t,s,i,r){return Zn(r),jr(i),MC(e,t,s,i,r,"avg")}}$9.className="AveragePooling2D";Ne($9);class O9 extends vt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new se(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];As(this.poolSize,"poolSize"),As(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Zn(this.dataFormat),jr(this.padding),this.inputSpec=[new ys({ndim:5})]}computeOutputShape(e){e=Bt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],i=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Qo(t,this.poolSize[0],this.padding,this.strides[0]),s=Qo(s,this.poolSize[1],this.padding,this.strides[1]),i=Qo(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s,i]:[e[0],t,s,i,e[4]]}call(e,t){return ce(()=>(this.invokeCallHook(e,t),this.poolingFunction(st(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class P9 extends O9{constructor(e){super(e)}poolingFunction(e,t,s,i,r){return Zn(r),jr(i),I9(e,t,s,i,r,"max")}}P9.className="MaxPooling3D";Ne(P9);class L9 extends O9{constructor(e){super(e)}poolingFunction(e,t,s,i,r){return Zn(r),jr(i),I9(e,t,s,i,r,"avg")}}L9.className="AveragePooling3D";Ne(L9);class M9 extends vt{constructor(e){super(e),this.inputSpec=[new ys({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new dt}}class F9 extends M9{constructor(e){super(e||{})}call(e,t){return ce(()=>{const s=st(e);return Rn(s,1)})}}F9.className="GlobalAveragePooling1D";Ne(F9);class V9 extends M9{constructor(e){super(e||{})}call(e,t){return ce(()=>{const s=st(e);return Fr(s,1)})}}V9.className="GlobalMaxPooling1D";Ne(V9);class z9 extends vt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Zn(this.dataFormat),this.inputSpec=[new ys({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new dt}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class B9 extends z9{call(e,t){return ce(()=>{const s=st(e);return this.dataFormat==="channelsLast"?Rn(s,[1,2]):Rn(s,[2,3])})}}B9.className="GlobalAveragePooling2D";Ne(B9);class U9 extends z9{call(e,t){return ce(()=>{const s=st(e);return this.dataFormat==="channelsLast"?Fr(s,[1,2]):Fr(s,[2,3])})}}U9.className="GlobalMaxPooling2D";Ne(U9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class W9 extends vt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,s={}){const i=t.layer,r=Yl(i,s);delete t.layer;const o={layer:r};return Object.assign(o,t),new e(o)}}class H9 extends W9{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Bt(e),e.length<3)throw new se(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Bt(e);const t=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(t),i=e[1];return[s[0],i].concat(s.slice(1))}call(e,t){return ce(()=>(e=st(e),Jq((o,a)=>[st(this.layer.call(o,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}H9.className="TimeDistributed";Ne(H9);function abe(n){mf(kge,"BidirectionalMergeMode",n)}const lbe="concat";class j9 extends W9{constructor(e){super(e);const t=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=t,this.forwardLayer=Yl(s),t.goBackwards=t.goBackwards!==!0;const i={};if(i.className=e.layer.getClassName(),i.config=t,this.backwardLayer=Yl(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?lbe:e.mergeMode,abe(this.mergeMode),e.weights)throw new dt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,s=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let s,i,r;return this.returnState&&(r=t.slice(1)),s=t[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,i=[s]):this.mergeMode==null?i=[s,s.slice()]:i=[s],this.returnState?this.mergeMode==null?i.concat(r).concat(r.slice()):[s].concat(r).concat(r.slice()):Ki(i)}apply(e,t){let s=t==null?null:t.initialState,i=t==null?null:t.constants;t==null&&(t={});const r=Zq(e,s,i,this.numConstants);if(e=r.inputs,s=r.initialState,i=r.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&i==null)return super.apply(e,t);const o=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new se("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=s,o.push(...s);const h=s.map(f=>new ys({shape:f.shape}));this.forwardLayer.stateSpec=h.slice(0,c/2),this.backwardLayer.stateSpec=h.slice(c/2),a.push(...h)}if(i!=null)throw new dt("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof el;for(const c of o)if(c instanceof el!==l)throw new se("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(o),h=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=h;const p=super.apply(c,t);return this.inputSpec=f,p}else return super.apply(e,t)}call(e,t){return ce(()=>{const s=t.initialState;let i,r;if(s==null)i=this.forwardLayer.call(e,t),r=this.backwardLayer.call(e,t);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);i=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),r=this.backwardLayer.call(e,Object.assign(t,{initialState:c}))}let o;this.returnState&&(Array.isArray(i)&&(o=i.slice(1).concat(r.slice(1))),i=i[0],r=r[0]),this.returnSequences&&(r=Wr(r,1));let a;return this.mergeMode==="concat"?a=_O([i,r]):this.mergeMode==="sum"?a=ke(i,r):this.mergeMode==="ave"?a=Y(.5,ke(i,r)):this.mergeMode==="mul"?a=Y(i,r):this.mergeMode==null&&(a=[i,r]),this.returnState?this.mergeMode==null?a.concat(o):[a].concat(o):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Id(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Id(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[t,t]:s=t:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const r=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(r).concat(r):[s].concat(r).concat(r)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const s=Yl(t.layer);if(delete t.layer,t.numConstants!=null)throw new dt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=t;return i.layer=s,new e(i)}}j9.className="Bidirectional";Ne(j9);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class G9 extends vt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ce(()=>(e=st(e),e.dtype!=="float32"&&(e=Ba(e,"float32")),ke(Y(e,this.scale),this.offset)))}}G9.className="Rescaling";Ne(G9);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:cbe,cropAndResize:ube}=yo;class q9 extends vt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,s,i,r,o,a,l){return ce(()=>{let c,h=!1;const f=t/o,p=s/a,g=(i+t)/o,y=(r+s)/a,x=[f,p,g,y],v=[];e.rank===3?(h=!0,c=sr([e])):c=e;for(let A=0;A<c.shape[0];A++)v.push(x);const w=_o(v,[v.length,4]),S=Ud(0,v.length,1,"int32"),I=ube(c,w,S,[i,r],"nearest");return Ba(h?st(Hr(I)):I,l)})}upsize(e,t,s,i){return ce(()=>{const r=cbe(e,[t,s]);return Ba(r,i)})}call(e,t){return ce(()=>{const s=st(e),i=s.dtype,r=s.shape,o=r[r.length-3],a=r[r.length-2];let l=0;o!==this.height&&(l=Math.floor((o-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,o,a,i):this.upsize(e,this.height,this.width,i)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Bt(e);const t=e.length-3,s=e.length-2;return e[t]=this.height,e[s]=this.width,e}}q9.className="CenterCrop";Ne(q9);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hbe(n,e,t,s){let i=st(n);if(i.dtype!=="int32"&&(i=Ba(i,"int32")),e==="int")return i;const r=i.shape;if(i.rank===0&&(i=ui(i,-1)),e==="oneHot"&&i.shape[i.shape.length-1]!==1&&(i=ui(i,-1)),i.rank>2)throw new se(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${r} which would result in output rank ${i.rank}.`);const o=["multiHot","oneHot"].includes(e),a=i;let l;if(typeof s<"u"&&e==="count"?l=uT(a,s,t,o):l=uT(a,[],t,o),e!=="tfIdf")return l;if(s)return Y(l,s);throw new se("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class K9 extends vt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=Bt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return ce(()=>{e=st(e),e.dtype!=="int32"&&(e=Ba(e,"int32"));let s;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new se(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);s=st(t.countWeights)}const i=Fr(e),r=Qp(e),o=rr(this.numTokens,i).bufferSync().get(0),a=bc(r,0).bufferSync().get(0);if(!(o&&a))throw new se(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return hbe(e,this.outputMode,this.numTokens,s)})}}K9.className="CategoryEncoding";Ne(K9);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const dbe=["bilinear","nearest"],Qz=new Set(dbe);class X9 extends vt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(Qz.has(e.interpolation))this.interpolation=e.interpolation;else throw new se(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Bt(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ce(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return yo.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return yo.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...Qz]} are supported`)})}}X9.className="Resizing";Ne(X9);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Y9{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}Y9.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Q9 extends vt{constructor(e){super(e),this.randomGenerator=new Y9(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}Q9.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const fbe=["bilinear","nearest"],Zz=new Set(fbe);class Z9 extends Q9{constructor(e){super(e);const{factor:t,interpolation:s="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new se(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new se(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new se(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(Zz.has(s))this.interpolation=s;else throw new se(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=Bt(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return ce(()=>{const s=st(e);this.imgHeight=s.shape[s.shape.length-3];const i=s.shape[s.shape.length-2];this.widthFactor=ch([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*i;r=Math.round(r);const o=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return yo.resizeBilinear(e,o);case"nearest":return yo.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...Zz]} are supported`)}})}}Z9.className="RandomWidth";Ne(Z9);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Jz;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(Jz||(Jz={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function He(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&B(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pbe=fC;class FC extends AS{nextDataId(){return FC.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new yD(this,Bo())}write(e,t,s){this.firstUse&&(this.firstUse=!1,de().get("IS_NODE")&&Dr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const i={id:this.nextDataId()};return this.data.set(i,{values:e,dtype:s,refCount:1}),i}makeTensorInfo(e,t,s){let i;if(t==="string"&&s!=null&&s.length>0&&Oa(s[0])){const r=s.map(o=>Fa(o));i=this.write(r,e,t)}else i=this.write(s,e,t);return{dataId:i,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,s,i,r){this.data.set(e,{values:t,dtype:i,refCount:r})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:s}=this.data.get(e);if(t==="complex64"){const i=this.readSync(s.real.dataId),r=this.readSync(s.imag.dataId);return ic(i,r)}return r6(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(i=>tc(i));return ut(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ut(e.shape,e.dtype,t)}makeOutput(e,t,s){return Bo().makeTensorFromTensorInfo(this.makeTensorInfo(t,s,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=Si();return e(),{kernelMs:Si()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){He([e],"where");const t=this.readSync(e.dataId);return pbe(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}FC.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const mbe=n=>{const{x:e}=n.inputs,t=n.backend;He(e,"abs");let s=new Float32Array(ye(e.shape));const i=t.data.get(e.dataId).values;return s=J9(i),t.makeOutput(s,e.shape,e.dtype)},gbe={kernelName:sv,backendName:"cpu",kernelFunc:mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jn(n){return(e,t,s,i,r)=>{const o=ot(e,t),a=o.length,l=Ye(o),c=ye(o),h=$s(r,c),f=e.length,p=t.length,g=Ye(e),y=Ye(t),x=zd(e,o),v=zd(t,o);if(x.length+v.length===0)for(let w=0;w<h.length;++w)h[w]=n(s[w%s.length],i[w%i.length]);else for(let w=0;w<h.length;++w){const S=cf(w,a,l),C=S.slice(-f);x.forEach(O=>C[O]=0);const I=Xo(C,f,g),A=S.slice(-p);v.forEach(O=>A[O]=0);const L=Xo(A,p,y);h[w]=n(s[I],i[L])}return[h,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pr(n){const{inputs:e,backend:t}=n,{real:s,imag:i}=e,r=t.data.get(s.dataId).values,o=t.data.get(i.dataId).values,a=t.makeTensorInfo(s.shape,"complex64"),l=t.data.get(a.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(s.shape,"float32",r),imag:t.makeTensorInfo(i.shape,"float32",o)},a}const ybe={kernelName:VS,backendName:"cpu",kernelFunc:pr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ST(n,e,t="float32"){if(t==="complex64"){const i=ST(n,e,"float32"),r=ST(n,e,"float32");return pr({inputs:{real:i,imag:r},backend:n})}const s=Zs(ye(e),t);return n.makeTensorInfo(e,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tl(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const bbe={kernelName:Km,backendName:"cpu",kernelFunc:tl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gd(n){const{inputs:e,backend:t}=n,{input:s}=e,i=t.data.get(s.dataId).complexTensorInfos.real,r=t.data.get(i.dataId).values;return t.makeTensorInfo(i.shape,i.dtype,r)}const vbe={kernelName:bE,backendName:"cpu",kernelFunc:Gd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e8(n,e,t,s){if(s==="int32"){const i=Int32Array.from(n);return[e,"int32",i]}if(s==="bool"){const i=ih([0],t),[r,o]=Jn((a,l)=>a!==l?1:0)(e,[],n,i,"bool");return[o,"bool",r]}throw new Error(`Error in Cast: failed to cast ${t} to ${s}`)}function Gu(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{dtype:r}=s;if(r==="complex64"){if(i.dtype==="complex64")return tl({inputs:{x:i},backend:t});const h=ST(t,i.shape,i.dtype),f=Gu({inputs:{x:i},backend:t,attrs:{dtype:"float32"}}),p=pr({inputs:{real:f,imag:h},backend:t});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(f),p}if(i.dtype==="complex64"){const h=Gd({inputs:{input:i},backend:t}),f=Gu({inputs:{x:h},backend:t,attrs:{dtype:r}});return t.disposeIntermediateTensorInfo(h),f}if(!xD(i.dtype,r)){const h=tl({inputs:{x:i},backend:t});return{dataId:h.dataId,shape:h.shape,dtype:r}}const o=t.data.get(i.dataId).values,[a,l,c]=e8(o,i.shape,i.dtype,r);return t.makeTensorInfo(a,l,c)}const xbe={kernelName:Pm,backendName:"cpu",kernelFunc:Gu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ws(n,e,t,s){return t==null?({inputs:i,backend:r})=>{const{a:o,b:a}=i,l=r;He([o,a],n);const c=l.data.get(o.dataId).values,h=l.data.get(a.dataId).values,f=o.dtype==="string"?rc(c):c,p=o.dtype==="string"?rc(h):h,g=s||o.dtype,[y,x]=e(o.shape,a.shape,f,p,g);return l.makeTensorInfo(x,g,y)}:({inputs:i,backend:r})=>{const{a:o,b:a}=i,l=r;if(o.dtype==="complex64"||a.dtype==="complex64"){const c=Gu({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),h=l.data.get(c.dataId),f=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,g=l.data.get(f.dataId).values,y=l.data.get(p.dataId).values,x=Gu({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),v=l.data.get(x.dataId),w=v.complexTensorInfos.real,S=v.complexTensorInfos.imag,C=l.data.get(w.dataId).values,I=l.data.get(S.dataId).values,[A,L,O]=t(o.shape,a.shape,g,y,C,I),N=l.makeTensorInfo(O,"float32",A),k=l.makeTensorInfo(O,"float32",L),$=pr({inputs:{real:N,imag:k},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(x),l.disposeIntermediateTensorInfo(N),l.disposeIntermediateTensorInfo(k),$}else{const c=l.data.get(o.dataId).values,h=l.data.get(a.dataId).values,f=s||o.dtype,[p,g]=e(o.shape,a.shape,c,h,f);return l.makeTensorInfo(g,f,p)}}}function BO(n){return(e,t,s,i,r,o)=>{const a=ot(e,t),l=ye(a),c=a.length,h=Ye(a),f=$s("float32",l),p=$s("float32",l),g=zd(e,a),y=zd(t,a),x=ic(s,i),v=ic(r,o),w=e.length,S=Ye(e),C=t.length,I=Ye(t);if(g.length+y.length===0)for(let A=0;A<f.length;A++){const L=A%x.length,O=A%v.length,N=n(x[L*2],x[L*2+1],v[O*2],v[O*2+1]);f[A]=N.real,p[A]=N.imag}else for(let A=0;A<f.length;A++){const L=cf(A,c,h),O=L.slice(-w);g.forEach(z=>O[z]=0);const N=Xo(O,w,S),k=L.slice(-C);y.forEach(z=>k[z]=0);const $=Xo(k,C,I),R=n(x[N*2],x[N*2+1],v[$*2],v[$*2+1]);f[A]=R.real,p[A]=R.imag}return[f,p,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t8=Jn((n,e)=>n+e),wbe=BO((n,e,t,s)=>({real:n+t,imag:e+s})),im=ws(uf,t8,wbe),_be={kernelName:uf,backendName:"cpu",kernelFunc:im};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UO(n,e,t,s,i){const r=ye(s),o=Zs(i,t);for(let a=0;a<n.length;a++){const l=n[a];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(r>0?o[l]+=e[a]:o[l]+=1)}return o}function n8(n,e,t,s=!1){const i=n.shape[0],r=n.shape[1],o=ut([i,t],e.dtype);for(let a=0;a<i;a++)for(let l=0;l<r;l++){const c=n.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=t||(s?o.set(1,a,c):e.size>0?o.set(o.get(a,c)+e.get(a,l),a,c):o.set(o.get(a,c)+1,a,c))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s8=Jn((n,e)=>n&e),Tbe=ws(hv,s8),Sbe={kernelName:hv,backendName:"cpu",kernelFunc:Tbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rl(n){return(e,t,s)=>{const i=Vn(t,e.length);for(let r=0;r<e.length;++r)i[r]=n(e[r],s);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tn(n,e,t){const s=rl(e);return dh(n,s,t)}function dh(n,e,t){return({inputs:s,attrs:i,backend:r})=>{const{x:o}=s;He(o,n);const a=r,l=a.data.get(o.dataId).values;let c;if(o.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=rc(l)}else c=l;const h=t||o.dtype,f=e(c,h,i);return a.makeTensorInfo(o.shape,h,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i8=rl(n=>Math.ceil(n)),Ebe=dh(Lm,i8),Cbe={kernelName:Lm,backendName:"cpu",kernelFunc:Ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8(n,e,t,s){const i=Vn(t,ye(e));if(s&&t!=="string"){let r=0;n.forEach(o=>{const a=ye(o.shape);i.set(o.vals,r),r+=a})}else{let r=0;n.forEach(o=>{const a=t==="string"?rc(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const h=c*e[1]+r;for(let f=0;f<o.shape[1];++f)i[h+f]=a[l++]}r+=o.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o8=Jn((n,e)=>n===e?1:0),a8=ws(xv,o8,null,"bool"),Ibe={kernelName:xv,backendName:"cpu",kernelFunc:a8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l8=rl(n=>Math.exp(n)),c8=dh(Wm,l8,"float32"),kbe={kernelName:Wm,backendName:"cpu",kernelFunc:c8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u8=rl(n=>Math.expm1(n)),Nbe=dh(Hm,u8),Abe={kernelName:Hm,backendName:"cpu",kernelFunc:Nbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h8=rl(n=>Math.floor(n)),Rbe=dh(jm,h8),Dbe={kernelName:jm,backendName:"cpu",kernelFunc:Rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d8=Jn((n,e)=>Math.floor(n/e)),$be=ws(Gm,d8,null,"int32"),Obe={kernelName:Gm,backendName:"cpu",kernelFunc:$be};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f8(n,e,t,s,i,r,o,a,l){const c=ut([s,r],t);for(let h=0;h<s;h++){const f=[];let p=0;for(let g=0;g<i;g++){const y=n[h*i+g];p+=y*o[g],f.push(y)}if(p<0||p>=l/r)throw new Error(`Invalid indices: ${f} does not index into ${a}`);for(let g=0;g<r;g++)c.values[h*r+g]=e.get(...e.indexToLoc(p*r+g))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(n,e,t){const s=ut(t,n.dtype);for(let i=0;i<s.size;++i){const o=s.indexToLoc(i).slice(),a=o[0],l=o[2],c=e.locToIndex([a,l]);o[2]=e.values[c];const h=n.locToIndex(o);0<=h&&h<n.values.length&&(s.values[i]=n.values[h])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m8=Jn((n,e)=>n>e?1:0),Pbe=ws(Sv,m8,null,"bool"),Lbe={kernelName:Sv,backendName:"cpu",kernelFunc:Pbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g8=Jn((n,e)=>n>=e?1:0),Mbe=ws(qm,g8,null,"bool"),Fbe={kernelName:qm,backendName:"cpu",kernelFunc:Mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y8=Jn((n,e)=>n<e?1:0),Vbe=ws(Cv,y8,null,"bool"),zbe={kernelName:Cv,backendName:"cpu",kernelFunc:Vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b8=Jn((n,e)=>n<=e?1:0),Bbe=ws(Iv,b8,null,"bool"),Ube={kernelName:Iv,backendName:"cpu",kernelFunc:Bbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v8(n,e,t){const s=(e-n)/(t-1),i=Zs(t,"float32");i[0]=n;for(let r=1;r<i.length;r++)i[r]=i[r-1]+s;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x8=rl(n=>Math.log(n)),Wbe=dh(Zm,x8),Hbe={kernelName:Zm,backendName:"cpu",kernelFunc:Wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8(n,e,t,s){const i=$s(s,ye(t));for(let r=0;r<i.length;++r){const o=r*e;let a=n[o];for(let l=0;l<e;++l){const c=n[o+l];(Number.isNaN(c)||c>a)&&(a=c)}i[r]=a}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _8=Jn((n,e)=>Math.max(n,e)),jbe=ws(eg,_8),Gbe={kernelName:eg,backendName:"cpu",kernelFunc:jbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T8=Jn((n,e)=>Math.min(n,e)),qbe=ws(tg,T8),Kbe={kernelName:tg,backendName:"cpu",kernelFunc:qbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WO=Jn((n,e)=>n*e),Xbe=BO((n,e,t,s)=>({real:n*t-e*s,imag:n*s+e*t})),VC=ws(sg,WO,Xbe),Ybe={kernelName:sg,backendName:"cpu",kernelFunc:VC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(n,e,t){const s=mc(-1,t);return WO([],e,s,n,t)}function Qbe(n){const{inputs:e,backend:t}=n,{x:s}=e;He(s,"neg");const i=t.data.get(s.dataId).values,[r,o]=S8(i,s.shape,s.dtype);return t.makeTensorInfo(o,s.dtype,r)}const Zbe={kernelName:Fv,backendName:"cpu",kernelFunc:Qbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8=Jn((n,e)=>n!==e?1:0),Jbe=ws(Vv,E8,null,"bool"),e0e={kernelName:Vv,backendName:"cpu",kernelFunc:Jbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HO(n,e,t,s,i){const r=e.length,o=ye(e),a=Ye(e),l=Ye(i),c=$s(t,ye(i));for(let h=0;h<o;++h){const f=cf(h,r,a),p=new Array(f.length);for(let y=0;y<p.length;y++)p[y]=f[s[y]];const g=Xo(p,r,l);c[g]=n[h]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ir(n){const{inputs:e,attrs:t,backend:s}=n,{x:i}=e,{perm:r}=t;He(i,"transpose");const o=i.shape.length,a=new Array(o);for(let f=0;f<a.length;f++)a[f]=i.shape[r[f]];const l=s.data.get(i.dataId).values,c=HO(l,i.shape,i.dtype,r,a);return{dataId:s.write(c,a,i.dtype),shape:a,dtype:i.dtype}}const t0e={kernelName:Ed,backendName:"cpu",kernelFunc:ir};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C8(n,e,t,s){const[i,r]=Ls(n,s),o=Ji(e,"int32"),a=Zs(ye(i),o),l=ye(r);for(let c=0;c<a.length;++c){const h=c*l;let f=1;for(let p=0;p<l;++p)f*=t[h+p];a[c]=f}return{outVals:a,outShape:i,outDtype:o}}function n0e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s;He(i,"prod");const a=i.shape.length,l=gt(r,i.shape),c=On(l,a);let h=l,f=i;const p=[];c!=null&&(f=ir({inputs:{x:i},backend:t,attrs:{perm:c}}),p.push(f),h=Qn(h.length,a));const g=t.data.get(f.dataId).values,{outVals:y,outShape:x,outDtype:v}=C8(f.shape,f.dtype,g,h);let w=x;return o&&(w=Xn(x,l)),p.forEach(S=>t.disposeIntermediateTensorInfo(S)),t.makeTensorInfo(w,v,y)}const s0e={kernelName:jv,backendName:"cpu",kernelFunc:n0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0e(n,e,t){n.forEach((s,i)=>{if(s<0||s>=t){const r=cf(i,e.length,Ye(e)).join(",");throw new Error(`indices[${r}] = ${s} is not in [0, ${t})`)}})}function r0e(n,e){for(let t=0;t<n.length;++t){const s=n[t],i=t===n.length-1?e:n[t+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>i)throw new Error("Ragged splits must not point past values");for(let r=1;r<s.length;++r)if(s[r-1]>s[r])throw new Error("Ragged splits must be sorted in ascending order")}}function o0e(n,e,t,s){const i=[];let r=0;const o=e.length-1+t.length,a=new Array(o).fill(null).map(()=>[0]);r0e(t,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const h=e[c+1];for(let f=1;f<l+1;++f)a[c].push(f*h)}for(let c=0;c<n.length;++c){let h=n[c],f=n[c]+1;for(let p=0;p<t.length;++p){const g=t[p],y=p+e.length-1;if(y>=0){const x=a[y],v=x[x.length-1]-g[h];for(let w=h;w<f;++w)a[y].push(g[w+1]+v)}h=g[h],f=g[f]}f!==h&&(i.push([h,f]),r+=f-h)}return{outSplits:a,valueSlices:i,numValues:r}}function a0e(n){const e=[];for(let t=0;t<n.length;++t){const s=n[t].length,i=Vn("int32",s);e.push(i),n[t].forEach((r,o)=>i[o]=r)}return e}function eB(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let s=e;s<n.length;s++)t[e-1]*=n[s];return t}function l0e(n,e,t,s,i,r){const o=eB(e,2)[1],a=eB(r,2)[1];let l=0;for(const c of t)for(let h=c[0];h<c[1];++h){for(let f=0;f<s;++f)i[l*a+f]=n[h*o+f];++l}}function c0e(n,e,t,s,i){const r=e.slice();r[0]=i;const o=Vn(t,ye(r)),a=n.length,l=a===0?0:a/e[0];return l0e(n,e,s,l,o,r),[o,r]}function I8(n,e,t,s,i,r,o,a){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(i0e(r,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:h,valueSlices:f,numValues:p}=o0e(r,o,n,c),g=a0e(h),y=c0e(t,s,i,f,p);return[g,y[0],y[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tB=2147483647;function k8(n,e,t,s,i,r,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=i.length===0,c=o.length===0,h=[];a||h.push(e[0]),l||h.push(i[0]),c||h.push(o[0]);for(let v=1;v<h.length;++v)if(h[v]!==h[v-1])throw new Error("starts, limits, and deltas must have the same shape");const f=h.length===0?1:h[0],p=Vn("int32",f+1);p[0]=0;for(let v=0;v<f;++v){const w=a?n[0]:n[v],S=l?s[0]:s[v],C=c?r[0]:r[v];if(C===0)throw new Error("Requires delta != 0");let I;if(C>0&&S<w||C<0&&S>w)I=0;else if(I=Math.ceil(Math.abs((S-w)/C)),I>tB)throw new Error(`Requires ((limit - start) / delta) <= ${tB}`);p[v+1]=p[v]+I}const g=p[f],y=Vn(t,g);let x=0;for(let v=0;v<f;++v){const w=p[v+1]-p[v];let S=a?n[0]:n[v];const C=c?r[0]:r[v];for(let I=0;I<w;++I)y[x++]=S,S+=C}return[p,y]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var co=Wo;class ET{constructor(e,t,s,i,r,o,a,l,c,h){this.shape=e,this.shapeShape=t,this.values=s,this.valuesShape=i,this.valuesDType=r,this.defaultValue=o,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=cG(h),this.raggedRank=uG(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===co.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===co.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case co.VALUE_ROWIDS:return ET.getMaxWidthValueRowID(t);case co.ROW_SPLITS:return ET.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${co[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let s=0;for(let i=0;i<t-1;++i){const r=e[i+1]-e[i];r>s&&(s=r)}return s}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let s=0,i=e[0],r=0;for(let o=1;o<t;++o){const a=e[o];a!==i&&(i=a,r=Math.max(o-s,r),s=o)}return Math.max(t-s,r)}tensorShapeFromTensor(e,t,s=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return sB(e,s)}calculateOutputSize(e){const t=this.valuesShape,s=this.defaultValueShape;hG(s,t);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=lG(this.raggedRank,i,t);o[0]<0&&(o[0]=e);for(let a=1;a<=this.raggedRank;++a)o[a]<0&&(o[a]=this.getMaxWidth(a));return o}calculateFirstParentOutputIndex(e,t,s){const i=Math.min(e,s),r=[];let o=0;for(let a=0;a<i;++a,o+=t)r.push(o);for(let a=i;a<e;++a)r.push(-1);return B(r.length===e,()=>"Final length of result must be equal to firstDimension."),r}calculateOutputIndexRowSplit(e,t,s,i){const r=e.length,o=[];for(let a=0;a<r-1;++a){const l=e[a+1]-e[a];let c=Math.min(i,l),h=t[a];h===-1&&(c=0);for(let f=0;f<c;++f)o.push(h),h+=s;for(let f=0;f<l-c;++f)o.push(-1)}if(r>0&&o.length!==e[r-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,t,s,i){const r=e.length,o=[];if(r===0)return[];let a=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let c=t[l];o.push(c);for(let h=1;h<r;++h){const f=e[h];if(f===l)c>=0&&(++a,a<i?c+=s:c=-1);else{if(a=0,l=f,f>=t.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${t.length}`);c=t[f]}o.push(c)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,t,s,i){const r=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case co.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(r,t,s,i);case co.ROW_SPLITS:if(r.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${r.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(r,t,s,i);default:throw new Error(`Unsupported partition type: ${co[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case co.FIRST_DIM_SIZE:return e[0];case co.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case co.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${co[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),s=this.calculateOutputSize(t),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let l=i.length-2;l>=0;--l)i[l]=i[l+1]*s[l+1];const r=sB(s,!1),o=Vn(this.valuesDType,ye(r));if(i[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(t,i[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,i[c],s[c]);this.setOutput(this.raggedRank,l,o,r)}return[r,o]}setOutput(e,t,s,i){if(s.length===0)return;const r=this.values,o=s;let a=i.slice();a=a.slice(e+1);const l=ye(a),c=t.length;let h=this.defaultValue;if(h.length!==l&&h.length!==1){const y=this.defaultValueShape;ce(()=>{const x=te(h,y);h=Cd(x,a).dataSync()})}let f=0,p=0,g=0;for(let y=0;y<=c;++y){let x=y<c?t[y]:-1;if(x===g){++g;continue}if(p<g){const v=r.subarray(f*l),w=o.subarray(p*l),S=(g-p)*l;nB(w,v,S)}if(y>=c){const v=s.length;x=Math.floor(v/l)}if(x>g)if(this.defaultValue.length===1)o.subarray(g*l,x*l).fill(this.defaultValue[0]),g=x;else for(;x>g;){const v=o.slice(g*l);nB(v,h,l),++g}x<0?(f=y+1,p=g):(f=y,p=g,g=p+1)}}}function nB(n,e,t){for(let s=0;s<t;s++)n[s]=e[s]}function sB(n,e){const t=[];for(let s of n){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}t.push(s)}return t}function N8(n,e,t,s,i,r,o,a,l,c){return new ET(n,e,t,s,i,r,o,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A8(n,e,t,s){const i=n===e,r=n<e&&t<0,o=e<n&&t>1;if(i||r||o)return Zs(0,s);const a=Math.abs(Math.ceil((e-n)/t)),l=Zs(a,s);e<n&&t===1&&(t=-1),l[0]=n;for(let c=1;c<l.length;c++)l[c]=l[c-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R8=rl(n=>1/Math.sqrt(n)),u0e=dh(cg,R8),h0e={kernelName:cg,backendName:"cpu",kernelFunc:u0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gd(n,e,t,s,i,r,o,a,l,c){const h=[s/i,i],f=n.values,p=e.values;if(s===0)return ut(t,e.dtype);const g=l instanceof as?l:ut(h,e.dtype);typeof l=="string"||typeof l=="number"?g.values.fill(l):typeof l=="boolean"&&g.values.fill(+l);for(let y=0;y<r;y++){const x=[];let v=0;for(let w=0;w<o;w++){const S=f[y*o+w];x.push(S),v+=S*a[w]}if(v<0||v>=s/i)throw new Error(`Invalid indices: ${x} does not index into ${t}`);for(let w=0;w<i;w++)c?g.values[v*i+w]+=p[y*i+w]:g.values[v*i+w]=e.rank===0?p[0]:p[y*i+w]}return g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d0e=rl(n=>1/(1+Math.exp(-n))),D8=tn(pg,n=>1/(1+Math.exp(-n))),f0e={kernelName:pg,backendName:"cpu",kernelFunc:D8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $8(n,e,t,s,i){const r=X$(s,e,t),o=ye(t),a=Ye(s);if(r){const f=Y$(e,a);return i==="string"?n.slice(f,f+o):n.subarray(f,f+o)}const l=i==="string"?rc(n):n,c=ut(s,i,l),h=ut(t,i);for(let f=0;f<h.size;++f){const p=h.indexToLoc(f),g=p.map((y,x)=>y+e[x]);h.set(c.get(...g),...p)}return i==="string"?RG(h.values):h.values}function qd(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{begin:r,size:o}=s;He(i,"slice");const[a,l]=SC(i,r,o);q$(i,a,l);const c=t.data.get(i.dataId).values,h=$8(c,a,l,i.shape,i.dtype);return t.makeTensorInfo(l,i.dtype,h)}const p0e={kernelName:Qv,backendName:"cpu",kernelFunc:qd};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O8(n,e,t,s,i,r,o){const a=e[0],l=r[0],c=new Array(l),h=new Array(a),f=e[1];if(l===0){if(a!==0)throw new Error(bG(a));const v=Vn(t,0),w=Vn(i,0);return[v,[0,f],w,c,h]}let p=!0,g=0;const y=new Array(l).fill(0);for(let v=0;v<a;++v){const w=n[v*f];if(w<0)throw new Error(vG(v,w));if(w>=l)throw new Error(xG(v,w,l));++y[w],p=p&&w>=g,g=w}let x=!0;for(let v=0;v<l;++v){const w=y[v]===0;c[v]=w,x=x&&!w,y[v]=Math.max(y[v],1),v>0&&(y[v]+=y[v-1])}if(x&&p){const v=n,w=s;for(let S=0;S<a;++S)h[S]=S;return[v,[a,f],w,c,h]}else{const v=y[l-1],w=Vn(t,v*f),S=Vn(i,v),C=new Array(l).fill(0);for(let I=0;I<a;++I){const A=n[I*f],L=C[A],O=(A===0?0:y[A-1])+L;C[A]++;for(let N=0;N<f;++N)w[O*f+N]=n[I*f+N];S[O]=s[I],h[I]=O}for(let I=0;I<l;++I)if(C[I]===0){const L=I===0?0:y[I-1];w[L*f+0]=I;for(let O=1;O<f;++O)w[L*f+O]=0;S[L]=o}return[w,[v,f],S,c,h]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8(n,e,t,s,i){const r=ye(s),o=e[0],a=i.length,l=[];let c=1,h=-1;for(let v=0;v<a;++v){const w=i[v];if(w===-1){if(h!==-1)throw new Error(wG(h,v));h=v,l.push(1)}else{if(w<0)throw new Error(_G(v,w));c*=w,l.push(w)}}if(h!==-1){if(c<=0)throw new Error(TG());const v=Math.trunc(r/c);if(c*v!==r)throw new Error(SG(s,l));l[h]=v}if(ye(l)!==r)throw new Error(EG(s,l));const p=s.length,g=[];if(p>0){g[p-1]=1;for(let v=p-2;v>=0;--v)g[v]=g[v+1]*s[v+1]}const y=[];if(a>0){y[a-1]=1;for(let v=a-2;v>=0;--v)y[v]=y[v+1]*l[v+1]}const x=Vn(t,o*a);for(let v=0;v<o;++v){let w=0;for(let S=0;S<p;++S)w+=n[v*p+S]*g[S];for(let S=0;S<a;++S)x[v*a+S]=Math.trunc(w/y[S]),w%=y[S]}return[x,[o,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jO(n,e,t,s,i,r=!1,o=0){const a=s.length,l=[e[0],n.length/e[0]],c=l[1],f=a>0?i[a-1]+1:0;if(f<0)throw new Error(vR());const p=e.slice();p[0]=f;const g=p.reduce((C,I)=>C*I,1),y=Vn(t,g);if(a===0)return f>0&&y.fill(o),[y,p];if(f<=0)throw new Error(vR());let x=0,v=1,w=0,S=i[x];for(;;){let C=0;if(v<a){if(C=i[v],S===C){++v;continue}if(S>=C)throw new Error(CG())}if(S<0||S>=f)throw new Error(IG(S,f));S>w&&y.fill(o,w*c,S*c);for(let I=x;I<v;++I){const A=s[I];if(A<0||A>=l[0])throw new Error(kG(I,s[I],l[0]));for(let L=0;L<c;L++)y[S*c+L]+=n[A*c+L]}if(r)for(let I=0;I<c;I++)y[S*c+I]/=v-x;if(x=v,++v,w=S+1,S=C,v>a)break}return w<f&&y.fill(o,w*c,f*c),[y,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m0e=rl(n=>Math.sqrt(n)),g0e=tn(gg,n=>Math.sqrt(n)),y0e={kernelName:gg,backendName:"cpu",kernelFunc:g0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L8=Jn((n,e)=>{const t=n-e;return t*t}),b0e=ws(yg,L8),v0e={kernelName:yg,backendName:"cpu",kernelFunc:b0e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M8=rl((n,e)=>{const{pattern:t,replaceGlobal:s,rewrite:i}=e;return n.replace(new RegExp(t,s?"g":""),i)}),x0e=dh(nx,M8),w0e={kernelName:nx,backendName:"cpu",kernelFunc:x0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F8(n,e,t,s){const i=ut(n,e.dtype);for(let r=0;r<i.size;r++){const o=i.indexToLoc(r),a=new Array(o.length);for(let l=0;l<a.length;l++)a[l]=o[l]*t[l]+s[l];i.set(e.get(...a),...o)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _0e{constructor(e,t,s,i,r,o){this.separator=Fa(e),this.nGramWidths=t,this.leftPad=Fa(s),this.rightPad=Fa(i),this.padWidth=r,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const s=this.getPadWidth(t);return Math.max(0,e+2*s-t+1)}createNGrams(e,t,s,i,r,o){for(let a=0;a<r;++a){const l=this.getPadWidth(o),c=Math.max(0,l-a),h=Math.max(0,l-(r-(a+1))),f=o-(c+h),p=t+(c>0?0:a-l);let g=0;g+=c*this.leftPad.length;for(let S=0;S<f;++S)g+=e[p+S].length;g+=h*this.rightPad.length;const y=c+h+f-1;g+=y*this.separator.length,s[i+a]=new Uint8Array(g);const x=s[i+a];let v=0;const w=S=>S.forEach(C=>x[v++]=C);for(let S=0;S<c;++S)w(this.leftPad),w(this.separator);for(let S=0;S<f-1;++S)w(e[p+S]),w(this.separator);if(f>0){w(e[p+f-1]);for(let S=0;S<h;++S)w(this.separator),w(this.rightPad)}else{for(let S=0;S<h-1;++S)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(e,t){const s=e.length,i=t.length;if(i>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<i;++c){let h=t[c]>=l;if(h=h&&t[c]<=s,!h)throw new Error(`Invalid split value ${t[c]}, must be in [${l}, ${s}]`);l=t[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const r=i-1,o=Vn("int32",i);if(s===0||i===0){const l=new Array(s);for(let c=0;c<=r;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=r;++l){const c=t[l]-t[l-1];let h=0;this.nGramWidths.forEach(f=>{h+=this.getNumNGrams(c,f)}),this.preserveShort&&c>0&&h===0&&(h=1),o[l]=o[l-1]+h}const a=new Array(o[r]);for(let l=0;l<r;++l){const c=t[l];let h=o[l];if(this.nGramWidths.forEach(f=>{const p=t[l+1]-t[l],g=this.getNumNGrams(p,f);this.createNGrams(e,c,a,h,g,f),h+=g}),this.preserveShort&&h===o[l]){const f=t[l+1]-t[l];if(f===0)continue;const p=f+2*this.padWidth;this.createNGrams(e,c,a,h,1,p)}}return[a,o]}}function V8(n,e,t,s,i,r,o,a){return new _0e(t,s,i,r,o,a).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0e(n,e,t,s){if(!n.length)return;if(e.length===0){for(let r=0;r<n.length;++r)s.push(n.subarray(r,r+1));return}if(e.length===1){const r=e[0];let o=n.indexOf(r);for(;o!==-1;){const a=n.subarray(0,o);(!t||a.length!==0)&&s.push(a),n=n.subarray(o+1),o=n.indexOf(r)}(!t||n.length!==0)&&s.push(n);return}let i=0;for(let r=0;r<n.length+1;r++)if(r===n.length||e.indexOf(n[r])!==-1){const o=n.subarray(i,r);(!t||o.length!==0)&&s.push(o),i=r+1}}function z8(n,e,t){const s=n.length,i=[];let r=0,o=0;const a=new Array(s);for(let p=0;p<s;++p){const g=i.length;T0e(n[p],e,t,i);const y=i.length-g;a[p]=y,r+=y,o=Math.max(o,y)}const l=Vn("int32",r*2),c=new Array(r),h=[s,o];let f=0;for(let p=0;p<s;++p)for(let g=0;g<a[p];++g)l[f*2]=p,l[f*2+1]=g,c[f]=i[f],++f;return[l,c,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8(n,e){const t=Vn("int32",n.length);for(let s=0;s<n.length;++s)t[s]=g6(n[s]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U8=Jn((n,e)=>n-e),S0e=BO((n,e,t,s)=>({real:n-t,imag:e-s})),GO=ws(bg,U8,S0e),E0e={kernelName:bg,backendName:"cpu",kernelFunc:GO};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(n,e){const t=new Array(n.rank);for(let i=0;i<t.length;i++)t[i]=n.shape[i]*e[i];const s=ut(t,n.dtype);for(let i=0;i<s.values.length;++i){const r=s.indexToLoc(i),o=new Array(n.rank);for(let l=0;l<o.length;l++)o[l]=r[l]%n.shape[l];const a=n.locToIndex(o);s.values[i]=n.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kb=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function H8(n,e,t=0,s=n.length-1){for(;s>t;){if(s-t>600){const a=s-t+1,l=e-t+1,c=Math.log(a),h=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*h*(a-h)/a)*Math.sign(l-a/2),p=Math.max(t,Math.floor(e-l*h/a+f)),g=Math.min(s,Math.floor(e+(a-l)*h/a+f));H8(n,e,p,g)}const i=n[e];let r=t,o=s;for(Bl(n,t,e),kb(n[s],i)>0&&Bl(n,t,s);r<o;){for(Bl(n,r,o),r++,o--;kb(n[r],i)<0;)r=r+1;for(;kb(n[o],i)>0;)o=o-1}kb(n[t],i)===0?Bl(n,t,o):(o=o+1,Bl(n,o,s)),o<=e&&(t=o+1),e<=o&&(s=o-1)}}function j8(n,e,t,s,i){const r=e[e.length-1],[o,a]=[n.length/r,r],l=$s(t,o*s),c=$s("int32",o*s);for(let f=0;f<o;f++){const p=f*a,g=n.subarray(p,p+a);let y=new Array(g.length);g.forEach((S,C)=>y[C]={value:S,index:C}),s<y.length&&(H8(y,s),y=y.slice(0,s)),i&&y.sort(kb);const x=f*s,v=l.subarray(x,x+s),w=c.subarray(x,x+s);for(let S=0;S<s;S++)v[S]=y[S].value,w[S]=y[S].index}const h=e.slice();return h[h.length-1]=s,[ut(h,t,l),ut(h,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G8(n,e,t,s){const i=gt(e,t)[0],r=[1,t[0],1];for(let y=0;y<i;y++)r[0]*=t[y];r[1]=t[i];for(let y=i+1;y<t.length;y++)r[2]*=t[y];const o=new Map,a=new Int32Array(t[i]),l=new as(r,s,n),c=[],h=r[0]===1&&r[2]===1;for(let y=0;y<t[i];y++){let x;if(h)x=n[y].toString();else{const w=[];for(let S=0;S<r[0];S++)for(let C=0;C<r[2];C++)w.push(l.get(S,y,C));x=w.join(",")}const v=o.get(x);if(v!=null)a[y]=v;else{const w=o.size;o.set(x,w),a[y]=w,c.push(y)}}const f=r.slice();f[1]=o.size;const p=new as(f,s);c.forEach((y,x)=>{for(let v=0;v<r[0];v++)for(let w=0;w<r[2];w++)p.set(l.get(v,y,w),v,x,w)});const g=t.slice();return g[i]=f[1],{outputValues:p.values,outputShape:g,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C0e=Object.freeze(Object.defineProperty({__proto__:null,addImpl:t8,bincountImpl:UO,bincountReduceImpl:n8,bitwiseAndImpl:s8,castImpl:e8,ceilImpl:i8,concatImpl:r8,equalImpl:o8,expImpl:l8,expm1Impl:u8,floorDivImpl:d8,floorImpl:h8,gatherNdImpl:f8,gatherV2Impl:p8,greaterEqualImpl:g8,greaterImpl:m8,lessEqualImpl:b8,lessImpl:y8,linSpaceImpl:v8,logImpl:x8,maxImpl:w8,maximumImpl:_8,minimumImpl:T8,multiplyImpl:WO,negImpl:S8,notEqualImpl:E8,prodImpl:C8,raggedGatherImpl:I8,raggedRangeImpl:k8,raggedTensorToTensorImpl:N8,rangeImpl:A8,rsqrtImpl:R8,scatterImpl:gd,sigmoidImpl:d0e,simpleAbsImpl:J9,sliceImpl:$8,sparseFillEmptyRowsImpl:O8,sparseReshapeImpl:P8,sparseSegmentReductionImpl:jO,sqrtImpl:m0e,squaredDifferenceImpl:L8,staticRegexReplaceImpl:M8,stridedSliceImpl:F8,stringNGramsImpl:V8,stringSplitImpl:z8,stringToHashBucketFastImpl:B8,subImpl:U8,tileImpl:W8,topKImpl:j8,transposeImpl:HO,uniqueImpl:G8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ND("cpu",()=>new FC,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q8=tn(Bm,n=>n>=0?n:Math.exp(n)-1),I0e={kernelName:Bm,backendName:"cpu",kernelFunc:q8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{alpha:r}=s;He([i],"leakyRelu");const o=ye(i.shape),a=t.data.get(i.dataId).values,l=$s("float32",o);for(let c=0;c<a.length;c++)l[c]=a[c]<0?r*a[c]:a[c];return t.makeTensorInfo(i.shape,"float32",l)}const k0e={kernelName:Ev,backendName:"cpu",kernelFunc:K8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N0e=Jn((n,e)=>n<0?e*n:n);function X8(n){const{inputs:e,backend:t}=n,{x:s,alpha:i}=e;He([s,i],"prelu");const r=t.data.get(s.dataId).values,o=t.data.get(i.dataId).values,[a,l]=N0e(s.shape,i.shape,r,o,"float32");return t.makeTensorInfo(l,"float32",a)}const A0e={kernelName:Hv,backendName:"cpu",kernelFunc:X8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y8=tn(og,n=>Math.max(0,n)),R0e={kernelName:og,backendName:"cpu",kernelFunc:Y8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q8=tn(ag,n=>Math.min(Math.max(0,n),6)),D0e={kernelName:ag,backendName:"cpu",kernelFunc:Q8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CT(n,e,t,s,i){if(t==="linear")return tl({inputs:{x:e},backend:n});if(t==="relu")return Y8({inputs:{x:e},backend:n});if(t==="elu")return q8({inputs:{x:e},backend:n});if(t==="relu6")return Q8({inputs:{x:e},backend:n});if(t==="prelu")return X8({inputs:{x:e,alpha:s},backend:n});if(t==="leakyrelu")return K8({inputs:{x:e},backend:n,attrs:{alpha:i}});if(t==="sigmoid")return D8({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yn(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{shape:r}=s,o=ye(i.shape),a=vD(r,o),l=ye(a);B(o===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),t.incRef(i.dataId);const c=t.data.get(i.dataId);if(c.complexTensorInfos!=null){const h=c.complexTensorInfos.real,f=c.complexTensorInfos.imag;h.shape=a,f.shape=a}return{dataId:i.dataId,shape:a,dtype:i.dtype}}const $0e={kernelName:Gv,backendName:"cpu",kernelFunc:yn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(n){const{inputs:e,backend:t,attrs:s}=n,{a:i,b:r}=e,{transposeA:o,transposeB:a}=s;He([i,r],"matMul");const l=i.shape.length,c=r.shape.length,h=o?i.shape[l-2]:i.shape[l-1],f=a?r.shape[c-1]:r.shape[c-2],p=o?i.shape[l-1]:i.shape[l-2],g=a?r.shape[c-2]:r.shape[c-1],y=i.shape.slice(0,-2),x=r.shape.slice(0,-2),v=ye(y),w=ye(x),C=ot(i.shape.slice(0,-2),r.shape.slice(0,-2)).concat([p,g]);B(h===f,()=>`Error in matMul: inner shapes (${h}) and (${f}) of Tensors with shapes ${i.shape} and ${r.shape} and transposeA=${o} and transposeB=${a} must match.`);const I=o?[v,h,p]:[v,p,h],A=a?[w,g,f]:[w,f,g],L=yn({inputs:{x:i},backend:t,attrs:{shape:I}}),O=yn({inputs:{x:r},backend:t,attrs:{shape:A}}),N=o?L.shape[1]:L.shape[2],k=o?L.shape[2]:L.shape[1],$=a?O.shape[1]:O.shape[2],R=Math.max(v,w),z=t.data.get(L.dataId).values,V=t.data.get(O.dataId).values,ne=Ye(L.shape),Q=Ye(O.shape),[G,J,Z]=o?[ne[0],1,ne[1]]:[ne[0],ne[1],1],[le,H,ee]=a?[1,Q[1],Q[0]]:[Q[1],1,Q[0]],he=k*$,ae=ut([R,k,$],L.dtype),pe=ae.values,_e=t.blockSize;for(let Ee=0;Ee<R;Ee++){const Le=Ee%v,$e=Ee%w;for(let Me=0;Me<k;Me+=_e){const ze=Math.min(Me+_e,k);for(let Ze=0;Ze<$;Ze+=_e){const yt=Math.min(Ze+_e,$);for(let bt=0;bt<N;bt+=_e){const Wt=Math.min(bt+_e,N);for(let Nt=Me;Nt<ze;Nt++)for(let xt=Ze;xt<yt;xt++){let Yt=0;for(let Ht=bt;Ht<Wt;Ht++){const yi=z[Le*G+Nt*J+Ht*Z],bn=V[Ht*le+xt*H+$e*ee];Yt+=yi*bn}pe[Ee*he+(Nt*$+xt)]+=Yt}}}}}return t.disposeIntermediateTensorInfo(L),t.disposeIntermediateTensorInfo(O),t.makeTensorInfo(C,ae.dtype,ae.values)}const O0e={kernelName:cv,backendName:"cpu",kernelFunc:Z8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P0e(n){const{inputs:e,backend:t,attrs:s}=n,{a:i,b:r,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:h,leakyreluAlpha:f}=s;let p,g,y;const x=[];p=Z8({inputs:{a:i,b:r},attrs:{transposeA:l,transposeB:c},backend:t}),o&&(g=im({inputs:{a:p,b:o},backend:t}),x.push(p),p=g),h&&(y=CT(t,p,h,a,f),x.push(p),p=y);for(const w of x)t.disposeIntermediateTensorInfo(w);return p}const L0e={kernelName:c0,backendName:"cpu",kernelFunc:P0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M0e=tn(km,n=>Math.acos(n)),F0e={kernelName:km,backendName:"cpu",kernelFunc:M0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V0e=tn(Nm,n=>Math.acosh(n)),z0e={kernelName:Nm,backendName:"cpu",kernelFunc:V0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B0e(n){const{inputs:e,backend:t}=n,s=e;He(e,"addN");const i=s.map(a=>t.data.get(a.dataId).values),r=ut(s[0].shape,s[0].dtype),o=r.values;for(let a=0;a<s.length;a++){const l=i[a];for(let c=0;c<o.length;c++)o[c]+=l[c]}return t.makeTensorInfo(r.shape,r.dtype,r.values)}const U0e={kernelName:iv,backendName:"cpu",kernelFunc:B0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s;He(i,"all");const a=gt(r,i.shape);let l=a;const c=On(l,i.shape.length);let h=i;c!=null&&(h=ir({inputs:{x:i},backend:t,attrs:{perm:c}}),l=Qn(l.length,i.shape.length)),ti("all",l,h.shape.length);const[f,p]=Ls(h.shape,l),g=ye(p),y=Zs(ye(f),h.dtype),x=t.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const S=w*g;let C=x[S];for(let I=0;I<g;++I){const A=x[S+I];C=C&&A}y[w]=C}c!=null&&t.disposeIntermediateTensorInfo(h);const v=t.makeTensorInfo(f,h.dtype,y);if(o){const w=Xn(f,a),S=yn({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),S}return v}const H0e={kernelName:$S,backendName:"cpu",kernelFunc:W0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j0e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s;He(i,"any");const a=gt(r,i.shape);let l=a;const c=On(l,i.shape.length);let h=i;c!=null&&(h=ir({inputs:{x:i},backend:t,attrs:{perm:c}}),l=Qn(l.length,i.shape.length)),ti("any",l,h.shape.length);const[f,p]=Ls(h.shape,l),g=ye(p),y=Zs(ye(f),h.dtype),x=t.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const S=w*g;let C=x[S];for(let I=0;I<g;++I){const A=x[S+I];C=C||A}y[w]=C}c!=null&&t.disposeIntermediateTensorInfo(h);const v=t.makeTensorInfo(f,h.dtype,y);if(o){const w=Xn(f,a),S=yn({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),S}return v}const G0e={kernelName:OS,backendName:"cpu",kernelFunc:j0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q0e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r}=s;He(i,"argMax");let o=gt(r,i.shape);const a=On(o,i.shape.length);let l=i;const c=[];a!=null&&(l=ir({inputs:{x:i},backend:t,attrs:{perm:a}}),c.push(l),o=Qn(o.length,l.shape.length)),o=[o[0]],ti("argMax",o,l.shape.length);const[h,f]=Ls(l.shape,o),p=ye(h),g=Zs(p,"int32"),y=ye(f),x=t.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const w=v*y;let S=x[w],C=0;for(let I=0;I<y;++I){const A=x[w+I];A>S&&(S=A,C=I)}g[v]=C}return c.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(h,"int32",g)}const K0e={kernelName:rv,backendName:"cpu",kernelFunc:q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X0e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r}=s;He(i,"argMin");let o=gt(r,i.shape);const a=On(o,i.shape.length);let l=i;const c=[];a!=null&&(l=ir({inputs:{x:i},backend:t,attrs:{perm:a}}),c.push(l),o=Qn(o.length,l.shape.length)),o=[o[0]],ti("argMin",o,l.shape.length);const[h,f]=Ls(l.shape,o),p=ye(h),g=Zs(p,"int32"),y=ye(f),x=t.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const w=v*y;let S=x[w],C=0;for(let I=0;I<y;++I){const A=x[w+I];A<S&&(S=A,C=I)}g[v]=C}return c.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(h,"int32",g)}const Y0e={kernelName:ov,backendName:"cpu",kernelFunc:X0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q0e=tn(Am,n=>Math.asin(n)),Z0e={kernelName:Am,backendName:"cpu",kernelFunc:Q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J0e=tn(Rm,n=>Math.asinh(n)),eve={kernelName:Rm,backendName:"cpu",kernelFunc:J0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tve=tn(Dm,n=>Math.atan(n)),nve={kernelName:Dm,backendName:"cpu",kernelFunc:tve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sve=Jn((n,e)=>Math.atan2(n,e)),ive=ws(Om,sve),rve={kernelName:Om,backendName:"cpu",kernelFunc:ive};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ove=tn($m,n=>Math.atanh(n)),ave={kernelName:$m,backendName:"cpu",kernelFunc:ove};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qO(n,e,t,s,i,r){const o=i.strideHeight,a=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,h=i.effectiveFilterHeight,f=i.effectiveFilterWidth,p=i.padInfo.top,g=i.padInfo.left,y=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=ut(i.outShape,t),v=x.values,w=i.outShape[1]*i.outShape[2]*i.outShape[3],S=i.outShape[2]*i.outShape[3],C=i.outShape[3];for(let I=0;I<i.batchSize;++I){const A=I*w,L=I*s[0];for(let O=0;O<i.inChannels;++O)for(let N=0;N<i.outHeight;++N){const k=N*o-p,$=Math.max(0,k),R=Math.min(i.inHeight,h+k),z=A+N*S;for(let V=0;V<i.outWidth;++V){const ne=V*a-g,Q=Math.max(0,ne),G=Math.min(i.inWidth,f+ne);let J=y,Z=0,le=0;for(let ee=$;ee<R;ee+=l){const he=L+ee*s[1];for(let ae=Q;ae<G;ae+=c){const pe=he+ae*s[2],_e=n[pe+O];r==="max"&&_e>J?J=_e:r==="avg"&&(Z+=_e,le++)}if(isNaN(J))break}const H=z+V*C+O;v[H]=r==="avg"?Z/le:J}}}return x}function J8(n,e,t,s,i=!1,r=!1){const o=ut(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,h=s.dilationWidth,f=s.effectiveFilterHeight,p=s.effectiveFilterWidth,g=s.padInfo.top,y=s.padInfo.left,x=ut(e,t,n);for(let v=0;v<s.batchSize;++v)for(let w=0;w<s.inChannels;++w)for(let S=0;S<s.outHeight;++S){const C=S*a-g;let I=C;for(;I<0;)I+=c;const A=Math.min(s.inHeight,f+C);for(let L=0;L<s.outWidth;++L){const O=L*l-y;let N=O;for(;N<0;)N+=h;const k=Math.min(s.inWidth,p+O);let $=Number.NEGATIVE_INFINITY,R=-1;for(let z=I;z<A;z+=c){const V=z-C;for(let ne=N;ne<k;ne+=h){const Q=ne-O,G=x.get(v,z,ne,w);G>$&&($=G,i?R=r?((v*s.inHeight+z)*s.inWidth+ne)*s.inChannels+w:(z*s.inWidth+ne)*s.inChannels+w:R=V*p+Q)}}o.set(R,v,S,L,w)}}return o}function e7(n,e,t,s,i,r){const o=i.strideDepth,a=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,h=i.dilationHeight,f=i.dilationWidth,p=i.effectiveFilterDepth,g=i.effectiveFilterHeight,y=i.effectiveFilterWidth,x=i.padInfo.front,v=i.padInfo.top,w=i.padInfo.left,S=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,C=ut(i.outShape,t),I=C.values,A=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],L=i.outShape[2]*i.outShape[3]*i.outShape[4],O=i.outShape[3]*i.outShape[4],N=i.outShape[4];for(let k=0;k<i.batchSize;++k){const $=k*A,R=k*s[0];for(let z=0;z<i.inChannels;++z)for(let V=0;V<i.outDepth;++V){const ne=V*o-x;let Q=ne;for(;Q<0;)Q+=c;const G=Math.min(i.inDepth,p+ne),J=$+V*L;for(let Z=0;Z<i.outHeight;++Z){const le=Z*a-v;let H=le;for(;H<0;)H+=h;const ee=Math.min(i.inHeight,g+le),he=J+Z*O;for(let ae=0;ae<i.outWidth;++ae){const pe=ae*l-w;let _e=pe;for(;_e<0;)_e+=f;const Ee=Math.min(i.inWidth,y+pe),Le=he+ae*N;let $e=S,Me=0,ze=0;for(let yt=Q;yt<G;yt+=c){const bt=R+yt*s[1];for(let Wt=H;Wt<ee;Wt+=h){const Nt=bt+Wt*s[2];for(let xt=_e;xt<Ee;xt+=f){const Yt=Nt+xt*s[3],Ht=n[Yt+z];if(r==="max"&&Ht>$e?$e=Ht:r==="avg"&&(Me+=Ht,ze++),isNaN($e))break}if(isNaN($e))break}if(isNaN($e))break}const Ze=Le+z;I[Ze]=r==="avg"?Me/Math.max(ze,1):$e}}}}return C}function lve(n,e){const t=ut(e.outShape,"int32"),s=e.strideDepth,i=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;for(let x=0;x<e.batchSize;++x)for(let v=0;v<e.inChannels;++v)for(let w=0;w<e.outDepth;++w){const S=w*s-p;let C=S;for(;C<0;)C+=o;const I=Math.min(e.inDepth,c+S);for(let A=0;A<e.outHeight;++A){const L=A*i-g;let O=L;for(;O<0;)O+=a;const N=Math.min(e.inHeight,h+L);for(let k=0;k<e.outWidth;++k){const $=k*r-y;let R=$;for(;R<0;)R+=l;const z=Math.min(e.inWidth,f+$);let V=Number.NEGATIVE_INFINITY,ne=-1;for(let Q=C;Q<I;Q+=o){const G=Q-S;for(let J=O;J<N;J+=a){const Z=J-L;for(let le=R;le<z;le+=l){const H=le-$,ee=n.get(x,Q,J,le,v);ee>=V&&(V=ee,ne=G*h*f+Z*h+H)}}}t.set(ne,x,w,A,k,v)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e;He(i,"avgPool");const{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=s,c=1;B(ei(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=No(i.shape,r,o,c,a,l);let f;if(h.filterWidth===1&&h.filterHeight===1&&_t(h.inShape,h.outShape))f=tl({inputs:{x:i},backend:t});else{const p=t.data.get(i.dataId).values,g=Ye(i.shape),y=qO(p,i.shape,i.dtype,g,h,"avg");f=t.makeTensorInfo(h.outShape,i.dtype,y.values)}return f}const uve={kernelName:av,backendName:"cpu",kernelFunc:cve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{filterSize:r,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;He(i,"avgPool3d");const h=gc(i.shape,r,o,1,a,l,c),f=t.data.get(i.dataId).values,p=e7(f,i.shape,i.dtype,Ye(i.shape),h,"avg");return t.makeTensorInfo(p.shape,"float32",p.values)}const dve={kernelName:lv,backendName:"cpu",kernelFunc:hve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fve(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,input:r}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;He([i,r],"avgPool3DGrad");const h=gc(r.shape,o,a,1,l,c),f=h.strideDepth,p=h.strideHeight,g=h.strideWidth,y=h.filterDepth,x=h.filterHeight,v=h.filterWidth,w=h.dilationDepth,S=h.dilationHeight,C=h.dilationWidth,I=h.effectiveFilterDepth,A=h.effectiveFilterHeight,L=h.effectiveFilterWidth,O=I-1-h.padInfo.front,N=L-1-h.padInfo.left,k=A-1-h.padInfo.top,$=ut(r.shape,"float32"),R=1/(y*x*v),z=t.bufferSync(i);for(let V=0;V<h.batchSize;++V)for(let ne=0;ne<h.inChannels;++ne)for(let Q=0;Q<h.inDepth;++Q)for(let G=0;G<h.inHeight;++G)for(let J=0;J<h.inWidth;++J){const Z=Q-O,le=G-k,H=J-N;let ee=0;for(let he=0;he<I;he+=w){const ae=(Z+he)/f;if(!(ae<0||ae>=h.outDepth||Math.floor(ae)!==ae))for(let pe=0;pe<A;pe+=S){const _e=(le+pe)/p;if(!(_e<0||_e>=h.outHeight||Math.floor(_e)!==_e))for(let Ee=0;Ee<L;Ee+=C){const Le=(H+Ee)/g;if(Le<0||Le>=h.outWidth||Math.floor(Le)!==Le)continue;const $e=z.get(V,ae,_e,Le,ne);ee+=$e}}}$.set(ee*R,V,Q,G,J,ne)}return t.makeTensorInfo($.shape,$.dtype,$.values)}const pve={kernelName:LS,backendName:"cpu",kernelFunc:fve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mve(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,input:r}=e,o=r;He([i,r],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,h=No(o.shape,a,l,1,c),f=h.strideHeight,p=h.strideWidth,g=h.filterHeight,y=h.filterWidth,x=h.dilationHeight,v=h.dilationWidth,w=h.effectiveFilterHeight,S=h.effectiveFilterWidth,C=S-1-h.padInfo.left,I=w-1-h.padInfo.top,A=ut(o.shape,"float32"),L=1/(g*y),O=t.data.get(i.dataId).values,N=ut(i.shape,"float32",O);for(let k=0;k<h.batchSize;++k)for(let $=0;$<h.inChannels;++$)for(let R=0;R<h.inHeight;++R)for(let z=0;z<h.inWidth;++z){const V=R-I,ne=z-C;let Q=0;for(let G=0;G<w;G+=x){const J=(V+G)/f;if(!(J<0||J>=h.outHeight||Math.floor(J)!==J))for(let Z=0;Z<S;Z+=v){const le=(ne+Z)/p;if(le<0||le>=h.outWidth||Math.floor(le)!==le)continue;const H=N.get(k,J,le,$);Q+=H}}A.set(Q*L,k,R,z,$)}return t.makeTensorInfo(A.shape,A.dtype,A.values)}const gve={kernelName:PS,backendName:"cpu",kernelFunc:mve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,scale:r,offset:o,mean:a,variance:l}=e;B(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(r==null||a.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),He([i,a,l,r,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const h=t.data.get(i.dataId).values,f=t.data.get(a.dataId).values,p=t.data.get(l.dataId).values,g=r?t.data.get(r.dataId).values:new Float32Array([1]),y=o?t.data.get(o.dataId).values:new Float32Array([0]),x=new Float32Array(h.length),v=y.length,w=g.length,S=p.length,C=f.length;let I=0,A=0,L=0,O=0;for(let N=0;N<h.length;++N)x[N]=y[I++]+(h[N]-f[A++])*g[L++]/Math.sqrt(p[O++]+c),I>=v&&(I=0),A>=C&&(A=0),L>=w&&(L=0),O>=S&&(O=0);return t.makeTensorInfo(i.shape,i.dtype,x)}const bve={kernelName:_v,backendName:"cpu",kernelFunc:yve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{blockShape:r,crops:o}=s;He([i],"batchToSpaceND");const a=r.reduce((w,S)=>w*S),l=Ex(i.shape,r,a),c=Cx(l.length,r.length),h=Ix(i.shape,r,a),f=nO(o,r.length),p=sO(h,o,r.length),g=yn({inputs:{x:i},backend:t,attrs:{shape:l}}),y=ir({inputs:{x:g},backend:t,attrs:{perm:c}}),x=yn({inputs:{x:y},backend:t,attrs:{shape:h}}),v=qd({inputs:{x},backend:t,attrs:{begin:f,size:p}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(x),v}const xve={kernelName:uv,backendName:"cpu",kernelFunc:vve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,weights:r}=e,{size:o}=s,a=t.data.get(i.dataId).values,l=t.data.get(r.dataId).values,c=UO(a,l,r.dtype,r.shape,o);return t.makeTensorInfo([o],r.dtype,c)}const _ve={kernelName:MS,backendName:"cpu",kernelFunc:wve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tve(n){const{inputs:e,backend:t}=n,{s0:s,s1:i}=e,r=t.data.get(s.dataId).values,o=t.data.get(i.dataId).values,a=ot(Array.from(r),Array.from(o));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Sve={kernelName:FS,backendName:"cpu",kernelFunc:Tve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eve=tn(Mm,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),Cve={kernelName:Mm,backendName:"cpu",kernelFunc:Eve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ive=n=>{const{x:e}=n.inputs,t=n.backend,s=new Float32Array(ye(e.shape)),i=t.data.get(e.dataId),r=i.complexTensorInfos.real,o=i.complexTensorInfos.imag,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values;for(let c=0;c<a.length;c++){const h=a[c],f=l[c];s[c]=Math.hypot(h,f)}return t.makeOutput(s,e.shape,"float32")},kve={kernelName:dv,backendName:"cpu",kernelFunc:Ive};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rm(n){const{inputs:e,backend:t}=n,{input:s}=e,i=t.data.get(s.dataId).complexTensorInfos.imag,r=t.data.get(i.dataId).values;return t.makeTensorInfo(i.shape,i.dtype,r)}const Nve={kernelName:iE,backendName:"cpu",kernelFunc:rm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function om(n){const{inputs:e,backend:t,attrs:s}=n,{axis:i}=s,r=gt(i,e[0].shape)[0],o=e.map(x=>x.shape);J$(o,r);let a=za(e.map(x=>x.shape),r);if(ye(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(x=>ye(x.shape)>0);if(l.length===1)return tl({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const x=l.map(I=>Gd({inputs:{input:I},backend:t})),v=l.map(I=>rm({inputs:{input:I},backend:t})),w=om({inputs:x,backend:t,attrs:{axis:r}}),S=om({inputs:v,backend:t,attrs:{axis:r}}),C=pr({inputs:{real:w,imag:S},backend:t});return x.forEach(I=>t.disposeIntermediateTensorInfo(I)),v.forEach(I=>t.disposeIntermediateTensorInfo(I)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(S),C}const c=l.map(x=>{const w=[-1,ye(x.shape.slice(r))];return yn({inputs:{x},backend:t,attrs:{shape:w}})}),h=c.map(x=>({vals:t.data.get(x.dataId).values,shape:x.shape}));a=za(c.map(x=>x.shape),1);const f=c[0].shape[0]===1,p=r8(h,a,e[0].dtype,f),g=za(l.map(x=>x.shape),r),y=t.makeTensorInfo(g,e[0].dtype,p);return c.forEach(x=>t.disposeIntermediateTensorInfo(x)),y}const Ave={kernelName:fv,backendName:"cpu",kernelFunc:om};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t7(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:h}=s;He([i,r],"conv2d");const f=yc(l),p=Ps(i.shape,r.shape,o,c,a,h,!1,f),g=p.filterHeight,y=p.filterWidth,x=p.dilationHeight,v=p.dilationWidth,w=p.padInfo.left,S=p.padInfo.top,C=p.dataFormat==="channelsLast",I=new as(p.outShape,i.dtype),A=Ye(i.shape),L=Ye(r.shape),O=A[0],N=C?A[1]:A[2],k=C?A[2]:1,$=C?1:A[1],R=I.strides[0],z=C?I.strides[1]:I.strides[2],V=C?I.strides[2]:1,ne=C?1:I.strides[1],Q=t.data.get(i.dataId).values,G=t.data.get(r.dataId).values,J=I.values;for(let Z=0;Z<p.batchSize;++Z){const le=Z*O,H=Z*R;for(let ee=0;ee<p.outHeight;++ee){const he=H+ee*z,ae=ee*p.strideHeight-S;for(let pe=0;pe<g;++pe){const _e=ae+pe*x;if(_e<0||_e>=p.inHeight)continue;const Ee=pe*L[0],Le=le+_e*N;for(let $e=0;$e<p.outWidth;++$e){const Me=he+$e*V,ze=$e*p.strideWidth-w;for(let Ze=0;Ze<y;++Ze){const yt=ze+Ze*v;if(yt<0||yt>=p.inWidth)continue;const bt=Ee+Ze*L[1],Wt=Le+yt*k;let Nt=bt;for(let xt=0;xt<p.inChannels;++xt){const Yt=Q[Wt+xt*$];for(let Ht=0;Ht<p.outChannels;++Ht)J[Me+Ht*ne]+=Yt*G[Nt+Ht];Nt+=p.outChannels}}}}}}return t.makeTensorInfo(I.shape,I.dtype,J)}const Rve={kernelName:pv,backendName:"cpu",kernelFunc:t7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,dy:r}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:h}=s;He([i,r],"conv2dBackpropFilter");const f=yc(l),p=Ps(i.shape,h,o,1,a,c,!1,f),{strideHeight:g,strideWidth:y,filterHeight:x,filterWidth:v}=p,w=p.dataFormat==="channelsLast",S=new as(p.filterShape,"float32"),C=p.padInfo.left,I=p.padInfo.top,A=t.data.get(i.dataId).values,L=t.data.get(r.dataId).values,O=new as(i.shape,i.dtype,A),N=new as(r.shape,r.dtype,L);for(let k=0;k<x;++k){const $=Math.max(0,Math.ceil((I-k)/g)),R=Math.min(p.outHeight,(p.inHeight+I-k)/g);for(let z=0;z<v;++z){const V=Math.max(0,Math.ceil((C-z)/y)),ne=Math.min(p.outWidth,(p.inWidth+C-z)/y);for(let Q=0;Q<p.inChannels;++Q)for(let G=0;G<p.outChannels;++G){let J=0;for(let Z=0;Z<p.batchSize;++Z)for(let le=$;le<R;++le){const H=k+le*g-I;for(let ee=V;ee<ne;++ee){const he=z+ee*y-C;w?J+=O.get(Z,H,he,Q)*N.get(Z,le,ee,G):J+=O.get(Z,Q,H,he)*N.get(Z,G,le,ee)}}S.set(J,k,z,Q,G)}}}return t.makeTensorInfo(S.shape,S.dtype,S.values)}const $ve={kernelName:zS,backendName:"cpu",kernelFunc:Dve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ove(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,filter:r}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:h}=s;He([i,r],"conv2dBackpropInput");const f=Ye(r.shape),p=Ye(i.shape);let g=yc(c);const y=Ps(o,r.shape,a,1,l,h,!1,g),x=new as(y.inShape,"float32"),v=x.values,w=t.data.get(i.dataId).values,S=t.data.get(r.dataId).values,[C,I,A]=f,{batchSize:L,filterHeight:O,filterWidth:N,inChannels:k,inHeight:$,inWidth:R,outChannels:z,outHeight:V,outWidth:ne,strideHeight:Q,strideWidth:G}=y;g=y.dataFormat;const J=O-1-y.padInfo.top,Z=N-1-y.padInfo.left,le=g==="channelsLast",H=x.strides[0],ee=le?x.strides[1]:x.strides[2],he=le?x.strides[2]:1,ae=le?1:x.strides[1],pe=p[0],_e=le?p[1]:p[2],Ee=le?p[2]:1,Le=le?1:p[1];for(let $e=0;$e<L;++$e)for(let Me=0;Me<k;++Me)for(let ze=0;ze<$;++ze){const Ze=ze-J,yt=Math.max(0,Math.ceil(Ze/Q)),bt=Math.min(V,(O+Ze)/Q);for(let Wt=0;Wt<R;++Wt){const Nt=Wt-Z,xt=Math.max(0,Math.ceil(Nt/G)),Yt=Math.min(ne,(N+Nt)/G);let Ht=0;for(let bn=yt;bn<bt;++bn){const Bi=bn*Q-Ze;for(let ii=xt;ii<Yt;++ii){const Tr=ii*G-Nt,vn=pe*$e+_e*bn+Ee*ii,or=C*(O-1-Bi)+I*(N-1-Tr)+A*Me;for(let an=0;an<z;++an){const dn=w[vn+Le*an],Ms=S[or+an];Ht+=dn*Ms}}}const yi=H*$e+ee*ze+he*Wt+ae*Me;v[yi]=Ht}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}const Pve={kernelName:mv,backendName:"cpu",kernelFunc:Ove};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r}=e,{strides:o,pad:a,dilations:l}=s;He([i,r],"conv3d");const c=oh(i.shape,r.shape,o,l,a),{filterDepth:h,filterHeight:f,filterWidth:p,dilationDepth:g,dilationHeight:y,dilationWidth:x,padInfo:v}=c,w=v.front,S=v.left,C=v.top,I=new as(c.outShape,i.dtype),A=t.data.get(i.dataId).values,L=t.data.get(r.dataId).values,O=I.values,N=Ye(i.shape),k=Ye(r.shape);for(let $=0;$<c.batchSize;++$){const R=$*N[0],z=$*I.strides[0];for(let V=0;V<c.outDepth;++V){const ne=z+V*I.strides[1],Q=V*c.strideDepth-w;for(let G=0;G<h;++G){const J=Q+G*g;if(J<0||J>=c.inDepth)continue;const Z=G*k[0],le=R+J*N[1];for(let H=0;H<c.outHeight;++H){const ee=ne+H*I.strides[2],he=H*c.strideHeight-C;for(let ae=0;ae<f;++ae){const pe=he+ae*y;if(pe<0||pe>=c.inHeight)continue;const _e=Z+ae*k[1],Ee=le+pe*N[2];for(let Le=0;Le<c.outWidth;++Le){const $e=ee+Le*c.outChannels,Me=Le*c.strideWidth-S;for(let ze=0;ze<p;++ze){const Ze=Me+ze*x;if(Ze<0||Ze>=c.inWidth)continue;const yt=_e+ze*k[2],bt=Ee+Ze*c.inChannels;let Wt=yt;for(let Nt=0;Nt<c.inChannels;++Nt){const xt=A[bt+Nt];for(let Yt=0;Yt<c.outChannels;++Yt)O[$e+Yt]+=xt*L[Wt+Yt];Wt+=c.outChannels}}}}}}}}return t.makeTensorInfo(I.shape,I.dtype,I.values)}const Mve={kernelName:gv,backendName:"cpu",kernelFunc:Lve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,dy:r}=e,{strides:o,pad:a,filterShape:l}=s;He([i,r],"conv3dBackpropFilterV2");const c=Ye(i.shape),h=Ye(r.shape),f=oh(i.shape,l,o,1,a),p=f.strideDepth,g=f.strideHeight,y=f.strideWidth,x=f.filterDepth,v=f.filterHeight,w=f.filterWidth,S=new as(f.filterShape,"float32"),C=S.values,[I,A,L,O]=S.strides,N=t.data.get(r.dataId).values,[k,$,R,z]=h,V=t.data.get(i.dataId).values,[ne,Q,G,J]=c,Z=f.padInfo.front,le=f.padInfo.left,H=f.padInfo.top;for(let ee=0;ee<x;++ee){const he=Math.max(0,Math.ceil((Z-ee)/p)),ae=Math.min(f.outDepth,(f.inDepth+Z-ee)/p),pe=ee*I;for(let _e=0;_e<v;++_e){const Ee=Math.max(0,Math.ceil((H-_e)/g)),Le=Math.min(f.outHeight,(f.inHeight+H-_e)/g),$e=_e*A+pe;for(let Me=0;Me<w;++Me){const ze=Math.max(0,Math.ceil((le-Me)/y)),Ze=Math.min(f.outWidth,(f.inWidth+le-Me)/y),yt=Me*L+$e;for(let bt=0;bt<f.inChannels;++bt){const Wt=bt*O+yt;for(let Nt=0;Nt<f.outChannels;++Nt){let xt=0;for(let Yt=0;Yt<f.batchSize;++Yt){const Ht=Yt*ne,yi=Yt*k;for(let bn=he;bn<ae;++bn){const ii=(ee+bn*p-Z)*Q+Ht,Tr=bn*$+yi;for(let vn=Ee;vn<Le;++vn){const an=(_e+vn*g-H)*G+ii,dn=vn*R+Tr;for(let Ms=ze;Ms<Ze;++Ms){const al=(Me+Ms*y-le)*J+an,bh=Ms*z+dn;xt+=V[al+bt]*N[bh+Nt]}}}}C[Wt+Nt]=xt}}}}}return t.makeTensorInfo(S.shape,S.dtype,S.values)}const Vve={kernelName:BS,backendName:"cpu",kernelFunc:Fve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zve(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,filter:r}=e,{pad:o,strides:a,inputShape:l}=s;He([i],"conv3dBackpropInputV2");const c=Ye(i.shape),h=Ye(r.shape),f=oh(l,r.shape,a,1,o),p=new as(f.inShape,"float32"),g=p.values,[y,x,v,w]=p.strides,S=t.data.get(i.dataId).values,[C,I,A,L]=c,O=t.data.get(r.dataId).values,[N,k,$,R]=h,{batchSize:z,filterDepth:V,filterHeight:ne,filterWidth:Q,inChannels:G,inDepth:J,inHeight:Z,inWidth:le,outChannels:H,outDepth:ee,outHeight:he,outWidth:ae,strideDepth:pe,strideHeight:_e,strideWidth:Ee}=f,Le=V-1-f.padInfo.front,$e=ne-1-f.padInfo.top,Me=Q-1-f.padInfo.left;for(let ze=0;ze<z;++ze)for(let Ze=0;Ze<G;++Ze)for(let yt=0;yt<J;++yt){const bt=yt-Le,Wt=Math.max(0,Math.ceil(bt/pe)),Nt=Math.min(ee,(V+bt)/pe);for(let xt=0;xt<Z;++xt){const Yt=xt-$e,Ht=Math.max(0,Math.ceil(Yt/_e)),yi=Math.min(he,(ne+Yt)/_e);for(let bn=0;bn<le;++bn){const Bi=bn-Me,ii=Math.max(0,Math.ceil(Bi/Ee)),Tr=Math.min(ae,(Q+Bi)/Ee);let vn=0;for(let or=Wt;or<Nt;++or){const an=or*pe-bt;for(let dn=Ht;dn<yi;++dn){const Ms=dn*_e-Yt;for(let ca=ii;ca<Tr;++ca){const al=ca*Ee-Bi,bh=C*ze+I*or+A*dn+L*ca,ll=N*(V-1-an)+k*(ne-1-Ms)+$*(Q-1-al)+R*Ze;for(let Sr=0;Sr<H;++Sr){const Fs=S[bh+Sr],vh=O[ll+Sr];vn+=Fs*vh}}}}g[y*ze+x*yt+v*xt+w*bn+Ze]=vn}}}return t.makeTensorInfo(p.shape,p.dtype,p.values)}const Bve={kernelName:US,backendName:"cpu",kernelFunc:zve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uve=tn(Fm,n=>Math.cos(n)),Wve={kernelName:Fm,backendName:"cpu",kernelFunc:Uve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hve=tn(Vm,n=>Math.cosh(n)),jve={kernelName:Vm,backendName:"cpu",kernelFunc:Hve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gve(n){const{inputs:e,backend:t,attrs:s}=n,{image:i,boxes:r,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[h,f,p,g]=i.shape,y=r.shape[0],[x,v]=a,w=ut([y,x,v,g],"float32"),S=t.data.get(r.dataId).values,C=t.data.get(o.dataId).values,I=t.data.get(i.dataId).values,A=Ye(i.shape),L=Ye(w.shape);for(let O=0;O<y;O++){const N=O*4,k=S[N],$=S[N+1],R=S[N+2],z=S[N+3],V=C[O];if(V>=h)continue;const ne=x>1?(R-k)*(f-1)/(x-1):0,Q=v>1?(z-$)*(p-1)/(v-1):0;for(let G=0;G<x;G++){const J=x>1?k*(f-1)+G*ne:.5*(k+R)*(f-1);if(J<0||J>f-1){for(let Z=0;Z<v;Z++)for(let le=0;le<g;le++){const H=le+Z*L[2]+G*L[1]+O*L[0];w.values[H]=c}continue}if(l==="bilinear"){const Z=Math.floor(J),le=Math.ceil(J),H=J-Z;for(let ee=0;ee<v;ee++){const he=v>1?$*(p-1)+ee*Q:.5*($+z)*(p-1);if(he<0||he>p-1){for(let Ee=0;Ee<g;Ee++){const Le=Ee+ee*L[2]+G*L[1]+O*L[0];w.values[Le]=c}continue}const ae=Math.floor(he),pe=Math.ceil(he),_e=he-ae;for(let Ee=0;Ee<g;Ee++){let Le=Ee+ae*A[2]+Z*A[1]+V*A[0];const $e=I[Le];Le=Ee+pe*A[2]+Z*A[1]+V*A[0];const Me=I[Le];Le=Ee+ae*A[2]+le*A[1]+V*A[0];const ze=I[Le];Le=Ee+pe*A[2]+le*A[1]+V*A[0];const Ze=I[Le],yt=$e+(Me-$e)*_e,bt=ze+(Ze-ze)*_e;Le=Ee+ee*L[2]+G*L[1]+O*L[0],w.values[Le]=yt+(bt-yt)*H}}}else for(let Z=0;Z<v;++Z){const le=v>1?$*(p-1)+Z*Q:.5*($+z)*(p-1);if(le<0||le>p-1){for(let he=0;he<g;he++){const ae=he+Z*L[2]+G*L[1]+O*L[0];w.values[ae]=c}continue}const H=Math.round(le),ee=Math.round(J);for(let he=0;he<g;he++){const ae=he+H*A[2]+ee*A[1]+V*A[0],pe=he+Z*L[2]+G*L[1]+O*L[0];w.values[pe]=I[ae]}}}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const qve={kernelName:HS,backendName:"cpu",kernelFunc:Gve};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,exclusive:o,reverse:a}=s;He(i,"cumprod");const l=On([r],i.shape.length);let c=i;l!=null&&(c=ir({inputs:{x:i},backend:t,attrs:{perm:l}}));const h=Qn(1,i.shape.length)[0];if(h!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${h}`);const f=Ji(c.dtype,"int32"),p=DS(ye(c.shape),f),g=t.data.get(c.dataId).values,y=c.shape[c.shape.length-1],x=a?(w,S)=>w+y-S-1:(w,S)=>w+S;for(let w=0;w<g.length;w+=y)for(let S=0;S<y;S++){const C=x(w,S);if(S===0)p[C]=o?1:g[C];else{const I=x(w,S-1);p[C]=o?g[I]*p[I]:g[C]*p[I]}}const v=t.makeTensorInfo(c.shape,f,p);if(l!=null){const w=ah(l),S=ir({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(c),S}return v}const Xve={kernelName:WS,backendName:"cpu",kernelFunc:Kve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,exclusive:o,reverse:a}=s;He(i,"cumsum");const l=On([r],i.shape.length);let c=i;l!=null&&(c=ir({inputs:{x:i},backend:t,attrs:{perm:l}}));const h=Qn(1,i.shape.length)[0];if(h!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${h}`);const f=Ji(c.dtype,"int32"),p=Zs(ye(c.shape),f),g=t.data.get(c.dataId).values,y=c.shape[c.shape.length-1],x=a?(w,S)=>w+y-S-1:(w,S)=>w+S;for(let w=0;w<g.length;w+=y)for(let S=0;S<y;S++){const C=x(w,S);if(S===0)p[C]=o?0:g[C];else{const I=x(w,S-1);p[C]=o?g[I]+p[I]:g[C]+p[I]}}const v=t.makeTensorInfo(c.shape,f,p);if(l!=null){const w=ah(l),S=ir({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(c),S}return v}const Qve={kernelName:yv,backendName:"cpu",kernelFunc:Yve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zve(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,weights:r}=e,{size:o,binaryOutput:a}=s;if(i.shape.length===1){const l=t.data.get(i.dataId).values,c=t.data.get(r.dataId).values,h=UO(l,c,r.dtype,r.shape,o);return t.makeTensorInfo([o],r.dtype,h)}else if(i.shape.length===2){const l=t.bufferSync(i),c=t.bufferSync(r),h=n8(l,c,o,a);return t.makeTensorInfo(h.shape,r.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const Jve={kernelName:jS,backendName:"cpu",kernelFunc:Zve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function exe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{blockSize:r,dataFormat:o}=s;B(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const a=i.shape[0],l=i.shape[1],c=i.shape[2],h=i.shape[3],f=l*r,p=c*r,g=h/(r*r),y=t.data.get(i.dataId).values,x=new Float32Array(a*f*p*g);let v=0;for(let w=0;w<a;++w)for(let S=0;S<f;++S){const C=Math.floor(S/r),I=S%r;for(let A=0;A<p;++A){const L=Math.floor(A/r),O=A%r,N=(I*r+O)*g;for(let k=0;k<g;++k){const R=k+N+h*(L+c*(C+l*w));x[v++]=y[R]}}}return t.makeTensorInfo([a,f,p,g],i.dtype,x)}const txe={kernelName:GS,backendName:"cpu",kernelFunc:exe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;He([i,r],"depthwiseConv2DNative");const h=Ye(i.shape),f=Ye(r.shape);let p=l;p==null&&(p=[1,1]),B(ei(o,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${p}'`);const g=Ps(i.shape,r.shape,o,p,a,c,!0),{filterHeight:y,filterWidth:x,dilationHeight:v,dilationWidth:w,padInfo:S}=g,C=S.left,I=S.top,A=g.outChannels/g.inChannels,L=new as(g.outShape,i.dtype),O=t.data.get(i.dataId).values,N=t.data.get(r.dataId).values,k=L.values;for(let $=0;$<g.batchSize;++$){const R=$*h[0],z=$*L.strides[0];for(let V=0;V<g.outHeight;++V){const ne=z+V*L.strides[1],Q=V*g.strideHeight-I;for(let G=0;G<y;++G){const J=Q+G*v;if(J<0||J>=g.inHeight)continue;const Z=G*f[0],le=R+J*h[1];for(let H=0;H<g.outWidth;++H){const ee=ne+H*L.strides[2],he=H*g.strideWidth-C;for(let ae=0;ae<x;++ae){const pe=he+ae*w;if(pe<0||pe>=g.inWidth)continue;const _e=Z+ae*f[1],Ee=le+pe*g.inChannels;let Le=ee,$e=_e;for(let Me=0;Me<g.inChannels;++Me){const ze=O[Ee+Me];for(let Ze=0;Ze<A;++Ze)k[Le+Ze]+=ze*N[$e+Ze];Le+=A,$e+=A}}}}}}return t.makeTensorInfo(L.shape,L.dtype,L.values)}const nxe={kernelName:bv,backendName:"cpu",kernelFunc:n7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sxe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,dy:r}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:h}=s;He([i,r],"depthwiseConv2dNativeBackpropFilter");const f=Ps(i.shape,h,o,a,l,c,!0),{strideHeight:p,strideWidth:g,filterHeight:y,filterWidth:x}=f,v=new as(f.filterShape,"float32"),w=f.padInfo.left,S=f.padInfo.top,C=f.outChannels/f.inChannels,I=t.data.get(i.dataId).values,A=new as(i.shape,i.dtype,I),L=t.data.get(r.dataId).values,O=new as(r.shape,r.dtype,L);for(let N=0;N<y;++N){const k=Math.max(0,Math.ceil((S-N)/p)),$=Math.min(f.outHeight,(f.inHeight+S-N)/p);for(let R=0;R<x;++R){const z=Math.max(0,Math.ceil((w-R)/g)),V=Math.min(f.outWidth,(f.inWidth+w-R)/g);for(let ne=0;ne<f.outChannels;++ne){const Q=Math.trunc(ne/C),G=ne%C;let J=0;for(let Z=0;Z<f.batchSize;++Z)for(let le=k;le<$;++le){const H=N+le*p-S;for(let ee=z;ee<V;++ee){const he=R+ee*g-w;J+=A.get(Z,H,he,Q)*O.get(Z,le,ee,ne)}}v.set(J,N,R,Q,G)}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const ixe={kernelName:qS,backendName:"cpu",kernelFunc:sxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rxe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,filter:r}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:h}=s;He([i,r],"depthwiseConv2DNativeBackpropInput");const f=Ye(i.shape),p=Ye(r.shape),g=Ps(h,r.shape,o,a,l,c,!0),y=new as(g.inShape,"float32"),x=y.values,[v,w,S]=y.strides,C=t.data.get(i.dataId).values,[I,A,L]=f,O=t.data.get(r.dataId).values,[N,k,$]=p,{batchSize:R,filterHeight:z,filterWidth:V,inChannels:ne,inHeight:Q,inWidth:G,outChannels:J,outHeight:Z,outWidth:le,strideHeight:H,strideWidth:ee}=g,he=z-1-g.padInfo.top,ae=V-1-g.padInfo.left,pe=J/ne;for(let _e=0;_e<R;++_e)for(let Ee=0;Ee<ne;++Ee)for(let Le=0;Le<Q;++Le){const $e=Le-he,Me=Math.max(0,Math.ceil($e/H)),ze=Math.min(Z,(z+$e)/H);for(let Ze=0;Ze<G;++Ze){const yt=Ze-ae,bt=Math.max(0,Math.ceil(yt/ee)),Wt=Math.min(le,(V+yt)/ee);let Nt=0;for(let xt=Me;xt<ze;++xt){const Yt=xt*H-$e;for(let Ht=bt;Ht<Wt;++Ht){const yi=Ht*ee-yt,bn=I*_e+A*xt+L*Ht,Bi=N*(z-1-Yt)+k*(V-1-yi)+$*Ee;for(let ii=0;ii<pe;++ii){const Tr=Ee*pe+ii,vn=C[bn+Tr],or=O[Bi+ii];Nt+=vn*or}}}x[v*_e+w*Le+S*Ze+Ee]=Nt}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const oxe={kernelName:KS,backendName:"cpu",kernelFunc:rxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function axe(n){const{inputs:e,backend:t}=n,{x:s}=e,i=ye(s.shape),r=t.data.get(s.dataId).values,o=ut([i,i],s.dtype),a=o.values;for(let c=0;c<r.length;c++)a[c*i+c]=r[c];const l=[...s.shape,...s.shape];return t.makeTensorInfo(l,o.dtype,o.values)}const lxe={kernelName:XS,backendName:"cpu",kernelFunc:axe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cxe={kernelName:vv,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:i}=n,{strides:r,pad:o,dilations:a}=t,l=e,c=l.data.get(s.dataId).values,h=s.shape.length,f=l.data.get(i.dataId).values,p=i.shape.length,{batchSize:g,inHeight:y,inWidth:x,inChannels:v,outHeight:w,outWidth:S,padInfo:C,strideHeight:I,strideWidth:A,filterHeight:L,filterWidth:O,dilationHeight:N,dilationWidth:k,outShape:$}=lx(s.shape,i.shape,r,o,"NHWC",a),R=ye($),z=$.length,V=Vn(s.dtype,R);for(let Q=0;Q<g;++Q)for(let G=0;G<w;++G){const J=G*I-C.top;for(let Z=0;Z<S;++Z){const le=Z*A-C.left;for(let H=0;H<v;++H){let ee=Number.MIN_SAFE_INTEGER;for(let ae=0;ae<L;++ae){const pe=J+ae*N;if(pe>=0&&pe<y)for(let _e=0;_e<O;++_e){const Ee=le+_e*k;if(Ee>=0&&Ee<x){const Le=Xo([Q,pe,Ee,H],h,Ye(s.shape)),$e=Xo([ae,_e,H],p,Ye(i.shape)),Me=c[Le]+f[$e];Me>ee&&(ee=Me)}}}const he=Xo([Q,G,Z,H],z,Ye($));V[he]=ee}}}return{dataId:l.write(ih(V,s.dtype),$,s.dtype),shape:$,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uxe={kernelName:aT,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:i,dy:r}=n,{strides:o,pad:a,dilations:l}=t,c=e,h=Mr(s.shape,c.data.get(s.dataId).values),f=Mr(i.shape,c.data.get(i.dataId).values),{batchSize:p,inHeight:g,inWidth:y,inChannels:x,outHeight:v,outWidth:w,padInfo:S,strideHeight:C,strideWidth:I,filterHeight:A,filterWidth:L,dilationHeight:O,dilationWidth:N,outShape:k}=lx(s.shape,i.shape,o,a,"NHWC",l);B(r.rank===k.length,()=>`Error in ${aT}, dy must have the same rank as output ${k.length}, but got ${r.rank}`);const $=Mr(k,c.data.get(r.dataId).values),R=wD(i.shape,i.dtype);for(let V=0;V<p;++V)for(let ne=0;ne<v;++ne){const Q=ne*C-S.top;for(let G=0;G<w;++G){const J=G*I-S.left;for(let Z=0;Z<x;++Z){let le=Number.MIN_SAFE_INTEGER,H=0,ee=0;for(let he=0;he<A;++he){const ae=Q+he*O;if(ae>=0&&ae<g)for(let pe=0;pe<L;++pe){const _e=J+pe*N;if(_e>=0&&_e<y){const Ee=h[V][ae][_e][Z]+f[he][pe][Z];Ee>le&&(le=Ee,H=he,ee=pe)}}}R[H][ee][Z]+=$[V][ne][G][Z]}}}return{dataId:c.write(ih(R,s.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hxe={kernelName:oT,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:i,dy:r}=n,{strides:o,pad:a,dilations:l}=t,c=e,h=Mr(s.shape,c.data.get(s.dataId).values),f=Mr(i.shape,c.data.get(i.dataId).values),{batchSize:p,inHeight:g,inWidth:y,inChannels:x,outHeight:v,outWidth:w,padInfo:S,strideHeight:C,strideWidth:I,filterHeight:A,filterWidth:L,dilationHeight:O,dilationWidth:N,outShape:k}=lx(s.shape,i.shape,o,a,"NHWC",l);B(r.rank===k.length,()=>`Error in ${oT}, dy must have the same rank as output ${k.length}, but got ${r.rank}`);const $=Mr(k,c.data.get(r.dataId).values),R=wD(s.shape,s.dtype);for(let V=0;V<p;++V)for(let ne=0;ne<v;++ne){const Q=ne*C-S.top;for(let G=0;G<w;++G){const J=G*I-S.left;for(let Z=0;Z<x;++Z){let le=Number.MIN_SAFE_INTEGER,H=Q<0?0:Q,ee=J<0?0:J;for(let he=0;he<A;++he){const ae=Q+he*O;if(ae>=0&&ae<g)for(let pe=0;pe<L;++pe){const _e=J+pe*N;if(_e>=0&&_e<y){const Ee=h[V][ae][_e][Z]+f[he][pe][Z];Ee>le&&(le=Ee,H=ae,ee=_e)}}}R[V][H][ee][Z]+=$[V][ne][G][Z]}}}return{dataId:c.write(ih(R,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dxe(n){const{inputs:e,backend:t,attrs:s}=n,{image:i}=e,{canvas:r,options:o}=s,{contextOptions:a,imageOptions:l}=o||{},c=(l==null?void 0:l.alpha)||1,h=(a==null?void 0:a.contextType)||"2d";if(h!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const f=r.getContext(h,(a==null?void 0:a.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${h} type.`);const[p,g]=i.shape.slice(0,2),y=i.shape.length===2?1:i.shape[2],x=t.data.get(i.dataId).values,v=i.dtype==="float32"?255:1,w=new Uint8ClampedArray(g*p*4);for(let C=0;C<p*g;++C){const I=[0,0,0,255*c];for(let L=0;L<y;L++){const O=x[C*y+L];if(i.dtype==="float32"){if(O<0||O>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${O}.`)}else if(i.dtype==="int32"&&(O<0||O>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${O}.`);y===1?(I[0]=O*v,I[1]=O*v,I[2]=O*v):I[L]=O*v}const A=C*4;w[A+0]=Math.round(I[0]),w[A+1]=Math.round(I[1]),w[A+2]=Math.round(I[2]),w[A+3]=Math.round(I[3])}r.width=g,r.height=p;const S=new ImageData(w,g,p);return f.putImageData(S,0,0),i}const fxe={kernelName:YS,backendName:"cpu",kernelFunc:dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lx(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s;He(i,"sum");let a;i.dtype==="bool"?a=Gu({inputs:{x:i},backend:t,attrs:{dtype:"int32"}}):a=tl({inputs:{x:i},backend:t});const l=a.shape.length,c=gt(r,a.shape),h=On(c,l);let f=c,p=a;h!=null&&(p=ir({inputs:{x:a},backend:t,attrs:{perm:h}}),f=Qn(f.length,l)),ti("sum",f,p.shape.length);const[g,y]=Ls(p.shape,f),x=Ji(p.dtype,"int32");let v=ST(t,g,x);const w=ye(y),S=t.data.get(v.dataId).values,C=t.data.get(p.dataId).values;for(let I=0;I<S.length;++I){const A=I*w;let L=0;for(let O=0;O<w;++O)L+=C[A+O];S[I]=L}if(o){const I=Xn(v.shape,c),A=v;v=yn({inputs:{x:v},backend:t,attrs:{shape:I}}),t.disposeIntermediateTensorInfo(A)}return t.disposeIntermediateTensorInfo(a),h!=null&&t.disposeIntermediateTensorInfo(p),v}const pxe={kernelName:Zv,backendName:"cpu",kernelFunc:Lx};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mxe(n){const{inputs:e,backend:t,attrs:s}=n,{equation:i}=s,r=e,{allDims:o,summedDims:a,idDims:l}=hO(i,r.length);fO(o.length,l,r);const{path:c,steps:h}=pO(a,l),f=h.length;let p=null,g=o.length;const y=[];for(let x=0;x<f;++x){for(const v of h[x]){const{permutationIndices:w,expandDims:S}=dO(g,l[v]);let C;mO(w)?C=r[v]:(C=ir({inputs:{x:r[v]},backend:t,attrs:{perm:w}}),y.push(C));const I=C.shape.slice();for(let A=0;A<S.length;++A)I.splice(S[A],0,1);_t(C.shape,I)||(C=yn({inputs:{x:C},backend:t,attrs:{shape:I}}),y.push(C)),p===null?p=C:(p=VC({inputs:{a:C,b:p},backend:t}),y.push(p))}x<f-1&&(c[x]>=0&&(p=Lx({inputs:{x:p},backend:t,attrs:{axis:c[x]-(o.length-g),keepDims:!1}}),y.push(p)),g--)}for(const x of y)x!==p&&t.disposeIntermediateTensorInfo(x);return p}const gxe={kernelName:QS,backendName:"cpu",kernelFunc:mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yxe(n){const{inputs:e,backend:t}=n,{dy:s,y:i}=e;He([s,i],"eluGrad");const r=new Float32Array(ye(i.shape)),o=t.data.get(i.dataId).values,a=t.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=0?r[l]=a[l]:r[l]=a[l]*(c+1)}return t.makeTensorInfo(i.shape,"float32",r)}const bxe={kernelName:ZS,backendName:"cpu",kernelFunc:yxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vxe=iO,xxe=rO,wxe=oO,_xe=aO,Txe=lO,Sxe=cO,Exe=tn(Um,n=>{const e=Math.sign(n),t=Math.abs(n),s=1/(1+vxe*t);return e*(1-((((Sxe*s+Txe)*s+_xe)*s+wxe)*s+xxe)*s*Math.exp(-t*t))}),Cxe={kernelName:Um,backendName:"cpu",kernelFunc:Exe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IT(n){const{inputs:e,backend:t,attrs:s}=n,{input:i}=e,{dim:r}=s,o=i.shape.length,a=i.shape.slice();let l=r;return r<0&&(B(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+r+1),a.splice(l,0,1),yn({inputs:{x:i},backend:t,attrs:{shape:a}})}const Ixe={kernelName:wv,backendName:"cpu",kernelFunc:IT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kxe=Jn((n,e)=>n/e),KO=ws(zm,kxe),BR={kernelName:zm,backendName:"cpu",kernelFunc:KO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s7(n,e,t){const s=n.shape,i=s[0],r=s[1],o=t.data.get(n.dataId),a=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[i,r],h=ye(c),f=$s("float32",h),p=$s("float32",h);for(let v=0;v<i;v++){const w=qd({inputs:{x:a},backend:t,attrs:{begin:[v,0],size:[1,r]}}),S=qd({inputs:{x:l},backend:t,attrs:{begin:[v,0],size:[1,r]}}),C=pr({inputs:{real:w,imag:S},backend:t}),{real:I,imag:A}=Nxe(C,e,t),L=ic(I,A);for(let O=0;O<r;O++){const N=uO(L,O);f[v*r+O]=N.real,p[v*r+O]=N.imag}t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(S),t.disposeIntermediateTensorInfo(C)}const g=t.makeTensorInfo(c,"float32",f),y=t.makeTensorInfo(c,"float32",p),x=pr({inputs:{real:g,imag:y},backend:t});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),x}function Nxe(n,e,t){const s=ye(n.shape),i=t.data.get(n.dataId),r=t.data.get(i.complexTensorInfos.real.dataId).values,o=t.data.get(i.complexTensorInfos.imag.dataId).values;if(Axe(s)){const a=UR(r,o,s,e,t),l=[n.shape[0],n.shape[1]];if(e){const c=t.makeTensorInfo(l,"float32",a.real),h=t.makeTensorInfo(l,"float32",a.imag),f=t.makeTensorInfo([],"float32",mc(s,"float32")),p=tl({inputs:{x:f},backend:t}),g=BR.kernelFunc({inputs:{a:c,b:f},backend:t}),y=BR.kernelFunc({inputs:{a:h,b:p},backend:t}),x=t.data.get(g.dataId).values,v=t.data.get(y.dataId).values;return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),{real:x,imag:v}}return a}else{const a=ic(r,o),l=Rxe(a,s,e);return dG(l)}}function Axe(n){return(n&n-1)===0}function UR(n,e,t,s,i){if(t===1)return{real:n,imag:e};const r=ic(n,e),o=t/2,a=fG(r),l=a.real,c=a.imag,h=[l.length],f=i.makeTensorInfo(h,"float32",l),p=i.makeTensorInfo(h,"float32",c),g=pr({inputs:{real:f,imag:p},backend:i}),y=pG(r),x=y.real,v=y.imag,w=[x.length],S=i.makeTensorInfo(w,"float32",x),C=i.makeTensorInfo(w,"float32",v),I=pr({inputs:{real:S,imag:C},backend:i}),A=UR(l,c,o,s,i),L=A.real,O=A.imag,N=[L.length],k=i.makeTensorInfo(N,"float32",L),$=i.makeTensorInfo(N,"float32",O),R=pr({inputs:{real:k,imag:$},backend:i}),z=UR(x,v,o,s,i),V=z.real,ne=z.imag,Q=[V.length],G=i.makeTensorInfo(Q,"float32",V),J=i.makeTensorInfo(Q,"float32",ne),Z=pr({inputs:{real:G,imag:J},backend:i}),le=gG(t,s),H=[le.real.length],ee=i.makeTensorInfo(H,"float32",le.real),he=i.makeTensorInfo(H,"float32",le.imag),ae=pr({inputs:{real:ee,imag:he},backend:i}),pe=VC({inputs:{a:ae,b:Z},backend:i}),_e=im({inputs:{a:R,b:pe},backend:i}),Ee=GO({inputs:{a:R,b:pe},backend:i}),Le=Gd({inputs:{input:_e},backend:i}),$e=Gd({inputs:{input:Ee},backend:i}),Me=rm({inputs:{input:_e},backend:i}),ze=rm({inputs:{input:Ee},backend:i}),Ze=om({inputs:[Le,$e],backend:i,attrs:{axis:0}}),yt=om({inputs:[Me,ze],backend:i,attrs:{axis:0}}),bt=i.data.get(Ze.dataId).values,Wt=i.data.get(yt.dataId).values;return i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(g),i.disposeIntermediateTensorInfo(S),i.disposeIntermediateTensorInfo(C),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(k),i.disposeIntermediateTensorInfo($),i.disposeIntermediateTensorInfo(R),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(J),i.disposeIntermediateTensorInfo(Z),i.disposeIntermediateTensorInfo(ee),i.disposeIntermediateTensorInfo(he),i.disposeIntermediateTensorInfo(ae),i.disposeIntermediateTensorInfo(pe),i.disposeIntermediateTensorInfo(_e),i.disposeIntermediateTensorInfo(Ee),i.disposeIntermediateTensorInfo(Le),i.disposeIntermediateTensorInfo(Me),i.disposeIntermediateTensorInfo($e),i.disposeIntermediateTensorInfo(ze),i.disposeIntermediateTensorInfo(Ze),i.disposeIntermediateTensorInfo(yt),{real:bt,imag:Wt}}function Rxe(n,e,t){const s=new Float32Array(e*2);for(let i=0;i<e;i++){let r=0,o=0;for(let a=0;a<e;a++){const l=yG(i*a,e,t),c=uO(n,a);r+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}t&&(r/=e,o/=e),mG(s,r,o,i)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dxe(n){const{inputs:e,backend:t}=n,{input:s}=e,i=ye(s.shape),r=s.shape[s.shape.length-1],o=i/r,a=yn({inputs:{x:s},backend:t,attrs:{shape:[o,r]}}),l=s7(a,!1,t),c=yn({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),c}const $xe={kernelName:JS,backendName:"cpu",kernelFunc:Dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XO(n){const{backend:e,attrs:t}=n,{shape:s,value:i,dtype:r}=t,o=r||lf(i),a=Vn(o,ye(s));return Pxe(a,i,o),e.makeTensorInfo(s,o,a)}const Oxe={kernelName:eE,backendName:"cpu",kernelFunc:XO};function Pxe(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lxe={kernelName:tE,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,i=t,r=$s(s.dtype,ye(s.shape)),[o,a,l,c]=s.shape,h=i.data.get(s.dataId).values;for(let p=0;p<o;p++){const g=p*l*a*c;for(let y=0;y<a;y++){const x=y*(l*c);for(let v=0;v<l;v++){const w=v*c;for(let S=0;S<c;S++){const C=Math.round(l-v-1),I=g+x+w+S;let A=h[I];if(C>=0&&C<l){const L=C*c,O=g+x+L+S;A=h[O]}r[I]=A}}}}return{dataId:i.write(r,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mxe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p,activation:g,leakyreluAlpha:y}=s;let x=t7({inputs:{x:i,filter:r},backend:t,attrs:{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p}});if(o){const v=x;if(h==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const w=yn({inputs:{x:o},backend:t,attrs:{shape:[o.shape[0],1,1]}});x=im({inputs:{a:x,b:w},backend:t}),t.disposeIntermediateTensorInfo(w)}else x=im({inputs:{a:x,b:o},backend:t});t.disposeIntermediateTensorInfo(v)}if(g){const v=x;if(h==="NCHW"&&g==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const w=yn({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});x=CT(t,x,g,w,y),t.disposeIntermediateTensorInfo(w)}else x=CT(t,x,g,a,y);t.disposeIntermediateTensorInfo(v)}return x}const Fxe={kernelName:u0,backendName:"cpu",kernelFunc:Mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vxe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p,activation:g,leakyreluAlpha:y}=s;let x=n7({inputs:{x:i,filter:r},backend:t,attrs:{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p}});if(o){const v=x;x=im({inputs:{a:x,b:o},backend:t}),t.disposeIntermediateTensorInfo(v)}if(g){const v=x;x=CT(t,x,g,a,y),t.disposeIntermediateTensorInfo(v)}return x}const zxe={kernelName:h0,backendName:"cpu",kernelFunc:Vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bxe(n){const{inputs:e,backend:t}=n,{params:s,indices:i}=e,r=ye(s.shape),o=i.shape,a=o[o.length-1],[l,c,h,f]=TC(s,i);if(c===0)return t.makeTensorInfo(l,s.dtype,[]);const p=t.data.get(i.dataId).values,g=t.bufferSync(s),y=f8(p,g,s.dtype,c,a,h,f,s.shape,r);return t.makeTensorInfo(l,s.dtype,y.values)}const Uxe={kernelName:nE,backendName:"cpu",kernelFunc:Bxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wxe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,indices:r}=e,{axis:o,batchDims:a}=s;He([i,r],"gatherV2");const l=gt(o,i.shape)[0],c=t.data.get(r.dataId).values,h=i.shape[l];for(let I=0;I<c.length;++I){const A=c[I];B(A<=h-1&&A>=0,()=>`GatherV2: the index value ${A} is not in [0, ${h-1}]`)}let f=a;a==null&&(f=0);const p=ye(r.shape),g=yO(i,r,l,f),y=yn({inputs:{x:i},backend:t,attrs:{shape:[g.batchSize,g.outerSize,g.dimSize,g.sliceSize]}}),x=yn({inputs:{x:r},backend:t,attrs:{shape:[g.batchSize,p/g.batchSize]}}),v=[g.batchSize,g.outerSize,p/g.batchSize,g.sliceSize],w=t.bufferSync(x),S=t.bufferSync(y),C=p8(S,w,v);return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(x),t.makeTensorInfo(g.outputShape,C.dtype,C.values)}const Hxe={kernelName:Tv,backendName:"cpu",kernelFunc:Wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jxe(n){const{inputs:e,backend:t}=n,{input:s}=e,i=ye(s.shape),r=s.shape[s.shape.length-1],o=i/r,a=yn({inputs:{x:s},backend:t,attrs:{shape:[o,r]}}),l=s7(a,!0,t),c=yn({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),c}const Gxe={kernelName:sE,backendName:"cpu",kernelFunc:jxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qxe=tn(Xm,n=>Number.isFinite(n)?1:0,"bool"),Kxe={kernelName:Xm,backendName:"cpu",kernelFunc:qxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xxe=tn(Ym,n=>Math.abs(n)===1/0?1:0,"bool"),Yxe={kernelName:Ym,backendName:"cpu",kernelFunc:Xxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qxe=tn(Qm,n=>Number.isNaN(n)?1:0,"bool"),Zxe={kernelName:Qm,backendName:"cpu",kernelFunc:Qxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jxe(n){const{backend:e,attrs:t}=n,{start:s,stop:i,num:r}=t,o=v8(s,i,r);return e.makeTensorInfo([o.length],"float32",o)}const ewe={kernelName:rE,backendName:"cpu",kernelFunc:Jxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const twe=tn(Jm,n=>Math.log1p(n)),nwe={kernelName:Jm,backendName:"cpu",kernelFunc:twe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const swe=Jn((n,e)=>n&&e),iwe=ws(kv,swe,null,"bool"),rwe={kernelName:kv,backendName:"cpu",kernelFunc:iwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const owe=tn(Nv,n=>n?0:1,"bool"),awe={kernelName:Nv,backendName:"cpu",kernelFunc:owe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lwe=Jn((n,e)=>n||e),cwe=ws(Av,lwe,null,"bool"),uwe={kernelName:Av,backendName:"cpu",kernelFunc:cwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hwe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{depthRadius:r,bias:o,alpha:a,beta:l}=s;He(i,"LRN");const c=i.shape[3],h=c-1,f=t.data.get(i.dataId).values,p=ye(i.shape),g=new Float32Array(p);function y(x){const v=x%c;let w=x-v+Math.max(0,v-r);const S=x-v+Math.min(v+r,h);let C=0;for(;w<=S;w++){const I=f[w];C+=I*I}return C}for(let x=0;x<p;x++){const v=y(x),w=f[x]*Math.pow(o+a*v,-l);g[x]=w}return t.makeTensorInfo(i.shape,i.dtype,g)}const dwe={kernelName:Rv,backendName:"cpu",kernelFunc:hwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fwe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,y:r,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:h}=s;He(o,"LRNGrad");const f=ye(o.shape),p=o.shape[3],g=t.data.get(o.dataId).values,y=t.data.get(i.dataId).values,x=t.data.get(r.dataId).values,v=new Float32Array(f),w=f;for(let S=0;S<w;S++){const C=S%p,I=S-C+Math.max(0,C-a),A=S-C+Math.min(p,C+a+1);let L=0;for(let O=I;O<A;O++)L+=Math.pow(y[O],2);L=c*L+l;for(let O=I;O<A;O++){let N=-2*c*h*y[O]*x[S]/L;S===O&&(N+=Math.pow(L,-h)),N*=g[S],v[O]+=N}}return t.makeTensorInfo(o.shape,i.dtype,v)}const pwe={kernelName:oE,backendName:"cpu",kernelFunc:fwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{reductionIndices:r,keepDims:o}=s,a=t;let l=i.shape;const c=l.length,h=gt(r,l);let f=h;const p=On(f,c);let g=a.data.get(i.dataId).values;if(p!=null){const I=new Array(c);for(let A=0;A<I.length;A++)I[A]=l[p[A]];g=HO(g,l,i.dtype,p,I),f=Qn(f.length,c),l=I}He(i,"max"),ti("max",f,c);const[y,x]=Ls(l,f),v=ye(x),w=w8(g,v,y,i.dtype),S=a.write(w,y,i.dtype);let C=y;return o&&(C=Xn(y,h)),{dataId:S,shape:C,dtype:i.dtype}}const mwe={kernelName:Dv,backendName:"cpu",kernelFunc:i7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gwe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e;He(i,"maxPool");const{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=s,c=1;B(ei(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=No(i.shape,r,o,c,a,l);let f;if(h.filterWidth===1&&h.filterHeight===1&&_t(h.inShape,h.outShape))f=tl({inputs:{x:i},backend:t});else{const p=t.data.get(i.dataId).values,g=Ye(i.shape),y=qO(p,i.shape,i.dtype,g,h,"max");f=t.makeTensorInfo(h.outShape,i.dtype,y.values)}return f}const ywe={kernelName:$v,backendName:"cpu",kernelFunc:gwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bwe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{filterSize:r,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s;He(i,"maxPool3d");const h=gc(i.shape,r,o,1,a,l,c),f=t.data.get(i.dataId).values,p=e7(f,i.shape,i.dtype,Ye(i.shape),h,"max");return t.makeTensorInfo(p.shape,"float32",p.values)}const vwe={kernelName:Ov,backendName:"cpu",kernelFunc:bwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xwe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,input:r}=e,{filterSize:o,strides:a,pad:l,dimRoundingMode:c}=s;He([i,r],"maxPool3DGrad");const h=gc(r.shape,o,a,1,l,c),f=t.bufferSync(r),p=lve(f,h),g=h.strideDepth,y=h.strideHeight,x=h.strideWidth,v=h.dilationDepth,w=h.dilationHeight,S=h.dilationWidth,C=h.effectiveFilterDepth,I=h.effectiveFilterHeight,A=h.effectiveFilterWidth,L=C-1-h.padInfo.front,O=A-1-h.padInfo.left,N=I-1-h.padInfo.top,k=ut(r.shape,"float32"),$=t.bufferSync(i);for(let R=0;R<h.batchSize;++R)for(let z=0;z<h.inChannels;++z)for(let V=0;V<h.inDepth;++V)for(let ne=0;ne<h.inHeight;++ne)for(let Q=0;Q<h.inWidth;++Q){const G=V-L,J=ne-N,Z=Q-O;let le=0;for(let H=0;H<C;H+=v){const ee=(G+H)/g;if(!(ee<0||ee>=h.outDepth||Math.floor(ee)!==ee))for(let he=0;he<I;he+=w){const ae=(J+he)/y;if(!(ae<0||ae>=h.outHeight||Math.floor(ae)!==ae))for(let pe=0;pe<A;pe+=S){const _e=(Z+pe)/x;if(_e<0||_e>=h.outWidth||Math.floor(_e)!==_e)continue;const Ee=C*I*A-1-p.get(R,ee,ae,_e,z),Le=H*I*A+he*A+pe,$e=Ee===Le?1:0;if($e===0)continue;const Me=$.get(R,ee,ae,_e,z);le+=Me*$e}}}k.set(le,R,V,ne,Q,z)}return t.makeTensorInfo(k.shape,k.dtype,k.values)}const wwe={kernelName:lE,backendName:"cpu",kernelFunc:xwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _we(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,input:r,output:o}=e,a=r;He([r,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:h,dimRoundingMode:f}=s,p=No(a.shape,l,c,1,h,f),g=t.data.get(a.dataId).values,y=ut(p.outShape,a.dtype,J8(g,a.shape,a.dtype,p).values),x=p.strideHeight,v=p.strideWidth,w=p.dilationHeight,S=p.dilationWidth,C=p.effectiveFilterHeight,I=p.effectiveFilterWidth,A=I-1-p.padInfo.left,L=C-1-p.padInfo.top,O=ut(a.shape,"float32"),N=t.data.get(i.dataId).values,k=ut(i.shape,"float32",N);for(let $=0;$<p.batchSize;++$)for(let R=0;R<p.inChannels;++R)for(let z=0;z<p.inHeight;++z)for(let V=0;V<p.inWidth;++V){const ne=z-L,Q=V-A;let G=0;for(let J=0;J<C;J+=w){const Z=(ne+J)/x;if(!(Z<0||Z>=p.outHeight||Math.floor(Z)!==Z))for(let le=0;le<I;le+=S){const H=(Q+le)/v;if(H<0||H>=p.outWidth||Math.floor(H)!==H)continue;const ee=C*I-1-y.get($,Z,H,R),he=J*I+le,ae=ee===he?1:0;if(ae===0)continue;const pe=k.get($,Z,H,R);G+=pe*ae}}O.set(G,$,z,V,R)}return t.makeTensorInfo(O.shape,O.dtype,O.values)}const Twe={kernelName:aE,backendName:"cpu",kernelFunc:_we};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Swe(n,e,t,s,i){const r=Ye(e),o=qO(n,e,t,r,i,"max"),a=J8(n,e,t,i,!0,s);return[o.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ewe={kernelName:cE,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:i,strides:r,pad:o,includeBatchInIndex:a}=e,l=t;He(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,h=No(s.shape,i,r,[1,1],o),[f,p]=Swe(c,s.shape,s.dtype,a,h),g=l.write(f,h.outShape,s.dtype),y=l.write(p,h.outShape,s.dtype);return[{dataId:g,shape:h.outShape,dtype:s.dtype},{dataId:y,shape:h.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cwe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s,a=gt(r,i.shape),c=Ls(i.shape,a)[1],h=ye(c),f=[],p=t.makeTensorInfo([],"float32",new Float32Array([h]));f.push(p);const g=Gu({inputs:{x:i},backend:t,attrs:{dtype:"float32"}});f.push(g);const y=KO({inputs:{a:g,b:p},backend:t});f.push(y);const x=Lx({inputs:{x:y},backend:t,attrs:{axis:r,keepDims:o}});return f.forEach(v=>t.disposeIntermediateTensorInfo(v)),x}const Iwe={kernelName:Pv,backendName:"cpu",kernelFunc:Cwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kwe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s;He(i,"min");const a=gt(r,i.shape);let l=a;const c=On(l,i.shape.length);let h=i;c!=null&&(h=ir({inputs:{x:i},backend:t,attrs:{perm:c}}),l=Qn(l.length,i.shape.length)),ti("min",l,h.shape.length);const[f,p]=Ls(h.shape,l),g=ye(p),y=Zs(ye(f),h.dtype),x=t.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const S=w*g;let C=x[S];for(let I=0;I<g;++I){const A=x[S+I];(Number.isNaN(A)||A<C)&&(C=A)}y[w]=C}c!=null&&t.disposeIntermediateTensorInfo(h);const v=t.makeTensorInfo(f,h.dtype,y);if(o){const w=Xn(f,a),S=yn({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),S}return v}const Nwe={kernelName:Lv,backendName:"cpu",kernelFunc:kwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Awe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{paddings:r,mode:o}=s;He(i,"mirrorPad");const a=r.map((C,I)=>C[0]+i.shape[I]+C[1]),l=r.map(C=>C[0]),c=r.map((C,I)=>C[0]+i.shape[I]),h=o==="reflect"?0:1,f=t.data.get(i.dataId).values,p=i.shape.length,g=Ye(i.shape),y=ye(a),x=a.length,v=Ye(a),w=$s(i.dtype,y);for(let C=0;C<y;C++){let I=cf(C,x,v);for(let L=0;L<x;L++)I[L]<l[L]?I[L]=l[L]*2-I[L]-h:I[L]>=c[L]&&(I[L]=(c[L]-1)*2-I[L]+h);I=I.map((L,O)=>L-l[O]);const A=Xo(I,p,g);w[C]=f[A]}return{dataId:t.write(w,a,i.dtype),shape:a,dtype:i.dtype}}const Rwe={kernelName:Mv,backendName:"cpu",kernelFunc:Awe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dwe=Jn((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e}),$we=ws(ng,Dwe),Owe={kernelName:ng,backendName:"cpu",kernelFunc:$we};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r7(n){const{inputs:e,backend:t,attrs:s}=n,{logits:i}=e,{dim:r}=s,o=i.shape.length;let a=r;if(a===-1&&(a=o-1),a!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${a}`);const l=gt([a],i.shape),c=i7({inputs:{x:i},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),h=Xn(c.shape,l),f=yn({inputs:{x:c},backend:t,attrs:{shape:h}}),p=GO({inputs:{a:i,b:f},backend:t}),g=c8({inputs:{x:p},backend:t}),y=Lx({inputs:{x:g},backend:t,attrs:{axis:l,keepDims:!1}}),x=yn({inputs:{x:y},backend:t,attrs:{shape:h}}),v=KO({inputs:{a:g,b:x},backend:t});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(x),v}const Pwe={kernelName:tx,backendName:"cpu",kernelFunc:r7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lwe(n){const{inputs:e,backend:t,attrs:s}=n,{logits:i}=e,{numSamples:r,seed:o,normalized:a}=s;He(i,"multinomial");const l=a?i:r7({inputs:{logits:i},backend:t,attrs:{dim:-1}}),c=l.shape[0],h=l.shape[1],f=t.data.get(l.dataId).values,p=[c,r],g=Zs(ye(p),"int32");for(let y=0;y<c;++y){const x=y*h,v=new Float32Array(h-1);v[0]=f[x];for(let C=1;C<v.length;++C)v[C]=v[C-1]+f[x+C];const w=ZE.alea(o.toString()),S=y*r;for(let C=0;C<r;++C){const I=w();g[S+C]=v.length;for(let A=0;A<v.length;A++)if(I<v[A]){g[S+C]=A;break}}}return a||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(p,"int32",g)}const Mwe={kernelName:uE,backendName:"cpu",kernelFunc:Lwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fwe=vC;function Vwe(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:i,scores:r}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s;He(i,"NonMaxSuppression");const c=t.data.get(i.dataId).values,h=t.data.get(r.dataId).values,{selectedIndices:f}=Fwe(c,h,o,a,l);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const zwe={kernelName:hE,backendName:"cpu",kernelFunc:Vwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bwe=xC;function Uwe(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:i,scores:r}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;He(i,"NonMaxSuppressionPadded");const h=t.data.get(i.dataId).values,f=t.data.get(r.dataId).values,{selectedIndices:p,validOutputs:g}=Bwe(h,f,o,a,l,c);return[t.makeTensorInfo([p.length],"int32",new Int32Array(p)),t.makeTensorInfo([],"int32",new Int32Array([g]))]}const Wwe={kernelName:dE,backendName:"cpu",kernelFunc:Uwe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hwe=wC;function jwe(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:i,scores:r}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;He(i,"NonMaxSuppressionWithScore");const h=t.data.get(i.dataId).values,f=t.data.get(r.dataId).values,p=o,g=a,y=l,x=c,{selectedIndices:v,selectedScores:w}=Hwe(h,f,p,g,y,x);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const Gwe={kernelName:fE,backendName:"cpu",kernelFunc:jwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qwe(n){const{inputs:e,backend:t,attrs:s}=n,{indices:i}=e,{dtype:r,depth:o,onValue:a,offValue:l}=s;He(i,"oneHot");const c=ye(i.shape),h=new Float32Array(c*o);h.fill(l);const f=t.data.get(i.dataId).values;for(let p=0;p<c;++p)f[p]>=0&&f[p]<o&&(h[p*o+f[p]]=a);return t.makeTensorInfo([...i.shape,o],r,h)}const Kwe={kernelName:Bv,backendName:"cpu",kernelFunc:qwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kT(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const i=Gd({inputs:{input:s},backend:t}),r=kT({inputs:{x:i},backend:t}),o=rm({inputs:{input:s},backend:t}),a=kT({inputs:{x:o},backend:t}),l=pr({inputs:{real:r,imag:a},backend:t});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return XO({backend:t,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const Xwe={kernelName:rx,backendName:"cpu",kernelFunc:kT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o7(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const i=Gd({inputs:{input:s},backend:t}),r=o7({inputs:{x:i},backend:t}),o=rm({inputs:{input:s},backend:t}),a=kT({inputs:{x:o},backend:t}),l=pr({inputs:{real:r,imag:a},backend:t});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return XO({backend:t,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const Ywe={kernelName:zv,backendName:"cpu",kernelFunc:o7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a7(n){const{inputs:e,backend:t,attrs:s}=n,{axis:i}=s;if(e.length===1)return IT({inputs:{input:e[0]},backend:t,attrs:{dim:i}});const r=e[0].shape,o=e[0].dtype;e.forEach(h=>{Js(r,h.shape,"All tensors passed to stack must have matching shapes"),B(o===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(h=>{const f=IT({inputs:{input:h},backend:t,attrs:{dim:i}});return a.push(f),f}),c=om({inputs:l,backend:t,attrs:{axis:i}});return a.forEach(h=>t.disposeIntermediateTensorInfo(h)),c}const Qwe={kernelName:Uv,backendName:"cpu",kernelFunc:a7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zwe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{paddings:r,constantValue:o}=s;He(i,"pad");const a=r.map((S,C)=>S[0]+i.shape[C]+S[1]),l=r.map(S=>S[0]),c=t.data.get(i.dataId).values,h=ye(i.shape),f=i.shape.length,p=Ye(i.shape),g=ye(a),y=a.length,x=Ye(a),v=$s(i.dtype,g);o!==0&&v.fill(o);for(let S=0;S<h;S++){const I=cf(S,f,p).map((L,O)=>L+l[O]),A=Xo(I,y,x);v[A]=c[S]}return{dataId:t.write(v,a,i.dtype),shape:a,dtype:i.dtype}}const l7={kernelName:Wv,backendName:"cpu",kernelFunc:Zwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jwe=Jn((n,e)=>Math.pow(n,e)),e_e=ws(ig,Jwe),t_e={kernelName:ig,backendName:"cpu",kernelFunc:e_e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_e(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:i,paramsDenseValues:r,indices:o}=e,{outputRaggedRank:a}=s,l=i.map(w=>t.data.get(w.dataId).values),c=i.map(w=>w.shape),h=t.data.get(r.dataId).values,f=t.data.get(o.dataId).values,[p,g,y]=I8(l,c,h,r.shape,r.dtype,f,o.shape),x=p.map(w=>t.makeTensorInfo([w.length],"int32",w)),v=t.makeTensorInfo(y,r.dtype,g);return x.concat([v])}const s_e={kernelName:pE,backendName:"cpu",kernelFunc:n_e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i_e(n){const{inputs:e,backend:t}=n,{starts:s,limits:i,deltas:r}=e,o=t.data.get(s.dataId).values,a=t.data.get(i.dataId).values,l=t.data.get(r.dataId).values,[c,h]=k8(o,s.shape,s.dtype,a,i.shape,l,r.shape),f=t.makeTensorInfo([c.length],"int32",c),p=t.makeTensorInfo([h.length],s.dtype,h);return[f,p]}const r_e={kernelName:mE,backendName:"cpu",kernelFunc:i_e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_e(n){const{inputs:e,backend:t,attrs:s}=n,{shape:i,values:r,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=t.data.get(i.dataId).values,h=t.data.get(r.dataId).values,f=t.data.get(o.dataId).values,p=a.map(v=>t.data.get(v.dataId).values),g=a.map(v=>v.shape),[y,x]=N8(c,i.shape,h,r.shape,r.dtype,f,o.shape,p,g,l);return t.makeTensorInfo(y,r.dtype,x)}const a_e={kernelName:gE,backendName:"cpu",kernelFunc:o_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l_e(n){const{backend:e,attrs:t}=n,{start:s,stop:i,dtype:r,step:o}=t,a=A8(s,i,o,r);return e.makeTensorInfo([a.length],r,a)}const c_e={kernelName:yE,backendName:"cpu",kernelFunc:l_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u_e=tn(rg,n=>1/n),h_e={kernelName:rg,backendName:"cpu",kernelFunc:u_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_e(n){const{inputs:e,backend:t,attrs:s}=n,{images:i}=e,{alignCorners:r,halfPixelCenters:o,size:a}=s;He(i,"resizeBilinear");const l=Ye(i.shape),[c,h]=a,[f,p,g,y]=i.shape,x=t.data.get(i.dataId).values,v=new Float32Array(ye([f,c,h,y])),w=[r&&c>1?p-1:p,r&&h>1?g-1:g],S=[r&&c>1?c-1:c,r&&h>1?h-1:h];let C=0;const I=w[0]/S[0],A=w[1]/S[1];for(let L=0;L<f;L++)for(let O=0;O<c;O++){let N;o?N=I*(O+.5)-.5:N=I*O;const k=Math.max(0,Math.floor(N)),$=N-k,R=Math.min(p-1,Math.ceil(N)),z=L*l[0]+k*l[1],V=L*l[0]+R*l[1];for(let ne=0;ne<h;ne++){let Q;o?Q=A*(ne+.5)-.5:Q=A*ne;const G=Math.max(0,Math.floor(Q)),J=Q-G,Z=Math.min(g-1,Math.ceil(Q)),le=z+G*l[2],H=V+G*l[2],ee=z+Z*l[2],he=V+Z*l[2];for(let ae=0;ae<y;ae++){const pe=x[le+ae],_e=x[H+ae],Ee=x[ee+ae],Le=x[he+ae],$e=pe+(Ee-pe)*J,Me=_e+(Le-_e)*J,ze=$e+(Me-$e)*$;v[C++]=ze}}}return t.makeTensorInfo([f,c,h,y],"float32",v)}const f_e={kernelName:Kv,backendName:"cpu",kernelFunc:d_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p_e(n){const{inputs:e,backend:t,attrs:s}=n,{images:i,dy:r}=e,{alignCorners:o}=s;He([r,i],"resizeBilinearGrad");const a=Ye(i.shape),[l,c,h,f]=i.shape,[,p,g]=r.shape,y=new Float32Array(l*c*h*f),x=[o&&p>1?c-1:c,o&&g>1?h-1:h],v=[o&&p>1?p-1:p,o&&g>1?g-1:g],w=x[0]/v[0],S=x[1]/v[1],C=t.data.get(r.dataId).values;let I=0;for(let A=0;A<l;A++){const L=A*a[0];for(let O=0;O<p;O++){const N=O*w,k=Math.floor(N),$=Math.min(Math.ceil(N),c-1),R=L+k*a[1],z=L+$*a[1],V=N-k,ne=1-V;for(let Q=0;Q<g;Q++){const G=Q*S,J=Math.floor(G),Z=Math.min(Math.ceil(G),h-1),le=G-J,H=1-le,ee=R+J*a[2],he=R+Z*a[2],ae=z+J*a[2],pe=z+Z*a[2],_e=ne*H,Ee=ne*le,Le=V*H,$e=V*le;for(let Me=0;Me<f;Me++){const ze=C[I++];y[ee+Me]+=ze*_e,y[he+Me]+=ze*Ee,y[ae+Me]+=ze*Le,y[pe+Me]+=ze*$e}}}}return t.makeTensorInfo([l,h,c,f],"float32",y)}const m_e={kernelName:xE,backendName:"cpu",kernelFunc:p_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_e(n){const{inputs:e,backend:t,attrs:s}=n,{images:i}=e,{alignCorners:r,halfPixelCenters:o,size:a}=s;He(i,"resizeNearestNeighbor");const l=Ye(i.shape),[c,h]=a,[f,p,g,y]=i.shape,x=t.data.get(i.dataId).values,v=new Float32Array(f*c*h*y),w=[r&&c>1?p-1:p,r&&h>1?g-1:g],S=[r&&c>1?c-1:c,r&&h>1?h-1:h],C=w[0]/S[0],I=w[1]/S[1];let A=0;for(let L=0;L<f;L++){const O=L*l[0];for(let N=0;N<c;N++){const k=o?C*(N+.5):C*N;let $=Math.min(p-1,r?Math.round(k):Math.floor(k));o&&($=Math.max(0,$));const R=O+$*l[1];for(let z=0;z<h;z++){const V=o?I*(z+.5):I*z;let ne=Math.min(g-1,r?Math.round(V):Math.floor(V));o&&(ne=Math.max(0,ne));const Q=R+ne*l[2];for(let G=0;G<y;G++){const J=x[Q+G];v[A++]=J}}}}return t.makeTensorInfo([f,c,h,y],i.dtype,v)}const y_e={kernelName:qv,backendName:"cpu",kernelFunc:g_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b_e(n){const{inputs:e,backend:t,attrs:s}=n,{images:i,dy:r}=e,{alignCorners:o}=s;He([r,i],"resizeNearestNeighborGrad");const a=Ye(i.shape),l=Ye(r.shape),[c,h,f,p]=i.shape,[,g,y]=r.shape,x=new Float32Array(c*h*f*p),v=t.data.get(r.dataId).values,w=[o&&g>1?h-1:h,o&&y>1?f-1:f],S=[o&&g>1?g-1:g,o&&y>1?y-1:y],C=w[0]/S[0],I=w[1]/S[1],A=1/C,L=1/I,O=Math.ceil(A)*2+2,N=Math.ceil(L)*2+2;for(let k=0;k<c;k++){const $=k*a[0];for(let R=0;R<h;R++){const z=$+R*a[1],V=Math.floor(R*A),ne=Math.floor(V-O/2);for(let Q=0;Q<f;Q++){const G=z+Q*a[2],J=Math.floor(Q*L),Z=Math.floor(J-N/2);for(let le=0;le<p;le++){let H=0;for(let ee=0;ee<O;ee++){const he=ee+ne;if(he<0||he>=g)continue;const ae=$+he*l[1],pe=he*C,_e=Math.min(h-1,o?Math.round(pe):Math.floor(pe));if(R===_e)for(let Ee=0;Ee<N;Ee++){const Le=Ee+Z;if(Le<0||Le>=y)continue;const $e=ae+Le*l[2],Me=Le*I,ze=Math.min(f-1,o?Math.round(Me):Math.floor(Me));Q===ze&&(H+=v[$e+le])}}x[G+le]=H}}}}return t.makeTensorInfo(i.shape,i.dtype,x)}const v_e={kernelName:vE,backendName:"cpu",kernelFunc:b_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x_e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{dims:r}=s;He(i,"reverse");const o=i.shape.length,a=gt(r,i.shape);if(o===0)return tl({inputs:{x:i},backend:t});const l=new as(i.shape,i.dtype),c=t.bufferSync(i);for(let h=0;h<l.size;h++){const f=l.indexToLoc(h),p=f.slice();a.forEach(g=>p[g]=i.shape[g]-1-p[g]),l.set(c.get(...p),...f)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const w_e={kernelName:Xv,backendName:"cpu",kernelFunc:x_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const __e={kernelName:ME,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:i,fillValue:r,center:o}=e,a=t,l=$s(s.dtype,ye(s.shape)),[c,h,f,p]=s.shape,[g,y]=tO(o,h,f),x=255,v=Math.sin(i),w=Math.cos(i),S=a.data.get(s.dataId).values;for(let I=0;I<c;I++){const A=I*f*h*p;for(let L=0;L<h;L++){const O=L*(f*p);for(let N=0;N<f;N++){const k=N*p;for(let $=0;$<p;$++){const R=[c,L,N,$],z=R[2],V=R[1];let ne=(z-g)*w-(V-y)*v,Q=(z-g)*v+(V-y)*w;ne=Math.round(ne+g),Q=Math.round(Q+y);let G=r;if(typeof r!="number"&&($===3?G=x:G=r[$]),ne>=0&&ne<f&&Q>=0&&Q<h){const Z=Q*(f*p),le=ne*p,H=A+Z+le+$;G=S[H]}const J=A+O+k+$;l[J]=G}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T_e=tn(lg,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),S_e={kernelName:lg,backendName:"cpu",kernelFunc:T_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_e(n){const{inputs:e,backend:t,attrs:s}=n,{indices:i,updates:r}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:h,outputSize:f}=uh(r,i,o),p=!0,g=t.bufferSync(i),y=t.bufferSync(r),x=gd(g,y,o,f,c,l,a,h,0,p);return t.makeTensorInfo(o,x.dtype,x.values)}const C_e={kernelName:wE,backendName:"cpu",kernelFunc:E_e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I_e(n,e){let t=0,s=n.length,i=0;for(;t<s;)i=Math.floor((t+s)/2),n[i]<e?t=i+1:s=i;return s}function k_e(n,e){let t=0,s=n.length,i=0;for(;t<s;)i=Math.floor((t+s)/2),n[i]<=e?t=i+1:s=i;return s}function N_e(n,e,t,s,i,r){const o=Vn("int32",t*i);for(let a=0;a<t;++a){const l=n.slice(a*s,(a+1)*s),c=a*i;for(let h=0;h<i;++h)o[c+h]=r==="left"?I_e(l,e[h+c]):k_e(l,e[h+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A_e(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:i,values:r}=e,{side:o}=s,a=t.data.get(i.dataId).values,l=t.data.get(r.dataId).values,c=N_e(a,l,i.shape[0],i.shape[1],r.shape[1],o);return t.makeTensorInfo(r.shape,"int32",c)}const R_e={kernelName:TE,backendName:"cpu",kernelFunc:A_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D_e(n){const{inputs:e,backend:t}=n,{condition:s,t:i,e:r}=e;He([s,i,r],"select");const o=s.shape.length,a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,c=t.data.get(r.dataId).values,h=Ji(i.dtype,r.dtype),f=Zs(ye(i.shape),h);let p=0;const g=o===0||o>1||i.shape.length===1?1:ye(i.shape.slice(1));for(let y=0;y<a.length;y++)for(let x=0;x<g;x++)a[y]===1?f[p++]=l[y]:f[p++]=c[y];return t.makeTensorInfo(i.shape,h,f)}const $_e={kernelName:Yv,backendName:"cpu",kernelFunc:D_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O_e=CC,P_e=IC,L_e=tn(ug,n=>n>=0?P_e*n:O_e*(Math.exp(n)-1)),M_e={kernelName:ug,backendName:"cpu",kernelFunc:L_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F_e=tn(fg,n=>n<0?-1:n>0?1:0),V_e={kernelName:fg,backendName:"cpu",kernelFunc:F_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z_e=tn(hg,n=>Math.sin(n)),B_e={kernelName:hg,backendName:"cpu",kernelFunc:z_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_e=tn(dg,n=>Math.sinh(n)),W_e={kernelName:dg,backendName:"cpu",kernelFunc:U_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H_e=11920928955078125e-23,iB=Math.log(H_e)+2,j_e=tn(mg,n=>{const e=n>-iB,t=n<iB,s=Math.exp(n);let i;return t?i=s:e?i=n:i=Math.log(1+s),i}),G_e={kernelName:mg,backendName:"cpu",kernelFunc:j_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q_e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{blockShape:r,paddings:o}=s;He([i],"spaceToBatchND");const a=ye(r),l=[[0,0]];l.push(...o);for(let L=1+r.length;L<i.shape.length;++L)l.push([0,0]);const c=l7.kernelFunc({inputs:{x:i},backend:t,attrs:{paddings:l,constantValue:0}}),h=Ex(c.shape,r,a,!1),f=Cx(h.length,r.length,!1),p=Ix(c.shape,r,a,!1),x=yn({inputs:{x:c},backend:t,attrs:{shape:h}}),S=ir({inputs:{x},backend:t,attrs:{perm:f}}),A=yn({inputs:{x:S},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(S),A}const K_e={kernelName:Jv,backendName:"cpu",kernelFunc:q_e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_e(n){const{inputs:e,backend:t}=n,{indices:s,values:i,denseShape:r,defaultValue:o}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,c=t.data.get(r.dataId).values,h=t.data.get(o.dataId).values[0],[f,p,g,y,x]=O8(a,s.shape,s.dtype,l,i.dtype,c,h);return[t.makeTensorInfo(p,s.dtype,f),t.makeTensorInfo([p[0]],i.dtype,g),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),t.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const Y_e={kernelName:SE,backendName:"cpu",kernelFunc:X_e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_e(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:i,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const o=Array.from(t.data.get(i.dataId).values),a=t.data.get(s.dataId).values,l=Array.from(t.data.get(r.dataId).values),[c,h,f]=P8(a,s.shape,s.dtype,o,l);return[t.makeTensorInfo(h,s.dtype,c),t.makeTensorInfo([f.length],r.dtype,new Int32Array(f))]}const Z_e={kernelName:EE,backendName:"cpu",kernelFunc:Q_e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_e(n){const{inputs:e,backend:t}=n,{data:s,indices:i,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${r.shape}`);if(i.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const o=t.data.get(s.dataId).values,a=t.data.get(i.dataId).values,l=t.data.get(r.dataId).values,[c,h]=jO(o,s.shape,s.dtype,a,l,!0);return t.makeTensorInfo(h,s.dtype,c)}const e1e={kernelName:CE,backendName:"cpu",kernelFunc:J_e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t1e(n){const{inputs:e,backend:t}=n,{data:s,indices:i,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${r.shape}`);if(i.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const o=t.data.get(s.dataId).values,a=t.data.get(i.dataId).values,l=t.data.get(r.dataId).values,[c,h]=jO(o,s.shape,s.dtype,a,l);return t.makeTensorInfo(h,s.dtype,c)}const n1e={kernelName:IE,backendName:"cpu",kernelFunc:t1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s1e(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:i,sparseValues:r,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:h,strides:f,outputSize:p}=uh(r,i,a),g=!1,y=t.bufferSync(i);let x;switch(r.dtype){case"bool":{const v=t.bufferSync(r),w=!!t.data.get(o.dataId).values[0];x=gd(y,v,a,p,h,c,l,f,w,g);break}case"float32":{const v=t.bufferSync(r),w=t.data.get(o.dataId).values[0];x=gd(y,v,a,p,h,c,l,f,w,g);break}case"int32":{const v=t.bufferSync(r),w=t.data.get(o.dataId).values[0];x=gd(y,v,a,p,h,c,l,f,w,g);break}case"string":{const v=t.bufferSync(r),w=tc(t.data.get(o.dataId).values[0]);x=gd(y,v,a,p,h,c,l,f,w,g);break}default:throw new Error(`Unsupported type ${r.dtype}`)}return t.makeTensorInfo(a,x.dtype,x.values)}const i1e={kernelName:kE,backendName:"cpu",kernelFunc:s1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r1e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{numOrSizeSplits:r,axis:o}=s,a=gt(o,i.shape)[0],l=gO(i,r,a),c=new Array(i.shape.length).fill(0),h=i.shape.slice();return l.map(f=>{const p=[...h];p[a]=f;const g=qd({inputs:{x:i},backend:t,attrs:{begin:c,size:p}});return c[a]+=f,g})}const o1e={kernelName:ex,backendName:"cpu",kernelFunc:r1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a1e={kernelName:NE,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,s=e;He(t,"square");const i=s.data.get(t.dataId).values,r=new Float32Array(i.length);for(let a=0;a<i.length;++a){const l=i[a];r[a]=l*l}return{dataId:s.write(r,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l1e=tn(_g,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),c1e={kernelName:_g,backendName:"cpu",kernelFunc:l1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{begin:r,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:h,newAxisMask:f,shrinkAxisMask:p}=s;He(i,"stridedSlice");const{finalShapeSparse:g,finalShape:y,isIdentity:x,sliceDim0:v,isSimpleSlice:w,begin:S,end:C,strides:I}=Q$(i.shape,r,o,a,l,c,h,f,p);let A;if(x)A=yn({inputs:{x:i},backend:t,attrs:{shape:y}});else if(v||w){B(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const L=K$(S,C,I),O=qd({inputs:{x:i},backend:t,attrs:{begin:S,size:L}});A=yn({inputs:{x:O},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(O)}else{const L=t.bufferSync(i),O=F8(g,L,I,S);A=t.makeTensorInfo(y,O.dtype,O.values)}return A}const h1e={kernelName:AE,backendName:"cpu",kernelFunc:u1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d1e(n){const{inputs:e,backend:t,attrs:s}=n,{separator:i,nGramWidths:r,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:h,dataSplits:f}=e,p=t.data.get(h.dataId).values,g=t.data.get(f.dataId).values,[y,x]=V8(p,g,i,r,o,a,l,c);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(f.shape,"int32",x)]}const f1e={kernelName:RE,backendName:"cpu",kernelFunc:d1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p1e(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:i}=s,{input:r,delimiter:o}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values[0],[c,h,f]=z8(a,l,i),p=h.length;return[t.makeTensorInfo([p,2],"int32",c),t.makeTensorInfo([p],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const m1e={kernelName:DE,backendName:"cpu",kernelFunc:p1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1e(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:i}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=t.data.get(r.dataId).values,a=B8(o,i);return t.makeTensorInfo(r.shape,"int32",a)}const y1e={kernelName:$E,backendName:"cpu",kernelFunc:g1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b1e=tn(vg,n=>Math.tan(n)),v1e={kernelName:vg,backendName:"cpu",kernelFunc:b1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x1e=tn(xg,n=>Math.tanh(n)),w1e={kernelName:xg,backendName:"cpu",kernelFunc:x1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1e(n){const{inputs:e,backend:t}=n,{tensor:s,indices:i,updates:r}=e,{sliceRank:o,numUpdates:a,sliceSize:l,strides:c,outputSize:h}=uh(r,i,s.shape),f=!1,p=t.bufferSync(i),g=t.bufferSync(r),y=t.bufferSync(s),x=gd(p,g,s.shape,h,l,a,o,c,y,f);return t.makeTensorInfo(s.shape,x.dtype,x.values)}const T1e={kernelName:_E,backendName:"cpu",kernelFunc:_1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S1e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{reps:r}=s;He(i,"tile");const o=W8(t.bufferSync(i),r);return t.makeTensorInfo(o.shape,o.dtype,o.values)}const E1e={kernelName:wg,backendName:"cpu",kernelFunc:S1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{k:r,sorted:o}=s;He(i,"topk");const a=t.data.get(i.dataId).values,[l,c]=j8(a,i.shape,i.dtype,r,o);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(c.shape,c.dtype,c.values)]}const I1e={kernelName:OE,backendName:"cpu",kernelFunc:C1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(n){const{inputs:e,attrs:t,backend:s}=n,{image:i,transforms:r}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=t,[h,f,p,g]=i.shape,[y,x]=c??[f,p],v=[h,y,x,g],w=Ye(i.shape),S=w[0],C=w[1],I=w[2],A=Ye(v),L=A[0],O=A[1],N=A[2],k=$s(i.dtype,ye(v));k.fill(l);const $=s.data.get(i.dataId).values,R=s.data.get(r.dataId).values;for(let V=0;V<h;++V){const ne=r.shape[0]===1?R:R.subarray(V*8,V*8+8);for(let Q=0;Q<y;++Q)for(let G=0;G<x;++G)for(let J=0;J<g;++J){let Z;const le=ne[6]*G+ne[7]*Q+1;if(le===0)continue;const H=(ne[0]*G+ne[1]*Q+ne[2])/le,ee=(ne[3]*G+ne[4]*Q+ne[5])/le,he=rB(H,p,a),ae=rB(ee,f,a);switch(o){case"nearest":Z=O1e($,f,p,S,C,I,V,ae,he,J,l);break;case"bilinear":Z=P1e($,f,p,S,C,I,V,ae,he,J,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const pe=V*L+Q*O+G*N+J;k[pe]=Z}return s.makeTensorInfo(v,i.dtype,k)}return{dataId:s.write(k,v,i.dtype),shape:i.shape,dtype:i.dtype}}const N1e={kernelName:PE,backendName:"cpu",kernelFunc:k1e};function rB(n,e,t){switch(t){case"reflect":return A1e(n,e);case"wrap":return R1e(n,e);case"nearest":return $1e(n,e);case"constant":default:return D1e(n)}}function A1e(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=2*e;t<s&&(t=s*Math.trunc(-t/s)+t),t=t<-e?t+s:-t-1}else if(t>e-1)if(e<=1)t=0;else{const s=2*e;t-=s*Math.trunc(t/s),t>=e&&(t=s-t-1)}return Pu(0,t,e-1)}function R1e(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=e-1;t+=e*(Math.trunc(-t/s)+1)}else if(t>e-1)if(e<=1)t=0;else{const s=e-1;t-=e*Math.trunc(t/s)}return Pu(0,t,e-1)}function D1e(n,e){return n}function $1e(n,e){return Pu(0,n,e-1)}function Nb(n,e,t,s,i,r,o,a,l,c,h){const f=o*s+a*i+l*r+c;return 0<=a&&a<e&&0<=l&&l<t?n[f]:h}function O1e(n,e,t,s,i,r,o,a,l,c,h){const f=Math.round(a),p=Math.round(l);return Nb(n,e,t,s,i,r,o,f,p,c,h)}function P1e(n,e,t,s,i,r,o,a,l,c,h){const f=Math.floor(a),p=Math.floor(l),g=f+1,y=p+1,x=(y-l)*Nb(n,e,t,s,i,r,o,f,p,c,h)+(l-p)*Nb(n,e,t,s,i,r,o,f,y,c,h),v=(y-l)*Nb(n,e,t,s,i,r,o,g,p,c,h)+(l-p)*Nb(n,e,t,s,i,r,o,g,y,c,h);return(g-a)*x+(a-f)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L1e(n){const{inputs:e,attrs:t,backend:s}=n,{axis:i}=t,{x:r}=e;He(r,"unique");const o=s.data.get(r.dataId).values,{outputValues:a,outputShape:l,indices:c}=G8(o,i,r.shape,r.dtype);return[s.makeTensorInfo(l,r.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const M1e={kernelName:LE,backendName:"cpu",kernelFunc:L1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(n){const{inputs:e,backend:t,attrs:s}=n,{value:i}=e;let{axis:r}=s;r<0&&(r+=i.shape.length);const o=i.shape.length,a=i.shape[r],l=new Array(o-1);let c=0;for(let g=0;g<o;g++)g!==r&&(l[c++]=i.shape[g]);const h=new Array(o).fill(0),f=i.shape.slice();f[r]=1;const p=new Array(a);for(let g=0;g<p.length;g++){h[r]=g;const y=qd({inputs:{x:i},backend:t,attrs:{begin:h,size:f}});p[g]=yn({inputs:{x:y},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(y)}return p}const V1e={kernelName:sx,backendName:"cpu",kernelFunc:F1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z1e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,segmentIds:r}=e,{numSegments:o}=s;He(i,"unsortedSegmentSum");const a=i.shape.length,l=r.shape.length,c=[],h=[],f=a-l;let p=r;for(let y=0;y<f;++y){const x=IT({inputs:{input:p},backend:t,attrs:{dim:y+1}});p=x,h.push(x)}for(let y=0;y<o;++y){const x=mc(y,"int32"),v=t.makeTensorInfo([],"int32",x),w=a8({inputs:{a:v,b:p},backend:t}),S=Gu({inputs:{x:w},backend:t,attrs:{dtype:"float32"}}),C=VC({inputs:{a:S,b:i},backend:t}),I=Lx({inputs:{x:C},backend:t,attrs:{axis:0,keepDims:!1}});c.push(I),h.push(v),h.push(w),h.push(S),h.push(C),h.push(I)}const g=a7({inputs:c,backend:t,attrs:{axis:0}});return h.forEach(y=>t.disposeIntermediateTensorInfo(y)),g}const B1e={kernelName:ix,backendName:"cpu",kernelFunc:z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U1e=[L0e,gbe,F0e,z0e,_be,U0e,H0e,G0e,K0e,Y0e,Z0e,eve,nve,rve,ave,uve,dve,pve,gve,O0e,bve,xve,_ve,Sbe,Sve,xbe,Cbe,Cve,ybe,kve,Ave,Rve,$ve,Pve,Mve,Vve,Bve,Wve,jve,qve,Xve,Qve,Jve,txe,nxe,ixe,oxe,lxe,cxe,uxe,hxe,fxe,gxe,I0e,bxe,Ibe,Cxe,kbe,Ixe,Abe,$xe,Oxe,Lxe,Dbe,Obe,Fxe,zxe,Uxe,Hxe,Lbe,Fbe,bbe,Gxe,Nve,Kxe,Yxe,Zxe,k0e,zbe,Ube,ewe,Hbe,nwe,rwe,awe,uwe,dwe,pwe,mwe,Gbe,ywe,vwe,wwe,Twe,Ewe,Iwe,Nwe,Kbe,Rwe,Owe,Mwe,Ybe,Zbe,zwe,Wwe,Gwe,e0e,Kwe,Ywe,Qwe,l7,t_e,A0e,s0e,s_e,r_e,a_e,c_e,vbe,BR,h_e,R0e,D0e,$0e,f_e,m_e,y_e,v_e,w_e,__e,S_e,h0e,C_e,R_e,$_e,M_e,f0e,V_e,B_e,W_e,p0e,Pwe,G_e,K_e,Y_e,Z_e,e1e,n1e,i1e,o1e,y0e,a1e,v0e,w0e,c1e,h1e,f1e,m1e,y1e,E0e,pxe,v1e,w1e,T1e,E1e,I1e,N1e,t0e,M1e,V1e,B1e,Xwe];for(const n of U1e)FE(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pd={},F_={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function W1e(n,e){pd[n]=e}function sa(n,e){if(!(n in pd)||e!=null){const s=j1e(n,e);if(s!==null)pd[n]=s;else return console.log("Could not get context for WebGL version",n),null}const t=pd[n];return t==null||t.isContextLost()?(delete pd[n],sa(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),pd[n])}function H1e(n){if(!de().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function j1e(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??H1e(n);return t.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete pd[n]},!1),de().getBool("SOFTWARE_WEBGL_ENABLED")&&(F_.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",F_)||t.getContext("experimental-webgl",F_):t.getContext("webgl2",F_)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var S0;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(S0||(S0={}));var Pr;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(Pr||(Pr={}));var Xs;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Xs||(Xs={}));function Mx(n,e){return[e,n]}function G1e(n,e){return n*e}function V_(n){const e=ye(n),t=Math.ceil(e/4);return sT(t)}function Dg(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function q1e(n,e){const[t,s]=Dg(n,e);return t*s*4}function YO(n,e){const t=n;let s,i,r,o,a,l,c,h,f,p;return de().getNumber("WEBGL_VERSION")===2?(s=t.R32F,i=t.R16F,r=t.RGBA16F,o=t.RGBA32F,a=t.RED,c=4,h=1,f=t.HALF_FLOAT,p=t.FLOAT,l=t.RGBA8):(s=n.RGBA,i=n.RGBA,r=n.RGBA,o=t.RGBA,a=n.RGBA,c=4,h=4,f=e!=null?e.HALF_FLOAT_OES:null,p=n.FLOAT,l=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:h,textureTypeHalfFloat:f,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ve(n,e){const t=e();return de().getBool("DEBUG")&&K1e(n),t}function K1e(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+Z1e(n,e))}const X1e=596e-10,Y1e=65504;function Q1e(n){return!!(de().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||X1e<Math.abs(n)&&Math.abs(n)<Y1e)}function Z1e(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function z_(n,e){return Tc(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function J1e(n,e){const t=Tc(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ve(n,()=>n.shaderSource(t,e)),Ve(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function eTe(n,e){const t=Tc(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ve(n,()=>n.shaderSource(t,e)),Ve(n,()=>n.compileShader(t)),de().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw c7(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const tTe=/ERROR: [0-9]+:([0-9]+):/g;function c7(n,e){const t=tTe.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const s=+t[1],i=n.split(`
`),r=i.length.toString().length+2,o=i.map((f,p)=>Sd((p+1).toString(),r)+f);let a=0;for(let f=0;f<o.length;f++)a=Math.max(o[f].length,a);const l=o.slice(0,s-1),c=o.slice(s-1,s),h=o.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Sd(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join(`
`))}function nTe(n){return Tc(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function sTe(n,e){if(Ve(n,()=>n.linkProgram(e)),!de().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function YN(n,e){if(Ve(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function iTe(n,e){const t=Tc(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ve(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),Ve(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function rTe(n,e){const t=Tc(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ve(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),Ve(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function oTe(n){return Tc(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function aTe(n,e){const t=de().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const s=`[${n}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>t||e>t){const s=`[${n}x${e}]`,i=`[${t}x${t}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+i+".")}}function lTe(n){return Tc(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function oB(n,e,t,s,i,r,o){const a=n.getAttribLocation(e,t);return a===-1?!1:(Ve(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),Ve(n,()=>n.vertexAttribPointer(a,i,n.FLOAT,!1,r,o)),Ve(n,()=>n.enableVertexAttribArray(a)),!0)}function cTe(n,e,t){pTe(n,t),Ve(n,()=>n.activeTexture(n.TEXTURE0+t)),Ve(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function uTe(n,e,t){return Tc(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function hTe(n,e,t){return n.getUniformLocation(e,t)}function dTe(n,e,t,s){Ve(n,()=>cTe(n,e,s)),Ve(n,()=>n.uniform1i(t,s))}function QN(n,e,t){Ve(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),Ve(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function aB(n,e){Ve(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),Ve(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function B_(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+fTe(n,e))}function fTe(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Tc(n,e,t){const s=Ve(n,()=>e());if(s==null)throw new Error(t);return s}function pTe(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+n.TEXTURE0;if(s<n.TEXTURE0||s>t){const i=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${i}.`)}}function am(n,e=2){return ye(n.slice(0,n.length-e))}function lm(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function U_(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[am(n),...lm(n)]),e}function mTe(n,e=!1){let t=de().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=de().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&de().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=t/2),e&&(t=t*2,s=s*2,n=n.map((a,l)=>l>=n.length-2?RS(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=pc(n).newShape);let i=ye(n),r=null;n.length<=1&&i<=t?r=[1,i]:n.length===2&&n[0]<=t&&n[1]<=t?r=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?r=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?r=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?r=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(r=[n[0],n[1]*n[2]*n[3]]);const o=r!=null&&Math.max(...r)>s&&Math.min(...r)<=(e?2:1)&&Math.min(...r)>0;if(r==null||o)if(e){const a=am(n);let l=2,c=2;n.length&&([l,c]=lm(n)),i=a*(l/2)*(c/2),r=sT(i).map(h=>h*2)}else r=sT(i);return r}function W_(n){return n%2===0}function NT(n,e){if(n=n.slice(-2),e=e.slice(-2),_t(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],s=e[e.length-1];if(t===s||W_(t)&&W_(s)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&W_(n[0])&&W_(e[0])}let ZN,JN;function gTe(n){if(ZN==null){const e=sa(n);ZN=e.getParameter(e.MAX_TEXTURE_SIZE)}return ZN}function yTe(n){if(JN==null){const e=sa(n);JN=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,JN)}function bTe(n){if(n===0)return 0;let e;const t=sa(n);return vo(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:vo(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function vo(n,e){return n.getExtension(e)!=null}function lB(n){try{if(sa(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function vTe(n){if(n===0)return!1;const e=sa(n);if(n===1){if(!vo(e,"OES_texture_float"))return!1}else if(!vo(e,"EXT_color_buffer_float"))return!1;return WR(e)}function xTe(n){if(n===0)return!1;const e=sa(n);if(n===1){if(!vo(e,"OES_texture_float")||!vo(e,"WEBGL_color_buffer_float"))return!1}else{if(vo(e,"EXT_color_buffer_float"))return WR(e);const s="EXT_color_buffer_half_float";if(vo(e,s)){const i=e.getExtension(s);return wTe(e,i)}return!1}return WR(e)}function WR(n){const e=YO(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(r),o}function wTe(n,e){const t=YO(n,e),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(o),a}function _Te(n){return n!==2?!1:sa(n).fenceSync!=null}function Fx(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&B(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ge=de();Ge.registerFlag("HAS_WEBGL",()=>Ge.getNumber("WEBGL_VERSION")>0);Ge.registerFlag("WEBGL_VERSION",()=>lB(2)?2:lB(1)?1:0);Ge.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ge.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ge.get("WEBGL_VERSION")===2);Ge.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ge.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ge.registerFlag("WEBGL_PACK",()=>Ge.getBool("HAS_WEBGL"));Ge.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_PACK_CLIP",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_PACK_REDUCE",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_CONV_IM2COL",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ge.getBool("WEBGL_PACK"));Ge.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>gTe(Ge.getNumber("WEBGL_VERSION")));Ge.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>yTe(Ge.getNumber("WEBGL_VERSION")));Ge.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Ge.getNumber("WEBGL_VERSION");return n===0?0:bTe(n)});Ge.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ge.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!CD());Ge.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>vTe(Ge.getNumber("WEBGL_VERSION")));Ge.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ge.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ge.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ge.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>xTe(Ge.getNumber("WEBGL_VERSION")));Ge.registerFlag("WEBGL_FENCE_API_ENABLED",()=>_Te(Ge.getNumber("WEBGL_VERSION")));Ge.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ge.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ge.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Ge.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>CD()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Ge.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ge.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ge.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ge.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ge.registerFlag("WEBGL_EXP_CONV",()=>!1);Ge.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ge.getBool("IS_TEST"));Ge.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ge.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ge.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ge.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zi(){let n,e,t,s,i,r,o,a,l,c;return de().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",s="in",i="texture",r="outputColor",o="out vec4 outputColor;",a=de().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",s="varying",i="texture2D",r="gl_FragColor",o="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:s,texture2D:i,output:r,defineOutput:o,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yf(n,e,t="index"){const s=Ye(e);return s.map((i,r)=>{const o=`int ${n[r]} = ${t} / ${i}`,a=r===s.length-1?`int ${n[r+1]} = ${t} - ${n[r]} * ${i}`:`index -= ${n[r]} * ${i}`;return`${o}; ${a};`}).join("")}function zC(n,e,t="index"){const s=Ye(e);return s.map((i,r)=>{const o=`int ${n[r]} = ${t} / outShapeStrides[${r}]`,a=r===s.length-1?`int ${n[r+1]} = ${t} - ${n[r]} * outShapeStrides[${r}]`:`index -= ${n[r]} * outShapeStrides[${r}]`;return`${o}; ${a};`}).join("")}function TTe(n,e){const t=n.length,s=n.map(r=>`${e}[${r}]`),i=new Array(t-1);i[t-2]=s[t-1];for(let r=t-3;r>=0;--r)i[r]=`(${i[r+1]} * ${s[r+1]})`;return i}function STe(n,e,t="index"){const s=n.map((r,o)=>o),i=TTe(s,e);return i.map((r,o)=>{const a=`int ${n[o]} = ${t} / ${i[o]}`,l=o===i.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * ${i[o]}`:`index -= ${n[o]} * ${i[o]}`;return`${a}; ${l};`}).join("")}function QO(n){const e=Ye(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function ZO(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const u7=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:h7}=DG;function ETe(n,e,t){const s=[];if(n.forEach(g=>{const y=ye(g.shapeInfo.logicalShape);if(g.shapeInfo.isUniform?s.push(`uniform float ${g.name}${y>1?`[${y}]`:""};`):(s.push(`uniform sampler2D ${g.name};`),s.push(`uniform int offset${g.name};`)),t.enableShapeUniforms){const{uniformShape:x}=JO(t.packedInputs,g.shapeInfo.logicalShape,g.shapeInfo.texShape);switch(x.length){case 1:s.push(`uniform int ${g.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${g.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${g.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${g.name}Shape;`);break}s.push(`uniform ivec2 ${g.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(g=>{s.push(`uniform ${g.type} ${g.name}${g.arrayIndex?`[${g.arrayIndex}]`:""};`)});const i=s.join(`
`),r=n.map(g=>CTe(g,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),o=e.texShape,a=zi(),l=NTe(a);let c,h,f=DTe(a);return e.isPacked?(c=ITe(e.logicalShape,o,t.enableShapeUniforms),h=RTe(a)):(c=kTe(e.logicalShape,o,t.enableShapeUniforms),h=ATe(a)),t.packedInputs&&(f+=LTe),[f,l,h,i,c,r,t.userCode].join(`
`)}function $g(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return KTe(n,e);case 1:return YTe(n,e);case 2:return ZTe(n,e);case 3:return eSe(n,e);case 4:return nSe(n,e);case 5:return sSe(n);case 6:return iSe(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function d7(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return qTe(n);case 1:return XTe(n,e);case 2:return QTe(n,e);case 3:return JTe(n,e);default:return tSe(n,e)}}function CTe(n,e,t=!1,s){let i="";t?i+=d7(n,s):i+=$g(n,s);const r=n.shapeInfo.logicalShape,o=e.logicalShape;return r.length<=o.length&&(t?i+=rSe(n,e):i+=oSe(n,e)),i}function ITe(n,e,t){switch(n.length){case 0:return f7();case 1:return MTe(n,e,t);case 2:return jTe(n,e,t);case 3:return VTe(n,e,t);default:return BTe(n,e,t)}}function kTe(n,e,t){switch(n.length){case 0:return f7();case 1:return FTe(n,e,t);case 2:return GTe(n,e,t);case 3:return zTe(n,e,t);case 4:return UTe(n,e,t);case 5:return WTe(n,e);case 6:return HTe(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function NTe(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function ATe(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function RTe(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function DTe(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${$Te}
    ${OTe}
    ${PTe}
  `}const $Te=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,OTe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,PTe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,LTe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function f7(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function MTe(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function FTe(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function VTe(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(n[2]/2),r=i*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function zTe(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${zC(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=yf(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function BTe(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(n[n.length-1]/2),r=i*Math.ceil(n[n.length-2]/2);let o=r,a="",l="b, r, c";for(let c=2;c<n.length-1;c++)o*=n[n.length-c-1],a=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+a,l=`b${c}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${n.length}(${l});
    }
  `}function UTe(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${zC(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=yf(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function WTe(n,e){const t=yf(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function HTe(n,e){const t=yf(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function jTe(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(_t(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const i=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function GTe(n,e,t){return _t(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function bf(n){return`offset${n}`}function qTe(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),s=zi();return`
    vec4 ${t}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function KTe(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${t};}`;const[i,r]=n.shapeInfo.texShape;if(i===1&&r===1)return`
      float ${s}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=bf(t);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${o});
      return sampleTexture(${t}, uv);
    }
  `;const[a,l]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${o});
      return sampleTexture(${t}, uv);
    }
  `}function XTe(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),i=n.shapeInfo.texShape,r=zi();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${r.texture2D}(${t}, uv);
    }
  `;const o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${r.texture2D}(${t}, uv);
    }
  `}function YTe(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Og(n)}
      }
    `;const i=n.shapeInfo.texShape,r=i[0],o=i[1];if(o===1&&r===1)return`
      float ${s}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=bf(t);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${r}.0);
        return sampleTexture(${t}, uv);
      }
    `:r===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${a});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${r}, ${o}, index + ${a});
      return sampleTexture(${t}, uv);
    }
  `}function QTe(n,e){const t=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n.shapeInfo.texShape,o=r[0],a=r[1],l=zi();if(r!=null&&_t(t,r))return e?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],h=Math.ceil(t[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${h}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function ZTe(n,e){const t=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n.shapeInfo.texShape;if(r!=null&&_t(t,r)){if(e)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const p=r[0],g=r[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${g}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:a}=pc(t),l=o;if(l.length<t.length){const p=Pg(n,l),g=["row","col"];return`
      ${$g(p,e)}
      float ${i}(int row, int col) {
        return ${i}(${Lg(g,a)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${Og(n)}
      }
    `;const c=r[0],h=r[1],f=bf(s);return h===1?e?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${h}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${f};
    vec2 uv = uvFromFlat(${c}, ${h}, index);
    return sampleTexture(${s}, uv);
  }
`}function JTe(n,e){const t=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n.shapeInfo.texShape,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(t[0]===1){const p=t.slice(1),g=[1,2],y=Pg(n,p),x=["b","row","col"];return`
        ${d7(y,e)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${Lg(x,g)});
        }
      `}const a=zi();if(e)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],h=Math.ceil(t[2]/2),f=h*Math.ceil(t[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${f}, ${h}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function eSe(n,e){const t=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t[1]*t[2],o=t[2],{newShape:a,keptDims:l}=pc(t),c=a;if(c.length<t.length){const x=Pg(n,c),v=["row","col","depth"];return`
        ${$g(x,e)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${Lg(v,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${r}, ${o}, 1)));
        ${Og(n)}
      }
    `;const h=n.shapeInfo.texShape,f=h[0],p=h[1],g=n.shapeInfo.flatOffset;if(p===r&&g==null)return e?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${f}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(p===o&&g==null)return e?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${f}.0);
      return sampleTexture(${s}, uv);
    }
  `;const y=bf(s);return e?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${y};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r} + col * ${o} + depth + ${y};
        vec2 uv = uvFromFlat(${f}, ${p}, index);
        return sampleTexture(${s}, uv);
      }
  `}function tSe(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),i=zi();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${t}, uv);
    }
  `;const r=n.shapeInfo.logicalShape,o=r.length,a=n.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],h=l[1],f=Math.ceil(r[o-1]/2);let p=f*Math.ceil(r[o-2]/2),g="int b, int row, int col",y=`b * ${p} + (row / 2) * ${f} + (col / 2)`;for(let x=2;x<o-1;x++)g=`int b${x}, `+g,p*=r[o-x-1],y=`b${x} * ${p} + `+y;return`
    vec4 ${s}(${g}) {
      int index = ${y};
      int texR = index / ${h};
      int texC = index - texR * ${h};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${c});
      return ${i.texture2D}(${t}, uv);
    }
  `}function nSe(n,e){const t=n.shapeInfo.logicalShape,s=n.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t[3],o=t[2]*r,a=t[1]*o,{newShape:l,keptDims:c}=pc(t);if(l.length<t.length){const S=Pg(n,l),C=["row","col","depth","depth2"];return`
      ${$g(S,e)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${Lg(C,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${o}, ${r}, 1)));
        ${Og(n)}
      }
    `;const h=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,p=f[0],g=f[1],y=`int stride2 = ${s}Shape[3];`,x=`int stride1 = ${s}Shape[2] * stride2;`,v=`int stride0 = ${s}Shape[1] * stride1;`;if(g===a&&h==null)return e?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${y}
        ${x}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(g===r&&h==null)return e?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;const w=bf(s);return e?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${y}
      ${x}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${w});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} +
          depth * ${r} + depth2;
      vec2 uv = uvFromFlat(${p}, ${g}, index + ${w});
      return sampleTexture(${s}, uv);
    }
  `}function sSe(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),i=e[4],r=e[3]*i,o=e[2]*r,a=e[1]*o,{newShape:l,keptDims:c}=pc(e);if(l.length<e.length){const x=Pg(n,l),v=["row","col","depth","depth2","depth3"];return`
      ${$g(x)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Lg(v,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${o}, ${r}, ${i})) +
          depth3;
        ${Og(n)}
      }
    `;const h=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,p=f[0],g=f[1];if(g===a&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${r}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(g===i&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;const y=bf(t);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${o} + depth * ${r} +
          depth2 * ${i} + depth3 + ${y};
      vec2 uv = uvFromFlat(${p}, ${g}, index);
      return sampleTexture(${t}, uv);
    }
  `}function iSe(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:i,keptDims:r}=pc(e);if(i.length<e.length){const v=Pg(n,i),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${$g(v)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Lg(w,r)});
      }
    `}const o=e[5],a=e[4]*o,l=e[3]*a,c=e[2]*l,h=e[1]*c;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${h}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Og(n)}
      }
    `;const f=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],y=p[1];if(y===h&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(y===o&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${g}.0);
        return sampleTexture(${t}, uv);
      }
    `;const x=bf(t);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${h} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${o} + depth4 + ${x};
      vec2 uv = uvFromFlat(${g}, ${y}, index);
      return sampleTexture(${t}, uv);
    }
  `}function Og(n){const e=n.name,t=ye(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function rSe(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),i="get"+s+"AtOutCoords",r=n.shapeInfo.logicalShape.length,o=e.logicalShape.length,a=h7(n.shapeInfo.logicalShape,e.logicalShape),l=on(o),c=o-r;let h;const f=["x","y","z","w","u","v"];r===0?h="":o<2&&a.length>=1?h="coords = 0;":h=a.map(S=>`coords.${f[S+c]} = 0;`).join(`
`);let p="";o<2&&r>0?p="coords":p=n.shapeInfo.logicalShape.map((S,C)=>`coords.${f[C+c]}`).join(", ");let g="return outputValue;";const x=ye(n.shapeInfo.logicalShape)===1,w=ye(e.logicalShape)===1;if(r===1&&!x&&!w)g=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(x&&!w)o===1?g=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:g=`
        return vec4(outputValue.x);
      `;else if(a.length){const S=r-2,C=r-1;a.indexOf(S)>-1&&a.indexOf(C)>-1?g="return vec4(outputValue.x);":a.indexOf(S)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(C)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${l} coords = getOutputCoords();
      ${h}
      vec4 outputValue = get${s}(${p});
      ${g}
    }
  `}function oSe(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),i="get"+s+"AtOutCoords",r=e.texShape,o=n.shapeInfo.texShape,a=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&a===l&&n.shapeInfo.flatOffset==null&&_t(o,r))return`
      float ${i}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const c=on(l),h=h7(n.shapeInfo.logicalShape,e.logicalShape),f=l-a;let p;const g=["x","y","z","w","u","v"];a===0?p="":l<2&&h.length>=1?p="coords = 0;":p=h.map(x=>`coords.${g[x+f]} = 0;`).join(`
`);let y="";return l<2&&a>0?y="coords":y=n.shapeInfo.logicalShape.map((x,v)=>`coords.${g[v+f]}`).join(", "),`
    float ${i}() {
      ${c} coords = getOutputCoords();
      ${p}
      return get${s}(${y});
    }
  `}function on(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function JO(n,e,t){const{newShape:s,keptDims:i}=pc(e),r=e.length,o=n&&r===3&&e[0]===1,a=o?e.slice(1):s,l=!n&&r>1&&!_t(e,t)&&s.length<r||o;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:i}}function Pg(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function Lg(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aSe(n,e,t,s){const i=t.map((h,f)=>{const p={logicalShape:h.shape,texShape:h.isUniform?null:h.texData.texShape,isUniform:h.isUniform,isPacked:h.isUniform?!1:h.texData.isPacked,flatOffset:null};return h.texData!=null&&h.texData.slice!=null&&h.texData.slice.flatOffset>0&&(p.flatOffset=h.texData.slice.flatOffset),{name:e.variableNames[f],shapeInfo:p}}),r=i.map(h=>h.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=ETe(i,o,e),l=eTe(n.gl,a),c=n.createProgram(l);return de().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:r,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:r,outShapeInfo:o},p7(n,e,c)))}function p7(n,e,t){const s=[],i=[];let r,o,a,l=null,c=null;c=n.getUniformLocation(t,"NAN",!1),de().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(t,"INFINITY",!1));const h=!1;for(const f of e.variableNames){const p={name:f,uniform:n.getUniformLocation(t,f,h),offset:n.getUniformLocation(t,`offset${f}`,h)};e.enableShapeUniforms&&(p.shape=n.getUniformLocation(t,`${f}Shape`,h),p.texShape=n.getUniformLocation(t,`${f}TexShape`,h)),s.push(p)}if(e.enableShapeUniforms&&(r=n.getUniformLocation(t,"outShape",h),a=n.getUniformLocation(t,"outShapeStrides",h),o=n.getUniformLocation(t,"outTexShape",h)),e.customUniforms)for(const f of e.customUniforms)i.push(n.getUniformLocation(t,f.name,h));return{variablesLocations:s,customUniformLocations:i,infLoc:l,nanLoc:c,outShapeLocation:r,outShapeStridesLocation:a,outTexShapeLocation:o}}function cB(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,s)=>{const i=t.logicalShape,r=e[s],o=r.shape;if(!_t(i,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${o} must match`);if(t.isUniform&&r.isUniform)return;const a=t.texShape,l=r.isUniform?null:r.texData.texShape;if(!_t(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function lSe(n,e,t,s,i){e.program.enableShapeUniforms||(cB(e.inShapeInfos,t),cB([e.outShapeInfo],[s]));const r=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(r.texture,o[0],o[1]):n.setOutputMatrixTexture(r.texture,o[0],o[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),de().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<t.length;++l){const c=t[l],{uniform:h,offset:f,shape:p,texShape:g}=e.variablesLocations[l];if(p){const{uniformShape:y}=JO(e.program.packedInputs,c.shape,c.texData.texShape);switch(y.length){case 1:n.gl.uniform1iv(p,new Int32Array(y));break;case 2:n.gl.uniform2iv(p,new Int32Array(y));break;case 3:n.gl.uniform3iv(p,new Int32Array(y));break;case 4:n.gl.uniform4iv(p,new Int32Array(y));break}}if(g&&n.gl.uniform2i(g,c.texData.texShape[0],c.texData.texShape[1]),h!=null){if(c.isUniform){if(ye(c.shape)<2)n.gl.uniform1f(h,c.uniformValues[0]);else{let y=c.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),n.gl.uniform1fv(h,y)}continue}c.texData.slice!=null&&f!=null&&n.gl.uniform1i(f,c.texData.slice.flatOffset),n.setInputMatrixTexture(c.texData.texture.texture,h,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:n.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Ye(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&i)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],h=e.customUniformLocations[l],f=i[l];if(c.type==="float")n.gl.uniform1fv(h,f);else if(c.type==="vec2")n.gl.uniform2fv(h,f);else if(c.type==="vec3")n.gl.uniform3fv(h,f);else if(c.type==="vec4")n.gl.uniform4fv(h,f);else if(c.type==="int")n.gl.uniform1iv(h,f);else if(c.type==="ivec2")n.gl.uniform2iv(h,f);else if(c.type==="ivec3")n.gl.uniform3iv(h,f);else if(c.type==="ivec4")n.gl.uniform4iv(h,f);else throw Error(`uniform type ${c.type} is not supported yet.`)}n.executeProgram()}function cSe(n,e,t){let s="";e.concat(t).forEach(o=>{const a=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:h,keptDims:f}=JO(n.packedInputs,o.shape,l);let p="",g="",y="";if(h.length===1&&n.packedInputs){const A=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${A[0]>1}_${A[1]>1}`}else if(h.length===2&&!n.packedInputs)g=`${h[0]>1}_${h[1]>1}`;else if(h.length>2&&!n.packedInputs){const A=Ye(h);y=`${A[0]===l[1]}_${A[A.length-1]===l[1]}`}const x=o.shape.length,v=h.length===2&&_t(o.shape,l),w=ye(o.shape)===1,S=zd(o.shape,t.shape),C=!n.packedInputs&&x===t.shape.length&&_t(l,t.texData.texShape),I=n.packedInputs||h.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${x}_${C}_${c?f:""}_${h.length}_${w}_${S}_${v}_${p}_${g}_${y}_${I}_${a}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${a}`}});const i=n.userCode;let r=n.constructor.name;return r+="_"+s+"_"+i+`${de().getNumber("WEBGL_VERSION")}`,r}function gi(n){return de().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uSe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=S0.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=zi();this.outputShape=e,this.enableShapeUniforms=gi(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?zC(["r","c","d"],e):yf(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hSe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=S0.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=zi();this.outputShape=e,this.enableShapeUniforms=gi(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?zC(["r","c","d"],e):yf(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dSe{constructor(e){this.variableNames=["A"],this.outTexUsage=Pr.DOWNLOAD;const t=zi();this.outputShape=e,this.userCode=`
      ${u7}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fSe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Pr.DOWNLOAD;const t=zi();this.outputShape=e,this.userCode=`
      ${u7}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pSe={R:0,G:1,B:2,A:3};class uB{constructor(e,t=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=zi();this.outputShape=e,this.enableShapeUniforms=gi(this.outputShape.length);let r="result";t&&(r="floor(result * 255. + 0.5)");let o="";for(let a=0;a<s.length;a++){const l=s[a];o+=`
          if(offset == ${a}) {
            result = values[${pSe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?ZO():QO(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${i.texture2D}(A, uv);
          ${o}
        }
        ${i.output} = vec4(${r}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mSe{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=zi();this.outputShape=e,this.enableShapeUniforms=gi(this.outputShape.length);let i="",r="result";t&&(r="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){const l=o*2+a;i+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?ZO():QO(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${s.output} = ${r};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gSe(n){const e=zi(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return J1e(n,t)}function ySe(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return iTe(n,e)}function bSe(n){const e=new Uint16Array([0,1,2,2,1,3]);return rTe(n,e)}function Vx(n,e,t,s,i,r){aTe(e,t);const o=oTe(n),a=n.TEXTURE_2D;return Ve(n,()=>n.bindTexture(a,o)),Ve(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),Ve(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),Ve(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),Ve(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),de().getNumber("WEBGL_VERSION")===1?Ve(n,()=>n.texImage2D(a,0,s,e,t,0,i,r,null)):Ve(n,()=>n.texStorage2D(a,1,s,e,t)),Ve(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:o,texShape:[t,e]}}function m7(n){return n.internalFormatFloat}function vSe(n,e,t,s){const[i,r]=Mx(e,t);return Vx(n,i,r,m7(s),s.textureFormatFloat,n.FLOAT)}function g7(n){return n.internalFormatHalfFloat}function xSe(n,e,t,s){const[i,r]=Mx(e,t);return Vx(n,i,r,g7(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function y7(n){return n.downloadTextureFormat}function wSe(n,e,t,s){const[i,r]=Mx(e,t);return Vx(n,i,r,y7(s),n.RGBA,n.UNSIGNED_BYTE)}function b7(n){return n.internalFormatPackedFloat}function _Se(n,e,t,s){const[i,r]=Dg(e,t);return Vx(n,i,r,b7(s),n.RGBA,n.FLOAT)}function v7(n){return n.internalFormatPackedHalfFloat}function TSe(n,e,t,s){const[i,r]=Dg(e,t);return Vx(n,i,r,v7(s),n.RGBA,s.textureTypeHalfFloat)}function SSe(n,e,t){return Ve(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),oB(n,e,"clipSpacePos",t,3,20,0)&&oB(n,e,"uv",t,2,20,12)}function ESe(n,e,t,s,i,r){Ve(n,()=>n.bindTexture(n.TEXTURE_2D,e));let o,a,l;i instanceof Uint8Array?(o=new Uint8Array(t*s*4),a=n.UNSIGNED_BYTE,l=n.RGBA):(o=new Float32Array(t*s*4),a=n.FLOAT,l=r.internalFormatPackedFloat),o.set(i),de().getNumber("WEBGL_VERSION")===2?Ve(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,s,n.RGBA,a,o)):Ve(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,s,0,n.RGBA,a,o)),Ve(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function CSe(n,e,t){Ve(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?de().getNumber("WEBGL_VERSION")===2?Ve(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):Ve(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):de().getNumber("WEBGL_VERSION")===2?Ve(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):Ve(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),Ve(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function ISe(n,e,t,s){const i=n.createBuffer();Ve(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,i));const a=4*4*e*t;return Ve(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),Ve(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),Ve(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),i}function kSe(n,e,t){const s=n,i=new Float32Array(t);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,i),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),i}function NSe(n,e,t,s){const[i,r]=Mx(e,t),o=4,a=new Uint8Array(G1e(e*t,o));return Ve(n,()=>n.readPixels(0,0,i,r,s.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function ASe(n,e,t,s,i,r,o,a){const l=n,c=new Float32Array(q1e(r,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function RSe(n,e,t){const s=new Float32Array(e*t*4);return Ve(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eA{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=de().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,W1e(t,e)):this.gl=sa(t),e=this.gl,de().getNumber("WEBGL_VERSION")===2){const r=e;this.createVertexArray=()=>Ve(r,()=>r.createVertexArray()),this.bindVertexArray=o=>Ve(r,()=>r.bindVertexArray(o)),this.deleteVertexArray=o=>Ve(r,()=>r.deleteVertexArray(o)),this.getVertexArray=()=>Ve(r,()=>r.getParameter(r.VERTEX_ARRAY_BINDING))}else if(e!=null){const r=e.getExtension("OES_vertex_array_object");if(r==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ve(e,()=>r.createVertexArrayOES()),this.bindVertexArray=o=>Ve(e,()=>r.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Ve(e,()=>r.deleteVertexArrayOES(o)),this.getVertexArray=()=>Ve(e,()=>e.getParameter(r.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),de().getNumber("WEBGL_VERSION")===1){const r="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=z_(this.gl,r),vo(this.gl,o))this.textureHalfFloatExtension=z_(this.gl,o);else if(de().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),vo(this.gl,i))this.colorBufferHalfFloatExtension=z_(this.gl,i);else if(de().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",vo(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(vo(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=ySe(this.gl),this.indexBuffer=bSe(this.gl),this.framebuffer=lTe(this.gl),this.textureConfig=YO(this.gl,this.textureHalfFloatExtension)}get debug(){return de().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ve(e,()=>e.finish()),Ve(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ve(e,()=>e.deleteFramebuffer(this.framebuffer)),Ve(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ve(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ve(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),vSe(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),xSe(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),wSe(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),CSe(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,s,i){this.throwIfDisposed(),ESe(this.gl,e,t,s,i,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),TSe(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),_Se(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(aB(this.gl,this.framebuffer),this.outputTexture=null),Ve(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,s){return this.downloadMatrixDriver(e,()=>NSe(this.gl,t,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,s,i,r,o){return ASe(this.gl,e,t,s,i,r,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return kSe(this.gl,e,t)}createBufferFromTexture(e,t,s){this.bindTextureToFrameBuffer(e);const i=ISe(this.gl,t,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,s;if(de().getBool("WEBGL_FENCE_API_ENABLED")){const i=e,r=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=i.clientWaitSync(r,0,0);return o===i.ALREADY_SIGNALED||o===i.CONDITION_SATISFIED},t=r}else de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(t,de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:t,isFencePassed:s}}downloadMatrixFromPackedTexture(e,t,s){return this.downloadMatrixDriver(e,()=>RSe(this.gl,t,s))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=gSe(t));const s=nTe(t);Ve(t,()=>t.attachShader(s,this.vertexShader)),Ve(t,()=>t.attachShader(s,e)),sTe(t,s);const i=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&YN(t,i),i}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;Ve(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),SSe(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ve(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&YN(this.gl,this.program),Ve(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,s=!0){return this.throwIfDisposed(),s?uTe(this.gl,e,t):hTe(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Ve(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,s){this.throwIfDisposed(),this.throwIfNoProgram(),dTe(this.gl,e,t,s)}setOutputMatrixTexture(e,t,s){this.setOutputMatrixTextureDriver(e,s,t)}setOutputPackedMatrixTexture(e,t,s){this.throwIfDisposed();const[i,r]=Dg(t,s);this.setOutputMatrixTextureDriver(e,i,r)}setOutputMatrixWriteRegion(e,t,s,i){this.setOutputMatrixWriteRegionDriver(s,e,i,t)}setOutputPackedMatrixWriteRegion(e,t,s,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&YN(this.gl,this.program),B_(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ve(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ve(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=z_(this.gl,de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,i=this.getQueryTimerExtensionWebGL2(),r=s.createQuery();return s.beginQuery(i.TIME_ELAPSED_EXT,r),r}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,s=this.getQueryTimerExtensionWebGL2();t.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await ZA(()=>this.disposed||this.isQueryAvailable(e,de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const s=this.gl,i=this.getQueryTimerExtensionWebGL2(),r=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),r&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),i=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=DSe(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:s}=this.itemsToPoll[t];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in de().platform&&(s=de().platform.setTimeoutCustom.bind(de().platform)),ZA(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),QN(this.gl,e,this.framebuffer),this.debug&&B_(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(QN(this.gl,this.outputTexture,this.framebuffer),this.debug&&B_(this.gl)):aB(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const s=t();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,t,s){this.throwIfDisposed();const i=this.gl;QN(i,e,this.framebuffer),this.debug&&B_(i),this.outputTexture=e,Ve(i,()=>i.viewport(0,0,t,s)),Ve(i,()=>i.scissor(0,0,t,s))}setOutputMatrixWriteRegionDriver(e,t,s,i){this.throwIfDisposed(),Ve(this.gl,()=>this.gl.scissor(e,t,s,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function DSe(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:$Se,bincountImpl:x7,bincountReduceImpl:OSe,bitwiseAndImpl:PSe,castImpl:LSe,ceilImpl:MSe,concatImpl:FSe,equalImpl:VSe,expImpl:zSe,expm1Impl:BSe,floorImpl:USe,gatherNdImpl:WSe,gatherV2Impl:HSe,greaterImpl:jSe,greaterEqualImpl:GSe,lessImpl:qSe,lessEqualImpl:KSe,linSpaceImpl:XSe,logImpl:YSe,maxImpl:QSe,maximumImpl:ZSe,minimumImpl:JSe,multiplyImpl:eEe,negImpl:tEe,notEqualImpl:nEe,prodImpl:sEe,raggedGatherImpl:iEe,raggedRangeImpl:rEe,raggedTensorToTensorImpl:oEe,rangeImpl:aEe,rsqrtImpl:lEe,scatterImpl:cEe,sigmoidImpl:uEe,simpleAbsImpl:w7,sliceImpl:hEe,sparseFillEmptyRowsImpl:dEe,sparseReshapeImpl:fEe,sparseSegmentReductionImpl:_7,sqrtImpl:pEe,staticRegexReplaceImpl:mEe,stridedSliceImpl:gEe,stringNGramsImpl:yEe,stringSplitImpl:bEe,stringToHashBucketFastImpl:vEe,subImpl:xEe,tileImpl:wEe,topKImpl:_Ee,transposeImpl:eP,uniqueImpl:TEe}=C0e;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function Ri(n,e){return e===1?[n]:T7(n,e)}function SEe(n,e){if(n===1)return"rc";let t="";for(let s=0;s<n;s++)t+=e[s],s<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EEe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=gi(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=Ri("rc",this.rank),s=on(this.rank),i=this.getOutOfBoundsCondition(t),r=this.getSetup(t),o=this.getOutput(t);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${r}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let s=0;s<=1;s++)for(let i=0;i<=1;i++){let r=`${s===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)r=`${e[e.length-1-o]},`+r;t.push(r)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let s=this.rank-2;s<this.rank;s++)t+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${i};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S7{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=gi(this.outputShape.length);let s="";for(let i=0;i<4;i++){let r="thisRC = rc;";i%2===1&&(r+="thisRC.z += 1;"),i>1&&(r+="thisRC.y += 1;"),s+=`
        ${r}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${CEe(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?ZO():QO(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function CEe(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?STe(["r","c","d"],"inputShape"):yf(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IEe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,s){const i=dB(t,s),r=fB(e,i,s);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);const o=hB(e,i,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[r].pop();return this.usedTextures[r].push(l),l}let a;return i===Xs.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===Xs.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===Xs.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===Xs.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===Xs.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[r].push(a),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),a}releaseTexture(e,t,s,i){if(this.freeTextures==null)return;const r=dB(s,i),o=fB(t,r,i);o in this.freeTextures||(this.freeTextures[o]=[]);const a=hB(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,i),l=de().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[o],h=c&&c.indexOf(e);if(h==null||h<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[h]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function kEe(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function hB(n,e,t,s,i){const r=NEe(e,s);let o;if(i){const[l,c]=Dg(n[0],n[1]);o=l*c}else{const[l,c]=Mx(n[0],n[1]);o=l*c}const a=kEe(t,r);return o*a}function NEe(n,e){switch(n){case Xs.PACKED_2X2_FLOAT32:return b7(e);case Xs.PACKED_2X2_FLOAT16:return v7(e);case Xs.UNPACKED_FLOAT32:return m7(e);case Xs.UNPACKED_FLOAT16:return g7(e);case Xs.PACKED_4X1_UNSIGNED_BYTE:return y7(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function AEe(n){return de().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Xs.PACKED_2X2_FLOAT32:Xs.UNPACKED_FLOAT32:n?Xs.PACKED_2X2_FLOAT16:Xs.UNPACKED_FLOAT16}function dB(n,e){if(n===Pr.UPLOAD)return Xs.PACKED_2X2_FLOAT32;if(n===Pr.RENDER||n==null)return AEe(e);if(n===Pr.DOWNLOAD||n===Pr.PIXELS)return Xs.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function fB(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pa{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=gi(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ro="if (isnan(x)) return x;",REe="return x;",pB="return abs(x);",DEe="return (x >= 0.0) ? x : (exp(x) - 1.0);",$Ee=Ro+`
  return (x < 0.0) ? 0.0 : x;
`,OEe=Ro+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,hu="return x;",PEe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LEe="return x;",MEe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,FEe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,VEe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zEe="return 1.0 / (1.0 + exp(-1.0 * x));";class bu{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=gi(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BEe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=gi(this.outputShape.length);const t=e.length,s=Ri("rc",t),i=on(t),r=SEe(t,s),o=s.slice(-2),a=t<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${r});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UEe=fC,WEe=1e-7,HEe=1e-4,H_={};function jEe(n){return n in H_||(H_[n]={}),H_[n]}const GEe=de().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),qEe=600;function KEe(){return de().global.screen==null?1024:de().global.screen.height*de().global.screen.width*window.devicePixelRatio*qEe/1024/1024}class BC extends AS{nextDataId(){return BC.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!de().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof eA)t=e;else{const s=sa(de().getNumber("WEBGL_VERSION"),e);t=new eA(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=sa(de().getNumber("WEBGL_VERSION"));t=new eA(s),this.binaryCache=jEe(de().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new IEe(this.gpgpu),this.numMBBeforeWarning=KEe(),this.texData=new yD(this,Bo())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,s,i,r,o){const a=this.makeTensorInfo(t,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[i,r]},l.texShape=[i,r];const c=U_(t),h=new uB(c,!1,o),f=this.runWebGLProgram(h,[a],s,[[i,r]]);return f.shape=t,l.texture=null,this.disposeIntermediateTensorInfo(a),f.dataId}write(e,t,s){if((de().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||de().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:t,dtype:s,values:e,usage:Pr.UPLOAD,refCount:1}),i}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,s,i,r){if(de().getBool("DEBUG")&&this.checkNumericalProblems(t),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:i,values:t,usage:Pr.UPLOAD,refCount:r})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:s,dtype:i,complexTensorInfos:r,slice:o,shape:a,isPacked:l}=t;if(o!=null){let p;l?p=new bu(a,hu):p=new Pa(a,hu);const g=this.runWebGLProgram(p,[{dataId:e,shape:a,dtype:i}],i),y=this.readSync(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(i==="string")return s;const c=this.activeTimers!=null;let h;c&&(h=Si());let f;if(i==="complex64"){const p=this.readSync(r.real.dataId),g=this.readSync(r.imag.dataId);f=ic(p,g)}else f=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Si()-h),this.convertAndCacheOnCPU(e,f)}async read(e){if(this.pendingRead.has(e)){const y=this.pendingRead.get(e);return new Promise(x=>y.push(x))}const t=this.texData.get(e),{values:s,shape:i,slice:r,dtype:o,complexTensorInfos:a,isPacked:l}=t;if(r!=null){let y;l?y=new bu(i,hu):y=new Pa(i,hu);const x=this.runWebGLProgram(y,[{dataId:e,shape:i,dtype:o}],o),v=this.read(x.dataId);return this.disposeIntermediateTensorInfo(x),v}if(s!=null)return this.convertAndCacheOnCPU(e);if(de().getBool("DEBUG")&&!de().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&de().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,h;if(o!=="complex64"&&de().get("WEBGL_BUFFER_SUPPORTED")){h=this.decode(e);const y=this.texData.get(h.dataId);c=this.gpgpu.createBufferFromTexture(y.texture.texture,...V_(i))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(o==="complex64"){const y=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),x=y[0],v=y[1];f=ic(x,v)}else if(c==null)f=this.getValuesFromTexture(e);else{const y=ye(i);f=this.gpgpu.downloadFloat32MatrixFromBuffer(c,y)}if(h!=null&&this.disposeIntermediateTensorInfo(h),c!=null){const y=this.gpgpu.gl;Ve(y,()=>y.deleteBuffer(c))}const p=this.convertAndCacheOnCPU(e,f),g=this.pendingRead.get(e);return this.pendingRead.delete(e),g.forEach(y=>y(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Bo().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,t={}){const s=this.texData.get(e),{values:i,shape:r,slice:o,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let g;l?g=new bu(r,hu):g=new Pa(r,hu);const y=this.runWebGLProgram(g,[{dataId:e,shape:r,dtype:a}],a),x=this.readToGPU(y,t);return this.disposeIntermediateTensorInfo(y),x}if(c==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const h=this.decode(e,t.customTexShape),f=Bo().makeTensorFromTensorInfo(h),p=this.texData.get(h.dataId);return Object.assign({tensorRef:f},p.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(i=>tc(i));return ut(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ut(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const s=e[t];if(!Q1e(s))throw de().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:s,isPacked:i}=this.texData.get(e),r=ye(t);if(de().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),g=this.texData.get(p.dataId),y=this.gpgpu.downloadMatrixFromPackedTexture(g.texture.texture,...V_(t)).subarray(0,r);return this.disposeIntermediateTensorInfo(p),y}const o=de().getBool("WEBGL_PACK")&&i===!0,a=o?U_(t):t,l=o?new fSe(a):new dSe(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),h=this.texData.get(c.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture.texture,h.texShape[0],h.texShape[1]).subarray(0,r);return this.disposeIntermediateTensorInfo(c),f}timerAvailable(){return de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,s=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=s,i=!0):this.activeTimers.push(s),this.activeTimers=s,e();const r=Ya(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=Ya(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,i&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(r);a.kernelMs=Zj(l),a.getExtraProfileInfo=()=>l.map((c,h)=>({name:o[h],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Si(),endMs:null}}endTimer(e){return de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Si(),e)}async getQueryTime(e){if(de().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,t),this.disposeData(s.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:s,texShape:i,usage:r,isPacked:o,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(i,s),this.textureManager.releaseTexture(t,i,r,o)));const h=this.texData.get(e);h.texture=null,h.texShape=null,h.isPacked=!1,h.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=GEe){return de().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&ye(s.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Dr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return UEe(e.shape,t)}packedUnaryOp(e,t,s){const i=new bu(e.shape,t),r=this.compileAndRun(i,[e],s);return Bo().makeTensorFromTensorInfo(r)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const i=w7(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,i)}if(de().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,pB,e.dtype);const t=new Pa(e.shape,pB),s=this.compileAndRun(t,[e]);return Bo().makeTensorFromTensorInfo(s)}makeTensorInfo(e,t,s){let i;if(t==="string"&&s!=null&&s.length>0&&Oa(s[0])){const r=s.map(o=>Fa(o));i=this.write(r,e,t)}else i=this.write(s,e,t);return this.texData.get(i).usage=null,{dataId:i,shape:e,dtype:t}}makeOutput(e,t,s){return Bo().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,s),this)}unpackTensor(e){const t=new BEe(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new EEe(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const s=[am(e.shape),...lm(e.shape)],i={dtype:e.dtype,shape:s,dataId:e.dataId},r=[am(t),...lm(t)],o=new S7(r,s),a=!0,l=[s],c=this.runWebGLProgram(o,[i],e.dtype,l,a);return{dataId:c.dataId,shape:t,dtype:c.dtype}}decode(e,t){const s=this.texData.get(e),{isPacked:i,shape:r,dtype:o}=s;if(t!=null){const p=ye(r),g=t[0]*t[1]*4;B(p<=g,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=U_(r);let l;i?l=new hSe(a):l=new uSe(a);const c=!0,h=[t??V_(a)],f=this.runWebGLProgram(l,[{shape:a,dtype:o,dataId:e}],o,h,c,t);return{dtype:o,shape:r,dataId:f.dataId}}runWebGLProgram(e,t,s,i,r=!1,o){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===S0.DENSE){const w=o??V_(e.outputShape);l.texShape=w.map(S=>S*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),ye(a.shape)===0)return l.values=$s(a.dtype,0),a;const c=[],h=t.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let S=this.texData.get(w.dataId);if(S.texture==null){if(!e.packedInputs&&ye(w.shape)<=de().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:S.values};e.packedInputs&&(S.isPacked=!0,S.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!S.isPacked!=!!e.packedInputs)w=S.isPacked?this.unpackTensor(w):this.packTensor(w),c.push(w),S=this.texData.get(w.dataId);else if(S.isPacked&&!NT(S.shape,w.shape)){const C=w,I=w.shape;w.shape=S.shape,w=this.packedReshape(w,I),c.push(w),S=this.texData.get(w.dataId),C.shape=I}return{shape:w.shape,texData:S,isUniform:!1}});this.uploadToGPU(a.dataId);const f={shape:a.shape,texData:l,isUniform:!1},p=cSe(e,h,f),g=this.getAndSaveBinary(p,()=>aSe(this.gpgpu,e,h,f)),y=this.activeTimers!=null;let x;y&&(x=this.startTimer()),de().get("ENGINE_COMPILE_ONLY")||lSe(this.gpgpu,g,h,f,i),c.forEach(w=>this.disposeIntermediateTensorInfo(w)),y&&(x=this.endTimer(x),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(x)}));const v=de().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const w=Si();w-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!de().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&r===!1){const w=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),w}return a}compileAndRun(e,t,s,i,r=!1){return s=s||t[0].dtype,this.runWebGLProgram(e,t,s,i,r)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(de().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ce(()=>{if(!de().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=de().getBool("DEBUG");de().set("DEBUG",!1);const t=this.abs(Qe(1e-8)).dataSync()[0];if(de().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?WEe:HEe}uploadToGPU(e){const t=this.texData.get(e),{shape:s,dtype:i,values:r,texture:o,usage:a,isPacked:l}=t;if(o!=null)return;const c=this.activeTimers!=null;let h;c&&(h=Si());let f=t.texShape;if(f==null&&(f=mTe(s,l),t.texShape=f),r!=null){const p=U_(s);let g,y=f[1],x=f[0];const v=r instanceof Uint8Array||r instanceof Uint8ClampedArray;(l||!v)&&([y,x]=Dg(f[0],f[1])),l?g=new mSe(p,v):g=new uB(p,v);const w=v?[x,y]:f,S=this.makeTensorInfo(w,i),C=this.texData.get(S.dataId);v?C.usage=Pr.PIXELS:C.usage=Pr.UPLOAD,C.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(S.dataId),y,x,r);const I=[[x,y]],L=this.runWebGLProgram(g,[S],i,I,!0),O=this.texData.get(L.dataId);t.texShape=O.texShape,t.isPacked=O.isPacked,t.usage=O.usage,de().get("ENGINE_COMPILE_ONLY")?this.disposeData(L.dataId):(t.texture=O.texture,t.values=null,this.texData.delete(L.dataId)),this.disposeIntermediateTensorInfo(S),c&&(this.uploadWaitMs+=Si()-h)}else{const p=this.acquireTexture(f,a,i,l);t.texture=p}}convertAndCacheOnCPU(e,t){const s=this.texData.get(e),{dtype:i}=s;return t!=null&&(s.values=XEe(t,i)),s.values}acquireTexture(e,t,s,i){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const r=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${r} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,i)}computeBytes(e,t){return e[0]*e[1]*l0(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const s=new Promise(i=>{try{this.checkCompletion_(t),i(!0)}catch(r){throw r}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await Z$(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(c7(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:s,infLoc:i,nanLoc:r,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:l}=p7(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=s,e.infLoc=i,e.nanLoc=r,e.outShapeLocation=o,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,t,s){e.channels=e.channels||"RGBA";const{texture:i,height:r,width:o,channels:a}=e,l=Bo().backend;if(!l.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(i,t,s,r,o,a);return Bo().makeTensorFromDataId(c,t,s,l)}}BC.nextDataId=0;function XEe(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<t.length;++s)t[s]=Math.round(n[s]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ID()&&ND("webgl",()=>new BC,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tP=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Kd{constructor(e,t,s){this.variableNames=["A","B"],this.outputShape=ot(t,s),this.enableShapeUniforms=gi(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vf=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Mg{constructor(e,t,s,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ot(t,s);const r=this.outputShape.length;this.enableShapeUniforms=gi(r);let o="";if(i)if(r===0||ye(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${on(r)} coords = getOutputCoords();
        `,r===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Ri("coords",r);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[r-2]} + 1) >= outShape[${r} - 2];
            bool nextColOutOfBounds =
              (${l[r-1]} + 1) >= outShape[${r} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[r-2]} + 1) >= ${this.outputShape[r-2]};
            bool nextColOutOfBounds =
              (${l[r-1]} + 1) >= ${this.outputShape[r-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wr(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const YEe={kernelName:Km,backendName:"webgl",kernelFunc:wr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fh(n){const{inputs:e,backend:t}=n,{real:s,imag:i}=e,r=t.makeTensorInfo(s.shape,"complex64"),o=t.texData.get(r.dataId),a=wr({inputs:{x:s},backend:t}),l=wr({inputs:{x:i},backend:t});return o.complexTensorInfos={real:a,imag:l},r}const QEe={kernelName:VS,backendName:"webgl",kernelFunc:fh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7="return (a < 0.) ? b * a : a;",C7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function ZEe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{alpha:r}=s,o=t.makeTensorInfo([],"float32",mc(r,"float32")),a=de().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mg(C7,i.shape,o.shape):new Kd(E7,i.shape,o.shape),l=t.runWebGLProgram(a,[i,o],"float32");return t.disposeIntermediateTensorInfo(o),l}const JEe={kernelName:Ev,backendName:"webgl",kernelFunc:ZEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I7="return (a < 0.) ? b * a : a;",k7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function eCe(n){const{inputs:e,backend:t}=n,{x:s,alpha:i}=e,r=de().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mg(k7,s.shape,i.shape):new Kd(I7,s.shape,i.shape);return t.runWebGLProgram(r,[s,i],"float32")}const tCe={kernelName:Hv,backendName:"webgl",kernelFunc:eCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fg="if (isnan(x)) return x;";function Ot({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:s}){return({inputs:i,backend:r})=>{const{x:o}=i,a=r,l=s||o.dtype;if(a.shouldExecuteOnCPU([o])&&t!=null){const f=a.texData.get(o.dataId),p=t(f.values,l);return a.makeTensorInfo(o.shape,l,p)}const c=de().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let h;return c?h=new bu(o.shape,e):h=new Pa(o.shape,n),a.runWebGLProgram(h,[o],l)}}function si({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:s=!1,cpuKernelImpl:i,dtype:r}){return({inputs:o,backend:a})=>{const{a:l,b:c}=o,h=a;if(s&&l.dtype==="complex64"){const y=h.texData.get(l.dataId),x=h.texData.get(c.dataId),[v,w]=[[y.complexTensorInfos.real,x.complexTensorInfos.real],[y.complexTensorInfos.imag,x.complexTensorInfos.imag]].map(C=>{const[I,A]=C,L={dataId:I.dataId,dtype:I.dtype,shape:l.shape},O={dataId:A.dataId,dtype:A.dtype,shape:c.shape},N=new Kd(n,l.shape,c.shape);return h.runWebGLProgram(N,[L,O],Ji(I.dtype,A.dtype))}),S=fh({inputs:{real:v,imag:w},backend:h});return h.disposeIntermediateTensorInfo(v),h.disposeIntermediateTensorInfo(w),S}const f=r||Ji(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||h.shouldExecuteOnCPU([l,c]))&&i!=null){const y=h.texData.get(l.dataId).values,x=h.texData.get(c.dataId).values,v=l.dtype==="string"?rc(y):y,w=l.dtype==="string"?rc(x):x,[S,C]=i(l.shape,c.shape,v,w,f),I=h.makeTensorInfo(C,f),A=h.texData.get(I.dataId);return A.values=S,I}const p=de().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let g;return p?g=new Mg(e,l.shape,c.shape,t):g=new Kd(n,l.shape,c.shape),h.runWebGLProgram(g,[l,c],f)}}function E0(n,e=!1){if(n==="linear")return e?LEe:REe;if(n==="relu")return e?FEe:$Ee;if(n==="elu")return e?MEe:DEe;if(n==="relu6")return e?VEe:OEe;if(n==="prelu")return e?k7:I7;if(n==="leakyrelu")return e?C7:E7;if(n==="sigmoid")return e?zEe:PEe;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N7{constructor(e,t,s,i=!1,r=!1,o=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=gi(this.outputShape.length);const h=i?e[1]:e[2],f=Math.ceil(h/2),p=i?"i * 2, rc.y":"rc.y, i * 2",g=r?"rc.z, i * 2":"i * 2, rc.z",y=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],x=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",w="";a&&(l?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:v=`vec4 activation(vec4 x) {
          ${a}
        }`,w="result = activation(result);");const S=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let C="rc.x",I="rc.x";e[0]<t[0]?C=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(I=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${C};
        int batchB = ${I};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${g});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${y[0]} * ${x[0]});
          result += (${y[1]} * ${x[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${S}

        ${w}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mB={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class gB{constructor(e,t,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ot(t,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yB="return a * b;";function nP(n){const{inputs:e,backend:t}=n,{a:s,b:i}=e,r=Ji(s.dtype,i.dtype);if(s.dtype==="complex64"){const a=t.texData.get(s.dataId),l=t.texData.get(i.dataId),c=new gB(mB.REAL,s.shape,i.shape),h=new gB(mB.IMAG,s.shape,i.shape),f=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],p=t.runWebGLProgram(c,f,"float32"),g=t.runWebGLProgram(h,f,"float32"),y=fh({inputs:{real:p,imag:g},backend:t});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),y}if(t.shouldExecuteOnCPU([s,i])){const a=t.texData.get(s.dataId),l=t.texData.get(i.dataId),[c,h]=eEe(s.shape,i.shape,a.values,l.values,r),f=t.makeTensorInfo(h,r),p=t.texData.get(f.dataId);return p.values=c,f}let o;return de().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Mg(yB,s.shape,i.shape):o=new Kd(yB,s.shape,i.shape),t.runWebGLProgram(o,[s,i],r)}const nCe={kernelName:sg,backendName:"webgl",kernelFunc:nP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sCe(n,e,t){const s=[am(n.shape),...lm(n.shape)],i={dtype:n.dtype,shape:s,dataId:n.dataId},r=[am(e),...lm(e)],o=new S7(r,s),a=!0,l=[s],c=t.runWebGLProgram(o,[i],n.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{shape:r}=s,o=t,a=ye(i.shape),l=vD(r,a),c=ye(l);B(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const h=o.texData.get(i.dataId);return h.isPacked&&!NT(i.shape,l)&&!(h.texture!==null&&NT(h.shape,l))?sCe(i,l,o):(o.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype})}const iCe={kernelName:Gv,backendName:"webgl",kernelFunc:Pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bB{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:i,inSize:r,outSize:o}=e;this.outputShape=[i,o];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(t!=null){const f=1/t;c=`sumValue += dot(values * ${Od(f)?f.toPrecision(2):f}, ones);`}let h="";r%s>0&&(h=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rCe{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:i,inSize:r,outSize:o}=e;this.outputShape=[i,o];let a="0.0",l="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",l="min"):t==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");const h=Math.floor(s/4)*4,f=s%4;let p=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,g="vec4";t==="all"?(a="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,g="bvec4"):t==="any"&&(a="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,g="bvec4");let y="";r%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${h};
        if (${f===1}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${f===2}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${f===3}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oCe(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],s=EC(t);e.push({inSize:t,windowSize:s,outSize:Math.ceil(t/s)})}return e}function xf(n,e,t,s){const i=oCe(n.shape);let r=n;for(let o=0;o<i.length;o++){const{inSize:a,windowSize:l,outSize:c}=i[o];let h,f;t==="mean"?h=o===0?new bB({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:c},a):new bB({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:c}):h=new rCe({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:c},t),f=r,r=s.runWebGLProgram(h,[r],e),f.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(f)}return r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aCe{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[t[o]];this.outputShape=s,this.rank=s.length;const i=on(this.rank),r=lCe(t);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${r}));
    }
    `}}function lCe(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let i=0;i<n.length;i++)s[n[i]]=t[i];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cCe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let h=0;h<s.length;h++)s[h]=e[t[h]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=on(this.rank),r=T7("rc",this.rank),o=new Array(this.rank);for(let h=0;h<t.length;h++)o[t[h]]=r[h];const a=`vec2(${o.slice(-2).join()})`,l=`++${r[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${a})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${r[this.rank-1]};
      if(++${r[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UC(n,e,t){const s=de().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cCe(n.shape,e):new aCe(n.shape,e);return t.runWebGLProgram(s,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uCe(n,e,t,s){const i=e,r=n.shape.length,o=gt(i,n.shape);let a=o;const l=On(a,r),c=l!=null;let h=n;c&&(h=UC(n,l,s),a=Qn(a.length,r)),ti("sum",a,r);const[f,p]=Ls(h.shape,a);let g=f;t&&(g=Xn(f,o));const y=ye(p),v=ye(n.shape)/y,w=Pe({inputs:{x:h},attrs:{shape:[v,y]},backend:s}),S=VE(n.dtype),C=xf(w,S,"sum",s),I=Pe({inputs:{x:C},attrs:{shape:g},backend:s});return s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(C),c&&s.disposeIntermediateTensorInfo(h),I}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WC(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s;return uCe(i,r,o,t)}const hCe={kernelName:Zv,backendName:"webgl",kernelFunc:WC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mi(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{perm:r}=s,o=t,a=i.shape.length,l=new Array(a);for(let h=0;h<l.length;h++)l[h]=i.shape[r[h]];let c;if(o.shouldExecuteOnCPU([i])){const f=o.texData.get(i.dataId).values,p=eP(f,i.shape,i.dtype,r,l);c=o.makeTensorInfo(l,i.dtype);const g=o.texData.get(c.dataId);g.values=p}else c=UC(i,r,o);return c}const dCe={kernelName:Ed,backendName:"webgl",kernelFunc:Mi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A7=1e3;function AT({a:n,b:e,transposeA:t,transposeB:s,backend:i,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:a=0,activation:l=null}){const c=n.shape.length,h=e.shape.length,f=t?n.shape[c-2]:n.shape[c-1],p=s?e.shape[h-1]:e.shape[h-2],g=t?n.shape[c-1]:n.shape[c-2],y=s?e.shape[h-2]:e.shape[h-1],x=n.shape.slice(0,-2),v=e.shape.slice(0,-2),w=ye(x),S=ye(v),I=ot(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([g,y]);B(f===p,()=>`Error in matMul: inner shapes (${f}) and (${p}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${s} must match.`);const A=t?[w,f,g]:[w,g,f],L=s?[S,y,p]:[S,p,y],O=Pe({inputs:{x:n},backend:i,attrs:{shape:A}}),N=Pe({inputs:{x:e},backend:i,attrs:{shape:L}}),k=[O,N],$=Math.max(w,S),R=t?O.shape[1]:O.shape[2],z=r!=null,V=o!=null,ne=l==="leakyrelu",Q=l!=null?E0(l,!0):null,G=z||V||ne||Q!=null;let J;if((g===1||y===1)&&R>A7&&G===!1){let le=O,H=N;t&&(le=Mi({inputs:{x:O},backend:i,attrs:{perm:[0,2,1]}}),k.push(le)),s&&(H=Mi({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),k.push(H));const ee=y!==1,he=y===1;let ae=le;ee&&(ae=Pe({inputs:{x:le},backend:i,attrs:{shape:[$,R,1]}}),k.push(ae));const pe=y===1?2:1;let _e=H;he&&(_e=Pe({inputs:{x:H},backend:i,attrs:{shape:[$,1,R]}}),k.push(_e));const Ee=nP({inputs:{a:ae,b:_e},backend:i});J=WC({inputs:{x:Ee},backend:i,attrs:{axis:pe,keepDims:!0}}),k.push(Ee)}else{const le=Ji(n.dtype,e.dtype),H=new N7(A,L,[$,g,y],t,s,z,Q,V,ne),ee=[O,N];if(r!=null&&ee.push(r),V&&ee.push(o),ne){const he=i.makeTensorInfo([],"float32",mc(a,"float32"));ee.push(he),k.push(he)}J=i.runWebGLProgram(H,ee,le)}const Z=Pe({inputs:{x:J},backend:i,attrs:{shape:I}});k.push(J);for(const le of k)i.disposeIntermediateTensorInfo(le);return Z}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fCe(n){const{inputs:e,backend:t,attrs:s}=n,{a:i,b:r,bias:o,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:h,leakyreluAlpha:f}=s;return AT({a:i,b:r,transposeA:l,transposeB:c,backend:t,bias:o,preluActivationWeights:a,leakyreluAlpha:f,activation:h})}const pCe={kernelName:c0,backendName:"webgl",kernelFunc:fCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vB="return abs(x);";function mCe(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const r=t.texData.get(s.dataId),o=w7(r.values);return t.makeTensorInfo(s.shape,s.dtype,o)}let i;return de().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new bu(s.shape,vB):i=new Pa(s.shape,vB),t.runWebGLProgram(i,[s],s.dtype)}const gCe={kernelName:sv,backendName:"webgl",kernelFunc:mCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yCe=Ro+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,bCe=Ot({opSnippet:yCe}),vCe={kernelName:km,backendName:"webgl",kernelFunc:bCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xCe=Ro+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,wCe=Ot({opSnippet:xCe}),_Ce={kernelName:Nm,backendName:"webgl",kernelFunc:wCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xB="return a + b;",TCe=si({opSnippet:xB,packedOpSnippet:xB,supportsComplex:!0,cpuKernelImpl:$Se}),SCe={kernelName:uf,backendName:"webgl",kernelFunc:TCe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ECe{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((r,o)=>`T${o}`);const s=[];this.variableNames.forEach(r=>{s.push(`float v${r} = get${r}AtOutCoords();`)});const i=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CCe{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((r,o)=>`T${o}`);const s=[];this.variableNames.forEach(r=>{s.push(`vec4 v${r} = get${r}AtOutCoords();`)});const i=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1(n){const{inputs:e,backend:t}=n,s=e;if(s.length===1)return wr({inputs:{x:s[0]},backend:t});if(s.length>de().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=R1({inputs:s.slice(0,l),backend:t}),h=R1({inputs:s.slice(l),backend:t});return R1({inputs:[c,h],backend:t})}const i=s.map(l=>l.dtype).reduce((l,c)=>Ji(l,c)),r=s.map(l=>l.shape),a=de().getBool("WEBGL_PACK")?new CCe(s[0].shape,r):new ECe(s[0].shape,r);return t.runWebGLProgram(a,s,i)}const ICe={kernelName:iv,backendName:"webgl",kernelFunc:R1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s,a=i.shape.length,l=gt(r,i.shape);let c=l;const h=On(c,a);let f=i;h!=null&&(f=Mi({inputs:{x:i},backend:t,attrs:{perm:h}}),c=Qn(c.length,a)),ti("all",c,a);const[p,g]=Ls(f.shape,c),y=ye(g),x=Pe({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}}),v=xf(x,x.dtype,"all",t);let w;if(o){const S=Xn(p,l);w=Pe({inputs:{x:v},backend:t,attrs:{shape:S}})}else w=Pe({inputs:{x:v},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),h!=null&&t.disposeIntermediateTensorInfo(f),w}const NCe={kernelName:$S,backendName:"webgl",kernelFunc:kCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ACe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s,a=i.shape.length,l=gt(r,i.shape);let c=l;const h=On(c,a);let f=i;h!=null&&(f=Mi({inputs:{x:i},backend:t,attrs:{perm:h}}),c=Qn(c.length,a)),ti("any",c,a);const[p,g]=Ls(f.shape,c),y=ye(g),x=Pe({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}}),v=xf(x,x.dtype,"any",t);let w;if(o){const S=Xn(p,l);w=Pe({inputs:{x:v},backend:t,attrs:{shape:S}})}else w=Pe({inputs:{x:v},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),h!=null&&t.disposeIntermediateTensorInfo(f),w}const RCe={kernelName:OS,backendName:"webgl",kernelFunc:ACe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DCe{constructor(e,t,s){this.variableNames=["A"];const{windowSize:i,batchSize:r,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[r,o];const a=t==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ce{constructor(e,t,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,B(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const r=e[e.length-1],o=Math.ceil(r/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),i||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=on(l),h=Ri("coords",l);let f,p;if(o===1){p=l+1;const N=on(p);f=`
        ${N} sourceLocR = ${N}(${h.join()}, 0);
        ++${h[l-1]};
        ${N} sourceLocG = ${N}(${h.join()}, 0);
        ++${h[l-2]};
        ${N} sourceLocA = ${N}(${h.join()}, 0);
        --${h[l-1]};
        ${N} sourceLocB = ${N}(${h.join()}, 0);
        --${h[l-2]};`}else p=l,f=`
        ${c} sourceLocR = coords;
        ++${h[l-1]};
        ${c} sourceLocG = coords;
        ++${h[l-2]};
        ${c} sourceLocA = coords;
        --${h[l-1]};
        ${c} sourceLocB = coords;
        --${h[l-2]};`;const g=["x","y","z","w","u","v"].slice(0,p),y="."+g[p-1],x=g.map(N=>"int "+N),v=Ri("sourceLocR",p-1).concat("inIdx.r"),w=Ri("sourceLocG",p-1).concat("inIdx.g"),S=Ri("sourceLocB",p-1).concat("inIdx.b"),C=Ri("sourceLocA",p-1).concat("inIdx.a"),I=s==="max"?"greaterThan":"lessThan",A=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${S.join()}),
                             getBestIndicesAChannel(${C.join()})));`,L=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${S.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${C.join()}) : 0.)`,O=i?"":`
      float getBestIndicesAChannel(${x.join()}) {
        return getChannel(getBestIndicesA(${g.join()}),
                                          vec2(${g.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${x.join()}) {
        return getChannel(getA(${g.join()}),
                               vec2(${g.slice(-2).join()}));
      }
      ${O}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${h[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${h[l-2]} < ${a[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${y}, sourceLocG${y},
          sourceLocB${y}, sourceLocA${y}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${L};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${A}
          vec4 candidate = ${L};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${I}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R7(n,e,t,s=null){let i=e.shape[0],r=e.shape[1];s!=null&&(i=s.shape[0],r=s.shape[1]);const o=EC(r),a={windowSize:o,inSize:r,batchSize:i,outSize:Math.ceil(r/o)},l=new DCe(a,t,s==null),c=[e];s!=null&&c.push(s);const h=n.runWebGLProgram(l,c,"int32");if(h.shape[1]===1)return h;const f=R7(n,e,t,h);return n.disposeIntermediateTensorInfo(h),f}function D7(n,e,t,s=null){const i=s!=null?s.shape:e.shape,r=i[i.length-1],o=EC(r),a=new $Ce(i,o,t,s==null),l=s==null?[e]:[e,s],c=n.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const h=D7(n,e,t,c);return n.disposeIntermediateTensorInfo(c),h}return c}function $7(n,e,t,s){const i=[t];if(ti("arg"+s.charAt(0).toUpperCase()+s.slice(1),i,e.shape.length),!de().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const r=[],o=n.texData.get(e.dataId),a=o!==null&&o.isPacked;let l=e;a&&(l=n.unpackTensor(e),r.push(l));const[c,h]=Ls(l.shape,i),f=ye(h),p=Pe({inputs:{x:l},backend:n,attrs:{shape:[-1,f]}});r.push(p);const g=R7(n,p,s);r.push(g);const y=Pe({inputs:{x:g},backend:n,attrs:{shape:c}});return r.forEach(x=>n.disposeIntermediateTensorInfo(x)),y}return D7(n,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r}=s;let o=gt(r,i.shape);const a=On(o,i.shape.length);let l=i;const c=[];a!=null&&(l=Mi({inputs:{x:i},backend:t,attrs:{perm:a}}),c.push(l),o=Qn(o.length,l.shape.length)),ti("argMax",[o[0]],l.shape.length);const h=$7(t,l,o[0],"max");return c.forEach(f=>t.disposeIntermediateTensorInfo(f)),h}const PCe={kernelName:rv,backendName:"webgl",kernelFunc:OCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r}=s;let o=gt(r,i.shape);const a=On(o,i.shape.length);let l=i;const c=[];a!=null&&(l=Mi({inputs:{x:i},backend:t,attrs:{perm:a}}),c.push(l),o=Qn(o.length,l.shape.length)),ti("argMin",[o[0]],l.shape.length);const h=$7(t,l,o[0],"min");return c.forEach(f=>t.disposeIntermediateTensorInfo(f)),h}const MCe={kernelName:ov,backendName:"webgl",kernelFunc:LCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FCe=Ro+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,VCe=Ot({opSnippet:FCe}),zCe={kernelName:Am,backendName:"webgl",kernelFunc:VCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BCe=Ro+"return log(x + sqrt(x * x + 1.0));",UCe=Ot({opSnippet:BCe}),WCe={kernelName:Rm,backendName:"webgl",kernelFunc:UCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HCe=Ro+`
  return atan(x);
`,jCe=Ot({opSnippet:HCe}),GCe={kernelName:Dm,backendName:"webgl",kernelFunc:jCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qCe=tP+`
  return atan(a, b);
`,KCe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+vf+`
  return result;
`,XCe=si({opSnippet:qCe,packedOpSnippet:KCe}),YCe={kernelName:Om,backendName:"webgl",kernelFunc:XCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QCe=Ro+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,ZCe=Ot({opSnippet:QCe}),JCe={kernelName:$m,backendName:"webgl",kernelFunc:ZCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C0{constructor(e,t,s,i=!1,r=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const x=t==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,w=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let S="0.0";if(x||(S="-1.0 / 1e-20"),s){const N=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${g}, ${y});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${h}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${N} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?r?v:w:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let I=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(I="avgValue / max(count, 1.0)");const A=Math.floor(o/4)*4,L=o%4,O=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${g}, ${y});
      const float initializationValue = ${S};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${S});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${A}; wC += 4) {
            int xC = xCCorner + wC * ${h};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              getValue(batch, xR, xC + 3 * ${h}, d)
            );

            ${O}
          }

          int xC = xCCorner + ${A};
          if (${L===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${O}
          } else if (${L===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              initializationValue,
              initializationValue
            );

            ${O}
          } else if (${L===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              initializationValue
            );

            ${O}
          }
        }
        setOutput(${I});
      }
    `}}class sP{constructor(e,t,s,i=!1,r=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,h=e.dilationDepth,f=e.dilationHeight,p=e.dilationWidth,g=e.effectiveFilterDepth,y=e.effectiveFilterHeight,x=e.effectiveFilterWidth,v=e.padInfo.front,w=e.padInfo.top,S=e.padInfo.left;this.outputShape=e.outShape;const C=t==="avg";let I="0.0";if(C||(I="-1.0 / 1e-20"),s){const $=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${v}, ${w}, ${S});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${g};
              wD += ${h}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${y};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${x};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${$} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?r?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${y} * ${x} +
                      wR * ${x} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const A="max";let L=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(L="avgValue / max(count, 1.0)");const O=Math.floor(o/4)*4,N=o%4,k=`
      if (${C}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${A}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${v}, ${w}, ${S});
      const float initializationValue = ${I};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${I});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${g};
            wD += ${h}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${y};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${O}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${k}
            }

            int xC = xCCorner + ${O};
            if (${N===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${N===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${N===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${k}
            }
          }
        }
        setOutput(${L});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eIe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e;Fx(i,"avgPool");const{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=s,c=1;B(ei(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=No(i.shape,r,o,c,a,l);if(h.filterWidth===1&&h.filterHeight===1&&_t(h.inShape,h.outShape))return wr({inputs:{x:i},backend:t});const f=new C0(h,"avg",!1);return t.runWebGLProgram(f,[i],"float32")}const tIe={kernelName:av,backendName:"webgl",kernelFunc:eIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nIe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{filterSize:r,strides:o,pad:a,dimRoundingMode:l,dataFormat:c}=s,h=[1,1,1],f=gc(i.shape,r,o,h,a,l,c),p=new sP(f,"avg",!1);return t.runWebGLProgram(p,[i],"float32")}const sIe={kernelName:lv,backendName:"webgl",kernelFunc:nIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iIe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,i=e.strideHeight,r=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,h=l-1-e.padInfo.top,f=c-1-e.padInfo.left,p=1/(t*s);this.userCode=`
      const ivec2 pads = ivec2(${h}, ${f});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class rIe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,i=e.filterWidth,r=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,y=f-1-e.padInfo.front,x=p-1-e.padInfo.top,v=g-1-e.padInfo.left,w=1/(t*s*i);this.userCode=`
      const ivec3 pads = ivec3(${y}, ${x}, ${v});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${r}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${g};
                wC += ${h}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oIe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,input:r}=e,o=r,{filterSize:a,strides:l,pad:c,dimRoundingMode:h}=s,f=[1,1,1],p=gc(o.shape,a,l,f,c,h),g=new rIe(p);return t.runWebGLProgram(g,[i],o.dtype)}const aIe={kernelName:LS,backendName:"webgl",kernelFunc:oIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lIe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,input:r}=e,o=r;Fx([i,r],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,h=No(o.shape,a,l,1,c),f=new iIe(h);return t.runWebGLProgram(f,[i],o.dtype)}const cIe={kernelName:PS,backendName:"webgl",kernelFunc:lIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uIe(n){const{inputs:e,backend:t,attrs:s}=n,{a:i,b:r}=e,{transposeA:o,transposeB:a}=s;return AT({a:i,b:r,transposeA:o,transposeB:a,backend:t})}const hIe={kernelName:cv,backendName:"webgl",kernelFunc:uIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dIe{constructor(e,t,s,i,r,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ot(e,t),ot(e,s);let a="0.0";i!=null&&(ot(e,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";r!=null&&(ot(e,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fIe{constructor(e,t,s,i,r,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ot(e,t),ot(e,s);let a="vec4(0.0)";i!=null&&(ot(e,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";r!=null&&(ot(e,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pIe=({inputs:n,backend:e,attrs:t})=>{const{x:s,mean:i,variance:r,offset:o,scale:a}=n;B(i.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const c=[s,i,r];let h=null;o!=null&&(h=o.shape,c.push(o));let f=null;a!=null&&(f=a.shape,c.push(a));const p=de().getBool("WEBGL_PACK_NORMALIZATION")?new fIe(s.shape,i.shape,r.shape,h,f,l):new dIe(s.shape,i.shape,r.shape,h,f,l);return e.runWebGLProgram(p,c,c[0].dtype)},mIe={kernelName:_v,backendName:"webgl",kernelFunc:pIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gIe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=on(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=yIe(this.rank);let i;const r=e.map((o,a)=>`sourceLoc.${HR[a]} = start[${a}] + coords.${HR[a]};`);i=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${r.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${s}));
      }
    `}}const HR=["x","y","z","w","u","v"];function yIe(n){if(n===1)return"sourceLoc";if(n<=6)return HR.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bIe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=on(this.rank),s=Ri("coords",this.rank),i=Ri("sourceLoc",this.rank),r=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,o=`getChannel(getSource(${i.join()}), ${r})`,a=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${o};
        --${i[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((h,f)=>`start[${f}]`).join()});`:e.map((h,f)=>`${i[f]} = ${s[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vIe(n,e,t,s){const i=s.texData.get(n.dataId),r=s.makeTensorInfo(t,n.dtype),o=s.texData.get(r.dataId);Object.assign(o,i),o.refCount=1,o.shape=t,o.dtype=n.dtype;let a=Y$(e,Ye(n.shape));i.slice&&(a+=i.slice.flatOffset),o.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||n.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),r}function Vg(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{begin:r,size:o}=s,[a,l]=SC(i,r,o);if(q$(i,a,l),ye(l)===0)return t.makeTensorInfo(l,i.dtype,[]);if(t.shouldExecuteOnCPU([i])||i.dtype==="string"){const f=t.texData.get(i.dataId),p=hEe(f.values,a,l,i.shape,i.dtype);return t.makeTensorInfo(l,i.dtype,p)}const{isPacked:c}=t.texData.get(i.dataId),h=X$(i.shape,a,l);if(c||!h){const f=de().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bIe(l):new gIe(l),p=[a];return t.runWebGLProgram(f,[i],i.dtype,p)}return t.uploadToGPU(i.dataId),vIe(i,a,l,t)}const xIe={kernelName:Qv,backendName:"webgl",kernelFunc:Vg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wIe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{blockShape:r,crops:o}=s;B(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=r.reduce((S,C)=>S*C),l=Ex(i.shape,r,a),c=Cx(l.length,r.length),h=Ix(i.shape,r,a),f=nO(o,r.length),p=sO(h,o,r.length),g=[],y=Pe({inputs:{x:i},backend:t,attrs:{shape:l}}),x=Mi({inputs:{x:y},backend:t,attrs:{perm:c}}),v=Pe({inputs:{x},backend:t,attrs:{shape:h}}),w=Vg({inputs:{x:v},backend:t,attrs:{begin:f,size:p}});return g.push(y),g.push(x),g.push(v),g.forEach(S=>t.disposeIntermediateTensorInfo(S)),w},_Ie={kernelName:uv,backendName:"webgl",kernelFunc:wIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TIe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,weights:r}=e,{size:o}=s,a=t.readSync(i.dataId),l=t.readSync(r.dataId),c=x7(a,l,r.dtype,r.shape,o);return t.makeTensorInfo([o],r.dtype,c)}const SIe={kernelName:MS,backendName:"webgl",kernelFunc:TIe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EIe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,CIe=`
  return float(int(a.r) & int(b.r));
`;function IIe(n){const{inputs:e,backend:t}=n,{a:s,b:i}=e,r=de().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=de().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([s,i])||o===1){const l=t.texData.get(s.dataId).values,c=t.texData.get(i.dataId).values,[h,f]=PSe(s.shape,i.shape,l,c,s.dtype),p=t.makeTensorInfo(f,s.dtype),g=t.texData.get(p.dataId);return g.values=h,p}let a;return r?a=new Mg(EIe,s.shape,i.shape,!1):a=new Kd(CIe,s.shape,i.shape),t.runWebGLProgram(a,[s,i],s.dtype)}const kIe={kernelName:hv,backendName:"webgl",kernelFunc:IIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NIe(n){const{inputs:e,backend:t}=n,{s0:s,s1:i}=e,r=t.readSync(s.dataId),o=t.readSync(i.dataId),a=ot(Array.from(r),Array.from(o));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const AIe={kernelName:FS,backendName:"webgl",kernelFunc:NIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RIe="return float(a != b);",O7=si({opSnippet:RIe,cpuKernelImpl:nEe,dtype:"bool"}),DIe={kernelName:Vv,backendName:"webgl",kernelFunc:O7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zx(n){const{inputs:e,backend:t}=n,{input:s}=e,i=t.texData.get(s.dataId);return wr({inputs:{x:i.complexTensorInfos.real},backend:t})}const $Ie={kernelName:bE,backendName:"webgl",kernelFunc:zx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OIe="return float(int(x));";function PIe(n,e){const t=new Pa(n.shape,OIe),s=e.runWebGLProgram(t,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jR(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{dtype:r}=s;if(r==="complex64"){if(i.dtype==="complex64")return wr({inputs:{x:i},backend:t});const o=qn(i.shape),a=jR({inputs:{x:i},backend:t,attrs:{dtype:"float32"}}),l=fh({inputs:{real:a,imag:o},backend:t});return o.dispose(),t.disposeIntermediateTensorInfo(a),l}if(i.dtype==="complex64"){const o=zx({inputs:{input:i},backend:t}),a=jR({inputs:{x:o},backend:t,attrs:{dtype:r}});return t.disposeIntermediateTensorInfo(o),a}if(!xD(i.dtype,r)){const o=wr({inputs:{x:i},backend:t});return{dataId:o.dataId,shape:o.shape,dtype:r}}if(t.shouldExecuteOnCPU([i])){const o=t.texData.get(i.dataId).values,[a,l,c]=LSe(o,i.shape,i.dtype,r);return t.makeTensorInfo(a,l,c)}if(r==="int32")return PIe(i,t);if(r==="bool"){const o=t.makeTensorInfo([],"bool",$s("bool",1)),l=O7({inputs:{a:i,b:o},backend:t});return t.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${r}`)}const LIe={kernelName:Pm,backendName:"webgl",kernelFunc:jR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wB="return ceil(x);",MIe=Ot({opSnippet:wB,packedOpSnippet:wB,cpuKernelImpl:MSe}),FIe={kernelName:Lm,backendName:"webgl",kernelFunc:MIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VIe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zIe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BIe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{clipValueMin:r,clipValueMax:o}=s;let a;de().getBool("WEBGL_PACK_CLIP")?a=new zIe(i.shape):a=new VIe(i.shape);const l=[[r],[o]];return t.runWebGLProgram(a,[i],i.dtype,l)}const UIe={kernelName:Mm,backendName:"webgl",kernelFunc:BIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WIe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _B(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function HIe(n){const{inputs:e,backend:t}=n,{x:s}=e,i=t.texData.get(s.dataId),r=new WIe(s.shape),o=[_B(s,i.complexTensorInfos.real),_B(s,i.complexTensorInfos.imag)];return t.runWebGLProgram(r,o,o[0].dtype)}const jIe={kernelName:dv,backendName:"webgl",kernelFunc:HIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GIe{constructor(e){this.outputShape=[],this.outputShape=za(e,1),this.variableNames=e.map((o,a)=>`T${a}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let o=1;o<t.length;o++)t[o]=t[o-1]+e[o][1];const s=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<t.length;o++){const a=t[o-1];s.push(`else if (yC < ${t[o]}) setOutput(getT${o}(yR, yC-${a}));`)}const i=t.length,r=t[t.length-1];s.push(`else setOutput(getT${i}(yR, yC-${r}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qIe{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=za(e,t);const s=this.outputShape,i=s.length,r=on(i),o=Ri("coords",i),a=["x","y","z","w","u","v"].slice(0,i);this.variableNames=e.map((x,v)=>`T${v}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let x=1;x<l.length;x++)l[x]=l[x-1]+e[x][t];const c=a[t],h=a.slice(-2),f=a.join();let p=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${h.join()}));
        }`;for(let x=1;x<l.length;x++){const v=l[x-1];p+=`
        if (${c} < ${l[x]}  && ${c} >= ${l[x-1]}) {
          return getChannel(
            getT${x}(${j_(a,c,v)}),
            vec2(${j_(h,c,v)}));
        }`}const g=l.length,y=l[l.length-1];p+=`
        return getChannel(
          getT${g}(${j_(a,c,y)}),
          vec2(${j_(h,c,y)}));`,this.userCode=`
      float getValue(${a.map(x=>"int "+x)}) {
        ${p}
      }

      void main() {
        ${r} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[i-1]} = ${o[i-1]} + 1;
        if (${o[i-1]} < ${s[i-1]}) {
          result.g = getValue(${o});
        }

        ${o[i-2]} = ${o[i-2]} + 1;
        if (${o[i-2]} < ${s[i-2]}) {
          result.a = getValue(${o});
        }

        ${o[i-1]} = ${o[i-1]} - 1;
        if (${o[i-2]} < ${s[i-2]} &&
            ${o[i-1]} < ${s[i-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function j_(n,e,t){const s=n.indexOf(e);return n.map((r,o)=>o===s?`${r} - ${t}`:r).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HC(n){const{inputs:e,backend:t}=n,{input:s}=e,i=t.texData.get(s.dataId);return wr({inputs:{x:i.complexTensorInfos.imag},backend:t})}const KIe={kernelName:iE,backendName:"webgl",kernelFunc:HC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ab(n,e,t){const s=n[0].dtype;if(s==="complex64"){const g=n.map(S=>zx({inputs:{input:S},backend:t})),y=n.map(S=>HC({inputs:{input:S},backend:t})),x=Ab(g,e,t),v=Ab(y,e,t),w=fh({inputs:{real:x,imag:v},backend:t});return g.forEach(S=>t.disposeIntermediateTensorInfo(S)),y.forEach(S=>t.disposeIntermediateTensorInfo(S)),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),w}let i=t.shouldExecuteOnCPU(n);if(s==="string"&&(i=!0),i){const g=n.map(I=>{const L=[-1,ye(I.shape.slice(e))];return Pe({inputs:{x:I},backend:t,attrs:{shape:L}})}),y=g.map(I=>({vals:t.readSync(I.dataId),shape:I.shape})),x=za(g.map(I=>I.shape),1),v=g[0].shape[0]===1,w=FSe(y,x,s,v),S=za(n.map(I=>I.shape),e),C=t.makeTensorInfo(S,s,w);return g.forEach(I=>t.disposeIntermediateTensorInfo(I)),C}const r=n.filter(g=>ye(g.shape)>0),o=de().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1;if(r.length===1){const g=o?new Pa(n[0].shape,hu):new bu(n[0].shape,hu);return t.runWebGLProgram(g,n,s)}const a=de().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(r.length>a){const g=[];for(let x=0;x<r.length;x+=a){const v=r.slice(x,x+a);g.push(Ab(v,e,t))}const y=Ab(g,e,t);for(const x of g)t.disposeIntermediateTensorInfo(x);return y}if(o){const g=new qIe(r.map(y=>y.shape),e);return t.runWebGLProgram(g,r,s)}const{tensors2D:l,outShape:c}=XIe(r,e,t),h=new GIe(l.map(g=>g.shape)),f=t.runWebGLProgram(h,l,s);l.forEach(g=>t.disposeIntermediateTensorInfo(g));const p=Pe({inputs:{x:f},attrs:{shape:c},backend:t});return t.disposeIntermediateTensorInfo(f),p}function XIe(n,e,t){const s=za(n.map(r=>r.shape),e);return{tensors2D:n.map(r=>Pe({inputs:{x:r},attrs:{shape:[-1,ye(r.shape.slice(e))]},backend:t})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(n){const{inputs:e,backend:t,attrs:s}=n,{axis:i}=s,r=gt(i,e[0].shape)[0],o=e.map(c=>c.shape);J$(o,r);const a=za(e.map(c=>c.shape),r);if(ye(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>ye(c.shape)>0);return l.length===1?wr({inputs:{x:l[0]},backend:t}):Ab(l,r,t)}const YIe={kernelName:fv,backendName:"webgl",kernelFunc:P7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L7{constructor(e,t=!1,s=null,i=!1,r=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,h=e.dilationHeight,f=e.dilationWidth,p=e.filterHeight,g=e.filterWidth,y=Math.floor(e.inChannels/4)*4,x=e.inChannels%4,v=e.dataFormat==="channelsLast",w=v?1:2,S=v?2:3,C=v?3:1;let I="",A="";s&&(i?I=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?I=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:I=`
          float activation(float x) {
            ${s}
          }
        `,A="result = activation(result);");const L=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${I}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${C}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${S}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${h};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${g}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${y}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${x===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${y}) *
                    getW(wR, wC, ${y}, d2);
              } else {
                dotProd +=
                    getX(batch, ${y}, xR, xC) *
                    getW(wR, wC, ${y}, d2);
              }

            } else if (${x===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${x===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2),
                getW(wR, wC, ${y} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1),
                  getX(batch, xR, xC, ${y} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC),
                  getX(batch, ${y} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${L}
        ${A}
        setOutput(result);
      }
    `}}class QIe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,s=e.padInfo.top,i=e.padInfo.left,r=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,h=e.dilationWidth,f=e.filterDepth,p=e.filterHeight,g=e.filterWidth,y=Math.floor(e.inChannels/4)*4,x=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${r}, ${o}, ${a});
      const ivec3 pads = ivec3(${t}, ${s}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${g}; wC++) {
              int xC = xCCorner + wC * ${h};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${y}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${x===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${y}) *
                  getW(wF, wR, wC, ${y}, d2);
              } else if (${x===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${x===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1),
                  getX(batch, xF, xR, xC, ${y} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2),
                  getW(wF, wR, wC, ${y} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M7{constructor(e,t=!1,s=null,i=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=gi(this.outputShape.length);const o=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,h=e.filterWidth,f=h;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<h;v++)p+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;p+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<h;v++)p+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(f+1)/2;v++){const w=v*2;if(p+=`
           xC = xCCorner + ${w*l};
           `,a===1){if(w<h&&(o%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,l===1&&w>0?p+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<h)){const S=o%2===0?RS(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${S};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:p+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):S===1?p+=`
                     xC${w+1} = xTexelC${w};
                     `:p+=`
                     xCOffset = xC + ${S};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<h&&(o%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<h&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<h&&(p+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<h&&(p+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<h&&(p+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let g="",y="";s&&(i?g=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:r?g=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:g=`vec4 activation(vec4 x) {
           ${s}
         }`,y="result = activation(result);");const x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${g}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${x}
         ${y}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZIe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=gi(this.outputShape.length);const{dataFormat:s}=t,i=zi(),r=s==="channelsLast",o=r?1:2,a=r?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let h=0;h<=1;h++)for(let f=0;f<=1;f++)c+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${h};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${r}) {
                  innerDims = vec2(d1, ch);
                  result[${h*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${h*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${i.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RT(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function F7({x:n,filter:e,convInfo:t,backend:s,bias:i=null,preluActivationWeights:r=null,leakyreluAlpha:o=0,activation:a=null}){const l=n.shape,c=s.texData.get(n.dataId),h=t.inChannels,f=l[0]*l[1]*l[2],p=t.outChannels,g=t.dataFormat==="channelsLast",y=!1,x=!1;let v;const w=[];if(r!=null){const I=RT(r.shape,g);I!=null&&(r=Pe({inputs:{x:r},backend:s,attrs:{shape:I}}),w.push(r))}if(i!=null){const I=RT(i.shape,g);I!=null&&(i=Pe({inputs:{x:i},backend:s,attrs:{shape:I}}),w.push(i))}if(!((f===1||p===1)&&h>A7)&&c.isPacked&&g&&c.texture!=null&&l[2]%2!==0&&_t(c.shape.slice(-3),l.slice(-3))){const I=l[0]*l[1]*(l[2]+1),A={dataId:n.dataId,shape:[1,I,t.inChannels],dtype:n.dtype},L=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,B(NT(c.shape,A.shape),()=>`packed reshape ${c.shape} to ${A.shape} isn't free`);const O=Pe({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}});w.push(O);const N=AT({a:A,b:O,backend:s,transposeA:y,transposeB:x,bias:i,activation:a,preluActivationWeights:r,leakyreluAlpha:o}),k=s.texData.get(N.dataId);B(k.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=L,k.shape=t.outShape,v=wr({inputs:{x:N},backend:s}),v.shape=t.outShape,w.push(N)}else{const I=t.outHeight*t.outWidth,A=Pe({inputs:{x:n},backend:s,attrs:{shape:g?[t.batchSize,I,t.inChannels]:[t.batchSize,t.inChannels,I]}}),L=Pe({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}}),O=AT({a:g?A:L,b:g?L:A,transposeA:!g,transposeB:x,backend:s,bias:i,activation:a,preluActivationWeights:r,leakyreluAlpha:o});v=Pe({inputs:{x:O},backend:s,attrs:{shape:t.outShape}}),w.push(A),w.push(L),w.push(O)}for(const I of w)s.disposeIntermediateTensorInfo(I);return v}function V7({x:n,filter:e,convInfo:t,backend:s,bias:i=null,preluActivationWeights:r=null,leakyreluAlpha:o=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:h,outWidth:f,outHeight:p,dataFormat:g}=t,y=g==="channelsLast",x=l*c*h,v=p*f,w=[t.batchSize,x,v],S=!0,C=!1,I=[];if(r!=null){const Z=RT(r.shape,y);Z!=null&&(r=Pe({inputs:{x:r},backend:s,attrs:{shape:Z}}),I.push(r))}if(i!=null){const Z=RT(i.shape,y);Z!=null&&(i=Pe({inputs:{x:i},backend:s,attrs:{shape:Z}}),I.push(i))}const A=Pe({inputs:{x:e},backend:s,attrs:{shape:[1,x,ye(e.shape)/x]}});I.push(A);const L=new ZIe(w,t),O=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],N=s.runWebGLProgram(L,[n],"float32",O),k=Pe({inputs:{x:N},backend:s,attrs:{shape:w}});I.push(N),I.push(k);const $=i!=null,R=r!=null,z=a==="leakyrelu",V=a?E0(a,!0):null,ne=new N7(y?k.shape:A.shape,y?A.shape:k.shape,y?[t.batchSize,v,t.outChannels]:[t.batchSize,t.outChannels,v],S,C,$,V,R,z),Q=y?[k,A]:[A,k];if(i&&Q.push(i),R&&Q.push(r),z){const Z=s.makeTensorInfo([],"float32",mc(o,"float32"));Q.push(Z),I.push(Z)}const G=s.runWebGLProgram(ne,Q,"float32"),J=Pe({inputs:{x:G},backend:s,attrs:{shape:t.outShape}});I.push(G);for(const Z of I)s.disposeIntermediateTensorInfo(Z);return J}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JIe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r}=e,{strides:o,pad:a,dataFormat:l,dilations:c,dimRoundingMode:h}=s,f=yc(l),p=Ps(i.shape,r.shape,o,c,a,h,!1,f);let g;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))g=F7({x:i,filter:r,convInfo:p,backend:t});else if(p.strideWidth<=2&&f==="channelsLast"&&de().getBool("WEBGL_EXP_CONV")){const x=new M7(p),v=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];g=t.runWebGLProgram(x,[i,r],"float32",v)}else if(de().getBool("WEBGL_CONV_IM2COL"))g=V7({x:i,filter:r,convInfo:p,backend:t});else{const x=new L7(p);g=t.runWebGLProgram(x,[i,r],"float32")}const y=Pe({inputs:{x:g},backend:t,attrs:{shape:p.outShape}});return t.disposeIntermediateTensorInfo(g),y}const eke={kernelName:pv,backendName:"webgl",kernelFunc:JIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,i=e.padInfo.top,r=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${i};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class nke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,i=e.strideHeight,r=e.strideWidth,o=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,l=s-1-e.padInfo.left,c=o?1:2,h=o?2:3,f=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${h}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ske{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,s=e.strideHeight,i=e.strideWidth,r=e.padInfo.front,o=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${r};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ike{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,i=e.filterWidth,r=e.strideDepth,o=e.strideHeight,a=e.strideWidth,l=t-1-e.padInfo.front,c=s-1-e.padInfo.top,h=i-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${r}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rke(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,dy:r}=e,{strides:o,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:h}=s,f=yc(l),p=Ps(i.shape,h,o,1,a,c,!1,f),g=new tke(p);return t.runWebGLProgram(g,[i,r],"float32")}const oke={kernelName:zS,backendName:"webgl",kernelFunc:rke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ake{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=gi(this.outputShape.length);const t=e.filterHeight,s=e.filterWidth,i=t-1-e.padInfo.top,r=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${r});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lke(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,filter:r}=e,{inputShape:o,strides:a,pad:l,dataFormat:c,dimRoundingMode:h}=s,f=yc(c),p=Ps(o,r.shape,a,1,l,h,!1,f);if(de().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){const g=[[p.strideHeight,p.strideWidth]],y=new ake(p);return t.runWebGLProgram(y,[i,r],"float32",g)}else{const g=new nke(p);return t.runWebGLProgram(g,[i,r],"float32")}}const cke={kernelName:mv,backendName:"webgl",kernelFunc:lke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uke(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r}=e,{strides:o,pad:a,dilations:l}=s,c=oh(i.shape,r.shape,o,l,a),h=new QIe(c);return t.runWebGLProgram(h,[i,r],"float32")}const hke={kernelName:gv,backendName:"webgl",kernelFunc:uke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dke(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,dy:r}=e,{strides:o,pad:a,filterShape:l}=s,c=oh(i.shape,l,o,1,a),h=new ske(c);return t.runWebGLProgram(h,[i,r],"float32")}const fke={kernelName:BS,backendName:"webgl",kernelFunc:dke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pke(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,filter:r}=e,{pad:o,strides:a,inputShape:l}=s,c=oh(l,r.shape,a,1,o),h=new ike(c);return t.runWebGLProgram(h,[i,r],"float32")}const mke={kernelName:US,backendName:"webgl",kernelFunc:pke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gke=Fg+`
  return cos(x);
`,yke=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${vf}
  return result;
`,bke=Ot({opSnippet:gke,packedOpSnippet:yke}),vke={kernelName:Fm,backendName:"webgl",kernelFunc:bke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xke=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,wke=Ot({opSnippet:xke}),_ke={kernelName:Vm,backendName:"webgl",kernelFunc:wke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tke{constructor(e,t,s,i,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,a,l,c]=e,[h]=t,[f,p]=s;this.outputShape=[h,f,p,c];const g=i==="bilinear"?1:0,[y,x]=[`${a-1}.0`,`${l-1}.0`],[v,w,S]=f>1?[`${(a-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${y} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${y}`],[C,I,A]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${x} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${x}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${C});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${I};

        float in_y = ${S};
        if( in_y < 0.0 || in_y > ${y} ) {
          setOutput(float(${r}));
          return;
        }
        float in_x = ${A};
        if( in_x < 0.0 || in_x > ${x} ) {
          setOutput(float(${r}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${g} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ske=n=>{const{inputs:e,backend:t,attrs:s}=n,{image:i,boxes:r,boxInd:o}=e,{cropSize:a,method:l,extrapolationValue:c}=s,h=new Tke(i.shape,r.shape,a,l,c);return t.runWebGLProgram(h,[i,r,o],"float32")},Eke={kernelName:HS,backendName:"webgl",kernelFunc:Ske};var I0;(function(n){n.Prod="*",n.Sum="+"})(I0||(I0={}));class TB{constructor(e,t,s,i){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const r=this.outputShape.length,o=this.op===I0.Prod?"1.0":"0.0",a=s?o:`getX(${SB(r,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",h="";s?(c=i?`end != ${l-1}`:"end != 0",h=i?"end + 1":"end - 1"):(c=i?`end + pow2 < ${l}`:"end >= pow2",h=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${on(r)} coords = getOutputCoords();
        int end = ${EB(r,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${h};
          ${EB(r,"coords",this.op)} = idx;
          val ${this.op}= getX(${SB(r,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function SB(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function EB(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(n,e,t,s,i,r){const o=e.shape.length,a=On([s],o);let l=e;a!=null&&(l=Mi({inputs:{x:e},backend:t,attrs:{perm:a}}));const c=Qn(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const h=l.shape[c];let f=wr({inputs:{x:l},backend:t});for(let p=0;p<=Math.ceil(Math.log2(h))-1;p++){const g=new TB(n,l.shape,!1,r),y=[[p]],x=f;f=t.runWebGLProgram(g,[f],f.dtype,y),t.disposeIntermediateTensorInfo(x)}if(i){const p=new TB(n,l.shape,i,r),g=f;f=t.runWebGLProgram(p,[f],f.dtype),t.disposeIntermediateTensorInfo(g)}if(a!=null){const p=ah(a),g=Mi({inputs:{x:f},backend:t,attrs:{perm:p}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(l),g}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,exclusive:o,reverse:a}=s;return z7(I0.Prod,i,t,r,o,a)}const Ike={kernelName:WS,backendName:"webgl",kernelFunc:Cke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kke(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,exclusive:o,reverse:a}=s;return z7(I0.Sum,i,t,r,o,a)}const Nke={kernelName:yv,backendName:"webgl",kernelFunc:kke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ake(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,weights:r}=e,{size:o,binaryOutput:a}=s;if(i.shape.length===1){const l=t.readSync(i.dataId),c=t.readSync(r.dataId),h=x7(l,c,r.dtype,r.shape,o);return t.makeTensorInfo([o],r.dtype,h)}else if(i.shape.length===2){const l=t.bufferSync(i),c=t.bufferSync(r),h=OSe(l,c,o,a);return t.makeTensorInfo(h.shape,r.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const Rke={kernelName:jS,backendName:"webgl",kernelFunc:Ake};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dke{constructor(e,t,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{blockSize:r,dataFormat:o}=s,a=i.shape[0],l=o==="NHWC"?i.shape[1]:i.shape[2],c=o==="NHWC"?i.shape[2]:i.shape[3],h=o==="NHWC"?i.shape[3]:i.shape[1],f=l*r,p=c*r,g=h/(r*r),y=o==="NHWC"?[a,f,p,g]:[a,g,f,p],x=new Dke(y,r,o);return t.runWebGLProgram(x,[i],i.dtype)}const Oke={kernelName:GS,backendName:"webgl",kernelFunc:$ke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B7{constructor(e,t=!1,s=null,i=!1,r=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=gi(this.outputShape.length);const o=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",h="";s&&(i?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,h="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U7{constructor(e,t=!1,s=null,i=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=gi(this.outputShape.length);const o=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=f;let g=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<f;w++)g+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;g+=`
    for (int r = 0; r < ${h}; r++) {
      `;for(let w=0;w<f;w++)g+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;g+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(p+1)/2;w++){const S=w*2;if(g+=`
          xC = xCCorner + ${S*c};
          `,l===1){if(S<f&&(a%2===1?(g+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }
              `,c===1&&S>0?g+=`
                xC${S} = vec4(xTexelC${S-2}.zw, xTexelC${S}.xy);
                `:g+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${S} = vec4(previous.zw, xTexelC${S}.xy);
                  } else {
                    xC${S} = vec4(0.0, 0.0, xTexelC${S}.xy);
                  }
                  `):g+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }

                xC${S} = xTexelC${S};
                `,S+1<f)){const C=a%2===0?RS(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(g+=`
                  xCOffset = xC + imod(pads[1], 2) + ${C};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                    xTexelC${S+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${S+1}.zw = vec2(0.0);
                    }
                    xTexelC${S+1}Ready = 1;
                  }
                  `,c>1?g+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${S+1} = vec4(previous.zw, xTexelC${S+1}.xy);
                    } else {
                     xC${S+1} = vec4(0.0, 0.0, xTexelC${S+1}.xy);
                    }
                    `:g+=`
                    xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.xy);
                    `):C===1?g+=`
                    xC${S+1} = xTexelC${S};
                    `:g+=`
                    xCOffset = xC + ${C};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                      xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${S+1}.zw = vec2(0.0);
                      }
                      xTexelC${S+1}Ready = 1;
                    }

                    xC${S+1} = xTexelC${S+1};
                    `}}else S<f&&(a%2===1?(g+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${S+1}Ready == 0) {
                  xTexelC${S+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${S+1}.zw = vec2(0.0);
                  }
                  xTexelC${S+1}Ready = 1;
                }

                xC${S} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
              `,S+1<f&&(g+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${S+1} = vec4(xTexelC${S+1}.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                  xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${S+1}.zw = vec2(0.);
                  }
                  xTexelC${S+1}Ready = 1;
                }

                xC${S} = vec4(
                  xTexelC${S}.xy, xTexelC${S+1}.xy);
              `,S+1<f&&(g+=`
                  xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
                `)));S<f&&(g+=`
            wTexel = getW(r, ${S}, d1, q);
            dotProd += xC${S} * vec4(wTexel.xz, wTexel.xz);
          `,S+1<f&&(g+=`
              wTexel = getW(r, ${S+1}, d1, q);
              dotProd += xC${S+1} * vec4(wTexel.xz, wTexel.xz);
            `))}g+=`
    }
  `,g+=`
      }
    `;let y="",x="";s&&(i?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:y=`vec4 activation(vec4 x) {
          ${s}
        }`,x="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${g}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pke(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r}=e,{strides:o,pad:a,dilations:l,dimRoundingMode:c}=s;let h=l;h==null&&(h=[1,1]),B(ei(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const f=Ps(i.shape,r.shape,o,h,a,c,!0);let p;de().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?p=new U7(f):p=new B7(f);const g=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return t.runWebGLProgram(p,[i,r],"float32",g)}const Lke={kernelName:bv,backendName:"webgl",kernelFunc:Pke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,i=e.padInfo.top,r=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${i};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Fke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,i=e.strideHeight,r=e.strideWidth,o=t-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vke(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,dy:r}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,filterShape:h}=s,f=Ps(i.shape,h,o,a,l,c,!0),p=new Mke(f);return t.runWebGLProgram(p,[i,r],"float32")}const zke={kernelName:qS,backendName:"webgl",kernelFunc:Vke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bke(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,filter:r}=e,{strides:o,dilations:a,pad:l,dimRoundingMode:c,inputShape:h}=s,f=Ps(h,r.shape,o,a,l,c,!0),p=new Fke(f);return t.runWebGLProgram(p,[i,r],"float32")}const Uke={kernelName:KS,backendName:"webgl",kernelFunc:Bke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wke{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hke(n){const{inputs:e,backend:t}=n,{x:s}=e,i=[...s.shape,...s.shape],r=ye(s.shape),o=Pe({inputs:{x:s},backend:t,attrs:{shape:[r]}}),a=new Wke(r),l=t.runWebGLProgram(a,[o],o.dtype),c=Pe({inputs:{x:l},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),c}const jke={kernelName:XS,backendName:"webgl",kernelFunc:Hke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gke{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:s,padInfo:i,strideHeight:r,strideWidth:o,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:h}=e,{top:f,left:p}=i;this.userCode=`
      const ivec2 strides = ivec2(${r}, ${o});
      const ivec2 pads = ivec2(${f}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${h};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qke(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r}=e,{strides:o,pad:a,dilations:l}=s,c=lx(i.shape,r.shape,o,a,"NHWC",l);let h;const f=new Gke(c);h=t.runWebGLProgram(f,[i,r],"float32");const p=Pe({inputs:{x:h},backend:t,attrs:{shape:c.outShape}});return t.disposeIntermediateTensorInfo(h),p}const Kke={kernelName:vv,backendName:"webgl",kernelFunc:qke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xke(n){const{inputs:e,backend:t,attrs:s}=n,{equation:i}=s,r=e,{allDims:o,summedDims:a,idDims:l}=hO(i,r.length);fO(o.length,l,r);const{path:c,steps:h}=pO(a,l),f=h.length;let p=null,g=o.length;const y=[];for(let x=0;x<f;++x){for(const v of h[x]){const{permutationIndices:w,expandDims:S}=dO(g,l[v]);let C;mO(w)?C=r[v]:(C=Mi({inputs:{x:r[v]},backend:t,attrs:{perm:w}}),y.push(C));const I=C.shape.slice();for(let A=0;A<S.length;++A)I.splice(S[A],0,1);_t(C.shape,I)||(C=Pe({inputs:{x:C},backend:t,attrs:{shape:I}}),y.push(C)),p===null?p=C:(p=nP({inputs:{a:C,b:p},backend:t}),y.push(p))}x<f-1&&(c[x]>=0&&(p=WC({inputs:{x:p},backend:t,attrs:{axis:c[x]-(o.length-g),keepDims:!1}}),y.push(p)),g--)}for(const x of y)x!==p&&t.disposeIntermediateTensorInfo(x);return p}const Yke={kernelName:QS,backendName:"webgl",kernelFunc:Xke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qke="return (x >= 0.0) ? x : (exp(x) - 1.0);",Zke=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Jke=Ot({opSnippet:Qke,packedOpSnippet:Zke}),eNe={kernelName:Bm,backendName:"webgl",kernelFunc:Jke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tNe="return (b >= 0.0) ? a : a * (b + 1.0);",nNe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,sNe=n=>{const{inputs:e,backend:t}=n,{dy:s,y:i}=e,r=de().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mg(nNe,s.shape,i.shape):new Kd(tNe,s.shape,i.shape);return t.runWebGLProgram(r,[s,i],s.dtype)},iNe={kernelName:ZS,backendName:"webgl",kernelFunc:sNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rNe=`
  return vec4(equal(a, b));
`,oNe="return float(a == b);",aNe=si({opSnippet:oNe,packedOpSnippet:rNe,dtype:"bool",cpuKernelImpl:VSe}),lNe={kernelName:xv,backendName:"webgl",kernelFunc:aNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cNe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${iO};
  float a1 = ${rO};
  float a2 = ${oO};
  float a3 = ${aO};
  float a4 = ${lO};
  float a5 = ${cO};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,uNe=Ot({opSnippet:cNe}),hNe={kernelName:Um,backendName:"webgl",kernelFunc:uNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dNe=Fg+`
  return exp(x);
`,fNe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,W7=Ot({opSnippet:dNe,packedOpSnippet:fNe,cpuKernelImpl:zSe,dtype:"float32"}),pNe={kernelName:Wm,backendName:"webgl",kernelFunc:W7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GR(n){const{inputs:e,attrs:t,backend:s}=n,{dim:i}=t,{input:r}=e,o=r.shape.length,a=r.shape.slice();let l=i;return i<0&&(B(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),a.splice(l,0,1),Pe({inputs:{x:r},backend:s,attrs:{shape:a}})}const mNe={kernelName:wv,backendName:"webgl",kernelFunc:GR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CB="return exp(x) - 1.0;",gNe=Ot({opSnippet:CB,packedOpSnippet:CB,cpuKernelImpl:BSe}),yNe={kernelName:Hm,backendName:"webgl",kernelFunc:gNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IB{constructor(e,t,s){this.variableNames=["real","imag"];const i=t[1];this.outputShape=t;const r=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${i}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${r};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H7(n,e,t){const s=t.texData.get(n.dataId),i=ye(n.shape),r=n.shape[n.shape.length-1],o=i/r,a=Pe({inputs:{x:n},backend:t,attrs:{shape:[o,r]}}),l=a.shape,c=new IB("real",l,e),h=new IB("imag",l,e),f=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],p=t.runWebGLProgram(c,f,"float32"),g=t.runWebGLProgram(h,f,"float32"),y=fh({inputs:{real:p,imag:g},backend:t});t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g);const x=Pe({inputs:{x:y},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(y),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bNe(n){const{inputs:e,backend:t}=n,{input:s}=e;return H7(s,!1,t)}const vNe={kernelName:JS,backendName:"webgl",kernelFunc:bNe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xNe{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bx(n){const{backend:e,attrs:t}=n,{shape:s,value:i}=t;let{dtype:r}=t;if(r=r||lf(i),r==="string"){const o=Vn(r,ye(s));return o.fill(i),e.makeTensorInfo(s,r,o)}else{const o=new xNe(s,i),a=[[i]];return e.runWebGLProgram(o,[],r,a)}}const wNe={kernelName:eE,backendName:"webgl",kernelFunc:Bx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ne{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TNe={kernelName:tE,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,s=e,i=new _Ne(t.shape);return s.runWebGLProgram(i,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kB="return floor(x);",SNe=Ot({opSnippet:kB,packedOpSnippet:kB,cpuKernelImpl:USe}),ENe={kernelName:jm,backendName:"webgl",kernelFunc:SNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CNe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,INe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,kNe=si({opSnippet:CNe,packedOpSnippet:INe,dtype:"int32"}),NNe={kernelName:Gm,backendName:"webgl",kernelFunc:kNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ANe{constructor(e){this.variableNames=["A"];const t=zi(),[s,i]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${s}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RNe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=zi(),[s,i]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${s}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DNe={kernelName:lT,backendName:"webgl",kernelFunc:$Ne};let gp,tA=de().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function $Ne(n){const{inputs:e,backend:t,attrs:s}=n;let{pixels:i}=e;const{numChannels:r}=s,o=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[l,c]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],h=[c,l],f=[c,l,r];if(a||o){const x=de().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(gp==null||x!==tA)&&(tA=x,gp=document.createElement("canvas").getContext("2d",{willReadFrequently:tA})),gp.canvas.width=l,gp.canvas.height=c,gp.drawImage(i,0,0,l,c),i=gp.canvas}const p=t.makeTensorInfo(h,"int32");t.texData.get(p.dataId).usage=Pr.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(p.dataId),i);const g=de().getBool("WEBGL_PACK")?new RNe(f):new ANe(f),y=t.runWebGLProgram(g,[p],"int32");return t.disposeData(p.dataId),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ONe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p,activation:g,leakyreluAlpha:y}=s,x=yc(h),v=Ps(i.shape,r.shape,l,f,c,p,!1,x);let w;const S=[],C=o!=null,I=a!=null,A=g==="leakyrelu",L=()=>{const N=[i,r],k=($,R)=>{if(R==="NCHW"&&$.shape.length===1&&$.shape[0]!==1){const z=Pe({inputs:{x:$},backend:t,attrs:{shape:[$.shape[0],1,1]}});return S.push(z),z}return $};if(C&&N.push(k(o,h)),I&&N.push(k(a,h)),A){const $=t.makeTensorInfo([],"float32",mc(y,"float32"));N.push($),S.push($)}return N};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))w=F7({x:i,filter:r,convInfo:v,backend:t,bias:o,activation:g,preluActivationWeights:a,leakyreluAlpha:y});else if(v.strideWidth<=2&&x==="channelsLast"&&de().getBool("WEBGL_EXP_CONV")){const N=g?E0(g,!0):null,k=new M7(v,C,N,I,A),$=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],R=L();w=t.runWebGLProgram(k,R,"float32",$)}else if(de().getBool("WEBGL_CONV_IM2COL"))w=V7({x:i,filter:r,convInfo:v,backend:t,bias:o,activation:g,preluActivationWeights:a,leakyreluAlpha:y});else{const N=g?E0(g,!1):null,k=new L7(v,C,N,I,A),$=L();w=t.runWebGLProgram(k,$,"float32")}const O=Pe({inputs:{x:w},backend:t,attrs:{shape:v.outShape}});return S.push(w),S.forEach(N=>t.disposeIntermediateTensorInfo(N)),O}const PNe={kernelName:u0,backendName:"webgl",kernelFunc:ONe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LNe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,filter:r,bias:o,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:h,dimRoundingMode:f,activation:p,leakyreluAlpha:g}=s,y=[];let x=h;x==null&&(x=[1,1]),B(ei(l,x),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${x}'`);const v=Ps(i.shape,r.shape,l,x,c,f,!0),w=de().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,S=p?E0(p,w):null,C=[i,r],I=o!=null,A=a!=null,L=p==="leakyrelu";if(I&&C.push(o),A&&C.push(a),L){const $=t.makeTensorInfo([],"float32",mc(g,"float32"));C.push($),y.push($)}let O;w?O=new U7(v,I,S,A,L):O=new B7(v,I,S,A,L);const N=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],k=t.runWebGLProgram(O,C,"float32",N);return y.forEach($=>t.disposeIntermediateTensorInfo($)),k}const MNe={kernelName:h0,backendName:"webgl",kernelFunc:LNe};class FNe{constructor(e,t,s,i){this.sliceDim=e,this.strides=t,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=s;const r=on(s.length);let o=`
    int index;`;for(let a=0;a<this.sliceDim;a++)o+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${r} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VNe(n){const{inputs:e,backend:t}=n,{params:s,indices:i}=e,r=i.shape,o=r[r.length-1],a=ye(s.shape),[l,c,h,f]=TC(s,i),p=Pe({inputs:{x:i},backend:t,attrs:{shape:[c,o]}}),g=Pe({inputs:{x:s},backend:t,attrs:{shape:[ye(s.shape)/h,h]}});if(t.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const w=t.readSync(i.dataId),S=t.bufferSync(s),C=WSe(w,S,s.dtype,c,o,h,f,s.shape,a);return t.makeTensorInfo(l,s.dtype,C.values)}const y=new FNe(o,f,[c,h],s.shape),x=t.runWebGLProgram(y,[g,p],g.dtype),v=Pe({inputs:{x},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(x),v}const zNe={kernelName:nE,backendName:"webgl",kernelFunc:VNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BNe{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const s=on(this.rank),i=UNe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}}function UNe(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let i=0;i<n.length;i++)i===2?s.push("index"):s.push(`${t[i]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j7(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,indices:r}=e,{axis:o,batchDims:a}=s,l=gt(o,i.shape)[0];if(de().get("DEBUG")){const S=t.readSync(r.dataId),C=i.shape[l];for(let I=0;I<S.length;++I){const A=S[I];B(A<=C-1&&A>=0,()=>`GatherV2: the index value ${A} is not in [0, ${C-1}]`)}}const c=yO(i,r,l,a),h=ye(r.shape),f=[],p=Pe({inputs:{x:i},backend:t,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),g=Pe({inputs:{x:r},backend:t,attrs:{shape:[c.batchSize,h/c.batchSize]}});f.push(p),f.push(g);const y=[c.batchSize,c.outerSize,h/c.batchSize,c.sliceSize];if(t.shouldExecuteOnCPU([i,r])||i.dtype==="string"){const S=t.bufferSync(g),C=t.bufferSync(p),I=HSe(C,S,y);return f.forEach(A=>t.disposeIntermediateTensorInfo(A)),t.makeTensorInfo(c.outputShape,I.dtype,I.values)}const x=new BNe(p.shape,y),v=t.runWebGLProgram(x,[p,g],p.dtype);f.push(v);const w=Pe({inputs:{x:v},backend:t,attrs:{shape:c.outputShape}});return f.forEach(S=>t.disposeIntermediateTensorInfo(S)),w}const WNe={kernelName:Tv,backendName:"webgl",kernelFunc:j7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HNe="return float(a > b);",jNe=`
  return vec4(greaterThan(a, b));
`,GNe=si({opSnippet:HNe,packedOpSnippet:jNe,cpuKernelImpl:jSe,dtype:"bool"}),qNe={kernelName:Sv,backendName:"webgl",kernelFunc:GNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KNe="return float(a >= b);",XNe=`
  return vec4(greaterThanEqual(a, b));
`,YNe=si({opSnippet:KNe,packedOpSnippet:XNe,dtype:"bool",cpuKernelImpl:GSe}),QNe={kernelName:qm,backendName:"webgl",kernelFunc:YNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZNe(n){const{inputs:e,backend:t}=n,{input:s}=e;return H7(s,!0,t)}const JNe={kernelName:sE,backendName:"webgl",kernelFunc:ZNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eAe="return float(!isnan(x) && !isinf(x));",tAe=Ot({opSnippet:eAe,dtype:"bool"}),nAe={kernelName:Xm,backendName:"webgl",kernelFunc:tAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sAe="return float(isinf(x));",iAe=Ot({opSnippet:sAe,dtype:"bool"}),rAe={kernelName:Ym,backendName:"webgl",kernelFunc:iAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oAe="return float(isnan(x));",aAe=Ot({opSnippet:oAe,dtype:"bool"}),lAe={kernelName:Qm,backendName:"webgl",kernelFunc:aAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cAe="return float(a < b);",uAe=`
  return vec4(lessThan(a, b));
`,hAe=si({opSnippet:cAe,packedOpSnippet:uAe,cpuKernelImpl:qSe,dtype:"bool"}),dAe={kernelName:Cv,backendName:"webgl",kernelFunc:hAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fAe="return float(a <= b);",pAe=`
  return vec4(lessThanEqual(a, b));
`,mAe=si({opSnippet:fAe,packedOpSnippet:pAe,cpuKernelImpl:KSe,dtype:"bool"}),gAe={kernelName:Iv,backendName:"webgl",kernelFunc:mAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yAe(n){const{backend:e,attrs:t}=n,{start:s,stop:i,num:r}=t,o=XSe(s,i,r);return e.makeTensorInfo([o.length],"float32",o)}const bAe={kernelName:rE,backendName:"webgl",kernelFunc:yAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vAe=Fg+`
  return x < 0.0 ? 0./0. : log(x);
`,xAe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,wAe=Ot({opSnippet:vAe,packedOpSnippet:xAe,cpuKernelImpl:YSe}),_Ae={kernelName:Zm,backendName:"webgl",kernelFunc:wAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TAe=Fg+`
  return log(1.0 + x);
`,SAe=Ot({opSnippet:TAe}),EAe={kernelName:Jm,backendName:"webgl",kernelFunc:SAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CAe="return float(a >= 1.0 && b >= 1.0);",IAe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,kAe=si({opSnippet:CAe,packedOpSnippet:IAe,dtype:"bool"}),NAe={kernelName:kv,backendName:"webgl",kernelFunc:kAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AAe="return float(!(x >= 1.0));",RAe=Ot({opSnippet:AAe}),DAe={kernelName:Nv,backendName:"webgl",kernelFunc:RAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ae="return float(a >= 1.0 || b >= 1.0);",OAe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,PAe=si({opSnippet:$Ae,packedOpSnippet:OAe,dtype:"bool"}),LAe={kernelName:Av,backendName:"webgl",kernelFunc:PAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MAe{constructor(e,t,s,i,r){this.variableNames=["x"],this.outputShape=[];const o=t,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${i}) * sum`;r===.5?l=`inversesqrt(${c})`:r===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FAe{constructor(e,t,s,i,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=t,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${i}) * sum`;r===.5?l=`inversesqrt(${c})`:r===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VAe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{depthRadius:r,bias:o,alpha:a,beta:l}=s,c=de().getBool("WEBGL_PACK_NORMALIZATION")?new FAe(i.shape,r,o,a,l):new MAe(i.shape,r,o,a,l);return t.runWebGLProgram(c,[i],i.dtype)},zAe={kernelName:Rv,backendName:"webgl",kernelFunc:VAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BAe{constructor(e,t,s,i,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=s,this.alpha=i,this.beta=r,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${r})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${r});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UAe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:i,y:r,dy:o}=e,{depthRadius:a,bias:l,alpha:c,beta:h}=s,f=new BAe(i.shape,a,l,c,h);return t.runWebGLProgram(f,[i,r,o],i.dtype)},WAe={kernelName:oE,backendName:"webgl",kernelFunc:UAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HAe(n,e,t,s){const i=ye(e),o=ye(n.shape)/i,a=Pe({inputs:{x:n},attrs:{shape:[o,i]},backend:s}),l=xf(a,n.dtype,"max",s),c=Pe({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{reductionIndices:r,keepDims:o}=s,a=i.shape.length,l=gt(r,i.shape);let c=l;const h=On(c,a),f=h!=null,p=t.shouldExecuteOnCPU([i]);let g=i;if(f){if(p){const C=t.texData.get(g.dataId).values,I=new Array(a);for(let O=0;O<I.length;O++)I[O]=i.shape[h[O]];const A=eP(C,i.shape,i.dtype,h,I);g=t.makeTensorInfo(I,i.dtype);const L=t.texData.get(g.dataId);L.values=A}else g=UC(i,h,t);c=Qn(c.length,a)}ti("max",c,a);const[y,x]=Ls(g.shape,c);let v=y;o&&(v=Xn(y,l));let w;if(p){const C=t.texData.get(g.dataId).values,I=QSe(C,ye(x),v,i.dtype);w=t.makeTensorInfo(v,i.dtype);const A=t.texData.get(w.dataId);A.values=I}else w=HAe(g,x,v,t);return f&&t.disposeIntermediateTensorInfo(g),w}const jAe={kernelName:Dv,backendName:"webgl",kernelFunc:G7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GAe=tP+`
  return max(a, b);
`,qAe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+vf+`
  return result;
`,KAe=si({opSnippet:GAe,packedOpSnippet:qAe,cpuKernelImpl:ZSe}),XAe={kernelName:eg,backendName:"webgl",kernelFunc:KAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YAe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e;Fx(i,"maxPool");const{filterSize:r,strides:o,pad:a,dimRoundingMode:l}=s,c=1;B(ei(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=No(i.shape,r,o,c,a,l);if(h.filterWidth===1&&h.filterHeight===1&&_t(h.inShape,h.outShape))return wr({inputs:{x:i},backend:t});const f=new C0(h,"max",!1);return t.runWebGLProgram(f,[i],i.dtype)}const QAe={kernelName:$v,backendName:"webgl",kernelFunc:YAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZAe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{filterSize:r,strides:o,pad:a,dataFormat:l,dimRoundingMode:c}=s,h=[1,1,1],f=gc(i.shape,r,o,h,a,c,l),p=new sP(f,"max",!1);return t.runWebGLProgram(p,[i],i.dtype)}const JAe={kernelName:Ov,backendName:"webgl",kernelFunc:ZAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eRe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,s=e.strideWidth,i=e.dilationHeight,r=e.effectiveFilterHeight,o=e.effectiveFilterWidth,a=r-1-e.padInfo.top,l=o-1-e.padInfo.left,c=r*o-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${r};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class tRe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,s=e.strideHeight,i=e.strideWidth,r=e.dilationDepth,o=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=l-1-e.padInfo.front,p=c-1-e.padInfo.top,g=h-1-e.padInfo.left,y=l*c*h-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${p}, ${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${r}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${y} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${h} +
                  wR * ${h} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nRe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,input:r}=e,o=r,{filterSize:a,strides:l,pad:c,dimRoundingMode:h}=s,f=[1,1,1],p=gc(o.shape,a,l,f,c,h),g=new sP(p,"max",!0),y=t.runWebGLProgram(g,[o],o.dtype),x=new tRe(p),v=t.runWebGLProgram(x,[i,y],o.dtype);return t.disposeIntermediateTensorInfo(y),v}const sRe={kernelName:lE,backendName:"webgl",kernelFunc:nRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iRe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:i,input:r,output:o}=e,a=r;Fx([r,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:h,dimRoundingMode:f}=s,p=No(a.shape,l,c,1,h,f),g=!0,y=new C0(p,"max",g),x=t.runWebGLProgram(y,[a],a.dtype),v=new eRe(p),w=t.runWebGLProgram(v,[i,x],a.dtype);return t.disposeIntermediateTensorInfo(x),w}const rRe={kernelName:aE,backendName:"webgl",kernelFunc:iRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oRe(n,e,t,s){let i=new C0(t,"max",!1);const r=s.runWebGLProgram(i,[n],"float32");i=new C0(t,"max",!0,!0,e);const o=s.runWebGLProgram(i,[n],"float32");return[r,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aRe={kernelName:cE,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:i,strides:r,pad:o,includeBatchInIndex:a}=e,l=t;B(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];B(ei(r,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${r} and dilations '${c}'`);const h=No(s.shape,i,r,c,o),[f,p]=oRe(s,a,h,l);return[f,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lRe(n,e,t,s){const i=ye(e),o=ye(n.shape)/i,a=Pe({inputs:{x:n},attrs:{shape:[o,i]},backend:s}),l=xf(a,"float32","mean",s),c=Pe({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cRe={kernelName:Pv,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{keepDims:i,axis:r}=e,o=t,a=s.shape.length,l=gt(r,s.shape);let c=l;const h=On(c,a),f=h!=null,p=o.shouldExecuteOnCPU([s]),g=[];let y=s;if(f){if(p){const I=o.texData.get(y.dataId).values,A=new Array(a);for(let N=0;N<A.length;N++)A[N]=s.shape[h[N]];const L=eP(I,s.shape,s.dtype,h,A);y=o.makeTensorInfo(A,s.dtype);const O=o.texData.get(y.dataId);O.values=L}else y=UC(s,h,o);g.push(y),c=Qn(c.length,a)}ti("sum",c,a);const[x,v]=Ls(y.shape,c);let w=x;i&&(w=Xn(x,l));const S=lRe(y,v,w,o);for(const C of g)o.disposeIntermediateTensorInfo(C);return S}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uRe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s,a=i.shape.length,l=gt(r,i.shape);let c=l;const h=On(c,a);let f=i;h!=null&&(f=Mi({inputs:{x:i},backend:t,attrs:{perm:h}}),c=Qn(c.length,i.shape.length)),ti("min",c,a);const[p,g]=Ls(f.shape,c),y=ye(g),x=Pe({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}}),v=xf(x,x.dtype,"min",t);let w;if(o){const S=Xn(p,l);w=Pe({inputs:{x:v},backend:t,attrs:{shape:S}})}else w=Pe({inputs:{x:v},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),h!=null&&t.disposeIntermediateTensorInfo(f),w}const hRe={kernelName:Lv,backendName:"webgl",kernelFunc:uRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dRe=tP+`
  return min(a, b);
`,fRe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+vf+`
  return result;
`,pRe=si({opSnippet:dRe,packedOpSnippet:fRe,cpuKernelImpl:JSe}),mRe={kernelName:tg,backendName:"webgl",kernelFunc:pRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gRe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=t.map((h,f)=>h[0]+e[f]+h[1]);const i=e.length,r=on(i),o=t.map(h=>h[0]).join(","),a=t.map((h,f)=>h[0]+e[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),c=s==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${o});
      ${r} end = ${r}(${a});

      void main() {
        ${r} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${r} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yRe{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((y,x)=>y[0]+e[x]+y[1]);const i=e.length,r=on(i),o=t.map(y=>y[0]).join(","),a=t.map((y,x)=>y[0]+e[x]).join(","),l=Ri("rc",i),c=Ri("source",i),h=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${c.slice(-2).join()})`,p=s==="reflect"?0:1;let g="";if(i===1){const y=`
        ${r} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;g=`
        ${r} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${c.join()}), ${f});
        ${l[i-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${c.join()}), ${f});
        }
      `}else{const y=`
        ${r} source = rc;
        ${r} lt = ${r}(lessThan(source, start));
        ${r} gte = ${r}(greaterThanEqual(source, end));
        ${r} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;g=`
        ${r} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${c.join()}), ${f});
        ${l[i-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${c.join()}), ${f});
        }
        rc = outputLoc;
        ${l[i-2]} += 1;
        if(${l[i-2]} < ${this.outputShape[i-2]}) {
          ${y}
          result[2] = getChannel(getX(${c.join()}), ${f});
          ${l[i-1]} += 1;
          if(${h}) {
            ${y}
            result[3] = getChannel(getX(${c.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${r} start = ${r}(${o});
      const ${r} end = ${r}(${a});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bRe=({inputs:n,backend:e,attrs:t})=>{const{x:s}=n,{paddings:i,mode:r}=t,o=de().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new yRe(s.shape,i,r):new gRe(s.shape,i,r);return e.runWebGLProgram(o,[s],s.dtype)},vRe={kernelName:Mv,backendName:"webgl",kernelFunc:bRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xRe=`if (b == 0.0) return NAN;
  return mod(a, b);`,wRe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+vf+`
  return result;
`,_Re=si({opSnippet:xRe,packedOpSnippet:wRe}),TRe={kernelName:ng,backendName:"webgl",kernelFunc:_Re};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SRe{constructor(e,t,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ERe=`
if (a == b) {
  return 1.0;
};
return a / b;`,CRe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,q7=si({opSnippet:ERe,packedOpSnippet:CRe,checkOutOfBounds:!0}),IRe={kernelName:zm,backendName:"webgl",kernelFunc:q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NB="return a - b;",K7=si({opSnippet:NB,packedOpSnippet:NB,supportsComplex:!0,cpuKernelImpl:xEe}),kRe={kernelName:bg,backendName:"webgl",kernelFunc:K7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(n){const{inputs:e,backend:t,attrs:s}=n,{logits:i}=e,{dim:r}=s,o=gt([r],i.shape),a=G7({inputs:{x:i},backend:t,attrs:{reductionIndices:o,keepDims:!1}}),l=Xn(a.shape,o),c=Pe({inputs:{x:a},backend:t,attrs:{shape:l}}),h=K7({inputs:{a:i,b:c},backend:t}),f=W7({inputs:{x:h},backend:t}),p=WC({inputs:{x:f},backend:t,attrs:{axis:o,keepDims:!1}}),g=Pe({inputs:{x:p},backend:t,attrs:{shape:l}}),y=q7({inputs:{a:f,b:g},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(g),y}const NRe={kernelName:tx,backendName:"webgl",kernelFunc:X7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ARe(n){const{inputs:e,backend:t,attrs:s}=n,{logits:i}=e,{numSamples:r,seed:o,normalized:a}=s,l=a?i:X7({inputs:{logits:i},backend:t,attrs:{dim:i.shape.length-1}}),c=l.shape[0],h=l.shape[1],f=new SRe(c,h,r),p=[[o]],g=t.runWebGLProgram(f,[l],"int32",p);return a||t.disposeIntermediateTensorInfo(l),g}const RRe={kernelName:uE,backendName:"webgl",kernelFunc:ARe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DRe=Ro+`
  return -x;
`,$Re=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function ORe(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])){const r=t.texData.get(s.dataId),[o,a]=tEe(r.values,s.shape,s.dtype);return t.makeTensorInfo(a,s.dtype,o)}let i;return de().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new bu(s.shape,$Re):i=new Pa(s.shape,DRe),t.runWebGLProgram(i,[s],s.dtype)}const PRe={kernelName:Fv,backendName:"webgl",kernelFunc:ORe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LRe=vC;function MRe(n){Dr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:i,scores:r}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l}=s,c=t.readSync(i.dataId),h=t.readSync(r.dataId),{selectedIndices:f}=LRe(c,h,o,a,l);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const FRe={kernelName:hE,backendName:"webgl",kernelFunc:MRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VRe=xC;function zRe(n){Dr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:i,scores:r}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,h=t.readSync(i.dataId),f=t.readSync(r.dataId),{selectedIndices:p,validOutputs:g}=VRe(h,f,o,a,l,c);return[t.makeTensorInfo([p.length],"int32",new Int32Array(p)),t.makeTensorInfo([],"int32",new Int32Array([g]))]}const BRe={kernelName:dE,backendName:"webgl",kernelFunc:zRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const URe=wC;function WRe(n){Dr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:i,scores:r}=e,{maxOutputSize:o,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,h=t.readSync(i.dataId),f=t.readSync(r.dataId),p=o,g=a,y=l,x=c,{selectedIndices:v,selectedScores:w}=URe(h,f,p,g,y,x);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const HRe={kernelName:fE,backendName:"webgl",kernelFunc:WRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jRe{constructor(e,t,s,i){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GRe=n=>{const{inputs:e,backend:t,attrs:s}=n,{indices:i}=e,{dtype:r,depth:o,onValue:a,offValue:l}=s,c=ye(i.shape),h=new jRe(c,o,a,l),f=Pe({inputs:{x:i},backend:t,attrs:{shape:[c]}}),p=t.runWebGLProgram(h,[f],r);t.disposeIntermediateTensorInfo(f);const g=[...i.shape,o],y=Pe({inputs:{x:p},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(p),y},qRe={kernelName:Bv,backendName:"webgl",kernelFunc:GRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DT(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="complex64"){const i=zx({inputs:{input:s},backend:t}),r=DT({inputs:{x:i},backend:t}),o=HC({inputs:{input:s},backend:t}),a=DT({inputs:{x:o},backend:t}),l=fh({inputs:{real:r,imag:a},backend:t});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return Bx({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:t})}const KRe={kernelName:rx,backendName:"webgl",kernelFunc:DT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const i=zx({inputs:{input:s},backend:t}),r=Y7({inputs:{x:i},backend:t}),o=HC({inputs:{input:s},backend:t}),a=DT({inputs:{x:o},backend:t}),l=fh({inputs:{real:r,imag:a},backend:t});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(a),l}else return Bx({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:t})}const XRe={kernelName:zv,backendName:"webgl",kernelFunc:Y7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YRe(n){const{inputs:e,backend:t,attrs:s}=n,{axis:i}=s;if(e.length===1)return GR({inputs:{input:e[0]},backend:t,attrs:{dim:i}});const r=e[0].shape,o=e[0].dtype;e.forEach(h=>{Js(r,h.shape,"All tensors passed to stack must have matching shapes"),B(o===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(h=>{const f=GR({inputs:{input:h},backend:t,attrs:{dim:i}});return a.push(f),f}),c=P7({inputs:l,backend:t,attrs:{axis:i}});return a.forEach(h=>t.disposeIntermediateTensorInfo(h)),c}const QRe={kernelName:Uv,backendName:"webgl",kernelFunc:YRe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZRe{constructor(e,t,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((c,h)=>c[0]+e[h]+c[1]);const i=e.length,r=on(i),o=t.map(c=>c[0]).join(","),a=t.map((c,h)=>c[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${o};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${o});
      ${r} end = ${r}(${a});

      void main() {
        ${r} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${r} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JRe{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((x,v)=>x[0]+e[v]+x[1]);const i=e.length,r=on(i),o=t.map(x=>x[0]).join(","),a=t.map((x,v)=>x[0]+e[v]).join(","),l=Ri("rc",i),c=Ri("source",i),h=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${c.slice(-2).join()})`,p=[`${r} rc = outputLoc;`,`${l[i-1]} += 1;
       if(${h}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${l[i-2]} += 1;
       if(${l[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${l[i-1]} += 1;
         if(${h}) {`],g=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let y="";for(let x=0,v=i===1?2:4;x<v;x++)y+=`
        ${p[x]}
        if (${g}) {
          result[${x}] = float(value);
        } else {
          ${r} source = rc - start;
          result[${x}] = getChannel(getX(${c.join()}), ${f});
        }
      `;y+=i===1?"} ":"}}",this.userCode=`
      const ${r} start = ${r}(${o});
      const ${r} end = ${r}(${a});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q7=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{paddings:r,constantValue:o}=s;if(ye(i.shape)===0){const c=r.map((h,f)=>h[0]+i.shape[f]+h[1]);return Bx({backend:t,attrs:{shape:c,value:o,dtype:i.dtype}})}const a=de().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new JRe(i.shape,r,o):new ZRe(i.shape,r,o),l=[[o]];return t.runWebGLProgram(a,[i],i.dtype,l)},e2e={kernelName:Wv,backendName:"webgl",kernelFunc:Q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t2e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n2e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+vf+`
  return result;
`,s2e=si({opSnippet:t2e,packedOpSnippet:n2e}),i2e={kernelName:ig,backendName:"webgl",kernelFunc:s2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{axis:r,keepDims:o}=s,a=i.shape.length,l=[],c=gt(r,i.shape);let h=c;const f=On(h,a);let p=i;f!=null&&(p=Mi({inputs:{x:i},backend:t,attrs:{perm:f}}),h=Qn(h.length,a),l.push(p)),ti("prod",h,a);let g;if(t.shouldExecuteOnCPU([p])){const y=t.texData.get(p.dataId).values,{outVals:x,outShape:v,outDtype:w}=sEe(p.shape,p.dtype,y,h);g=t.makeTensorInfo(v,w,x)}else{const[y,x]=Ls(p.shape,h),v=ye(x),w=Pe({inputs:{x:p},backend:t,attrs:{shape:[-1,v]}}),S=VE(i.dtype),C=xf(w,S,"prod",t);g=Pe({inputs:{x:C},backend:t,attrs:{shape:y}}),l.push(w),l.push(C)}if(o){l.push(g);const y=Xn(g.shape,c);g=Pe({inputs:{x:g},backend:t,attrs:{shape:y}})}return l.forEach(y=>t.disposeIntermediateTensorInfo(y)),g}const o2e={kernelName:jv,backendName:"webgl",kernelFunc:r2e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a2e(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:i,paramsDenseValues:r,indices:o}=e,{outputRaggedRank:a}=s,l=i.map(w=>t.readSync(w.dataId)),c=i.map(w=>w.shape),h=t.readSync(r.dataId),f=t.readSync(o.dataId),[p,g,y]=iEe(l,c,h,r.shape,r.dtype,f,o.shape,a),x=p.map(w=>t.makeTensorInfo([w.length],"int32",w)),v=t.makeTensorInfo(y,r.dtype,g);return x.concat([v])}const l2e={kernelName:pE,backendName:"webgl",kernelFunc:a2e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c2e(n){const{inputs:e,backend:t}=n,{starts:s,limits:i,deltas:r}=e,o=t.readSync(s.dataId),a=t.readSync(i.dataId),l=t.readSync(r.dataId),[c,h]=rEe(o,s.shape,s.dtype,a,i.shape,l,r.shape),f=t.makeTensorInfo([c.length],"int32",c),p=t.makeTensorInfo([h.length],s.dtype,h);return[f,p]}const u2e={kernelName:mE,backendName:"webgl",kernelFunc:c2e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2e(n){const{inputs:e,backend:t,attrs:s}=n,{shape:i,values:r,defaultValue:o,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=t.readSync(i.dataId),h=t.readSync(r.dataId),f=t.readSync(o.dataId),p=a.map(v=>t.readSync(v.dataId)),g=a.map(v=>v.shape),[y,x]=oEe(c,i.shape,h,r.shape,r.dtype,f,o.shape,p,g,l);return t.makeTensorInfo(y,r.dtype,x)}const d2e={kernelName:gE,backendName:"webgl",kernelFunc:h2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z7=n=>{const{backend:e,attrs:t}=n,{start:s,stop:i,step:r,dtype:o}=t,a=aEe(s,i,r,o);return e.makeTensorInfo([a.length],o,a)},f2e={kernelName:yE,backendName:"webgl",kernelFunc:Z7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p2e="return 1.0 / x;",m2e=Ot({opSnippet:p2e}),g2e={kernelName:rg,backendName:"webgl",kernelFunc:m2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y2e=Ro+`
  return (x < 0.0) ? 0.0 : x;
`,b2e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,v2e=Ot({opSnippet:y2e,packedOpSnippet:b2e}),x2e={kernelName:og,backendName:"webgl",kernelFunc:v2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2e=Ro+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,_2e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,T2e=Ot({opSnippet:w2e,packedOpSnippet:_2e}),S2e={kernelName:ag,backendName:"webgl",kernelFunc:T2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E2e{constructor(e,t,s,i,r){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,t,s,c];const h=[i&&t>1?a-1:a,i&&s>1?l-1:l],f=[i&&t>1?t-1:t,i&&s>1?s-1:s];let p;r?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/f[0]},
          ${h[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C2e{constructor(e,t,s,i,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,t,s,c];const h=[i&&t>1?a-1:a,i&&s>1?l-1:l],f=[i&&t>1?t-1:t,i&&s>1?s-1:s];let p;r?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/f[0]},
          ${h[1]/f[1]},
          ${h[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2e(n){const{inputs:e,backend:t,attrs:s}=n,{images:i}=e,{alignCorners:r,halfPixelCenters:o,size:a}=s,[l,c]=a,h=de().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new C2e(i.shape,l,c,r,o):new E2e(i.shape,l,c,r,o);return t.runWebGLProgram(h,[i],"float32")}const k2e={kernelName:Kv,backendName:"webgl",kernelFunc:I2e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N2e{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,i,r]=t,[,o,a]=e,l=[s&&o>1?i-1:i,s&&a>1?r-1:r],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],h=l[0]/c[0],f=l[1]/c[1],p=1/h,g=1/f,y=Math.ceil(p)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${f});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${y});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${r-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A2e(n){const{inputs:e,backend:t,attrs:s}=n,{images:i,dy:r}=e,{alignCorners:o}=s,a=new N2e(r.shape,i.shape,o);return t.runWebGLProgram(a,[r],r.dtype)}const R2e={kernelName:xE,backendName:"webgl",kernelFunc:A2e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D2e{constructor(e,t,s,i,r){this.variableNames=["A"],this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,t,s,c];const h=[i&&t>1?a-1:a,i&&s>1?l-1:l],f=[i&&t>1?t-1:t,i&&s>1?s-1:s],p=i?"0.5":"0.0";let g;r?g="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/f[0]},
          ${h[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $2e{constructor(e,t,s,i,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,a,l,c]=e;this.outputShape=[o,t,s,c];const h=[i&&t>1?a-1:a,i&&s>1?l-1:l],f=[i&&t>1?t-1:t,i&&s>1?s-1:s],p=i?"0.5":"0.0";let g;r?g="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/f[0]},
          ${h[1]/f[1]},
          ${h[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O2e(n){const{inputs:e,backend:t,attrs:s}=n,{images:i}=e,{alignCorners:r,halfPixelCenters:o,size:a}=s,[l,c]=a,h=de().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new $2e(i.shape,l,c,r,o):new D2e(i.shape,l,c,r,o);return t.runWebGLProgram(h,[i],i.dtype)}const P2e={kernelName:qv,backendName:"webgl",kernelFunc:O2e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L2e{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,i,r]=t,[,o,a]=e,l=[s&&o>1?i-1:i,s&&a>1?r-1:r],c=[s&&o>1?o-1:o,s&&a>1?a-1:a],h=l[0]/c[0],f=l[1]/c[1],p=1/h,g=1/f,y=Math.ceil(p)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${f});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${y});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(n){const{inputs:e,backend:t,attrs:s}=n,{images:i,dy:r}=e,{alignCorners:o}=s,a=new L2e(r.shape,i.shape,o);return t.runWebGLProgram(a,[r],r.dtype)}const F2e={kernelName:vE,backendName:"webgl",kernelFunc:M2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V2e{constructor(e,t){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const i=a=>t.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,r=e.map((a,l)=>i(l)).join(","),o=on(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${r}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z2e{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const i=Ri("rc",s),r=`${i[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${i[s-2]} + 1 < ${this.outputShape[s-2]}`,a=on(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${r}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(i.slice())};
          if(${r}){
            result.g = ${c(i.slice())};
          }
          if(${o}) {
            result.b = ${h(i.slice())};
            if(${r}) {
              result.a = ${f(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(y){return p(y)}function c(y){return y[s-1]="("+y[s-1]+" + 1)",p(y)}function h(y){return y[s-2]="("+y[s-2]+" + 1)",p(y)}function f(y){return y[s-1]="("+y[s-1]+" + 1)",y[s-2]="("+y[s-2]+" + 1)",p(y)}function p(y){const x=e.map((S,C)=>g(C,y)),v=x.join(","),w=x.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${w}))`}function g(y,x){return t.indexOf(y)!==-1&&e[y]!==1?`${e[y]} - ${x[y]} - 1`:`${x[y]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B2e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{dims:r}=s,o=i.shape.length,a=gt(r,i.shape);if(o===0)return wr({inputs:{x:i},backend:t});const l=de().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new z2e(i.shape,a):new V2e(i.shape,a);return t.runWebGLProgram(l,[i],i.dtype)}const U2e={kernelName:Xv,backendName:"webgl",kernelFunc:B2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W2e{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],i=e[2];this.outputShape=e;let r="";typeof t=="number"?r=`float outputValue = ${t.toFixed(2)};`:r=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${r}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H2e={kernelName:ME,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:i,fillValue:r,center:o}=e,a=t,l=new W2e(s.shape,r),[c,h]=tO(o,s.shape[1],s.shape[2]),f=[[c,h,Math.sin(i),Math.cos(i)]];return a.runWebGLProgram(l,[s],s.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j2e=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,G2e=Ot({opSnippet:j2e}),q2e={kernelName:lg,backendName:"webgl",kernelFunc:G2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K2e="return inversesqrt(x);",X2e=Ot({opSnippet:K2e,cpuKernelImpl:lEe}),Y2e={kernelName:cg,backendName:"webgl",kernelFunc:X2e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iP{constructor(e,t,s,i,r,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const c=on(r.length),h=on(o.length);let f="";s===1?f="i":s===2&&(f="i, j");const p=`getIndices(${f})`;let g="";i===1?g="i":i===2&&(g="i, coords[1]");const y=`getUpdates(${g})`;let x="";l&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,w=t>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${r});

        void main() {
          ${h} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${y};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q2e{constructor(e,t,s,i,r,o,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const c=on(r.length),h=on(o.length);let f="";s===1?f="i":s===2&&(f="i, j");const p=`getIndices(${f})`;let g="";i===1?g="i":i===2&&(g="i, coords[1]");const y=`getUpdates(${g})`;let x="";l&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,w=t>1?"strides[j]":"strides",S=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${r});

        void main() {
          ${h} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${p});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${S};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${y};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z2e(n){const{inputs:e,backend:t,attrs:s}=n,{indices:i,updates:r}=e,{shape:o}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:h,outputSize:f}=uh(r,i,o),p=[f/c,c];if(f===0)return t.makeTensorInfo(o,i.dtype);const g=Pe({inputs:{x:i},backend:t,attrs:{shape:[l,a]}}),y=Pe({inputs:{x:r},backend:t,attrs:{shape:[l,c]}}),x=t.makeTensorInfo([],"float32",new Float32Array([0]));let v;de().getBool("WEBGL_PACK")?v=new Q2e(l,a,g.shape.length,y.shape.length,h,p):v=new iP(l,a,g.shape.length,y.shape.length,h,p);const w=t.runWebGLProgram(v,[y,g,x],y.dtype),S=Pe({inputs:{x:w},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),S}const J2e={kernelName:wE,backendName:"webgl",kernelFunc:Z2e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eDe{constructor(e,t,s,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const r="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,a=de().getNumber("WEBGL_VERSION")===2?r:o,l=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tDe(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:i,values:r}=e,{side:o}=s,a=new eDe(i.shape[0],i.shape[1],r.shape[1],o),l=[[i.shape[1]]];return t.runWebGLProgram(a,[i,r],"int32",l)}const nDe={kernelName:TE,backendName:"webgl",kernelFunc:tDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sDe{constructor(e,t,s){this.variableNames=["c","a","b"],this.outputShape=t;let i,r;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)r="resRC",i="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let h=0;h<t.length;h++)c.push(`${a[h]}`),h<e&&l.push(`${a[h]}`);i=l.join(),r=c.join()}const o=on(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${r}));
        } else {
          setOutput(getB(${r}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iDe(n){const{inputs:e,backend:t}=n,{condition:s,t:i,e:r}=e,o=new sDe(s.shape.length,i.shape,i.shape.length);return t.runWebGLProgram(o,[s,i,r],Ji(i.dtype,r.dtype))}const rDe={kernelName:Yv,backendName:"webgl",kernelFunc:iDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oDe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${CC};
  float scale = ${IC};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,aDe=Ot({opSnippet:oDe}),lDe={kernelName:ug,backendName:"webgl",kernelFunc:aDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cDe=Fg+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,uDe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,hDe=Ot({opSnippet:cDe,packedOpSnippet:uDe,cpuKernelImpl:uEe}),dDe={kernelName:pg,backendName:"webgl",kernelFunc:hDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fDe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,pDe=Ot({opSnippet:fDe}),mDe={kernelName:fg,backendName:"webgl",kernelFunc:pDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gDe=Fg+`
  return sin(x);
`,yDe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${vf}
  return result;
`,bDe=Ot({opSnippet:gDe,packedOpSnippet:yDe}),vDe={kernelName:hg,backendName:"webgl",kernelFunc:bDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xDe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,wDe=Ot({opSnippet:xDe}),_De={kernelName:dg,backendName:"webgl",kernelFunc:wDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TDe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,SDe=Ot({opSnippet:TDe}),EDe={kernelName:mg,backendName:"webgl",kernelFunc:SDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CDe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{blockShape:r,paddings:o}=s;B(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=r.reduce((w,S)=>w*S),l=[[0,0]];l.push(...o);for(let w=1+r.length;w<i.shape.length;++w)l.push([0,0]);const c=[],h=Q7({inputs:{x:i},backend:t,attrs:{paddings:l,constantValue:0}}),f=Ex(h.shape,r,a,!1),p=Cx(f.length,r.length,!1),g=Ix(h.shape,r,a,!1),y=Pe({inputs:{x:h},backend:t,attrs:{shape:f}}),x=Mi({inputs:{x:y},backend:t,attrs:{perm:p}}),v=Pe({inputs:{x},backend:t,attrs:{shape:g}});return c.push(h),c.push(y),c.push(x),c.forEach(w=>t.disposeIntermediateTensorInfo(w)),v},IDe={kernelName:Jv,backendName:"webgl",kernelFunc:CDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kDe(n){const{inputs:e,backend:t}=n,{indices:s,values:i,denseShape:r,defaultValue:o}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const a=t.readSync(s.dataId),l=t.readSync(i.dataId),c=t.readSync(r.dataId),h=t.readSync(o.dataId)[0],[f,p,g,y,x]=dEe(a,s.shape,s.dtype,l,i.dtype,c,h);return[t.makeTensorInfo(p,s.dtype,f),t.makeTensorInfo([p[0]],i.dtype,g),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),t.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const NDe={kernelName:SE,backendName:"webgl",kernelFunc:kDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ADe(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:i,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const o=Array.from(t.readSync(i.dataId)),a=t.readSync(s.dataId),l=Array.from(t.readSync(r.dataId)),[c,h,f]=fEe(a,s.shape,s.dtype,o,l);return[t.makeTensorInfo(h,s.dtype,c),t.makeTensorInfo([f.length],r.dtype,new Int32Array(f))]}const RDe={kernelName:EE,backendName:"webgl",kernelFunc:ADe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DDe(n){const{inputs:e,backend:t}=n,{data:s,indices:i,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${r.shape}`);const o=t.readSync(s.dataId),a=t.readSync(i.dataId),l=t.readSync(r.dataId),[c,h]=_7(o,s.shape,s.dtype,a,l,!0);return t.makeTensorInfo(h,s.dtype,c)}const $De={kernelName:CE,backendName:"webgl",kernelFunc:DDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ODe(n){const{inputs:e,backend:t}=n,{data:s,indices:i,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${r.shape}`);const o=t.readSync(s.dataId),a=t.readSync(i.dataId),l=t.readSync(r.dataId),[c,h]=_7(o,s.shape,s.dtype,a,l);return t.makeTensorInfo(h,s.dtype,c)}const PDe={kernelName:IE,backendName:"webgl",kernelFunc:ODe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LDe(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:i,sparseValues:r,defaultValue:o}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:h,strides:f,outputSize:p}=uh(r,i,a),g=!1;if(r.dtype==="string"){const w=t.bufferSync(i),S=t.bufferSync(r),C=tc(t.readSync(o.dataId)[0]),I=cEe(w,S,a,p,h,c,l,f,C,g);return t.makeTensorInfo(a,I.dtype,I.values)}const y=new iP(c,l,i.shape.length,r.shape.length,f,[p,1],g),x=t.runWebGLProgram(y,[r,i,o],r.dtype),v=Pe({inputs:{x},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(x),v}const MDe={kernelName:kE,backendName:"webgl",kernelFunc:LDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FDe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{numOrSizeSplits:r,axis:o}=s,a=gt(o,i.shape)[0],l=gO(i,r,a),c=i.shape.length,h=new Array(c).fill(0),f=i.shape.slice();return l.map(p=>{const g=[...f];g[a]=p;const y=Vg({inputs:{x:i},backend:t,attrs:{begin:h,size:g}});return h[a]+=p,y})}const VDe={kernelName:ex,backendName:"webgl",kernelFunc:FDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AB="return sqrt(x);",zDe=Ot({opSnippet:AB,packedOpSnippet:AB,cpuKernelImpl:pEe}),BDe={kernelName:gg,backendName:"webgl",kernelFunc:zDe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UDe="return x * x;",WDe=Ot({opSnippet:UDe}),HDe={kernelName:NE,backendName:"webgl",kernelFunc:WDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RB="return (a - b) * (a - b);",jDe=si({opSnippet:RB,packedOpSnippet:RB}),GDe={kernelName:yg,backendName:"webgl",kernelFunc:jDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qDe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");const r=t.readSync(i.dataId),o=rc(r),a=mEe(o,"string",s);return t.makeTensorInfo(i.shape,"string",a)}const KDe={kernelName:nx,backendName:"webgl",kernelFunc:qDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XDe({inputs:n,attrs:e,backend:t}){const{x:s}=n,i=Ro+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,r=new Pa(s.shape,i);return t.runWebGLProgram(r,[s],s.dtype)}const YDe={kernelName:_g,backendName:"webgl",kernelFunc:XDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QDe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=s;const i=s.length,r=on(s.length),o=on(s.length);let a="";if(i===1)a="coords * strides + begin";else{let l=0;a=s.map((c,h)=>(l++,s.length===1?`coords * strides[${h}] + begin[${h}]`:`coords[${l-1}] * strides[${h}] + begin[${h}]`)).join(",")}this.userCode=`
      ${r} begin = ${r}(${e});
      ${r} strides = ${r}(${t});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZDe(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{begin:r,end:o,strides:a,beginMask:l,endMask:c,ellipsisMask:h,newAxisMask:f,shrinkAxisMask:p}=s,{finalShapeSparse:g,finalShape:y,isIdentity:x,sliceDim0:v,isSimpleSlice:w,begin:S,end:C,strides:I}=Q$(i.shape,r,o,a,l,c,h,f,p);let A;if(x)A=Pe({inputs:{x:i},backend:t,attrs:{shape:y}});else if(v||w){B(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const O=K$(S,C,I),N=Vg({inputs:{x:i},backend:t,attrs:{begin:S,size:O}});A=Pe({inputs:{x:N},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(N)}else if(t.shouldExecuteOnCPU([i])){const N=t.readSync(i.dataId),k=ut(i.shape,i.dtype,N),$=gEe(g,k,I,S);A=t.makeTensorInfo(y,i.dtype,$.values)}else{const N=new QDe(S,I,g);A=t.runWebGLProgram(N,[i],i.dtype)}const L=Pe({inputs:{x:A},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo(A),L}const JDe={kernelName:AE,backendName:"webgl",kernelFunc:ZDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e$e(n){const{inputs:e,backend:t,attrs:s}=n,{separator:i,nGramWidths:r,leftPad:o,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:h,dataSplits:f}=e,p=t.readSync(h.dataId),g=t.readSync(f.dataId),[y,x]=yEe(p,g,i,r,o,a,l,c);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(f.shape,"int32",x)]}const t$e={kernelName:RE,backendName:"webgl",kernelFunc:e$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n$e(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:i}=s,{input:r,delimiter:o}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const a=t.readSync(r.dataId),l=t.readSync(o.dataId)[0],[c,h,f]=bEe(a,l,i),p=h.length;return[t.makeTensorInfo([p,2],"int32",c),t.makeTensorInfo([p],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const s$e={kernelName:DE,backendName:"webgl",kernelFunc:n$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i$e(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:i}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=t.readSync(r.dataId),a=vEe(o,i);return t.makeTensorInfo(r.shape,"int32",a)}const r$e={kernelName:$E,backendName:"webgl",kernelFunc:i$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o$e="return tan(x);",a$e=Ot({opSnippet:o$e}),l$e={kernelName:vg,backendName:"webgl",kernelFunc:a$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c$e=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,u$e=Ot({opSnippet:c$e}),h$e={kernelName:xg,backendName:"webgl",kernelFunc:u$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d$e(n){const{inputs:e,backend:t,attrs:s}=n,{tensor:i,indices:r,updates:o}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:h,outputSize:f}=uh(o,r,i.shape),p=[f/c,c];if(f===0)return t.makeTensorInfo(i.shape,r.dtype);const g=Pe({inputs:{x:r},backend:t,attrs:{shape:[l,a]}}),y=Pe({inputs:{x:o},backend:t,attrs:{shape:[l,c]}}),x=Pe({inputs:{x:i},backend:t,attrs:{shape:p}}),v=new iP(l,a,g.shape.length,y.shape.length,h,p,!1,!0),w=t.runWebGLProgram(v,[y,g,x],x.dtype),S=Pe({inputs:{x:w},backend:t,attrs:{shape:i.shape}});return t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(w),S}const f$e={kernelName:_E,backendName:"webgl",kernelFunc:d$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p$e{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*t[o];this.outputShape=s,this.rank=s.length;const i=on(this.rank),r=m$e(e);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${r}));
      }
    `}}function m$e(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let i=0;i<n.length;i++)s.push(`imod(${t[i]}, ${n[i]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J7(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{reps:r}=s;if(i.dtype==="string"||i.shape.length>5){const l=t.readSync(i.dataId),c=i.dtype==="string"?l.map(p=>tc(p)):l,h=ut(i.shape,i.dtype,c),f=wEe(h,r);return t.makeTensorInfo(f.shape,f.dtype,f.values)}const o=new p$e(i.shape,r);return t.runWebGLProgram(o,[i],i.dtype)}const g$e={kernelName:wg,backendName:"webgl",kernelFunc:J7};class y$e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class b$e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zh(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function DB(n){let e=1;for(;e<n;)e*=2;return e}function v$e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i}=e,{k:r,sorted:o}=s,a=de().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=de().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=i.shape,h=c[c.length-1];if(t.shouldExecuteOnCPU([i])||h<a||r>l){const $=t.readSync(i.dataId),[R,z]=_Ee($,c,i.dtype,r,o);return[t.makeTensorInfo(R.shape,R.dtype,R.values),t.makeTensorInfo(z.shape,z.dtype,z.values)]}if(r===0)return c[c.length-1]=0,[t.makeTensorInfo(c,i.dtype,[]),t.makeTensorInfo(c,"int32",[])];if(h===1)return[i,Bx({attrs:{shape:c,dtype:"int32",value:0},backend:t})];const f=t.texData.get(i.dataId),p=f!==null&&f.isPacked,g=p?t.unpackTensor(i):i,x=ye(c)/h,v=Pe({inputs:{x:g},attrs:{shape:[x,h]},backend:t});p&&Zh(t,g);const w=DB(r),S=DB(h);let C=null;const I=()=>C===null?[v,v]:[v,C],A=($,R,z)=>{const V=I(),ne=new y$e(z),G=[[h],[C===null?1:0],[Number.NEGATIVE_INFINITY],[$],[R]],J=C;C=t.runWebGLProgram(ne,V,"int32",G),Zh(t,J)};for(let $=1;$<w;$*=2){const R=$*2;for(let z=$;z>=1;z/=2)A(R,z,[x,S])}for(let $=S;$>w;$/=2){const R=I(),z=new b$e([x,$/2]),ne=[[h],[C===null?1:0],[w]],Q=C;C=t.runWebGLProgram(z,R,"int32",ne),Zh(t,Q);const G=w/2,J=G*2;for(let Z=G;Z>=1;Z/=2)A(J,Z,C.shape)}let L=C;C=Vg({inputs:{x:C},backend:t,attrs:{begin:0,size:[x,r]}}),Zh(t,L);let O=j7({inputs:{x:v,indices:C},backend:t,attrs:{axis:1,batchDims:1}});Zh(t,v);const N=c.slice(0,-1);N.push(r),L=C,C=Pe({inputs:{x:C},attrs:{shape:N},backend:t}),Zh(t,L);const k=O;return O=Pe({inputs:{x:O},attrs:{shape:N},backend:t}),Zh(t,k),[O,C]}const x$e={kernelName:OE,backendName:"webgl",kernelFunc:v$e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w$e{constructor(e,t,s,i,r,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const a=s==="nearest"?1:2;let l;switch(i){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${r});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${r});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _$e(n){const{inputs:e,backend:t,attrs:s}=n,{image:i,transforms:r}=e,{interpolation:o,fillMode:a,fillValue:l,outputShape:c}=s,[h,f,p,g]=i.shape,[y,x]=c??[f,p],v=[h,y,x,g],w=new w$e(f,p,o,a,l,v);return t.runWebGLProgram(w,[i,r],"float32")}const T$e={kernelName:PE,backendName:"webgl",kernelFunc:_$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S$e(n){const{inputs:e,attrs:t,backend:s}=n,{axis:i}=t,{x:r}=e;Fx(r,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(r.dataId),{outputValues:a,outputShape:l,indices:c}=TEe(o,i,r.shape,r.dtype);return[s.makeTensorInfo(l,r.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const E$e={kernelName:LE,backendName:"webgl",kernelFunc:S$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C$e(n){const{inputs:e,backend:t,attrs:s}=n,{value:i}=e;let{axis:r}=s;r<0&&(r+=i.shape.length);const o=i,a=o.shape.length,l=i.shape[r],c=new Array(a-1);let h=0;for(let x=0;x<a;x++)x!==r&&(c[h++]=o.shape[x]);const f=[],p=new Array(a).fill(0),g=o.shape.slice();g[r]=1;const y=new Array(l);for(let x=0;x<y.length;x++){p[r]=x;const v=Vg({inputs:{x:o},backend:t,attrs:{begin:p,size:g}}),w=Pe({inputs:{x:v},backend:t,attrs:{shape:c}});y[x]=w,f.push(v)}return f.forEach(x=>t.disposeIntermediateTensorInfo(x)),y}const I$e={kernelName:sx,backendName:"webgl",kernelFunc:C$e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k$e{constructor(e,t){this.variableNames=["x","segmentIds"];const s=e.windowSize,i=e.batchSize,r=e.inSize,o=e.numSegments,a=o*Math.ceil(r/s);this.outputShape=[i,a];const l="0.0",c="sumValue",h=Math.floor(s/4)*4,f=s%4,p=`
        sumValue += dot(values, segFilter);
    `;let g="";r%s>0&&(g=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `);let y="";r%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${y}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${h};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N$e(n){const{inputs:e,backend:t,attrs:s}=n,{x:i,segmentIds:r}=e,{numSegments:o}=s,a=i.shape.length,l=[];let c=0;const h=On([c],a);let f=i;h!=null&&(f=Mi({inputs:{x:i},backend:t,attrs:{perm:h}}),l.push(f),c=Qn(1,a)[0]);const p=AG(f.shape,c,o),g=ye([f.shape[c]]),y=Pe({inputs:{x:f},backend:t,attrs:{shape:[-1,g]}});l.push(y);const x=VE(i.dtype),v=(I,A,L,O,N)=>{const k=I.shape[0],$=I.shape[1],R=NG($,N),z={windowSize:R,inSize:$,batchSize:k,numSegments:N},V=new k$e(z,A),ne=t.compileAndRun(V,[I,L],O);if(l.push(ne),ne.shape[1]===N)return ne;const Q=Z7({backend:t,attrs:{start:0,stop:N,step:1,dtype:"float32"}}),G=J7({inputs:{x:Q},backend:t,attrs:{reps:[$/R]}});return l.push(Q),l.push(G),v(ne,A,G,O,N)},w=v(y,"unsortedSegmentSum",r,x,o),S=Pe({inputs:{x:w},backend:t,attrs:{shape:p}});let C=S;if(h!=null){l.push(S);const I=ah(h);C=Mi({inputs:{x:C},backend:t,attrs:{perm:I}})}return l.forEach(I=>t.disposeIntermediateTensorInfo(I)),C}const A$e={kernelName:ix,backendName:"webgl",kernelFunc:N$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R$e=[pCe,gCe,vCe,_Ce,SCe,ICe,NCe,RCe,PCe,MCe,zCe,WCe,GCe,YCe,JCe,tIe,sIe,aIe,cIe,hIe,mIe,_Ie,SIe,kIe,AIe,LIe,FIe,UIe,QEe,jIe,YIe,eke,oke,cke,hke,fke,mke,vke,_ke,Eke,Ike,Nke,Rke,Oke,Lke,zke,Uke,jke,Kke,Yke,eNe,iNe,lNe,hNe,pNe,mNe,yNe,vNe,wNe,TNe,ENe,NNe,DNe,PNe,MNe,zNe,WNe,qNe,QNe,YEe,JNe,KIe,nAe,rAe,lAe,JEe,dAe,gAe,bAe,_Ae,EAe,NAe,DAe,LAe,zAe,WAe,jAe,XAe,QAe,JAe,sRe,rRe,aRe,cRe,hRe,mRe,vRe,TRe,RRe,nCe,PRe,FRe,BRe,HRe,DIe,qRe,XRe,QRe,e2e,i2e,tCe,o2e,l2e,u2e,d2e,f2e,$Ie,IRe,g2e,x2e,S2e,iCe,k2e,R2e,P2e,F2e,U2e,H2e,q2e,Y2e,J2e,nDe,rDe,lDe,dDe,mDe,vDe,_De,xIe,NRe,EDe,IDe,NDe,RDe,$De,PDe,MDe,VDe,BDe,HDe,GDe,KDe,YDe,JDe,t$e,s$e,r$e,kRe,hCe,l$e,h$e,f$e,g$e,x$e,T$e,dCe,E$e,I$e,A$e,KRe];for(const n of R$e)FE(n);function eK(n,e){return function(){return n.apply(e,arguments)}}const{toString:D$e}=Object.prototype,{getPrototypeOf:rP}=Object,jC=(n=>e=>{const t=D$e.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),la=n=>(n=n.toLowerCase(),e=>jC(e)===n),GC=n=>e=>typeof e===n,{isArray:zg}=Array,k0=GC("undefined");function $$e(n){return n!==null&&!k0(n)&&n.constructor!==null&&!k0(n.constructor)&&Vr(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const tK=la("ArrayBuffer");function O$e(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&tK(n.buffer),e}const P$e=GC("string"),Vr=GC("function"),nK=GC("number"),qC=n=>n!==null&&typeof n=="object",L$e=n=>n===!0||n===!1,D1=n=>{if(jC(n)!=="object")return!1;const e=rP(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},M$e=la("Date"),F$e=la("File"),V$e=la("Blob"),z$e=la("FileList"),B$e=n=>qC(n)&&Vr(n.pipe),U$e=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Vr(n.append)&&((e=jC(n))==="formdata"||e==="object"&&Vr(n.toString)&&n.toString()==="[object FormData]"))},W$e=la("URLSearchParams"),[H$e,j$e,G$e,q$e]=["ReadableStream","Request","Response","Headers"].map(la),K$e=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ux(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let s,i;if(typeof n!="object"&&(n=[n]),zg(n))for(s=0,i=n.length;s<i;s++)e.call(null,n[s],s,n);else{const r=t?Object.getOwnPropertyNames(n):Object.keys(n),o=r.length;let a;for(s=0;s<o;s++)a=r[s],e.call(null,n[a],a,n)}}function sK(n,e){e=e.toLowerCase();const t=Object.keys(n);let s=t.length,i;for(;s-- >0;)if(i=t[s],e===i.toLowerCase())return i;return null}const yd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,iK=n=>!k0(n)&&n!==yd;function qR(){const{caseless:n}=iK(this)&&this||{},e={},t=(s,i)=>{const r=n&&sK(e,i)||i;D1(e[r])&&D1(s)?e[r]=qR(e[r],s):D1(s)?e[r]=qR({},s):zg(s)?e[r]=s.slice():e[r]=s};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Ux(arguments[s],t);return e}const X$e=(n,e,t,{allOwnKeys:s}={})=>(Ux(e,(i,r)=>{t&&Vr(i)?n[r]=eK(i,t):n[r]=i},{allOwnKeys:s}),n),Y$e=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),Q$e=(n,e,t,s)=>{n.prototype=Object.create(e.prototype,s),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},Z$e=(n,e,t,s)=>{let i,r,o;const a={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),r=i.length;r-- >0;)o=i[r],(!s||s(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&rP(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},J$e=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const s=n.indexOf(e,t);return s!==-1&&s===t},eOe=n=>{if(!n)return null;if(zg(n))return n;let e=n.length;if(!nK(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},tOe=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&rP(Uint8Array)),nOe=(n,e)=>{const s=(n&&n[Symbol.iterator]).call(n);let i;for(;(i=s.next())&&!i.done;){const r=i.value;e.call(n,r[0],r[1])}},sOe=(n,e)=>{let t;const s=[];for(;(t=n.exec(e))!==null;)s.push(t);return s},iOe=la("HTMLFormElement"),rOe=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,i){return s.toUpperCase()+i}),$B=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),oOe=la("RegExp"),rK=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),s={};Ux(t,(i,r)=>{let o;(o=e(i,r,n))!==!1&&(s[r]=o||i)}),Object.defineProperties(n,s)},aOe=n=>{rK(n,(e,t)=>{if(Vr(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=n[t];if(Vr(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},lOe=(n,e)=>{const t={},s=i=>{i.forEach(r=>{t[r]=!0})};return zg(n)?s(n):s(String(n).split(e)),t},cOe=()=>{},uOe=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e,nA="abcdefghijklmnopqrstuvwxyz",OB="0123456789",oK={DIGIT:OB,ALPHA:nA,ALPHA_DIGIT:nA+nA.toUpperCase()+OB},hOe=(n=16,e=oK.ALPHA_DIGIT)=>{let t="";const{length:s}=e;for(;n--;)t+=e[Math.random()*s|0];return t};function dOe(n){return!!(n&&Vr(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const fOe=n=>{const e=new Array(10),t=(s,i)=>{if(qC(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[i]=s;const r=zg(s)?[]:{};return Ux(s,(o,a)=>{const l=t(o,i+1);!k0(l)&&(r[a]=l)}),e[i]=void 0,r}}return s};return t(n,0)},pOe=la("AsyncFunction"),mOe=n=>n&&(qC(n)||Vr(n))&&Vr(n.then)&&Vr(n.catch),aK=((n,e)=>n?setImmediate:e?((t,s)=>(yd.addEventListener("message",({source:i,data:r})=>{i===yd&&r===t&&s.length&&s.shift()()},!1),i=>{s.push(i),yd.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Vr(yd.postMessage)),gOe=typeof queueMicrotask<"u"?queueMicrotask.bind(yd):typeof process<"u"&&process.nextTick||aK,we={isArray:zg,isArrayBuffer:tK,isBuffer:$$e,isFormData:U$e,isArrayBufferView:O$e,isString:P$e,isNumber:nK,isBoolean:L$e,isObject:qC,isPlainObject:D1,isReadableStream:H$e,isRequest:j$e,isResponse:G$e,isHeaders:q$e,isUndefined:k0,isDate:M$e,isFile:F$e,isBlob:V$e,isRegExp:oOe,isFunction:Vr,isStream:B$e,isURLSearchParams:W$e,isTypedArray:tOe,isFileList:z$e,forEach:Ux,merge:qR,extend:X$e,trim:K$e,stripBOM:Y$e,inherits:Q$e,toFlatObject:Z$e,kindOf:jC,kindOfTest:la,endsWith:J$e,toArray:eOe,forEachEntry:nOe,matchAll:sOe,isHTMLForm:iOe,hasOwnProperty:$B,hasOwnProp:$B,reduceDescriptors:rK,freezeMethods:aOe,toObjectSet:lOe,toCamelCase:rOe,noop:cOe,toFiniteNumber:uOe,findKey:sK,global:yd,isContextDefined:iK,ALPHABET:oK,generateString:hOe,isSpecCompliantForm:dOe,toJSONObject:fOe,isAsyncFn:pOe,isThenable:mOe,setImmediate:aK,asap:gOe};function ht(n,e,t,s,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),s&&(this.request=s),i&&(this.response=i,this.status=i.status?i.status:null)}we.inherits(ht,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:we.toJSONObject(this.config),code:this.code,status:this.status}}});const lK=ht.prototype,cK={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{cK[n]={value:n}});Object.defineProperties(ht,cK);Object.defineProperty(lK,"isAxiosError",{value:!0});ht.from=(n,e,t,s,i,r)=>{const o=Object.create(lK);return we.toFlatObject(n,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),ht.call(o,n.message,e,t,s,i),o.cause=n,o.name=n.name,r&&Object.assign(o,r),o};const yOe=null;function KR(n){return we.isPlainObject(n)||we.isArray(n)}function uK(n){return we.endsWith(n,"[]")?n.slice(0,-2):n}function PB(n,e,t){return n?n.concat(e).map(function(i,r){return i=uK(i),!t&&r?"["+i+"]":i}).join(t?".":""):e}function bOe(n){return we.isArray(n)&&!n.some(KR)}const vOe=we.toFlatObject(we,{},null,function(e){return/^is[A-Z]/.test(e)});function KC(n,e,t){if(!we.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=we.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,v){return!we.isUndefined(v[x])});const s=t.metaTokens,i=t.visitor||h,r=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&we.isSpecCompliantForm(e);if(!we.isFunction(i))throw new TypeError("visitor must be a function");function c(y){if(y===null)return"";if(we.isDate(y))return y.toISOString();if(!l&&we.isBlob(y))throw new ht("Blob is not supported. Use a Buffer instead.");return we.isArrayBuffer(y)||we.isTypedArray(y)?l&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function h(y,x,v){let w=y;if(y&&!v&&typeof y=="object"){if(we.endsWith(x,"{}"))x=s?x:x.slice(0,-2),y=JSON.stringify(y);else if(we.isArray(y)&&bOe(y)||(we.isFileList(y)||we.endsWith(x,"[]"))&&(w=we.toArray(y)))return x=uK(x),w.forEach(function(C,I){!(we.isUndefined(C)||C===null)&&e.append(o===!0?PB([x],I,r):o===null?x:x+"[]",c(C))}),!1}return KR(y)?!0:(e.append(PB(v,x,r),c(y)),!1)}const f=[],p=Object.assign(vOe,{defaultVisitor:h,convertValue:c,isVisitable:KR});function g(y,x){if(!we.isUndefined(y)){if(f.indexOf(y)!==-1)throw Error("Circular reference detected in "+x.join("."));f.push(y),we.forEach(y,function(w,S){(!(we.isUndefined(w)||w===null)&&i.call(e,w,we.isString(S)?S.trim():S,x,p))===!0&&g(w,x?x.concat(S):[S])}),f.pop()}}if(!we.isObject(n))throw new TypeError("data must be an object");return g(n),e}function LB(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function oP(n,e){this._pairs=[],n&&KC(n,this,e)}const hK=oP.prototype;hK.append=function(e,t){this._pairs.push([e,t])};hK.toString=function(e){const t=e?function(s){return e.call(this,s,LB)}:LB;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function xOe(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function dK(n,e,t){if(!e)return n;const s=t&&t.encode||xOe;we.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let r;if(i?r=i(e,t):r=we.isURLSearchParams(e)?e.toString():new oP(e,t).toString(s),r){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+r}return n}class MB{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){we.forEach(this.handlers,function(s){s!==null&&e(s)})}}const fK={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wOe=typeof URLSearchParams<"u"?URLSearchParams:oP,_Oe=typeof FormData<"u"?FormData:null,TOe=typeof Blob<"u"?Blob:null,SOe={isBrowser:!0,classes:{URLSearchParams:wOe,FormData:_Oe,Blob:TOe},protocols:["http","https","file","blob","url","data"]},aP=typeof window<"u"&&typeof document<"u",XR=typeof navigator=="object"&&navigator||void 0,EOe=aP&&(!XR||["ReactNative","NativeScript","NS"].indexOf(XR.product)<0),COe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",IOe=aP&&window.location.href||"http://localhost",kOe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:aP,hasStandardBrowserEnv:EOe,hasStandardBrowserWebWorkerEnv:COe,navigator:XR,origin:IOe},Symbol.toStringTag,{value:"Module"})),Di={...kOe,...SOe};function NOe(n,e){return KC(n,new Di.classes.URLSearchParams,Object.assign({visitor:function(t,s,i,r){return Di.isNode&&we.isBuffer(t)?(this.append(s,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},e))}function AOe(n){return we.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function ROe(n){const e={},t=Object.keys(n);let s;const i=t.length;let r;for(s=0;s<i;s++)r=t[s],e[r]=n[r];return e}function pK(n){function e(t,s,i,r){let o=t[r++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=r>=t.length;return o=!o&&we.isArray(i)?i.length:o,l?(we.hasOwnProp(i,o)?i[o]=[i[o],s]:i[o]=s,!a):((!i[o]||!we.isObject(i[o]))&&(i[o]=[]),e(t,s,i[o],r)&&we.isArray(i[o])&&(i[o]=ROe(i[o])),!a)}if(we.isFormData(n)&&we.isFunction(n.entries)){const t={};return we.forEachEntry(n,(s,i)=>{e(AOe(s),i,t,0)}),t}return null}function DOe(n,e,t){if(we.isString(n))try{return(e||JSON.parse)(n),we.trim(n)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(n)}const Wx={transitional:fK,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",i=s.indexOf("application/json")>-1,r=we.isObject(e);if(r&&we.isHTMLForm(e)&&(e=new FormData(e)),we.isFormData(e))return i?JSON.stringify(pK(e)):e;if(we.isArrayBuffer(e)||we.isBuffer(e)||we.isStream(e)||we.isFile(e)||we.isBlob(e)||we.isReadableStream(e))return e;if(we.isArrayBufferView(e))return e.buffer;if(we.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(r){if(s.indexOf("application/x-www-form-urlencoded")>-1)return NOe(e,this.formSerializer).toString();if((a=we.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return KC(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return r||i?(t.setContentType("application/json",!1),DOe(e)):e}],transformResponse:[function(e){const t=this.transitional||Wx.transitional,s=t&&t.forcedJSONParsing,i=this.responseType==="json";if(we.isResponse(e)||we.isReadableStream(e))return e;if(e&&we.isString(e)&&(s&&!this.responseType||i)){const o=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?ht.from(a,ht.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Di.classes.FormData,Blob:Di.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};we.forEach(["delete","get","head","post","put","patch"],n=>{Wx.headers[n]={}});const $Oe=we.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),OOe=n=>{const e={};let t,s,i;return n&&n.split(`
`).forEach(function(o){i=o.indexOf(":"),t=o.substring(0,i).trim().toLowerCase(),s=o.substring(i+1).trim(),!(!t||e[t]&&$Oe[t])&&(t==="set-cookie"?e[t]?e[t].push(s):e[t]=[s]:e[t]=e[t]?e[t]+", "+s:s)}),e},FB=Symbol("internals");function fb(n){return n&&String(n).trim().toLowerCase()}function $1(n){return n===!1||n==null?n:we.isArray(n)?n.map($1):String(n)}function POe(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(n);)e[s[1]]=s[2];return e}const LOe=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function sA(n,e,t,s,i){if(we.isFunction(s))return s.call(this,e,t);if(i&&(e=t),!!we.isString(e)){if(we.isString(s))return e.indexOf(s)!==-1;if(we.isRegExp(s))return s.test(e)}}function MOe(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}function FOe(n,e){const t=we.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(n,s+t,{value:function(i,r,o){return this[s].call(this,e,i,r,o)},configurable:!0})})}let yr=class{constructor(e){e&&this.set(e)}set(e,t,s){const i=this;function r(a,l,c){const h=fb(l);if(!h)throw new Error("header name must be a non-empty string");const f=we.findKey(i,h);(!f||i[f]===void 0||c===!0||c===void 0&&i[f]!==!1)&&(i[f||l]=$1(a))}const o=(a,l)=>we.forEach(a,(c,h)=>r(c,h,l));if(we.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(we.isString(e)&&(e=e.trim())&&!LOe(e))o(OOe(e),t);else if(we.isHeaders(e))for(const[a,l]of e.entries())r(l,a,s);else e!=null&&r(t,e,s);return this}get(e,t){if(e=fb(e),e){const s=we.findKey(this,e);if(s){const i=this[s];if(!t)return i;if(t===!0)return POe(i);if(we.isFunction(t))return t.call(this,i,s);if(we.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=fb(e),e){const s=we.findKey(this,e);return!!(s&&this[s]!==void 0&&(!t||sA(this,this[s],s,t)))}return!1}delete(e,t){const s=this;let i=!1;function r(o){if(o=fb(o),o){const a=we.findKey(s,o);a&&(!t||sA(s,s[a],a,t))&&(delete s[a],i=!0)}}return we.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let s=t.length,i=!1;for(;s--;){const r=t[s];(!e||sA(this,this[r],r,e,!0))&&(delete this[r],i=!0)}return i}normalize(e){const t=this,s={};return we.forEach(this,(i,r)=>{const o=we.findKey(s,r);if(o){t[o]=$1(i),delete t[r];return}const a=e?MOe(r):String(r).trim();a!==r&&delete t[r],t[a]=$1(i),s[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return we.forEach(this,(s,i)=>{s!=null&&s!==!1&&(t[i]=e&&we.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach(i=>s.set(i)),s}static accessor(e){const s=(this[FB]=this[FB]={accessors:{}}).accessors,i=this.prototype;function r(o){const a=fb(o);s[a]||(FOe(i,o),s[a]=!0)}return we.isArray(e)?e.forEach(r):r(e),this}};yr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);we.reduceDescriptors(yr.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(s){this[t]=s}}});we.freezeMethods(yr);function iA(n,e){const t=this||Wx,s=e||t,i=yr.from(s.headers);let r=s.data;return we.forEach(n,function(a){r=a.call(t,r,i.normalize(),e?e.status:void 0)}),i.normalize(),r}function mK(n){return!!(n&&n.__CANCEL__)}function Bg(n,e,t){ht.call(this,n??"canceled",ht.ERR_CANCELED,e,t),this.name="CanceledError"}we.inherits(Bg,ht,{__CANCEL__:!0});function gK(n,e,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?n(t):e(new ht("Request failed with status code "+t.status,[ht.ERR_BAD_REQUEST,ht.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function VOe(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function zOe(n,e){n=n||10;const t=new Array(n),s=new Array(n);let i=0,r=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),h=s[r];o||(o=c),t[i]=l,s[i]=c;let f=r,p=0;for(;f!==i;)p+=t[f++],f=f%n;if(i=(i+1)%n,i===r&&(r=(r+1)%n),c-o<e)return;const g=h&&c-h;return g?Math.round(p*1e3/g):void 0}}function BOe(n,e){let t=0,s=1e3/e,i,r;const o=(c,h=Date.now())=>{t=h,i=null,r&&(clearTimeout(r),r=null),n.apply(null,c)};return[(...c)=>{const h=Date.now(),f=h-t;f>=s?o(c,h):(i=c,r||(r=setTimeout(()=>{r=null,o(i)},s-f)))},()=>i&&o(i)]}const $T=(n,e,t=3)=>{let s=0;const i=zOe(50,250);return BOe(r=>{const o=r.loaded,a=r.lengthComputable?r.total:void 0,l=o-s,c=i(l),h=o<=a;s=o;const f={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&h?(a-o)/c:void 0,event:r,lengthComputable:a!=null,[e?"download":"upload"]:!0};n(f)},t)},VB=(n,e)=>{const t=n!=null;return[s=>e[0]({lengthComputable:t,total:n,loaded:s}),e[1]]},zB=n=>(...e)=>we.asap(()=>n(...e)),UOe=Di.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,Di.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(Di.origin),Di.navigator&&/(msie|trident)/i.test(Di.navigator.userAgent)):()=>!0,WOe=Di.hasStandardBrowserEnv?{write(n,e,t,s,i,r){const o=[n+"="+encodeURIComponent(e)];we.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),we.isString(s)&&o.push("path="+s),we.isString(i)&&o.push("domain="+i),r===!0&&o.push("secure"),document.cookie=o.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function HOe(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function jOe(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function yK(n,e){return n&&!HOe(e)?jOe(n,e):e}const BB=n=>n instanceof yr?{...n}:n;function Xd(n,e){e=e||{};const t={};function s(c,h,f,p){return we.isPlainObject(c)&&we.isPlainObject(h)?we.merge.call({caseless:p},c,h):we.isPlainObject(h)?we.merge({},h):we.isArray(h)?h.slice():h}function i(c,h,f,p){if(we.isUndefined(h)){if(!we.isUndefined(c))return s(void 0,c,f,p)}else return s(c,h,f,p)}function r(c,h){if(!we.isUndefined(h))return s(void 0,h)}function o(c,h){if(we.isUndefined(h)){if(!we.isUndefined(c))return s(void 0,c)}else return s(void 0,h)}function a(c,h,f){if(f in e)return s(c,h);if(f in n)return s(void 0,c)}const l={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,h,f)=>i(BB(c),BB(h),f,!0)};return we.forEach(Object.keys(Object.assign({},n,e)),function(h){const f=l[h]||i,p=f(n[h],e[h],h);we.isUndefined(p)&&f!==a||(t[h]=p)}),t}const bK=n=>{const e=Xd({},n);let{data:t,withXSRFToken:s,xsrfHeaderName:i,xsrfCookieName:r,headers:o,auth:a}=e;e.headers=o=yr.from(o),e.url=dK(yK(e.baseURL,e.url),n.params,n.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(we.isFormData(t)){if(Di.hasStandardBrowserEnv||Di.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...h]=l?l.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...h].join("; "))}}if(Di.hasStandardBrowserEnv&&(s&&we.isFunction(s)&&(s=s(e)),s||s!==!1&&UOe(e.url))){const c=i&&r&&WOe.read(r);c&&o.set(i,c)}return e},GOe=typeof XMLHttpRequest<"u",qOe=GOe&&function(n){return new Promise(function(t,s){const i=bK(n);let r=i.data;const o=yr.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=i,h,f,p,g,y;function x(){g&&g(),y&&y(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let v=new XMLHttpRequest;v.open(i.method.toUpperCase(),i.url,!0),v.timeout=i.timeout;function w(){if(!v)return;const C=yr.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),A={data:!a||a==="text"||a==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:C,config:n,request:v};gK(function(O){t(O),x()},function(O){s(O),x()},A),v=null}"onloadend"in v?v.onloadend=w:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(w)},v.onabort=function(){v&&(s(new ht("Request aborted",ht.ECONNABORTED,n,v)),v=null)},v.onerror=function(){s(new ht("Network Error",ht.ERR_NETWORK,n,v)),v=null},v.ontimeout=function(){let I=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const A=i.transitional||fK;i.timeoutErrorMessage&&(I=i.timeoutErrorMessage),s(new ht(I,A.clarifyTimeoutError?ht.ETIMEDOUT:ht.ECONNABORTED,n,v)),v=null},r===void 0&&o.setContentType(null),"setRequestHeader"in v&&we.forEach(o.toJSON(),function(I,A){v.setRequestHeader(A,I)}),we.isUndefined(i.withCredentials)||(v.withCredentials=!!i.withCredentials),a&&a!=="json"&&(v.responseType=i.responseType),c&&([p,y]=$T(c,!0),v.addEventListener("progress",p)),l&&v.upload&&([f,g]=$T(l),v.upload.addEventListener("progress",f),v.upload.addEventListener("loadend",g)),(i.cancelToken||i.signal)&&(h=C=>{v&&(s(!C||C.type?new Bg(null,n,v):C),v.abort(),v=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const S=VOe(i.url);if(S&&Di.protocols.indexOf(S)===-1){s(new ht("Unsupported protocol "+S+":",ht.ERR_BAD_REQUEST,n));return}v.send(r||null)})},KOe=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let s=new AbortController,i;const r=function(c){if(!i){i=!0,a();const h=c instanceof Error?c:this.reason;s.abort(h instanceof ht?h:new Bg(h instanceof Error?h.message:h))}};let o=e&&setTimeout(()=>{o=null,r(new ht(`timeout ${e} of ms exceeded`,ht.ETIMEDOUT))},e);const a=()=>{n&&(o&&clearTimeout(o),o=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(r):c.removeEventListener("abort",r)}),n=null)};n.forEach(c=>c.addEventListener("abort",r));const{signal:l}=s;return l.unsubscribe=()=>we.asap(a),l}},XOe=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let s=0,i;for(;s<t;)i=s+e,yield n.slice(s,i),s=i},YOe=async function*(n,e){for await(const t of QOe(n))yield*XOe(t,e)},QOe=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:s}=await e.read();if(t)break;yield s}}finally{await e.cancel()}},UB=(n,e,t,s)=>{const i=YOe(n,e);let r=0,o,a=l=>{o||(o=!0,s&&s(l))};return new ReadableStream({async pull(l){try{const{done:c,value:h}=await i.next();if(c){a(),l.close();return}let f=h.byteLength;if(t){let p=r+=f;t(p)}l.enqueue(new Uint8Array(h))}catch(c){throw a(c),c}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},XC=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",vK=XC&&typeof ReadableStream=="function",ZOe=XC&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),xK=(n,...e)=>{try{return!!n(...e)}catch{return!1}},JOe=vK&&xK(()=>{let n=!1;const e=new Request(Di.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),WB=64*1024,YR=vK&&xK(()=>we.isReadableStream(new Response("").body)),OT={stream:YR&&(n=>n.body)};XC&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!OT[e]&&(OT[e]=we.isFunction(n[e])?t=>t[e]():(t,s)=>{throw new ht(`Response type '${e}' is not supported`,ht.ERR_NOT_SUPPORT,s)})})})(new Response);const ePe=async n=>{if(n==null)return 0;if(we.isBlob(n))return n.size;if(we.isSpecCompliantForm(n))return(await new Request(Di.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(we.isArrayBufferView(n)||we.isArrayBuffer(n))return n.byteLength;if(we.isURLSearchParams(n)&&(n=n+""),we.isString(n))return(await ZOe(n)).byteLength},tPe=async(n,e)=>{const t=we.toFiniteNumber(n.getContentLength());return t??ePe(e)},nPe=XC&&(async n=>{let{url:e,method:t,data:s,signal:i,cancelToken:r,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:h,withCredentials:f="same-origin",fetchOptions:p}=bK(n);c=c?(c+"").toLowerCase():"text";let g=KOe([i,r&&r.toAbortSignal()],o),y;const x=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let v;try{if(l&&JOe&&t!=="get"&&t!=="head"&&(v=await tPe(h,s))!==0){let A=new Request(e,{method:"POST",body:s,duplex:"half"}),L;if(we.isFormData(s)&&(L=A.headers.get("content-type"))&&h.setContentType(L),A.body){const[O,N]=VB(v,$T(zB(l)));s=UB(A.body,WB,O,N)}}we.isString(f)||(f=f?"include":"omit");const w="credentials"in Request.prototype;y=new Request(e,{...p,signal:g,method:t.toUpperCase(),headers:h.normalize().toJSON(),body:s,duplex:"half",credentials:w?f:void 0});let S=await fetch(y);const C=YR&&(c==="stream"||c==="response");if(YR&&(a||C&&x)){const A={};["status","statusText","headers"].forEach(k=>{A[k]=S[k]});const L=we.toFiniteNumber(S.headers.get("content-length")),[O,N]=a&&VB(L,$T(zB(a),!0))||[];S=new Response(UB(S.body,WB,O,()=>{N&&N(),x&&x()}),A)}c=c||"text";let I=await OT[we.findKey(OT,c)||"text"](S,n);return!C&&x&&x(),await new Promise((A,L)=>{gK(A,L,{data:I,headers:yr.from(S.headers),status:S.status,statusText:S.statusText,config:n,request:y})})}catch(w){throw x&&x(),w&&w.name==="TypeError"&&/fetch/i.test(w.message)?Object.assign(new ht("Network Error",ht.ERR_NETWORK,n,y),{cause:w.cause||w}):ht.from(w,w&&w.code,n,y)}}),QR={http:yOe,xhr:qOe,fetch:nPe};we.forEach(QR,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const HB=n=>`- ${n}`,sPe=n=>we.isFunction(n)||n===null||n===!1,wK={getAdapter:n=>{n=we.isArray(n)?n:[n];const{length:e}=n;let t,s;const i={};for(let r=0;r<e;r++){t=n[r];let o;if(s=t,!sPe(t)&&(s=QR[(o=String(t)).toLowerCase()],s===void 0))throw new ht(`Unknown adapter '${o}'`);if(s)break;i[o||"#"+r]=s}if(!s){const r=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?r.length>1?`since :
`+r.map(HB).join(`
`):" "+HB(r[0]):"as no adapter specified";throw new ht("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:QR};function rA(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Bg(null,n)}function jB(n){return rA(n),n.headers=yr.from(n.headers),n.data=iA.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),wK.getAdapter(n.adapter||Wx.adapter)(n).then(function(s){return rA(n),s.data=iA.call(n,n.transformResponse,s),s.headers=yr.from(s.headers),s},function(s){return mK(s)||(rA(n),s&&s.response&&(s.response.data=iA.call(n,n.transformResponse,s.response),s.response.headers=yr.from(s.response.headers))),Promise.reject(s)})}const _K="1.7.9",YC={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{YC[n]=function(s){return typeof s===n||"a"+(e<1?"n ":" ")+n}});const GB={};YC.transitional=function(e,t,s){function i(r,o){return"[Axios v"+_K+"] Transitional option '"+r+"'"+o+(s?". "+s:"")}return(r,o,a)=>{if(e===!1)throw new ht(i(o," has been removed"+(t?" in "+t:"")),ht.ERR_DEPRECATED);return t&&!GB[o]&&(GB[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(r,o,a):!0}};YC.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function iPe(n,e,t){if(typeof n!="object")throw new ht("options must be an object",ht.ERR_BAD_OPTION_VALUE);const s=Object.keys(n);let i=s.length;for(;i-- >0;){const r=s[i],o=e[r];if(o){const a=n[r],l=a===void 0||o(a,r,n);if(l!==!0)throw new ht("option "+r+" must be "+l,ht.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ht("Unknown option "+r,ht.ERR_BAD_OPTION)}}const O1={assertOptions:iPe,validators:YC},Ca=O1.validators;let Nd=class{constructor(e){this.defaults=e,this.interceptors={request:new MB,response:new MB}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const r=i.stack?i.stack.replace(/^.+\n/,""):"";try{s.stack?r&&!String(s.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+r):s.stack=r}catch{}}throw s}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Xd(this.defaults,t);const{transitional:s,paramsSerializer:i,headers:r}=t;s!==void 0&&O1.assertOptions(s,{silentJSONParsing:Ca.transitional(Ca.boolean),forcedJSONParsing:Ca.transitional(Ca.boolean),clarifyTimeoutError:Ca.transitional(Ca.boolean)},!1),i!=null&&(we.isFunction(i)?t.paramsSerializer={serialize:i}:O1.assertOptions(i,{encode:Ca.function,serialize:Ca.function},!0)),O1.assertOptions(t,{baseUrl:Ca.spelling("baseURL"),withXsrfToken:Ca.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=r&&we.merge(r.common,r[t.method]);r&&we.forEach(["delete","get","head","post","put","patch","common"],y=>{delete r[y]}),t.headers=yr.concat(o,r);const a=[];let l=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(t)===!1||(l=l&&x.synchronous,a.unshift(x.fulfilled,x.rejected))});const c=[];this.interceptors.response.forEach(function(x){c.push(x.fulfilled,x.rejected)});let h,f=0,p;if(!l){const y=[jB.bind(this),void 0];for(y.unshift.apply(y,a),y.push.apply(y,c),p=y.length,h=Promise.resolve(t);f<p;)h=h.then(y[f++],y[f++]);return h}p=a.length;let g=t;for(f=0;f<p;){const y=a[f++],x=a[f++];try{g=y(g)}catch(v){x.call(this,v);break}}try{h=jB.call(this,g)}catch(y){return Promise.reject(y)}for(f=0,p=c.length;f<p;)h=h.then(c[f++],c[f++]);return h}getUri(e){e=Xd(this.defaults,e);const t=yK(e.baseURL,e.url);return dK(t,e.params,e.paramsSerializer)}};we.forEach(["delete","get","head","options"],function(e){Nd.prototype[e]=function(t,s){return this.request(Xd(s||{},{method:e,url:t,data:(s||{}).data}))}});we.forEach(["post","put","patch"],function(e){function t(s){return function(r,o,a){return this.request(Xd(a||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:r,data:o}))}}Nd.prototype[e]=t(),Nd.prototype[e+"Form"]=t(!0)});let rPe=class TK{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(r){t=r});const s=this;this.promise.then(i=>{if(!s._listeners)return;let r=s._listeners.length;for(;r-- >0;)s._listeners[r](i);s._listeners=null}),this.promise.then=i=>{let r;const o=new Promise(a=>{s.subscribe(a),r=a}).then(i);return o.cancel=function(){s.unsubscribe(r)},o},e(function(r,o,a){s.reason||(s.reason=new Bg(r,o,a),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=s=>{e.abort(s)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new TK(function(i){e=i}),cancel:e}}};function oPe(n){return function(t){return n.apply(null,t)}}function aPe(n){return we.isObject(n)&&n.isAxiosError===!0}const ZR={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ZR).forEach(([n,e])=>{ZR[e]=n});function SK(n){const e=new Nd(n),t=eK(Nd.prototype.request,e);return we.extend(t,Nd.prototype,e,{allOwnKeys:!0}),we.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return SK(Xd(n,i))},t}const cs=SK(Wx);cs.Axios=Nd;cs.CanceledError=Bg;cs.CancelToken=rPe;cs.isCancel=mK;cs.VERSION=_K;cs.toFormData=KC;cs.AxiosError=ht;cs.Cancel=cs.CanceledError;cs.all=function(e){return Promise.all(e)};cs.spread=oPe;cs.isAxiosError=aPe;cs.mergeConfig=Xd;cs.AxiosHeaders=yr;cs.formToJSON=n=>pK(we.isHTMLForm(n)?new FormData(n):n);cs.getAdapter=wK.getAdapter;cs.HttpStatusCode=ZR;cs.default=cs;const{Axios:aKe,AxiosError:lKe,CanceledError:cKe,isCancel:uKe,CancelToken:hKe,VERSION:dKe,all:fKe,Cancel:pKe,isAxiosError:mKe,spread:gKe,toFormData:yKe,AxiosHeaders:bKe,HttpStatusCode:vKe,formToJSON:xKe,getAdapter:wKe,mergeConfig:_Ke}=cs;var qB={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EK={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fe=function(n,e){if(!n)throw Ug(e)},Ug=function(n){return new Error("Firebase Database ("+EK.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CK=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},lPe=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const i=n[t++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=n[t++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=n[t++],o=n[t++],a=n[t++],l=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const r=n[t++],o=n[t++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},lP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const r=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=r>>2,f=(r&3)<<4|a>>4;let p=(a&15)<<2|c>>6,g=c&63;l||(g=64,o||(p=64)),s.push(t[h],t[f],t[p],t[g])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(CK(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):lPe(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const r=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,r==null||a==null||c==null||f==null)throw new cPe;const p=r<<2|a>>4;if(s.push(p),c!==64){const g=a<<4&240|c>>2;if(s.push(g),f!==64){const y=c<<6&192|f;s.push(y)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class cPe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const IK=function(n){const e=CK(n);return lP.encodeByteArray(e,!0)},PT=function(n){return IK(n).replace(/\./g,"")},LT=function(n){try{return lP.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uPe(n){return kK(void 0,n)}function kK(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!hPe(t)||(n[t]=kK(n[t],e[t]));return n}function hPe(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dPe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fPe=()=>dPe().__FIREBASE_DEFAULTS__,pPe=()=>{if(typeof process>"u"||typeof qB>"u")return;const n=qB.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},mPe=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&LT(n[1]);return e&&JSON.parse(e)},QC=()=>{try{return fPe()||pPe()||mPe()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},NK=n=>{var e,t;return(t=(e=QC())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},cP=n=>{const e=NK(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},AK=()=>{var n;return(n=QC())===null||n===void 0?void 0:n.config},RK=n=>{var e;return(e=QC())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",i=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},n);return[PT(JSON.stringify(t)),PT(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function dP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fi())}function gPe(){var n;const e=(n=QC())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yPe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bPe(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function DK(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vPe(){const n=Fi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function xPe(){return EK.NODE_ADMIN===!0}function wPe(){return!gPe()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _Pe(){try{return typeof indexedDB=="object"}catch{return!1}}function TPe(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SPe="FirebaseError";class ol extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=SPe,Object.setPrototypeOf(this,ol.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hx.prototype.create)}}class Hx{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?EPe(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ol(i,a,s)}}function EPe(n,e){return n.replace(CPe,(t,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const CPe=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(n){return JSON.parse(n)}function hi(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $K=function(n){let e={},t={},s={},i="";try{const r=n.split(".");e=N0(LT(r[0])||""),t=N0(LT(r[1])||""),i=r[2],s=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:s,signature:i}},IPe=function(n){const e=$K(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},kPe=function(n){const e=$K(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sc(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function cm(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function JR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function MT(n,e,t){const s={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(s[i]=e.call(t,n[i],i,n));return s}function FT(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const i of t){if(!s.includes(i))return!1;const r=n[i],o=e[i];if(KB(r)&&KB(o)){if(!FT(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!t.includes(i))return!1;return!0}function KB(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Rb(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,r]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(r)}}),e}function Db(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NPe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const s=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)s[f]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let f=0;f<16;f++)s[f]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let f=16;f<80;f++){const p=s[f-3]^s[f-8]^s[f-14]^s[f-16];s[f]=(p<<1|p>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,h;for(let f=0;f<80;f++){f<40?f<20?(c=a^r&(o^a),h=1518500249):(c=r^o^a,h=1859775393):f<60?(c=r&o|a&(r|o),h=2400959708):(c=r^o^a,h=3395469782);const p=(i<<5|i>>>27)+c+l+h+s[f]&4294967295;l=a,a=o,o=(r<<30|r>>>2)&4294967295,r=i,i=p}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const s=t-this.blockSize;let i=0;const r=this.buf_;let o=this.inbuf_;for(;i<t;){if(o===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(r[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}else for(;i<t;)if(r[o]=e[i],++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function APe(n,e){const t=new RPe(n,e);return t.subscribe.bind(t)}class RPe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let i;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");DPe(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:s},i.next===void 0&&(i.next=oA),i.error===void 0&&(i.error=oA),i.complete===void 0&&(i.complete=oA);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DPe(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function oA(){}function $Pe(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OPe=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,Fe(s<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(s)-56320;i=65536+(r<<10)+o}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ZC=function(n){let e=0;for(let t=0;t<n.length;t++){const s=n.charCodeAt(t);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(n){return n&&n._delegate?n._delegate:n}class oc{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const od="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PPe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new uP;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(MPe(e))try{this.getOrInitializeService({instanceIdentifier:od})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=od){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=od){return this.instances.has(e)}getOptions(e=od){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(e,t){var s;const i=this.normalizeInstanceIdentifier(t),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const i of s)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:LPe(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=od){return this.component?this.component.multipleInstances?e:od:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function LPe(n){return n===od?void 0:n}function MPe(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FPe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new PPe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var It;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(It||(It={}));const VPe={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},zPe=It.INFO,BPe={[It.DEBUG]:"log",[It.VERBOSE]:"log",[It.INFO]:"info",[It.WARN]:"warn",[It.ERROR]:"error"},UPe=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),i=BPe[e];if(i)console[i](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class JC{constructor(e){this.name=e,this._logLevel=zPe,this._logHandler=UPe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in It))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?VPe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,It.DEBUG,...e),this._logHandler(this,It.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,It.VERBOSE,...e),this._logHandler(this,It.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,It.INFO,...e),this._logHandler(this,It.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,It.WARN,...e),this._logHandler(this,It.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,It.ERROR,...e),this._logHandler(this,It.ERROR,...e)}}const WPe=(n,e)=>e.some(t=>n instanceof t);let XB,YB;function HPe(){return XB||(XB=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jPe(){return YB||(YB=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const OK=new WeakMap,e2=new WeakMap,PK=new WeakMap,aA=new WeakMap,fP=new WeakMap;function GPe(n){const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{t(Eu(n.result)),i()},o=()=>{s(n.error),i()};n.addEventListener("success",r),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&OK.set(t,n)}).catch(()=>{}),fP.set(e,n),e}function qPe(n){if(e2.has(n))return;const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{t(),i()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});e2.set(n,e)}let t2={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return e2.get(n);if(e==="objectStoreNames")return n.objectStoreNames||PK.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Eu(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function KPe(n){t2=n(t2)}function XPe(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(lA(this),e,...t);return PK.set(s,e.sort?e.sort():[e]),Eu(s)}:jPe().includes(n)?function(...e){return n.apply(lA(this),e),Eu(OK.get(this))}:function(...e){return Eu(n.apply(lA(this),e))}}function YPe(n){return typeof n=="function"?XPe(n):(n instanceof IDBTransaction&&qPe(n),WPe(n,HPe())?new Proxy(n,t2):n)}function Eu(n){if(n instanceof IDBRequest)return GPe(n);if(aA.has(n))return aA.get(n);const e=YPe(n);return e!==n&&(aA.set(n,e),fP.set(e,n)),e}const lA=n=>fP.get(n);function QPe(n,e,{blocked:t,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(n,e),a=Eu(o);return s&&o.addEventListener("upgradeneeded",l=>{s(Eu(o.result),l.oldVersion,l.newVersion,Eu(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const ZPe=["get","getKey","getAll","getAllKeys","count"],JPe=["put","add","delete","clear"],cA=new Map;function QB(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(cA.get(e))return cA.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,i=JPe.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(i||ZPe.includes(t)))return;const r=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),i&&l.done]))[0]};return cA.set(e,r),r}KPe(n=>({...n,get:(e,t,s)=>QB(e,t)||n.get(e,t,s),has:(e,t)=>!!QB(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eLe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(tLe(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function tLe(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const n2="@firebase/app",ZB="0.11.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac=new JC("@firebase/app"),nLe="@firebase/app-compat",sLe="@firebase/analytics-compat",iLe="@firebase/analytics",rLe="@firebase/app-check-compat",oLe="@firebase/app-check",aLe="@firebase/auth",lLe="@firebase/auth-compat",cLe="@firebase/database",uLe="@firebase/data-connect",hLe="@firebase/database-compat",dLe="@firebase/functions",fLe="@firebase/functions-compat",pLe="@firebase/installations",mLe="@firebase/installations-compat",gLe="@firebase/messaging",yLe="@firebase/messaging-compat",bLe="@firebase/performance",vLe="@firebase/performance-compat",xLe="@firebase/remote-config",wLe="@firebase/remote-config-compat",_Le="@firebase/storage",TLe="@firebase/storage-compat",SLe="@firebase/firestore",ELe="@firebase/vertexai",CLe="@firebase/firestore-compat",ILe="firebase",kLe="11.3.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2="[DEFAULT]",NLe={[n2]:"fire-core",[nLe]:"fire-core-compat",[iLe]:"fire-analytics",[sLe]:"fire-analytics-compat",[oLe]:"fire-app-check",[rLe]:"fire-app-check-compat",[aLe]:"fire-auth",[lLe]:"fire-auth-compat",[cLe]:"fire-rtdb",[uLe]:"fire-data-connect",[hLe]:"fire-rtdb-compat",[dLe]:"fire-fn",[fLe]:"fire-fn-compat",[pLe]:"fire-iid",[mLe]:"fire-iid-compat",[gLe]:"fire-fcm",[yLe]:"fire-fcm-compat",[bLe]:"fire-perf",[vLe]:"fire-perf-compat",[xLe]:"fire-rc",[wLe]:"fire-rc-compat",[_Le]:"fire-gcs",[TLe]:"fire-gcs-compat",[SLe]:"fire-fst",[CLe]:"fire-fst-compat",[ELe]:"fire-vertex","fire-js":"fire-js",[ILe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VT=new Map,ALe=new Map,i2=new Map;function JB(n,e){try{n.container.addComponent(e)}catch(t){ac.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function qu(n){const e=n.name;if(i2.has(e))return ac.debug(`There were multiple attempts to register component ${e}.`),!1;i2.set(e,n);for(const t of VT.values())JB(t,n);for(const t of ALe.values())JB(t,n);return!0}function jx(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Xi(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RLe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Cu=new Hx("app","Firebase",RLe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DLe{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new oc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Cu.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph=kLe;function LK(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:s2,automaticDataCollectionEnabled:!1},e),i=s.name;if(typeof i!="string"||!i)throw Cu.create("bad-app-name",{appName:String(i)});if(t||(t=AK()),!t)throw Cu.create("no-options");const r=VT.get(i);if(r){if(FT(t,r.options)&&FT(s,r.config))return r;throw Cu.create("duplicate-app",{appName:i})}const o=new FPe(i);for(const l of i2.values())o.addComponent(l);const a=new DLe(t,s,o);return VT.set(i,a),a}function eI(n=s2){const e=VT.get(n);if(!e&&n===s2&&AK())return LK();if(!e)throw Cu.create("no-app",{appName:n});return e}function To(n,e,t){var s;let i=(s=NLe[n])!==null&&s!==void 0?s:n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${i}" with version "${e}":`];r&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ac.warn(a.join(" "));return}qu(new oc(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $Le="firebase-heartbeat-database",OLe=1,A0="firebase-heartbeat-store";let uA=null;function MK(){return uA||(uA=QPe($Le,OLe,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(A0)}catch(t){console.warn(t)}}}}).catch(n=>{throw Cu.create("idb-open",{originalErrorMessage:n.message})})),uA}async function PLe(n){try{const t=(await MK()).transaction(A0),s=await t.objectStore(A0).get(FK(n));return await t.done,s}catch(e){if(e instanceof ol)ac.warn(e.message);else{const t=Cu.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ac.warn(t.message)}}}async function e4(n,e){try{const s=(await MK()).transaction(A0,"readwrite");await s.objectStore(A0).put(e,FK(n)),await s.done}catch(t){if(t instanceof ol)ac.warn(t.message);else{const s=Cu.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ac.warn(s.message)}}}function FK(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LLe=1024,MLe=30;class FLe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new zLe(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=t4();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>MLe){const o=BLe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){ac.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=t4(),{heartbeatsToSend:s,unsentEntries:i}=VLe(this._heartbeatsCache.heartbeats),r=PT(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return ac.warn(t),""}}}function t4(){return new Date().toISOString().substring(0,10)}function VLe(n,e=LLe){const t=[];let s=n.slice();for(const i of n){const r=t.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),n4(t)>e){r.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),n4(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class zLe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _Pe()?TPe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await PLe(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return e4(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return e4(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function n4(n){return PT(JSON.stringify({version:2,heartbeats:n})).length}function BLe(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ULe(n){qu(new oc("platform-logger",e=>new eLe(e),"PRIVATE")),qu(new oc("heartbeat",e=>new FLe(e),"PRIVATE")),To(n2,ZB,n),To(n2,ZB,"esm2017"),To("fire-js","")}ULe("");var WLe="firebase",HLe="11.3.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */To(WLe,HLe,"app");var s4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Iu,VK;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(O,N){function k(){}k.prototype=N.prototype,O.D=N.prototype,O.prototype=new k,O.prototype.constructor=O,O.C=function($,R,z){for(var V=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)V[ne-2]=arguments[ne];return N.prototype[R].apply($,V)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(O,N,k){k||(k=0);var $=Array(16);if(typeof N=="string")for(var R=0;16>R;++R)$[R]=N.charCodeAt(k++)|N.charCodeAt(k++)<<8|N.charCodeAt(k++)<<16|N.charCodeAt(k++)<<24;else for(R=0;16>R;++R)$[R]=N[k++]|N[k++]<<8|N[k++]<<16|N[k++]<<24;N=O.g[0],k=O.g[1],R=O.g[2];var z=O.g[3],V=N+(z^k&(R^z))+$[0]+3614090360&4294967295;N=k+(V<<7&4294967295|V>>>25),V=z+(R^N&(k^R))+$[1]+3905402710&4294967295,z=N+(V<<12&4294967295|V>>>20),V=R+(k^z&(N^k))+$[2]+606105819&4294967295,R=z+(V<<17&4294967295|V>>>15),V=k+(N^R&(z^N))+$[3]+3250441966&4294967295,k=R+(V<<22&4294967295|V>>>10),V=N+(z^k&(R^z))+$[4]+4118548399&4294967295,N=k+(V<<7&4294967295|V>>>25),V=z+(R^N&(k^R))+$[5]+1200080426&4294967295,z=N+(V<<12&4294967295|V>>>20),V=R+(k^z&(N^k))+$[6]+2821735955&4294967295,R=z+(V<<17&4294967295|V>>>15),V=k+(N^R&(z^N))+$[7]+4249261313&4294967295,k=R+(V<<22&4294967295|V>>>10),V=N+(z^k&(R^z))+$[8]+1770035416&4294967295,N=k+(V<<7&4294967295|V>>>25),V=z+(R^N&(k^R))+$[9]+2336552879&4294967295,z=N+(V<<12&4294967295|V>>>20),V=R+(k^z&(N^k))+$[10]+4294925233&4294967295,R=z+(V<<17&4294967295|V>>>15),V=k+(N^R&(z^N))+$[11]+2304563134&4294967295,k=R+(V<<22&4294967295|V>>>10),V=N+(z^k&(R^z))+$[12]+1804603682&4294967295,N=k+(V<<7&4294967295|V>>>25),V=z+(R^N&(k^R))+$[13]+4254626195&4294967295,z=N+(V<<12&4294967295|V>>>20),V=R+(k^z&(N^k))+$[14]+2792965006&4294967295,R=z+(V<<17&4294967295|V>>>15),V=k+(N^R&(z^N))+$[15]+1236535329&4294967295,k=R+(V<<22&4294967295|V>>>10),V=N+(R^z&(k^R))+$[1]+4129170786&4294967295,N=k+(V<<5&4294967295|V>>>27),V=z+(k^R&(N^k))+$[6]+3225465664&4294967295,z=N+(V<<9&4294967295|V>>>23),V=R+(N^k&(z^N))+$[11]+643717713&4294967295,R=z+(V<<14&4294967295|V>>>18),V=k+(z^N&(R^z))+$[0]+3921069994&4294967295,k=R+(V<<20&4294967295|V>>>12),V=N+(R^z&(k^R))+$[5]+3593408605&4294967295,N=k+(V<<5&4294967295|V>>>27),V=z+(k^R&(N^k))+$[10]+38016083&4294967295,z=N+(V<<9&4294967295|V>>>23),V=R+(N^k&(z^N))+$[15]+3634488961&4294967295,R=z+(V<<14&4294967295|V>>>18),V=k+(z^N&(R^z))+$[4]+3889429448&4294967295,k=R+(V<<20&4294967295|V>>>12),V=N+(R^z&(k^R))+$[9]+568446438&4294967295,N=k+(V<<5&4294967295|V>>>27),V=z+(k^R&(N^k))+$[14]+3275163606&4294967295,z=N+(V<<9&4294967295|V>>>23),V=R+(N^k&(z^N))+$[3]+4107603335&4294967295,R=z+(V<<14&4294967295|V>>>18),V=k+(z^N&(R^z))+$[8]+1163531501&4294967295,k=R+(V<<20&4294967295|V>>>12),V=N+(R^z&(k^R))+$[13]+2850285829&4294967295,N=k+(V<<5&4294967295|V>>>27),V=z+(k^R&(N^k))+$[2]+4243563512&4294967295,z=N+(V<<9&4294967295|V>>>23),V=R+(N^k&(z^N))+$[7]+1735328473&4294967295,R=z+(V<<14&4294967295|V>>>18),V=k+(z^N&(R^z))+$[12]+2368359562&4294967295,k=R+(V<<20&4294967295|V>>>12),V=N+(k^R^z)+$[5]+4294588738&4294967295,N=k+(V<<4&4294967295|V>>>28),V=z+(N^k^R)+$[8]+2272392833&4294967295,z=N+(V<<11&4294967295|V>>>21),V=R+(z^N^k)+$[11]+1839030562&4294967295,R=z+(V<<16&4294967295|V>>>16),V=k+(R^z^N)+$[14]+4259657740&4294967295,k=R+(V<<23&4294967295|V>>>9),V=N+(k^R^z)+$[1]+2763975236&4294967295,N=k+(V<<4&4294967295|V>>>28),V=z+(N^k^R)+$[4]+1272893353&4294967295,z=N+(V<<11&4294967295|V>>>21),V=R+(z^N^k)+$[7]+4139469664&4294967295,R=z+(V<<16&4294967295|V>>>16),V=k+(R^z^N)+$[10]+3200236656&4294967295,k=R+(V<<23&4294967295|V>>>9),V=N+(k^R^z)+$[13]+681279174&4294967295,N=k+(V<<4&4294967295|V>>>28),V=z+(N^k^R)+$[0]+3936430074&4294967295,z=N+(V<<11&4294967295|V>>>21),V=R+(z^N^k)+$[3]+3572445317&4294967295,R=z+(V<<16&4294967295|V>>>16),V=k+(R^z^N)+$[6]+76029189&4294967295,k=R+(V<<23&4294967295|V>>>9),V=N+(k^R^z)+$[9]+3654602809&4294967295,N=k+(V<<4&4294967295|V>>>28),V=z+(N^k^R)+$[12]+3873151461&4294967295,z=N+(V<<11&4294967295|V>>>21),V=R+(z^N^k)+$[15]+530742520&4294967295,R=z+(V<<16&4294967295|V>>>16),V=k+(R^z^N)+$[2]+3299628645&4294967295,k=R+(V<<23&4294967295|V>>>9),V=N+(R^(k|~z))+$[0]+4096336452&4294967295,N=k+(V<<6&4294967295|V>>>26),V=z+(k^(N|~R))+$[7]+1126891415&4294967295,z=N+(V<<10&4294967295|V>>>22),V=R+(N^(z|~k))+$[14]+2878612391&4294967295,R=z+(V<<15&4294967295|V>>>17),V=k+(z^(R|~N))+$[5]+4237533241&4294967295,k=R+(V<<21&4294967295|V>>>11),V=N+(R^(k|~z))+$[12]+1700485571&4294967295,N=k+(V<<6&4294967295|V>>>26),V=z+(k^(N|~R))+$[3]+2399980690&4294967295,z=N+(V<<10&4294967295|V>>>22),V=R+(N^(z|~k))+$[10]+4293915773&4294967295,R=z+(V<<15&4294967295|V>>>17),V=k+(z^(R|~N))+$[1]+2240044497&4294967295,k=R+(V<<21&4294967295|V>>>11),V=N+(R^(k|~z))+$[8]+1873313359&4294967295,N=k+(V<<6&4294967295|V>>>26),V=z+(k^(N|~R))+$[15]+4264355552&4294967295,z=N+(V<<10&4294967295|V>>>22),V=R+(N^(z|~k))+$[6]+2734768916&4294967295,R=z+(V<<15&4294967295|V>>>17),V=k+(z^(R|~N))+$[13]+1309151649&4294967295,k=R+(V<<21&4294967295|V>>>11),V=N+(R^(k|~z))+$[4]+4149444226&4294967295,N=k+(V<<6&4294967295|V>>>26),V=z+(k^(N|~R))+$[11]+3174756917&4294967295,z=N+(V<<10&4294967295|V>>>22),V=R+(N^(z|~k))+$[2]+718787259&4294967295,R=z+(V<<15&4294967295|V>>>17),V=k+(z^(R|~N))+$[9]+3951481745&4294967295,O.g[0]=O.g[0]+N&4294967295,O.g[1]=O.g[1]+(R+(V<<21&4294967295|V>>>11))&4294967295,O.g[2]=O.g[2]+R&4294967295,O.g[3]=O.g[3]+z&4294967295}s.prototype.u=function(O,N){N===void 0&&(N=O.length);for(var k=N-this.blockSize,$=this.B,R=this.h,z=0;z<N;){if(R==0)for(;z<=k;)i(this,O,z),z+=this.blockSize;if(typeof O=="string"){for(;z<N;)if($[R++]=O.charCodeAt(z++),R==this.blockSize){i(this,$),R=0;break}}else for(;z<N;)if($[R++]=O[z++],R==this.blockSize){i(this,$),R=0;break}}this.h=R,this.o+=N},s.prototype.v=function(){var O=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);O[0]=128;for(var N=1;N<O.length-8;++N)O[N]=0;var k=8*this.o;for(N=O.length-8;N<O.length;++N)O[N]=k&255,k/=256;for(this.u(O),O=Array(16),N=k=0;4>N;++N)for(var $=0;32>$;$+=8)O[k++]=this.g[N]>>>$&255;return O};function r(O,N){var k=a;return Object.prototype.hasOwnProperty.call(k,O)?k[O]:k[O]=N(O)}function o(O,N){this.h=N;for(var k=[],$=!0,R=O.length-1;0<=R;R--){var z=O[R]|0;$&&z==N||(k[R]=z,$=!1)}this.g=k}var a={};function l(O){return-128<=O&&128>O?r(O,function(N){return new o([N|0],0>N?-1:0)}):new o([O|0],0>O?-1:0)}function c(O){if(isNaN(O)||!isFinite(O))return f;if(0>O)return v(c(-O));for(var N=[],k=1,$=0;O>=k;$++)N[$]=O/k|0,k*=4294967296;return new o(N,0)}function h(O,N){if(O.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(O.charAt(0)=="-")return v(h(O.substring(1),N));if(0<=O.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(N,8)),$=f,R=0;R<O.length;R+=8){var z=Math.min(8,O.length-R),V=parseInt(O.substring(R,R+z),N);8>z?(z=c(Math.pow(N,z)),$=$.j(z).add(c(V))):($=$.j(k),$=$.add(c(V)))}return $}var f=l(0),p=l(1),g=l(16777216);n=o.prototype,n.m=function(){if(x(this))return-v(this).m();for(var O=0,N=1,k=0;k<this.g.length;k++){var $=this.i(k);O+=(0<=$?$:4294967296+$)*N,N*=4294967296}return O},n.toString=function(O){if(O=O||10,2>O||36<O)throw Error("radix out of range: "+O);if(y(this))return"0";if(x(this))return"-"+v(this).toString(O);for(var N=c(Math.pow(O,6)),k=this,$="";;){var R=I(k,N).g;k=w(k,R.j(N));var z=((0<k.g.length?k.g[0]:k.h)>>>0).toString(O);if(k=R,y(k))return z+$;for(;6>z.length;)z="0"+z;$=z+$}},n.i=function(O){return 0>O?0:O<this.g.length?this.g[O]:this.h};function y(O){if(O.h!=0)return!1;for(var N=0;N<O.g.length;N++)if(O.g[N]!=0)return!1;return!0}function x(O){return O.h==-1}n.l=function(O){return O=w(this,O),x(O)?-1:y(O)?0:1};function v(O){for(var N=O.g.length,k=[],$=0;$<N;$++)k[$]=~O.g[$];return new o(k,~O.h).add(p)}n.abs=function(){return x(this)?v(this):this},n.add=function(O){for(var N=Math.max(this.g.length,O.g.length),k=[],$=0,R=0;R<=N;R++){var z=$+(this.i(R)&65535)+(O.i(R)&65535),V=(z>>>16)+(this.i(R)>>>16)+(O.i(R)>>>16);$=V>>>16,z&=65535,V&=65535,k[R]=V<<16|z}return new o(k,k[k.length-1]&-2147483648?-1:0)};function w(O,N){return O.add(v(N))}n.j=function(O){if(y(this)||y(O))return f;if(x(this))return x(O)?v(this).j(v(O)):v(v(this).j(O));if(x(O))return v(this.j(v(O)));if(0>this.l(g)&&0>O.l(g))return c(this.m()*O.m());for(var N=this.g.length+O.g.length,k=[],$=0;$<2*N;$++)k[$]=0;for($=0;$<this.g.length;$++)for(var R=0;R<O.g.length;R++){var z=this.i($)>>>16,V=this.i($)&65535,ne=O.i(R)>>>16,Q=O.i(R)&65535;k[2*$+2*R]+=V*Q,S(k,2*$+2*R),k[2*$+2*R+1]+=z*Q,S(k,2*$+2*R+1),k[2*$+2*R+1]+=V*ne,S(k,2*$+2*R+1),k[2*$+2*R+2]+=z*ne,S(k,2*$+2*R+2)}for($=0;$<N;$++)k[$]=k[2*$+1]<<16|k[2*$];for($=N;$<2*N;$++)k[$]=0;return new o(k,0)};function S(O,N){for(;(O[N]&65535)!=O[N];)O[N+1]+=O[N]>>>16,O[N]&=65535,N++}function C(O,N){this.g=O,this.h=N}function I(O,N){if(y(N))throw Error("division by zero");if(y(O))return new C(f,f);if(x(O))return N=I(v(O),N),new C(v(N.g),v(N.h));if(x(N))return N=I(O,v(N)),new C(v(N.g),N.h);if(30<O.g.length){if(x(O)||x(N))throw Error("slowDivide_ only works with positive integers.");for(var k=p,$=N;0>=$.l(O);)k=A(k),$=A($);var R=L(k,1),z=L($,1);for($=L($,2),k=L(k,2);!y($);){var V=z.add($);0>=V.l(O)&&(R=R.add(k),z=V),$=L($,1),k=L(k,1)}return N=w(O,R.j(N)),new C(R,N)}for(R=f;0<=O.l(N);){for(k=Math.max(1,Math.floor(O.m()/N.m())),$=Math.ceil(Math.log(k)/Math.LN2),$=48>=$?1:Math.pow(2,$-48),z=c(k),V=z.j(N);x(V)||0<V.l(O);)k-=$,z=c(k),V=z.j(N);y(z)&&(z=p),R=R.add(z),O=w(O,V)}return new C(R,O)}n.A=function(O){return I(this,O).h},n.and=function(O){for(var N=Math.max(this.g.length,O.g.length),k=[],$=0;$<N;$++)k[$]=this.i($)&O.i($);return new o(k,this.h&O.h)},n.or=function(O){for(var N=Math.max(this.g.length,O.g.length),k=[],$=0;$<N;$++)k[$]=this.i($)|O.i($);return new o(k,this.h|O.h)},n.xor=function(O){for(var N=Math.max(this.g.length,O.g.length),k=[],$=0;$<N;$++)k[$]=this.i($)^O.i($);return new o(k,this.h^O.h)};function A(O){for(var N=O.g.length+1,k=[],$=0;$<N;$++)k[$]=O.i($)<<1|O.i($-1)>>>31;return new o(k,O.h)}function L(O,N){var k=N>>5;N%=32;for(var $=O.g.length-k,R=[],z=0;z<$;z++)R[z]=0<N?O.i(z+k)>>>N|O.i(z+k+1)<<32-N:O.i(z+k);return new o(R,O.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,VK=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Iu=o}).apply(typeof s4<"u"?s4:typeof self<"u"?self:typeof window<"u"?window:{});var G_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zK,$b,BK,P1,r2,UK,WK,HK;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(_,D,M){return _==Array.prototype||_==Object.prototype||(_[D]=M.value),_};function t(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof G_=="object"&&G_];for(var D=0;D<_.length;++D){var M=_[D];if(M&&M.Math==Math)return M}throw Error("Cannot find global object")}var s=t(this);function i(_,D){if(D)e:{var M=s;_=_.split(".");for(var j=0;j<_.length-1;j++){var fe=_[j];if(!(fe in M))break e;M=M[fe]}_=_[_.length-1],j=M[_],D=D(j),D!=j&&D!=null&&e(M,_,{configurable:!0,writable:!0,value:D})}}function r(_,D){_ instanceof String&&(_+="");var M=0,j=!1,fe={next:function(){if(!j&&M<_.length){var xe=M++;return{value:D(xe,_[xe]),done:!1}}return j=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}i("Array.prototype.values",function(_){return _||function(){return r(this,function(D,M){return M})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(_){var D=typeof _;return D=D!="object"?D:_?Array.isArray(_)?"array":D:"null",D=="array"||D=="object"&&typeof _.length=="number"}function c(_){var D=typeof _;return D=="object"&&_!=null||D=="function"}function h(_,D,M){return _.call.apply(_.bind,arguments)}function f(_,D,M){if(!_)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,j),_.apply(D,fe)}}return function(){return _.apply(D,arguments)}}function p(_,D,M){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,p.apply(null,arguments)}function g(_,D){var M=Array.prototype.slice.call(arguments,1);return function(){var j=M.slice();return j.push.apply(j,arguments),_.apply(this,j)}}function y(_,D){function M(){}M.prototype=D.prototype,_.aa=D.prototype,_.prototype=new M,_.prototype.constructor=_,_.Qb=function(j,fe,xe){for(var Oe=Array(arguments.length-2),Pt=2;Pt<arguments.length;Pt++)Oe[Pt-2]=arguments[Pt];return D.prototype[fe].apply(j,Oe)}}function x(_){const D=_.length;if(0<D){const M=Array(D);for(let j=0;j<D;j++)M[j]=_[j];return M}return[]}function v(_,D){for(let M=1;M<arguments.length;M++){const j=arguments[M];if(l(j)){const fe=_.length||0,xe=j.length||0;_.length=fe+xe;for(let Oe=0;Oe<xe;Oe++)_[fe+Oe]=j[Oe]}else _.push(j)}}class w{constructor(D,M){this.i=D,this.j=M,this.h=0,this.g=null}get(){let D;return 0<this.h?(this.h--,D=this.g,this.g=D.next,D.next=null):D=this.i(),D}}function S(_){return/^[\s\xa0]*$/.test(_)}function C(){var _=a.navigator;return _&&(_=_.userAgent)?_:""}function I(_){return I[" "](_),_}I[" "]=function(){};var A=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function L(_,D,M){for(const j in _)D.call(M,_[j],j,_)}function O(_,D){for(const M in _)D.call(void 0,_[M],M,_)}function N(_){const D={};for(const M in _)D[M]=_[M];return D}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(_,D){let M,j;for(let fe=1;fe<arguments.length;fe++){j=arguments[fe];for(M in j)_[M]=j[M];for(let xe=0;xe<k.length;xe++)M=k[xe],Object.prototype.hasOwnProperty.call(j,M)&&(_[M]=j[M])}}function R(_){var D=1;_=_.split(":");const M=[];for(;0<D&&_.length;)M.push(_.shift()),D--;return _.length&&M.push(_.join(":")),M}function z(_){a.setTimeout(()=>{throw _},0)}function V(){var _=le;let D=null;return _.g&&(D=_.g,_.g=_.g.next,_.g||(_.h=null),D.next=null),D}class ne{constructor(){this.h=this.g=null}add(D,M){const j=Q.get();j.set(D,M),this.h?this.h.next=j:this.g=j,this.h=j}}var Q=new w(()=>new G,_=>_.reset());class G{constructor(){this.next=this.g=this.h=null}set(D,M){this.h=D,this.g=M,this.next=null}reset(){this.next=this.g=this.h=null}}let J,Z=!1,le=new ne,H=()=>{const _=a.Promise.resolve(void 0);J=()=>{_.then(ee)}};var ee=()=>{for(var _;_=V();){try{_.h.call(_.g)}catch(M){z(M)}var D=Q;D.j(_),100>D.h&&(D.h++,_.next=D.g,D.g=_)}Z=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ae(_,D){this.type=_,this.g=this.target=D,this.defaultPrevented=!1}ae.prototype.h=function(){this.defaultPrevented=!0};var pe=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var _=!1,D=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const M=()=>{};a.addEventListener("test",M,D),a.removeEventListener("test",M,D)}catch{}return _}();function _e(_,D){if(ae.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_){var M=this.type=_.type,j=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;if(this.target=_.target||_.srcElement,this.g=D,D=_.relatedTarget){if(A){e:{try{I(D.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(D=null)}}else M=="mouseover"?D=_.fromElement:M=="mouseout"&&(D=_.toElement);this.relatedTarget=D,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=typeof _.pointerType=="string"?_.pointerType:Ee[_.pointerType]||"",this.state=_.state,this.i=_,_.defaultPrevented&&_e.aa.h.call(this)}}y(_e,ae);var Ee={2:"touch",3:"pen",4:"mouse"};_e.prototype.h=function(){_e.aa.h.call(this);var _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var Le="closure_listenable_"+(1e6*Math.random()|0),$e=0;function Me(_,D,M,j,fe){this.listener=_,this.proxy=null,this.src=D,this.type=M,this.capture=!!j,this.ha=fe,this.key=++$e,this.da=this.fa=!1}function ze(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function Ze(_){this.src=_,this.g={},this.h=0}Ze.prototype.add=function(_,D,M,j,fe){var xe=_.toString();_=this.g[xe],_||(_=this.g[xe]=[],this.h++);var Oe=bt(_,D,j,fe);return-1<Oe?(D=_[Oe],M||(D.fa=!1)):(D=new Me(D,this.src,xe,!!j,fe),D.fa=M,_.push(D)),D};function yt(_,D){var M=D.type;if(M in _.g){var j=_.g[M],fe=Array.prototype.indexOf.call(j,D,void 0),xe;(xe=0<=fe)&&Array.prototype.splice.call(j,fe,1),xe&&(ze(D),_.g[M].length==0&&(delete _.g[M],_.h--))}}function bt(_,D,M,j){for(var fe=0;fe<_.length;++fe){var xe=_[fe];if(!xe.da&&xe.listener==D&&xe.capture==!!M&&xe.ha==j)return fe}return-1}var Wt="closure_lm_"+(1e6*Math.random()|0),Nt={};function xt(_,D,M,j,fe){if(Array.isArray(D)){for(var xe=0;xe<D.length;xe++)xt(_,D[xe],M,j,fe);return null}return M=or(M),_&&_[Le]?_.K(D,M,c(j)?!!j.capture:!1,fe):Yt(_,D,M,!1,j,fe)}function Yt(_,D,M,j,fe,xe){if(!D)throw Error("Invalid event type");var Oe=c(fe)?!!fe.capture:!!fe,Pt=Tr(_);if(Pt||(_[Wt]=Pt=new Ze(_)),M=Pt.add(D,M,j,Oe,xe),M.proxy)return M;if(j=Ht(),M.proxy=j,j.src=_,j.listener=M,_.addEventListener)pe||(fe=Oe),fe===void 0&&(fe=!1),_.addEventListener(D.toString(),j,fe);else if(_.attachEvent)_.attachEvent(Bi(D.toString()),j);else if(_.addListener&&_.removeListener)_.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return M}function Ht(){function _(M){return D.call(_.src,_.listener,M)}const D=ii;return _}function yi(_,D,M,j,fe){if(Array.isArray(D))for(var xe=0;xe<D.length;xe++)yi(_,D[xe],M,j,fe);else j=c(j)?!!j.capture:!!j,M=or(M),_&&_[Le]?(_=_.i,D=String(D).toString(),D in _.g&&(xe=_.g[D],M=bt(xe,M,j,fe),-1<M&&(ze(xe[M]),Array.prototype.splice.call(xe,M,1),xe.length==0&&(delete _.g[D],_.h--)))):_&&(_=Tr(_))&&(D=_.g[D.toString()],_=-1,D&&(_=bt(D,M,j,fe)),(M=-1<_?D[_]:null)&&bn(M))}function bn(_){if(typeof _!="number"&&_&&!_.da){var D=_.src;if(D&&D[Le])yt(D.i,_);else{var M=_.type,j=_.proxy;D.removeEventListener?D.removeEventListener(M,j,_.capture):D.detachEvent?D.detachEvent(Bi(M),j):D.addListener&&D.removeListener&&D.removeListener(j),(M=Tr(D))?(yt(M,_),M.h==0&&(M.src=null,D[Wt]=null)):ze(_)}}}function Bi(_){return _ in Nt?Nt[_]:Nt[_]="on"+_}function ii(_,D){if(_.da)_=!0;else{D=new _e(D,this);var M=_.listener,j=_.ha||_.src;_.fa&&bn(_),_=M.call(j,D)}return _}function Tr(_){return _=_[Wt],_ instanceof Ze?_:null}var vn="__closure_events_fn_"+(1e9*Math.random()>>>0);function or(_){return typeof _=="function"?_:(_[vn]||(_[vn]=function(D){return _.handleEvent(D)}),_[vn])}function an(){he.call(this),this.i=new Ze(this),this.M=this,this.F=null}y(an,he),an.prototype[Le]=!0,an.prototype.removeEventListener=function(_,D,M,j){yi(this,_,D,M,j)};function dn(_,D){var M,j=_.F;if(j)for(M=[];j;j=j.F)M.push(j);if(_=_.M,j=D.type||D,typeof D=="string")D=new ae(D,_);else if(D instanceof ae)D.target=D.target||_;else{var fe=D;D=new ae(j,_),$(D,fe)}if(fe=!0,M)for(var xe=M.length-1;0<=xe;xe--){var Oe=D.g=M[xe];fe=Ms(Oe,j,!0,D)&&fe}if(Oe=D.g=_,fe=Ms(Oe,j,!0,D)&&fe,fe=Ms(Oe,j,!1,D)&&fe,M)for(xe=0;xe<M.length;xe++)Oe=D.g=M[xe],fe=Ms(Oe,j,!1,D)&&fe}an.prototype.N=function(){if(an.aa.N.call(this),this.i){var _=this.i,D;for(D in _.g){for(var M=_.g[D],j=0;j<M.length;j++)ze(M[j]);delete _.g[D],_.h--}}this.F=null},an.prototype.K=function(_,D,M,j){return this.i.add(String(_),D,!1,M,j)},an.prototype.L=function(_,D,M,j){return this.i.add(String(_),D,!0,M,j)};function Ms(_,D,M,j){if(D=_.i.g[String(D)],!D)return!0;D=D.concat();for(var fe=!0,xe=0;xe<D.length;++xe){var Oe=D[xe];if(Oe&&!Oe.da&&Oe.capture==M){var Pt=Oe.listener,Ts=Oe.ha||Oe.src;Oe.fa&&yt(_.i,Oe),fe=Pt.call(Ts,j)!==!1&&fe}}return fe&&!j.defaultPrevented}function ca(_,D,M){if(typeof _=="function")M&&(_=p(_,M));else if(_&&typeof _.handleEvent=="function")_=p(_.handleEvent,_);else throw Error("Invalid listener argument");return 2147483647<Number(D)?-1:a.setTimeout(_,D||0)}function al(_){_.g=ca(()=>{_.g=null,_.i&&(_.i=!1,al(_))},_.l);const D=_.h;_.h=null,_.m.apply(null,D)}class bh extends he{constructor(D,M){super(),this.m=D,this.l=M,this.h=null,this.i=!1,this.g=null}j(D){this.h=arguments,this.g?this.i=!0:al(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ll(_){he.call(this),this.h=_,this.g={}}y(ll,he);var Sr=[];function Fs(_){L(_.g,function(D,M){this.g.hasOwnProperty(M)&&bn(D)},_),_.g={}}ll.prototype.N=function(){ll.aa.N.call(this),Fs(this)},ll.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vh=a.JSON.stringify,ua=a.JSON.parse,Ui=class{stringify(_){return a.JSON.stringify(_,void 0)}parse(_){return a.JSON.parse(_,void 0)}};function iy(){}iy.prototype.h=null;function hw(_){return _.h||(_.h=_.i())}function dw(){}var ha={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Cc(){ae.call(this,"d")}y(Cc,ae);function Do(){ae.call(this,"c")}y(Do,ae);var Gr={},Ic=null;function kf(){return Ic=Ic||new an}Gr.La="serverreachability";function ry(_){ae.call(this,Gr.La,_)}y(ry,ae);function kc(_){const D=kf();dn(D,new ry(D))}Gr.STAT_EVENT="statevent";function Nf(_,D){ae.call(this,Gr.STAT_EVENT,_),this.stat=D}y(Nf,ae);function ts(_){const D=kf();dn(D,new Nf(D,_))}Gr.Ma="timingevent";function fw(_,D){ae.call(this,Gr.Ma,_),this.size=D}y(fw,ae);function Nc(_,D){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){_()},D)}function Ac(){this.g=!0}Ac.prototype.xa=function(){this.g=!1};function pw(_,D,M,j,fe,xe){_.info(function(){if(_.g)if(xe)for(var Oe="",Pt=xe.split("&"),Ts=0;Ts<Pt.length;Ts++){var Lt=Pt[Ts].split("=");if(1<Lt.length){var Bs=Lt[0];Lt=Lt[1];var Ss=Bs.split("_");Oe=2<=Ss.length&&Ss[1]=="type"?Oe+(Bs+"="+Lt+"&"):Oe+(Bs+"=redacted&")}}else Oe=null;else Oe=xe;return"XMLHTTP REQ ("+j+") [attempt "+fe+"]: "+D+`
`+M+`
`+Oe})}function mw(_,D,M,j,fe,xe,Oe){_.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+fe+"]: "+D+`
`+M+`
`+xe+" "+Oe})}function Rc(_,D,M,j){_.info(function(){return"XMLHTTP TEXT ("+D+"): "+Vs(_,M)+(j?" "+j:"")})}function da(_,D){_.info(function(){return"TIMEOUT: "+D})}Ac.prototype.info=function(){};function Vs(_,D){if(!_.g)return D;if(!D)return null;try{var M=JSON.parse(D);if(M){for(_=0;_<M.length;_++)if(Array.isArray(M[_])){var j=M[_];if(!(2>j.length)){var fe=j[1];if(Array.isArray(fe)&&!(1>fe.length)){var xe=fe[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(var Oe=1;Oe<fe.length;Oe++)fe[Oe]=""}}}}return vh(M)}catch{return D}}var _s={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},cl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xh;function Af(){}y(Af,iy),Af.prototype.g=function(){return new XMLHttpRequest},Af.prototype.i=function(){return{}},xh=new Af;function fa(_,D,M,j){this.j=_,this.i=D,this.l=M,this.R=j||1,this.U=new ll(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oy}function oy(){this.i=null,this.g="",this.h=!1}var Dc={},wh={};function $o(_,D,M){_.L=1,_.v=Sh(Un(D)),_.m=M,_.P=!0,ul(_,null)}function ul(_,D){_.F=Date.now(),Pn(_),_.A=Un(_.v);var M=_.A,j=_.R;Array.isArray(j)||(j=[String(j)]),fl(M.i,"t",j),_.C=0,M=_.j.J,_.h=new oy,_.g=Nw(_.j,M?D:null,!_.m),0<_.O&&(_.M=new bh(p(_.Y,_,_.g),_.O)),D=_.U,M=_.g,j=_.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(Sr[0]=fe.toString()),fe=Sr);for(var xe=0;xe<fe.length;xe++){var Oe=xt(M,fe[xe],j||D.handleEvent,!1,D.h||D);if(!Oe)break;D.g[Oe.key]=Oe}D=_.H?N(_.H):{},_.m?(_.u||(_.u="POST"),D["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.A,_.u,_.m,D)):(_.u="GET",_.g.ea(_.A,_.u,null,D)),kc(),pw(_.i,_.u,_.A,_.l,_.R,_.m)}fa.prototype.ca=function(_){_=_.target;const D=this.M;D&&Qr(_)==3?D.j():this.Y(_)},fa.prototype.Y=function(_){try{if(_==this.g)e:{const Ss=Qr(this.g);var D=this.g.Ba();const yl=this.g.Z();if(!(3>Ss)&&(Ss!=3||this.g&&(this.h.h||this.g.oa()||ww(this.g)))){this.J||Ss!=4||D==7||(D==8||0>=yl?kc(3):kc(2)),Rf(this);var M=this.g.Z();this.X=M;t:if($c(this)){var j=ww(this.g);_="";var fe=j.length,xe=Qr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ar(this),Er(this);var Oe="";break t}this.h.i=new a.TextDecoder}for(D=0;D<fe;D++)this.h.h=!0,_+=this.h.i.decode(j[D],{stream:!(xe&&D==fe-1)});j.length=0,this.h.g+=_,this.C=0,Oe=this.h.g}else Oe=this.g.oa();if(this.o=M==200,mw(this.i,this.u,this.A,this.l,this.R,Ss,M),this.o){if(this.T&&!this.K){t:{if(this.g){var Pt,Ts=this.g;if((Pt=Ts.g?Ts.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Pt)){var Lt=Pt;break t}}Lt=null}if(M=Lt)Rc(this.i,this.l,M,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Cr(this,M);else{this.o=!1,this.s=3,ts(12),ar(this),Er(this);break e}}if(this.P){M=!0;let ri;for(;!this.J&&this.C<Oe.length;)if(ri=Oc(this,Oe),ri==wh){Ss==4&&(this.s=4,ts(14),M=!1),Rc(this.i,this.l,null,"[Incomplete Response]");break}else if(ri==Dc){this.s=4,ts(15),Rc(this.i,this.l,Oe,"[Invalid Chunk]"),M=!1;break}else Rc(this.i,this.l,ri,null),Cr(this,ri);if($c(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ss!=4||Oe.length!=0||this.h.h||(this.s=1,ts(16),M=!1),this.o=this.o&&M,!M)Rc(this.i,this.l,Oe,"[Invalid Chunked Response]"),ar(this),Er(this);else if(0<Oe.length&&!this.W){this.W=!0;var Bs=this.j;Bs.g==this&&Bs.ba&&!Bs.M&&(Bs.j.info("Great, no buffering proxy detected. Bytes received: "+Oe.length),Rh(Bs),Bs.M=!0,ts(11))}}else Rc(this.i,this.l,Oe,null),Cr(this,Oe);Ss==4&&ar(this),this.o&&!this.J&&(Ss==4?Cw(this.j,this):(this.o=!1,Pn(this)))}else LI(this.g),M==400&&0<Oe.indexOf("Unknown SID")?(this.s=3,ts(12)):(this.s=0,ts(13)),ar(this),Er(this)}}}catch{}finally{}};function $c(_){return _.g?_.u=="GET"&&_.L!=2&&_.j.Ca:!1}function Oc(_,D){var M=_.C,j=D.indexOf(`
`,M);return j==-1?wh:(M=Number(D.substring(M,j)),isNaN(M)?Dc:(j+=1,j+M>D.length?wh:(D=D.slice(j,j+M),_.C=j+M,D)))}fa.prototype.cancel=function(){this.J=!0,ar(this)};function Pn(_){_.S=Date.now()+_.I,ay(_,_.I)}function ay(_,D){if(_.B!=null)throw Error("WatchDog timer not null");_.B=Nc(p(_.ba,_),D)}function Rf(_){_.B&&(a.clearTimeout(_.B),_.B=null)}fa.prototype.ba=function(){this.B=null;const _=Date.now();0<=_-this.S?(da(this.i,this.A),this.L!=2&&(kc(),ts(17)),ar(this),this.s=2,Er(this)):ay(this,this.S-_)};function Er(_){_.j.G==0||_.J||Cw(_.j,_)}function ar(_){Rf(_);var D=_.M;D&&typeof D.ma=="function"&&D.ma(),_.M=null,Fs(_.U),_.g&&(D=_.g,_.g=null,D.abort(),D.ma())}function Cr(_,D){try{var M=_.j;if(M.G!=0&&(M.g==_||Pc(M.h,_))){if(!_.K&&Pc(M.h,_)&&M.G==3){try{var j=M.Da.g.parse(D)}catch{j=null}if(Array.isArray(j)&&j.length==3){var fe=j;if(fe[0]==0){e:if(!M.u){if(M.g)if(M.g.F+3e3<_.F)Bf(M),Vf(M);else break e;by(M),ts(18)}}else M.za=fe[1],0<M.za-M.T&&37500>fe[2]&&M.F&&M.v==0&&!M.C&&(M.C=Nc(p(M.Za,M),6e3));if(1>=gw(M.h)&&M.ca){try{M.ca()}catch{}M.ca=void 0}}else gl(M,11)}else if((_.K||M.g==_)&&Bf(M),!S(D))for(fe=M.Da.g.parse(D),D=0;D<fe.length;D++){let Lt=fe[D];if(M.T=Lt[0],Lt=Lt[1],M.G==2)if(Lt[0]=="c"){M.K=Lt[1],M.ia=Lt[2];const Bs=Lt[3];Bs!=null&&(M.la=Bs,M.j.info("VER="+M.la));const Ss=Lt[4];Ss!=null&&(M.Aa=Ss,M.j.info("SVER="+M.Aa));const yl=Lt[5];yl!=null&&typeof yl=="number"&&0<yl&&(j=1.5*yl,M.L=j,M.j.info("backChannelRequestTimeoutMs_="+j)),j=M;const ri=_.g;if(ri){const xa=ri.g?ri.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xa){var xe=j.h;xe.g||xa.indexOf("spdy")==-1&&xa.indexOf("quic")==-1&&xa.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&(Lc(xe,xe.h),xe.h=null))}if(j.D){const xy=ri.g?ri.g.getResponseHeader("X-HTTP-Session-Id"):null;xy&&(j.ya=xy,jt(j.I,j.D,xy))}}M.G=3,M.l&&M.l.ua(),M.ba&&(M.R=Date.now()-_.F,M.j.info("Handshake RTT: "+M.R+"ms")),j=M;var Oe=_;if(j.qa=kw(j,j.J?j.ia:null,j.W),Oe.K){qr(j.h,Oe);var Pt=Oe,Ts=j.L;Ts&&(Pt.I=Ts),Pt.B&&(Rf(Pt),Pn(Pt)),j.g=Oe}else Sw(j);0<M.i.length&&zf(M)}else Lt[0]!="stop"&&Lt[0]!="close"||gl(M,7);else M.G==3&&(Lt[0]=="stop"||Lt[0]=="close"?Lt[0]=="stop"?gl(M,7):gy(M):Lt[0]!="noop"&&M.l&&M.l.ta(Lt),M.v=0)}}kc(4)}catch{}}var RI=class{constructor(_,D){this.g=_,this.map=D}};function ly(_){this.l=_||10,a.PerformanceNavigationTiming?(_=a.performance.getEntriesByType("navigation"),_=0<_.length&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function cy(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function gw(_){return _.h?1:_.g?_.g.size:0}function Pc(_,D){return _.h?_.h==D:_.g?_.g.has(D):!1}function Lc(_,D){_.g?_.g.add(D):_.h=D}function qr(_,D){_.h&&_.h==D?_.h=null:_.g&&_.g.has(D)&&_.g.delete(D)}ly.prototype.cancel=function(){if(this.i=Wi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function Wi(_){if(_.h!=null)return _.i.concat(_.h.D);if(_.g!=null&&_.g.size!==0){let D=_.i;for(const M of _.g.values())D=D.concat(M.D);return D}return x(_.i)}function yw(_){if(_.V&&typeof _.V=="function")return _.V();if(typeof Map<"u"&&_ instanceof Map||typeof Set<"u"&&_ instanceof Set)return Array.from(_.values());if(typeof _=="string")return _.split("");if(l(_)){for(var D=[],M=_.length,j=0;j<M;j++)D.push(_[j]);return D}D=[],M=0;for(j in _)D[M++]=_[j];return D}function DI(_){if(_.na&&typeof _.na=="function")return _.na();if(!_.V||typeof _.V!="function"){if(typeof Map<"u"&&_ instanceof Map)return Array.from(_.keys());if(!(typeof Set<"u"&&_ instanceof Set)){if(l(_)||typeof _=="string"){var D=[];_=_.length;for(var M=0;M<_;M++)D.push(M);return D}D=[],M=0;for(const j in _)D[M++]=j;return D}}}function _h(_,D){if(_.forEach&&typeof _.forEach=="function")_.forEach(D,void 0);else if(l(_)||typeof _=="string")Array.prototype.forEach.call(_,D,void 0);else for(var M=DI(_),j=yw(_),fe=j.length,xe=0;xe<fe;xe++)D.call(void 0,j[xe],M&&M[xe],_)}var uy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Df(_,D){if(_){_=_.split("&");for(var M=0;M<_.length;M++){var j=_[M].indexOf("="),fe=null;if(0<=j){var xe=_[M].substring(0,j);fe=_[M].substring(j+1)}else xe=_[M];D(xe,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function hl(_){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,_ instanceof hl){this.h=_.h,Mc(this,_.j),this.o=_.o,this.g=_.g,Th(this,_.s),this.l=_.l;var D=_.i,M=new pa;M.i=D.i,D.g&&(M.g=new Map(D.g),M.h=D.h),$f(this,M),this.m=_.m}else _&&(D=String(_).match(uy))?(this.h=!1,Mc(this,D[1]||"",!0),this.o=Fc(D[2]||""),this.g=Fc(D[3]||"",!0),Th(this,D[4]),this.l=Fc(D[5]||"",!0),$f(this,D[6]||"",!0),this.m=Fc(D[7]||"")):(this.h=!1,this.i=new pa(null,this.h))}hl.prototype.toString=function(){var _=[],D=this.j;D&&_.push(Kr(D,hy,!0),":");var M=this.g;return(M||D=="file")&&(_.push("//"),(D=this.o)&&_.push(Kr(D,hy,!0),"@"),_.push(encodeURIComponent(String(M)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),M=this.s,M!=null&&_.push(":",String(M))),(M=this.l)&&(this.g&&M.charAt(0)!="/"&&_.push("/"),_.push(Kr(M,M.charAt(0)=="/"?dy:bw,!0))),(M=this.i.toString())&&_.push("?",M),(M=this.m)&&_.push("#",Kr(M,PI)),_.join("")};function Un(_){return new hl(_)}function Mc(_,D,M){_.j=M?Fc(D,!0):D,_.j&&(_.j=_.j.replace(/:$/,""))}function Th(_,D){if(D){if(D=Number(D),isNaN(D)||0>D)throw Error("Bad port number "+D);_.s=D}else _.s=null}function $f(_,D,M){D instanceof pa?(_.i=D,fy(_.i,_.h)):(M||(D=Kr(D,OI)),_.i=new pa(D,_.h))}function jt(_,D,M){_.i.set(D,M)}function Sh(_){return jt(_,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),_}function Fc(_,D){return _?D?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Kr(_,D,M){return typeof _=="string"?(_=encodeURI(_).replace(D,$I),M&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function $I(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var hy=/[#\/\?@]/g,bw=/[#\?:]/g,dy=/[#\?]/g,OI=/[#\?@]/g,PI=/#/g;function pa(_,D){this.h=this.g=null,this.i=_||null,this.j=!!D}function Xr(_){_.g||(_.g=new Map,_.h=0,_.i&&Df(_.i,function(D,M){_.add(decodeURIComponent(D.replace(/\+/g," ")),M)}))}n=pa.prototype,n.add=function(_,D){Xr(this),this.i=null,_=pl(this,_);var M=this.g.get(_);return M||this.g.set(_,M=[]),M.push(D),this.h+=1,this};function Of(_,D){Xr(_),D=pl(_,D),_.g.has(D)&&(_.i=null,_.h-=_.g.get(D).length,_.g.delete(D))}function dl(_,D){return Xr(_),D=pl(_,D),_.g.has(D)}n.forEach=function(_,D){Xr(this),this.g.forEach(function(M,j){M.forEach(function(fe){_.call(D,fe,j,this)},this)},this)},n.na=function(){Xr(this);const _=Array.from(this.g.values()),D=Array.from(this.g.keys()),M=[];for(let j=0;j<D.length;j++){const fe=_[j];for(let xe=0;xe<fe.length;xe++)M.push(D[j])}return M},n.V=function(_){Xr(this);let D=[];if(typeof _=="string")dl(this,_)&&(D=D.concat(this.g.get(pl(this,_))));else{_=Array.from(this.g.values());for(let M=0;M<_.length;M++)D=D.concat(_[M])}return D},n.set=function(_,D){return Xr(this),this.i=null,_=pl(this,_),dl(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[D]),this.h+=1,this},n.get=function(_,D){return _?(_=this.V(_),0<_.length?String(_[0]):D):D};function fl(_,D,M){Of(_,D),0<M.length&&(_.i=null,_.g.set(pl(_,D),x(M)),_.h+=M.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],D=Array.from(this.g.keys());for(var M=0;M<D.length;M++){var j=D[M];const xe=encodeURIComponent(String(j)),Oe=this.V(j);for(j=0;j<Oe.length;j++){var fe=xe;Oe[j]!==""&&(fe+="="+encodeURIComponent(String(Oe[j]))),_.push(fe)}}return this.i=_.join("&")};function pl(_,D){return D=String(D),_.j&&(D=D.toLowerCase()),D}function fy(_,D){D&&!_.j&&(Xr(_),_.i=null,_.g.forEach(function(M,j){var fe=j.toLowerCase();j!=fe&&(Of(this,j),fl(this,fe,M))},_)),_.j=D}function vw(_,D){const M=new Ac;if(a.Image){const j=new Image;j.onload=g(Yr,M,"TestLoadImage: loaded",!0,D,j),j.onerror=g(Yr,M,"TestLoadImage: error",!1,D,j),j.onabort=g(Yr,M,"TestLoadImage: abort",!1,D,j),j.ontimeout=g(Yr,M,"TestLoadImage: timeout",!1,D,j),a.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=_}else D(!1)}function Eh(_,D){const M=new Ac,j=new AbortController,fe=setTimeout(()=>{j.abort(),Yr(M,"TestPingServer: timeout",!1,D)},1e4);fetch(_,{signal:j.signal}).then(xe=>{clearTimeout(fe),xe.ok?Yr(M,"TestPingServer: ok",!0,D):Yr(M,"TestPingServer: server error",!1,D)}).catch(()=>{clearTimeout(fe),Yr(M,"TestPingServer: error",!1,D)})}function Yr(_,D,M,j,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),j(M)}catch{}}function Ch(){this.g=new Ui}function ma(_,D,M){const j=M||"";try{_h(_,function(fe,xe){let Oe=fe;c(fe)&&(Oe=vh(fe)),D.push(j+xe+"="+encodeURIComponent(Oe))})}catch(fe){throw D.push(j+"type="+encodeURIComponent("_badmap")),fe}}function Vc(_){this.l=_.Ub||null,this.j=_.eb||!1}y(Vc,iy),Vc.prototype.g=function(){return new ml(this.l,this.j)},Vc.prototype.i=function(_){return function(){return _}}({});function ml(_,D){an.call(this),this.D=_,this.o=D,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(ml,an),n=ml.prototype,n.open=function(_,D){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=_,this.A=D,this.readyState=1,ya(this)},n.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const D={headers:this.u,method:this.B,credentials:this.m,cache:void 0};_&&(D.body=_),(this.D||a).fetch(new Request(this.A,D)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ga(this)),this.readyState=0},n.Sa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,ya(this)),this.g&&(this.readyState=3,ya(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;py(this)}else _.text().then(this.Ra.bind(this),this.ga.bind(this))};function py(_){_.j.read().then(_.Pa.bind(_)).catch(_.ga.bind(_))}n.Pa=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var D=_.value?_.value:new Uint8Array(0);(D=this.v.decode(D,{stream:!_.done}))&&(this.response=this.responseText+=D)}_.done?ga(this):ya(this),this.readyState==3&&py(this)}},n.Ra=function(_){this.g&&(this.response=this.responseText=_,ga(this))},n.Qa=function(_){this.g&&(this.response=_,ga(this))},n.ga=function(){this.g&&ga(this)};function ga(_){_.readyState=4,_.l=null,_.j=null,_.v=null,ya(_)}n.setRequestHeader=function(_,D){this.u.append(_,D)},n.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],D=this.h.entries();for(var M=D.next();!M.done;)M=M.value,_.push(M[0]+": "+M[1]),M=D.next();return _.join(`\r
`)};function ya(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(ml.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function my(_){let D="";return L(_,function(M,j){D+=j,D+=":",D+=M,D+=`\r
`}),D}function zs(_,D,M){e:{for(j in M){var j=!1;break e}j=!0}j||(M=my(M),typeof _=="string"?M!=null&&encodeURIComponent(String(M)):jt(_,D,M))}function Qt(_){an.call(this),this.headers=new Map,this.o=_||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Qt,an);var Pf=/^https?$/i,Ih=["POST","PUT"];n=Qt.prototype,n.Ha=function(_){this.J=_},n.ea=function(_,D,M,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);D=D?D.toUpperCase():"GET",this.D=_,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xh.g(),this.v=this.o?hw(this.o):hw(xh),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(D,String(_),!0),this.B=!1}catch(xe){xw(this,xe);return}if(_=M||"",M=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var fe in j)M.set(fe,j[fe]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const xe of j.keys())M.set(xe,j.get(xe));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(M.keys()).find(xe=>xe.toLowerCase()=="content-type"),fe=a.FormData&&_ instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Ih,D,void 0))||j||fe||M.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,Oe]of M)this.g.setRequestHeader(xe,Oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{kh(this),this.u=!0,this.g.send(_),this.u=!1}catch(xe){xw(this,xe)}};function xw(_,D){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=D,_.m=5,Lf(_),ba(_)}function Lf(_){_.A||(_.A=!0,dn(_,"complete"),dn(_,"error"))}n.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=_||7,dn(this,"complete"),dn(this,"abort"),ba(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ba(this,!0)),Qt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Mf(this):this.bb())},n.bb=function(){Mf(this)};function Mf(_){if(_.h&&typeof o<"u"&&(!_.v[1]||Qr(_)!=4||_.Z()!=2)){if(_.u&&Qr(_)==4)ca(_.Ea,0,_);else if(dn(_,"readystatechange"),Qr(_)==4){_.h=!1;try{const Oe=_.Z();e:switch(Oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var D=!0;break e;default:D=!1}var M;if(!(M=D)){var j;if(j=Oe===0){var fe=String(_.D).match(uy)[1]||null;!fe&&a.self&&a.self.location&&(fe=a.self.location.protocol.slice(0,-1)),j=!Pf.test(fe?fe.toLowerCase():"")}M=j}if(M)dn(_,"complete"),dn(_,"success");else{_.m=6;try{var xe=2<Qr(_)?_.g.statusText:""}catch{xe=""}_.l=xe+" ["+_.Z()+"]",Lf(_)}}finally{ba(_)}}}}function ba(_,D){if(_.g){kh(_);const M=_.g,j=_.v[0]?()=>{}:null;_.g=null,_.v=null,D||dn(_,"ready");try{M.onreadystatechange=j}catch{}}}function kh(_){_.I&&(a.clearTimeout(_.I),_.I=null)}n.isActive=function(){return!!this.g};function Qr(_){return _.g?_.g.readyState:0}n.Z=function(){try{return 2<Qr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(_){if(this.g){var D=this.g.responseText;return _&&D.indexOf(_)==0&&(D=D.substring(_.length)),ua(D)}};function ww(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.H){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function LI(_){const D={};_=(_.g&&2<=Qr(_)&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<_.length;j++){if(S(_[j]))continue;var M=R(_[j]);const fe=M[0];if(M=M[1],typeof M!="string")continue;M=M.trim();const xe=D[fe]||[];D[fe]=xe,xe.push(M)}O(D,function(j){return j.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Nh(_,D,M){return M&&M.internalChannelParams&&M.internalChannelParams[_]||D}function Ff(_){this.Aa=0,this.i=[],this.j=new Ac,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Nh("failFast",!1,_),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Nh("baseRetryDelayMs",5e3,_),this.cb=Nh("retryDelaySeedMs",1e4,_),this.Wa=Nh("forwardChannelMaxRetries",2,_),this.wa=Nh("forwardChannelRequestTimeoutMs",2e4,_),this.pa=_&&_.xmlHttpFactory||void 0,this.Xa=_&&_.Tb||void 0,this.Ca=_&&_.useFetchStreams||!1,this.L=void 0,this.J=_&&_.supportsCrossDomainXhr||!1,this.K="",this.h=new ly(_&&_.concurrentRequestLimit),this.Da=new Ch,this.P=_&&_.fastHandshake||!1,this.O=_&&_.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=_&&_.Rb||!1,_&&_.xa&&this.j.xa(),_&&_.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&_&&_.detectBufferingProxy||!1,this.ja=void 0,_&&_.longPollingTimeout&&0<_.longPollingTimeout&&(this.ja=_.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Ff.prototype,n.la=8,n.G=1,n.connect=function(_,D,M,j){ts(0),this.W=_,this.H=D||{},M&&j!==void 0&&(this.H.OSID=M,this.H.OAID=j),this.F=this.X,this.I=kw(this,null,this.W),zf(this)};function gy(_){if(_w(_),_.G==3){var D=_.U++,M=Un(_.I);if(jt(M,"SID",_.K),jt(M,"RID",D),jt(M,"TYPE","terminate"),Ah(_,M),D=new fa(_,_.j,D),D.L=2,D.v=Sh(Un(M)),M=!1,a.navigator&&a.navigator.sendBeacon)try{M=a.navigator.sendBeacon(D.v.toString(),"")}catch{}!M&&a.Image&&(new Image().src=D.v,M=!0),M||(D.g=Nw(D.j,null),D.g.ea(D.v)),D.F=Date.now(),Pn(D)}Iw(_)}function Vf(_){_.g&&(Rh(_),_.g.cancel(),_.g=null)}function _w(_){Vf(_),_.u&&(a.clearTimeout(_.u),_.u=null),Bf(_),_.h.cancel(),_.s&&(typeof _.s=="number"&&a.clearTimeout(_.s),_.s=null)}function zf(_){if(!cy(_.h)&&!_.s){_.s=!0;var D=_.Ga;J||H(),Z||(J(),Z=!0),le.add(D,_),_.B=0}}function MI(_,D){return gw(_.h)>=_.h.j-(_.s?1:0)?!1:_.s?(_.i=D.D.concat(_.i),!0):_.G==1||_.G==2||_.B>=(_.Va?0:_.Wa)?!1:(_.s=Nc(p(_.Ga,_,D),vy(_,_.B)),_.B++,!0)}n.Ga=function(_){if(this.s)if(this.s=null,this.G==1){if(!_){this.U=Math.floor(1e5*Math.random()),_=this.U++;const fe=new fa(this,this.j,_);let xe=this.o;if(this.S&&(xe?(xe=N(xe),$(xe,this.S)):xe=this.S),this.m!==null||this.O||(fe.H=xe,xe=null),this.P)e:{for(var D=0,M=0;M<this.i.length;M++){t:{var j=this.i[M];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(D+=j,4096<D){D=M;break e}if(D===4096||M===this.i.length-1){D=M+1;break e}}D=1e3}else D=1e3;D=Tw(this,fe,D),M=Un(this.I),jt(M,"RID",_),jt(M,"CVER",22),this.D&&jt(M,"X-HTTP-Session-Id",this.D),Ah(this,M),xe&&(this.O?D="headers="+encodeURIComponent(String(my(xe)))+"&"+D:this.m&&zs(M,this.m,xe)),Lc(this.h,fe),this.Ua&&jt(M,"TYPE","init"),this.P?(jt(M,"$req",D),jt(M,"SID","null"),fe.T=!0,$o(fe,M,null)):$o(fe,M,D),this.G=2}}else this.G==3&&(_?yy(this,_):this.i.length==0||cy(this.h)||yy(this))};function yy(_,D){var M;D?M=D.l:M=_.U++;const j=Un(_.I);jt(j,"SID",_.K),jt(j,"RID",M),jt(j,"AID",_.T),Ah(_,j),_.m&&_.o&&zs(j,_.m,_.o),M=new fa(_,_.j,M,_.B+1),_.m===null&&(M.H=_.o),D&&(_.i=D.D.concat(_.i)),D=Tw(_,M,1e3),M.I=Math.round(.5*_.wa)+Math.round(.5*_.wa*Math.random()),Lc(_.h,M),$o(M,j,D)}function Ah(_,D){_.H&&L(_.H,function(M,j){jt(D,j,M)}),_.l&&_h({},function(M,j){jt(D,j,M)})}function Tw(_,D,M){M=Math.min(_.i.length,M);var j=_.l?p(_.l.Na,_.l,_):null;e:{var fe=_.i;let xe=-1;for(;;){const Oe=["count="+M];xe==-1?0<M?(xe=fe[0].g,Oe.push("ofs="+xe)):xe=0:Oe.push("ofs="+xe);let Pt=!0;for(let Ts=0;Ts<M;Ts++){let Lt=fe[Ts].g;const Bs=fe[Ts].map;if(Lt-=xe,0>Lt)xe=Math.max(0,fe[Ts].g-100),Pt=!1;else try{ma(Bs,Oe,"req"+Lt+"_")}catch{j&&j(Bs)}}if(Pt){j=Oe.join("&");break e}}}return _=_.i.splice(0,M),D.D=_,j}function Sw(_){if(!_.g&&!_.u){_.Y=1;var D=_.Fa;J||H(),Z||(J(),Z=!0),le.add(D,_),_.v=0}}function by(_){return _.g||_.u||3<=_.v?!1:(_.Y++,_.u=Nc(p(_.Fa,_),vy(_,_.v)),_.v++,!0)}n.Fa=function(){if(this.u=null,Ew(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var _=2*this.R;this.j.info("BP detection timer enabled: "+_),this.A=Nc(p(this.ab,this),_)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ts(10),Vf(this),Ew(this))};function Rh(_){_.A!=null&&(a.clearTimeout(_.A),_.A=null)}function Ew(_){_.g=new fa(_,_.j,"rpc",_.Y),_.m===null&&(_.g.H=_.o),_.g.O=0;var D=Un(_.qa);jt(D,"RID","rpc"),jt(D,"SID",_.K),jt(D,"AID",_.T),jt(D,"CI",_.F?"0":"1"),!_.F&&_.ja&&jt(D,"TO",_.ja),jt(D,"TYPE","xmlhttp"),Ah(_,D),_.m&&_.o&&zs(D,_.m,_.o),_.L&&(_.g.I=_.L);var M=_.g;_=_.ia,M.L=1,M.v=Sh(Un(D)),M.m=null,M.P=!0,ul(M,_)}n.Za=function(){this.C!=null&&(this.C=null,Vf(this),by(this),ts(19))};function Bf(_){_.C!=null&&(a.clearTimeout(_.C),_.C=null)}function Cw(_,D){var M=null;if(_.g==D){Bf(_),Rh(_),_.g=null;var j=2}else if(Pc(_.h,D))M=D.D,qr(_.h,D),j=1;else return;if(_.G!=0){if(D.o)if(j==1){M=D.m?D.m.length:0,D=Date.now()-D.F;var fe=_.B;j=kf(),dn(j,new fw(j,M)),zf(_)}else Sw(_);else if(fe=D.s,fe==3||fe==0&&0<D.X||!(j==1&&MI(_,D)||j==2&&by(_)))switch(M&&0<M.length&&(D=_.h,D.i=D.i.concat(M)),fe){case 1:gl(_,5);break;case 4:gl(_,10);break;case 3:gl(_,6);break;default:gl(_,2)}}}function vy(_,D){let M=_.Ta+Math.floor(Math.random()*_.cb);return _.isActive()||(M*=2),M*D}function gl(_,D){if(_.j.info("Error code "+D),D==2){var M=p(_.fb,_),j=_.Xa;const fe=!j;j=new hl(j||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Mc(j,"https"),Sh(j),fe?vw(j.toString(),M):Eh(j.toString(),M)}else ts(2);_.G=0,_.l&&_.l.sa(D),Iw(_),_w(_)}n.fb=function(_){_?(this.j.info("Successfully pinged google.com"),ts(2)):(this.j.info("Failed to ping google.com"),ts(1))};function Iw(_){if(_.G=0,_.ka=[],_.l){const D=Wi(_.h);(D.length!=0||_.i.length!=0)&&(v(_.ka,D),v(_.ka,_.i),_.h.i.length=0,x(_.i),_.i.length=0),_.l.ra()}}function kw(_,D,M){var j=M instanceof hl?Un(M):new hl(M);if(j.g!="")D&&(j.g=D+"."+j.g),Th(j,j.s);else{var fe=a.location;j=fe.protocol,D=D?D+"."+fe.hostname:fe.hostname,fe=+fe.port;var xe=new hl(null);j&&Mc(xe,j),D&&(xe.g=D),fe&&Th(xe,fe),M&&(xe.l=M),j=xe}return M=_.D,D=_.ya,M&&D&&jt(j,M,D),jt(j,"VER",_.la),Ah(_,j),j}function Nw(_,D,M){if(D&&!_.J)throw Error("Can't create secondary domain capable XhrIo object.");return D=_.Ca&&!_.pa?new Qt(new Vc({eb:M})):new Qt(_.pa),D.Ha(_.J),D}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Aw(){}n=Aw.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Uf(){}Uf.prototype.g=function(_,D){return new Hi(_,D)};function Hi(_,D){an.call(this),this.g=new Ff(D),this.l=_,this.h=D&&D.messageUrlParams||null,_=D&&D.messageHeaders||null,D&&D.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=D&&D.initMessageHeaders||null,D&&D.messageContentType&&(_?_["X-WebChannel-Content-Type"]=D.messageContentType:_={"X-WebChannel-Content-Type":D.messageContentType}),D&&D.va&&(_?_["X-WebChannel-Client-Profile"]=D.va:_={"X-WebChannel-Client-Profile":D.va}),this.g.S=_,(_=D&&D.Sb)&&!S(_)&&(this.g.m=_),this.v=D&&D.supportsCrossDomainXhr||!1,this.u=D&&D.sendRawJson||!1,(D=D&&D.httpSessionIdParam)&&!S(D)&&(this.g.D=D,_=this.h,_!==null&&D in _&&(_=this.h,D in _&&delete _[D])),this.j=new va(this)}y(Hi,an),Hi.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Hi.prototype.close=function(){gy(this.g)},Hi.prototype.o=function(_){var D=this.g;if(typeof _=="string"){var M={};M.__data__=_,_=M}else this.u&&(M={},M.__data__=vh(_),_=M);D.i.push(new RI(D.Ya++,_)),D.G==3&&zf(D)},Hi.prototype.N=function(){this.g.l=null,delete this.j,gy(this.g),delete this.g,Hi.aa.N.call(this)};function Rw(_){Cc.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var D=_.__sm__;if(D){e:{for(const M in D){_=M;break e}_=void 0}(this.i=_)&&(_=this.i,D=D!==null&&_ in D?D[_]:void 0),this.data=D}else this.data=_}y(Rw,Cc);function Dw(){Do.call(this),this.status=1}y(Dw,Do);function va(_){this.g=_}y(va,Aw),va.prototype.ua=function(){dn(this.g,"a")},va.prototype.ta=function(_){dn(this.g,new Rw(_))},va.prototype.sa=function(_){dn(this.g,new Dw)},va.prototype.ra=function(){dn(this.g,"b")},Uf.prototype.createWebChannel=Uf.prototype.g,Hi.prototype.send=Hi.prototype.o,Hi.prototype.open=Hi.prototype.m,Hi.prototype.close=Hi.prototype.close,HK=function(){return new Uf},WK=function(){return kf()},UK=Gr,r2={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},_s.NO_ERROR=0,_s.TIMEOUT=8,_s.HTTP_ERROR=6,P1=_s,cl.COMPLETE="complete",BK=cl,dw.EventType=ha,ha.OPEN="a",ha.CLOSE="b",ha.ERROR="c",ha.MESSAGE="d",an.prototype.listen=an.prototype.K,$b=dw,Qt.prototype.listenOnce=Qt.prototype.L,Qt.prototype.getLastError=Qt.prototype.Ka,Qt.prototype.getLastErrorCode=Qt.prototype.Ba,Qt.prototype.getStatus=Qt.prototype.Z,Qt.prototype.getResponseJson=Qt.prototype.Oa,Qt.prototype.getResponseText=Qt.prototype.oa,Qt.prototype.send=Qt.prototype.ea,Qt.prototype.setWithCredentials=Qt.prototype.Ha,zK=Qt}).apply(typeof G_<"u"?G_:typeof self<"u"?self:typeof window<"u"?window:{});const i4="@firebase/firestore",r4="4.7.8";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ti.UNAUTHENTICATED=new Ti(null),Ti.GOOGLE_CREDENTIALS=new Ti("google-credentials-uid"),Ti.FIRST_PARTY=new Ti("first-party-uid"),Ti.MOCK_USER=new Ti("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hg="11.3.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd=new JC("@firebase/firestore");function _p(){return Yd.logLevel}function Ue(n,...e){if(Yd.logLevel<=It.DEBUG){const t=e.map(pP);Yd.debug(`Firestore (${Hg}): ${n}`,...t)}}function lc(n,...e){if(Yd.logLevel<=It.ERROR){const t=e.map(pP);Yd.error(`Firestore (${Hg}): ${n}`,...t)}}function um(n,...e){if(Yd.logLevel<=It.WARN){const t=e.map(pP);Yd.warn(`Firestore (${Hg}): ${n}`,...t)}}function pP(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(n="Unexpected state"){const e=`FIRESTORE (${Hg}) INTERNAL ASSERTION FAILED: `+n;throw lc(e),new Error(e)}function en(n,e){n||rt()}function ct(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ke extends ol{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jK{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class jLe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ti.UNAUTHENTICATED))}shutdown(){}}class GLe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class qLe{constructor(e){this.t=e,this.currentUser=Ti.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){en(this.o===void 0);let s=this.i;const i=l=>this.i!==s?(s=this.i,t(l)):Promise.resolve();let r=new Ad;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Ad,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=r;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{Ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Ad)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(Ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(en(typeof s.accessToken=="string"),new jK(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return en(e===null||typeof e=="string"),new Ti(e)}}class KLe{constructor(e,t,s){this.l=e,this.h=t,this.P=s,this.type="FirstParty",this.user=Ti.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class XLe{constructor(e,t,s){this.l=e,this.h=t,this.P=s}getToken(){return Promise.resolve(new KLe(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ti.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class o4{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class YLe{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Xi(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){en(this.o===void 0);const s=r=>{r.error!=null&&Ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.R;return this.R=r.token,Ue("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>s(r))};const i=r=>{Ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(r=>i(r)),setTimeout(()=>{if(!this.appCheck){const r=this.A.getImmediate({optional:!0});r?i(r):Ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new o4(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(en(typeof t.token=="string"),this.R=t.token,new o4(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QLe(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GK{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=QLe(40);for(let r=0;r<i.length;++r)s.length<20&&i[r]<t&&(s+=e.charAt(i[r]%62))}return s}}function Dt(n,e){return n<e?-1:n>e?1:0}function hm(n,e,t){return n.length===e.length&&n.every((s,i)=>t(s,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4=-62135596800,l4=1e6;class Rs{static now(){return Rs.fromMillis(Date.now())}static fromDate(e){return Rs.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*l4);return new Rs(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ke(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ke(Ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<a4)throw new Ke(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ke(Ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/l4}_compareTo(e){return this.seconds===e.seconds?Dt(this.nanoseconds,e.nanoseconds):Dt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-a4;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{static fromTimestamp(e){return new at(e)}static min(){return new at(new Rs(0,0))}static max(){return new at(new Rs(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4="__name__";class Aa{constructor(e,t,s){t===void 0?t=0:t>e.length&&rt(),s===void 0?s=e.length-t:s>e.length-t&&rt(),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Aa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Aa?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let i=0;i<s;i++){const r=Aa.compareSegments(e.get(i),t.get(i));if(r!==0)return r}return Math.sign(e.length-t.length)}static compareSegments(e,t){const s=Aa.isNumericId(e),i=Aa.isNumericId(t);return s&&!i?-1:!s&&i?1:s&&i?Aa.extractNumericId(e).compare(Aa.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Iu.fromString(e.substring(4,e.length-2))}}class Cn extends Aa{construct(e,t,s){return new Cn(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ke(Ae.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(i=>i.length>0))}return new Cn(t)}static emptyPath(){return new Cn([])}}const ZLe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class di extends Aa{construct(e,t,s){return new di(e,t,s)}static isValidIdentifier(e){return ZLe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),di.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===c4}static keyField(){return new di([c4])}static fromServerFormat(e){const t=[];let s="",i=0;const r=()=>{if(s.length===0)throw new Ke(Ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new Ke(Ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ke(Ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(s+=a,i++):(r(),i++)}if(r(),o)throw new Ke(Ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new di(t)}static emptyPath(){return new di([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.path=e}static fromPath(e){return new et(Cn.fromString(e))}static fromName(e){return new et(Cn.fromString(e).popFirst(5))}static empty(){return new et(Cn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Cn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Cn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new et(new Cn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0=-1;function JLe(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=at.fromTimestamp(s===1e9?new Rs(t+1,0):new Rs(t,s));return new Ku(i,et.empty(),e)}function eMe(n){return new Ku(n.readTime,n.key,R0)}class Ku{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Ku(at.min(),et.empty(),R0)}static max(){return new Ku(at.max(),et.empty(),R0)}}function tMe(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=et.comparator(n.documentKey,e.documentKey),t!==0?t:Dt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nMe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sMe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jg(n){if(n.code!==Ae.FAILED_PRECONDITION||n.message!==nMe)throw n;Ue("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ie((s,i)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(s,i)},this.catchCallback=r=>{this.wrapFailure(t,r).next(s,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Ie?t:Ie.resolve(t)}catch(t){return Ie.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Ie.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Ie.reject(t)}static resolve(e){return new Ie((t,s)=>{t(e)})}static reject(e){return new Ie((t,s)=>{s(e)})}static waitFor(e){return new Ie((t,s)=>{let i=0,r=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++r,o&&r===i&&t()},l=>s(l))}),o=!0,r===i&&t()})}static or(e){let t=Ie.resolve(!1);for(const s of e)t=t.next(i=>i?Ie.resolve(i):s());return t}static forEach(e,t){const s=[];return e.forEach((i,r)=>{s.push(t.call(this,i,r))}),this.waitFor(s)}static mapArray(e,t){return new Ie((s,i)=>{const r=e.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const c=l;t(e[c]).next(h=>{o[c]=h,++a,a===r&&s(o)},h=>i(h))}})}static doWhile(e,t){return new Ie((s,i)=>{const r=()=>{e()===!0?t().next(()=>{r()},i):s()};r()})}}function iMe(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Gg(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.oe(s),this._e=s=>t.writeSequenceNumber(s))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}tI.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mP=-1;function nI(n){return n==null}function zT(n){return n===0&&1/n==-1/0}function rMe(n){return typeof n=="number"&&Number.isInteger(n)&&!zT(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qK="";function oMe(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=u4(e)),e=aMe(n.get(t),e);return u4(e)}function aMe(n,e){let t=e;const s=n.length;for(let i=0;i<s;i++){const r=n.charAt(i);switch(r){case"\0":t+="";break;case qK:t+="";break;default:t+=r}}return t}function u4(n){return n+qK+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h4(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wf(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function KK(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xs=class o2{constructor(e,t){this.comparator=e,this.root=t||ku.EMPTY}insert(e,t){return new o2(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ku.BLACK,null,null))}remove(e){return new o2(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ku.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(e,s.key);if(i===0)return t+s.left.size;i<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new q_(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new q_(this.root,e,this.comparator,!1)}getReverseIterator(){return new q_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new q_(this.root,e,this.comparator,!0)}},q_=class{constructor(e,t,s,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?s(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ku=class Ol{constructor(e,t,s,i,r){this.key=e,this.value=t,this.color=s??Ol.RED,this.left=i??Ol.EMPTY,this.right=r??Ol.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,i,r){return new Ol(e??this.key,t??this.value,s??this.color,i??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const r=s(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,s),null):r===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ol.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ol.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ol.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ol.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw rt();const e=this.left.check();if(e!==this.right.check())throw rt();return e+(this.isRed()?0:1)}};ku.EMPTY=null,ku.RED=!0,ku.BLACK=!1;ku.EMPTY=new class{constructor(){this.size=0}get key(){throw rt()}get value(){throw rt()}get color(){throw rt()}get left(){throw rt()}get right(){throw rt()}copy(e,t,s,i,r){return this}insert(e,t,s){return new ku(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e){this.comparator=e,this.data=new xs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new d4(this.data.getIterator())}getIteratorFrom(e){return new d4(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof Ds)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,r=s.getNext().key;if(this.comparator(i,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ds(this.comparator);return t.data=e,t}}class d4{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e){this.fields=e,e.sort(di.comparator)}static empty(){return new jo([])}unionWith(e){let t=new Ds(di.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new jo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hm(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XK extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new XK("Invalid base64 string: "+r):r}}(e);return new pi(t)}static fromUint8Array(e){const t=function(i){let r="";for(let o=0;o<i.length;++o)r+=String.fromCharCode(i[o]);return r}(e);return new pi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Dt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pi.EMPTY_BYTE_STRING=new pi("");const lMe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xu(n){if(en(!!n),typeof n=="string"){let e=0;const t=lMe.exec(n);if(en(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:rs(n.seconds),nanos:rs(n.nanos)}}function rs(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Yu(n){return typeof n=="string"?pi.fromBase64String(n):pi.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YK="server_timestamp",QK="__type__",ZK="__previous_value__",JK="__local_write_time__";function gP(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[QK])===null||t===void 0?void 0:t.stringValue)===YK}function sI(n){const e=n.mapValue.fields[ZK];return gP(e)?sI(e):e}function D0(n){const e=Xu(n.mapValue.fields[JK].timestampValue);return new Rs(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cMe{constructor(e,t,s,i,r,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}const BT="(default)";class $0{constructor(e,t){this.projectId=e,this.database=t||BT}static empty(){return new $0("","")}get isDefaultDatabase(){return this.database===BT}isEqual(e){return e instanceof $0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eX="__type__",uMe="__max__",K_={mapValue:{}},tX="__vector__",UT="value";function Qu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?gP(n)?4:dMe(n)?9007199254740991:hMe(n)?10:11:rt()}function nl(n,e){if(n===e)return!0;const t=Qu(n);if(t!==Qu(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return D0(n).isEqual(D0(e));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const o=Xu(i.timestampValue),a=Xu(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,r){return Yu(i.bytesValue).isEqual(Yu(r.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,r){return rs(i.geoPointValue.latitude)===rs(r.geoPointValue.latitude)&&rs(i.geoPointValue.longitude)===rs(r.geoPointValue.longitude)}(n,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return rs(i.integerValue)===rs(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const o=rs(i.doubleValue),a=rs(r.doubleValue);return o===a?zT(o)===zT(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return hm(n.arrayValue.values||[],e.arrayValue.values||[],nl);case 10:case 11:return function(i,r){const o=i.mapValue.fields||{},a=r.mapValue.fields||{};if(h4(o)!==h4(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!nl(o[l],a[l])))return!1;return!0}(n,e);default:return rt()}}function O0(n,e){return(n.values||[]).find(t=>nl(t,e))!==void 0}function dm(n,e){if(n===e)return 0;const t=Qu(n),s=Qu(e);if(t!==s)return Dt(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Dt(n.booleanValue,e.booleanValue);case 2:return function(r,o){const a=rs(r.integerValue||r.doubleValue),l=rs(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return f4(n.timestampValue,e.timestampValue);case 4:return f4(D0(n),D0(e));case 5:return Dt(n.stringValue,e.stringValue);case 6:return function(r,o){const a=Yu(r),l=Yu(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(r,o){const a=r.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=Dt(a[c],l[c]);if(h!==0)return h}return Dt(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,o){const a=Dt(rs(r.latitude),rs(o.latitude));return a!==0?a:Dt(rs(r.longitude),rs(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return p4(n.arrayValue,e.arrayValue);case 10:return function(r,o){var a,l,c,h;const f=r.fields||{},p=o.fields||{},g=(a=f[UT])===null||a===void 0?void 0:a.arrayValue,y=(l=p[UT])===null||l===void 0?void 0:l.arrayValue,x=Dt(((c=g==null?void 0:g.values)===null||c===void 0?void 0:c.length)||0,((h=y==null?void 0:y.values)===null||h===void 0?void 0:h.length)||0);return x!==0?x:p4(g,y)}(n.mapValue,e.mapValue);case 11:return function(r,o){if(r===K_.mapValue&&o===K_.mapValue)return 0;if(r===K_.mapValue)return 1;if(o===K_.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const p=Dt(l[f],h[f]);if(p!==0)return p;const g=dm(a[l[f]],c[h[f]]);if(g!==0)return g}return Dt(l.length,h.length)}(n.mapValue,e.mapValue);default:throw rt()}}function f4(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Dt(n,e);const t=Xu(n),s=Xu(e),i=Dt(t.seconds,s.seconds);return i!==0?i:Dt(t.nanos,s.nanos)}function p4(n,e){const t=n.values||[],s=e.values||[];for(let i=0;i<t.length&&i<s.length;++i){const r=dm(t[i],s[i]);if(r)return r}return Dt(t.length,s.length)}function fm(n){return a2(n)}function a2(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=Xu(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Yu(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return et.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",i=!0;for(const r of t.values||[])i?i=!1:s+=",",s+=a2(r);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let i="{",r=!0;for(const o of s)r?r=!1:i+=",",i+=`${o}:${a2(t.fields[o])}`;return i+"}"}(n.mapValue):rt()}function L1(n){switch(Qu(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=sI(n);return e?16+L1(e):16;case 5:return 2*n.stringValue.length;case 6:return Yu(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((i,r)=>i+L1(r),0)}(n.arrayValue);case 10:case 11:return function(s){let i=0;return wf(s.fields,(r,o)=>{i+=r.length+L1(o)}),i}(n.mapValue);default:throw rt()}}function m4(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function l2(n){return!!n&&"integerValue"in n}function yP(n){return!!n&&"arrayValue"in n}function g4(n){return!!n&&"nullValue"in n}function y4(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function M1(n){return!!n&&"mapValue"in n}function hMe(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[eX])===null||t===void 0?void 0:t.stringValue)===tX}function Wb(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return wf(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=Wb(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Wb(n.arrayValue.values[t]);return e}return Object.assign({},n)}function dMe(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===uMe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this.value=e}static empty(){return new go({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!M1(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Wb(t)}setAll(e){let t=di.emptyPath(),s={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,s,i),s={},i=[],t=a.popLast()}o?s[a.lastSegment()]=Wb(o):i.push(a.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,s,i)}delete(e){const t=this.field(e.popLast());M1(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let i=t.mapValue.fields[e.get(s)];M1(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,s){wf(t,(i,r)=>e[i]=r);for(const i of s)delete e[i]}clone(){return new go(Wb(this.value))}}function nX(n){const e=[];return wf(n.fields,(t,s)=>{const i=new di([t]);if(M1(s)){const r=nX(s.mapValue).fields;if(r.length===0)e.push(i);else for(const o of r)e.push(i.child(o))}else e.push(i)}),new jo(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,t,s,i,r,o,a){this.key=e,this.documentType=t,this.version=s,this.readTime=i,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ii(e,0,at.min(),at.min(),at.min(),go.empty(),0)}static newFoundDocument(e,t,s,i){return new Ii(e,1,t,at.min(),s,i,0)}static newNoDocument(e,t){return new Ii(e,2,t,at.min(),at.min(),go.empty(),0)}static newUnknownDocument(e,t){return new Ii(e,3,t,at.min(),at.min(),go.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(at.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=go.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=go.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=at.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ii&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ii(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,t){this.position=e,this.inclusive=t}}function b4(n,e,t){let s=0;for(let i=0;i<n.position.length;i++){const r=e[i],o=n.position[i];if(r.field.isKeyField()?s=et.comparator(et.fromName(o.referenceValue),t.key):s=dm(o,t.data.field(r.field)),r.dir==="desc"&&(s*=-1),s!==0)break}return s}function v4(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!nl(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e,t="asc"){this.field=e,this.dir=t}}function fMe(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sX{}class ps extends sX{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new mMe(e,t,s):t==="array-contains"?new bMe(e,s):t==="in"?new vMe(e,s):t==="not-in"?new xMe(e,s):t==="array-contains-any"?new wMe(e,s):new ps(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new gMe(e,s):new yMe(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(dm(t,this.value)):t!==null&&Qu(this.value)===Qu(t)&&this.matchesComparison(dm(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ia extends sX{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new ia(e,t)}matches(e){return iX(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function iX(n){return n.op==="and"}function rX(n){return pMe(n)&&iX(n)}function pMe(n){for(const e of n.filters)if(e instanceof ia)return!1;return!0}function c2(n){if(n instanceof ps)return n.field.canonicalString()+n.op.toString()+fm(n.value);if(rX(n))return n.filters.map(e=>c2(e)).join(",");{const e=n.filters.map(t=>c2(t)).join(",");return`${n.op}(${e})`}}function oX(n,e){return n instanceof ps?function(s,i){return i instanceof ps&&s.op===i.op&&s.field.isEqual(i.field)&&nl(s.value,i.value)}(n,e):n instanceof ia?function(s,i){return i instanceof ia&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce((r,o,a)=>r&&oX(o,i.filters[a]),!0):!1}(n,e):void rt()}function aX(n){return n instanceof ps?function(t){return`${t.field.canonicalString()} ${t.op} ${fm(t.value)}`}(n):n instanceof ia?function(t){return t.op.toString()+" {"+t.getFilters().map(aX).join(" ,")+"}"}(n):"Filter"}class mMe extends ps{constructor(e,t,s){super(e,t,s),this.key=et.fromName(s.referenceValue)}matches(e){const t=et.comparator(e.key,this.key);return this.matchesComparison(t)}}class gMe extends ps{constructor(e,t){super(e,"in",t),this.keys=lX("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class yMe extends ps{constructor(e,t){super(e,"not-in",t),this.keys=lX("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function lX(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(s=>et.fromName(s.referenceValue))}class bMe extends ps{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return yP(t)&&O0(t.arrayValue,this.value)}}class vMe extends ps{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&O0(this.value.arrayValue,t)}}class xMe extends ps{constructor(e,t){super(e,"not-in",t)}matches(e){if(O0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!O0(this.value.arrayValue,t)}}class wMe extends ps{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!yP(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>O0(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Me{constructor(e,t=null,s=[],i=[],r=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=i,this.limit=r,this.startAt=o,this.endAt=a,this.le=null}}function x4(n,e=null,t=[],s=[],i=null,r=null,o=null){return new _Me(n,e,t,s,i,r,o)}function bP(n){const e=ct(n);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>c2(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),nI(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>fm(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>fm(s)).join(",")),e.le=t}return e.le}function vP(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!fMe(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!oX(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!v4(n.startAt,e.startAt)&&v4(n.endAt,e.endAt)}function u2(n){return et.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(e,t=null,s=[],i=[],r=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=i,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function TMe(n,e,t,s,i,r,o,a){return new Gx(n,e,t,s,i,r,o,a)}function xP(n){return new Gx(n)}function w4(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function cX(n){return n.collectionGroup!==null}function Hb(n){const e=ct(n);if(e.he===null){e.he=[];const t=new Set;for(const r of e.explicitOrderBy)e.he.push(r),t.add(r.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ds(di.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.he.push(new HT(r,s))}),t.has(di.keyField().canonicalString())||e.he.push(new HT(di.keyField(),s))}return e.he}function Wa(n){const e=ct(n);return e.Pe||(e.Pe=SMe(e,Hb(n))),e.Pe}function SMe(n,e){if(n.limitType==="F")return x4(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const r=i.dir==="desc"?"asc":"desc";return new HT(i.field,r)});const t=n.endAt?new WT(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new WT(n.startAt.position,n.startAt.inclusive):null;return x4(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function h2(n,e){const t=n.filters.concat([e]);return new Gx(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function d2(n,e,t){return new Gx(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function iI(n,e){return vP(Wa(n),Wa(e))&&n.limitType===e.limitType}function uX(n){return`${bP(Wa(n))}|lt:${n.limitType}`}function Tp(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(i=>aX(i)).join(", ")}]`),nI(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(i=>fm(i)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(i=>fm(i)).join(",")),`Target(${s})`}(Wa(n))}; limitType=${n.limitType})`}function rI(n,e){return e.isFoundDocument()&&function(s,i){const r=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(r):et.isDocumentKey(s.path)?s.path.isEqual(r):s.path.isImmediateParentOf(r)}(n,e)&&function(s,i){for(const r of Hb(s))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(n,e)&&function(s,i){for(const r of s.filters)if(!r.matches(i))return!1;return!0}(n,e)&&function(s,i){return!(s.startAt&&!function(o,a,l){const c=b4(o,a,l);return o.inclusive?c<=0:c<0}(s.startAt,Hb(s),i)||s.endAt&&!function(o,a,l){const c=b4(o,a,l);return o.inclusive?c>=0:c>0}(s.endAt,Hb(s),i))}(n,e)}function EMe(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function hX(n){return(e,t)=>{let s=!1;for(const i of Hb(n)){const r=CMe(i,e,t);if(r!==0)return r;s=s||i.field.isKeyField()}return 0}}function CMe(n,e,t){const s=n.field.isKeyField()?et.comparator(e.key,t.key):function(r,o,a){const l=o.data.field(r),c=a.data.field(r);return l!==null&&c!==null?dm(l,c):rt()}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return rt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[i,r]of s)if(this.equalsFn(i,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),i=this.inner[s];if(i===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return s.length===1?delete this.inner[t]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wf(this.inner,(t,s)=>{for(const[i,r]of s)e(i,r)})}isEmpty(){return KK(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IMe=new xs(et.comparator);function cc(){return IMe}const dX=new xs(et.comparator);function Ob(...n){let e=dX;for(const t of n)e=e.insert(t.key,t);return e}function fX(n){let e=dX;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function bd(){return jb()}function pX(){return jb()}function jb(){return new _f(n=>n.toString(),(n,e)=>n.isEqual(e))}const kMe=new xs(et.comparator),NMe=new Ds(et.comparator);function At(...n){let e=NMe;for(const t of n)e=e.add(t);return e}const AMe=new Ds(Dt);function RMe(){return AMe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zT(e)?"-0":e}}function mX(n){return{integerValue:""+n}}function DMe(n,e){return rMe(e)?mX(e):wP(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(){this._=void 0}}function $Me(n,e,t){return n instanceof jT?function(i,r){const o={fields:{[QK]:{stringValue:YK},[JK]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&gP(r)&&(r=sI(r)),r&&(o.fields[ZK]=r),{mapValue:o}}(t,e):n instanceof P0?yX(n,e):n instanceof L0?bX(n,e):function(i,r){const o=gX(i,r),a=_4(o)+_4(i.Ie);return l2(o)&&l2(i.Ie)?mX(a):wP(i.serializer,a)}(n,e)}function OMe(n,e,t){return n instanceof P0?yX(n,e):n instanceof L0?bX(n,e):t}function gX(n,e){return n instanceof GT?function(s){return l2(s)||function(r){return!!r&&"doubleValue"in r}(s)}(e)?e:{integerValue:0}:null}class jT extends oI{}class P0 extends oI{constructor(e){super(),this.elements=e}}function yX(n,e){const t=vX(e);for(const s of n.elements)t.some(i=>nl(i,s))||t.push(s);return{arrayValue:{values:t}}}class L0 extends oI{constructor(e){super(),this.elements=e}}function bX(n,e){let t=vX(e);for(const s of n.elements)t=t.filter(i=>!nl(i,s));return{arrayValue:{values:t}}}class GT extends oI{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function _4(n){return rs(n.integerValue||n.doubleValue)}function vX(n){return yP(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function PMe(n,e){return n.field.isEqual(e.field)&&function(s,i){return s instanceof P0&&i instanceof P0||s instanceof L0&&i instanceof L0?hm(s.elements,i.elements,nl):s instanceof GT&&i instanceof GT?nl(s.Ie,i.Ie):s instanceof jT&&i instanceof jT}(n.transform,e.transform)}class LMe{constructor(e,t){this.version=e,this.transformResults=t}}class Ha{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ha}static exists(e){return new Ha(void 0,e)}static updateTime(e){return new Ha(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function F1(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class aI{}function xX(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _P(n.key,Ha.none()):new qx(n.key,n.data,Ha.none());{const t=n.data,s=go.empty();let i=new Ds(di.comparator);for(let r of e.fields)if(!i.has(r)){let o=t.field(r);o===null&&r.length>1&&(r=r.popLast(),o=t.field(r)),o===null?s.delete(r):s.set(r,o),i=i.add(r)}return new Tf(n.key,s,new jo(i.toArray()),Ha.none())}}function MMe(n,e,t){n instanceof qx?function(i,r,o){const a=i.value.clone(),l=S4(i.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Tf?function(i,r,o){if(!F1(i.precondition,r))return void r.convertToUnknownDocument(o.version);const a=S4(i.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(wX(i)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Gb(n,e,t,s){return n instanceof qx?function(r,o,a,l){if(!F1(r.precondition,o))return a;const c=r.value.clone(),h=E4(r.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,s):n instanceof Tf?function(r,o,a,l){if(!F1(r.precondition,o))return a;const c=E4(r.fieldTransforms,l,o),h=o.data;return h.setAll(wX(r)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(f=>f.field))}(n,e,t,s):function(r,o,a){return F1(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function FMe(n,e){let t=null;for(const s of n.fieldTransforms){const i=e.data.field(s.field),r=gX(s.transform,i||null);r!=null&&(t===null&&(t=go.empty()),t.set(s.field,r))}return t||null}function T4(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&hm(s,i,(r,o)=>PMe(r,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class qx extends aI{constructor(e,t,s,i=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Tf extends aI{constructor(e,t,s,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function wX(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function S4(n,e,t){const s=new Map;en(n.length===t.length);for(let i=0;i<t.length;i++){const r=n[i],o=r.transform,a=e.data.field(r.field);s.set(r.field,OMe(o,a,t[i]))}return s}function E4(n,e,t){const s=new Map;for(const i of n){const r=i.transform,o=t.data.field(i.field);s.set(i.field,$Me(r,o,e))}return s}class _P extends aI{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class VMe extends aI{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zMe{constructor(e,t,s,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const r=this.mutations[i];r.key.isEqual(e.key)&&MMe(r,e,s[i])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Gb(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Gb(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=pX();return this.mutations.forEach(i=>{const r=e.get(i.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=t.has(i.key)?null:a;const l=xX(o,a);l!==null&&s.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(at.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),At())}isEqual(e){return this.batchId===e.batchId&&hm(this.mutations,e.mutations,(t,s)=>T4(t,s))&&hm(this.baseMutations,e.baseMutations,(t,s)=>T4(t,s))}}class TP{constructor(e,t,s,i){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=i}static from(e,t,s){en(e.mutations.length===s.length);let i=function(){return kMe}();const r=e.mutations;for(let o=0;o<r.length;o++)i=i.insert(r[o].key,s[o].version);return new TP(e,t,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BMe{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UMe{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fs,Ft;function WMe(n){switch(n){case Ae.OK:return rt();case Ae.CANCELLED:case Ae.UNKNOWN:case Ae.DEADLINE_EXCEEDED:case Ae.RESOURCE_EXHAUSTED:case Ae.INTERNAL:case Ae.UNAVAILABLE:case Ae.UNAUTHENTICATED:return!1;case Ae.INVALID_ARGUMENT:case Ae.NOT_FOUND:case Ae.ALREADY_EXISTS:case Ae.PERMISSION_DENIED:case Ae.FAILED_PRECONDITION:case Ae.ABORTED:case Ae.OUT_OF_RANGE:case Ae.UNIMPLEMENTED:case Ae.DATA_LOSS:return!0;default:return rt()}}function _X(n){if(n===void 0)return lc("GRPC error has no .code"),Ae.UNKNOWN;switch(n){case fs.OK:return Ae.OK;case fs.CANCELLED:return Ae.CANCELLED;case fs.UNKNOWN:return Ae.UNKNOWN;case fs.DEADLINE_EXCEEDED:return Ae.DEADLINE_EXCEEDED;case fs.RESOURCE_EXHAUSTED:return Ae.RESOURCE_EXHAUSTED;case fs.INTERNAL:return Ae.INTERNAL;case fs.UNAVAILABLE:return Ae.UNAVAILABLE;case fs.UNAUTHENTICATED:return Ae.UNAUTHENTICATED;case fs.INVALID_ARGUMENT:return Ae.INVALID_ARGUMENT;case fs.NOT_FOUND:return Ae.NOT_FOUND;case fs.ALREADY_EXISTS:return Ae.ALREADY_EXISTS;case fs.PERMISSION_DENIED:return Ae.PERMISSION_DENIED;case fs.FAILED_PRECONDITION:return Ae.FAILED_PRECONDITION;case fs.ABORTED:return Ae.ABORTED;case fs.OUT_OF_RANGE:return Ae.OUT_OF_RANGE;case fs.UNIMPLEMENTED:return Ae.UNIMPLEMENTED;case fs.DATA_LOSS:return Ae.DATA_LOSS;default:return rt()}}(Ft=fs||(fs={}))[Ft.OK=0]="OK",Ft[Ft.CANCELLED=1]="CANCELLED",Ft[Ft.UNKNOWN=2]="UNKNOWN",Ft[Ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ft[Ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ft[Ft.NOT_FOUND=5]="NOT_FOUND",Ft[Ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ft[Ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ft[Ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ft[Ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ft[Ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ft[Ft.ABORTED=10]="ABORTED",Ft[Ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ft[Ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ft[Ft.INTERNAL=13]="INTERNAL",Ft[Ft.UNAVAILABLE=14]="UNAVAILABLE",Ft[Ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HMe(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jMe=new Iu([4294967295,4294967295],0);function C4(n){const e=HMe().encode(n),t=new VK;return t.update(e),new Uint8Array(t.digest())}function I4(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new Iu([t,s],0),new Iu([i,r],0)]}class SP{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Pb(`Invalid padding: ${t}`);if(s<0)throw new Pb(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Pb(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Pb(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=Iu.fromNumber(this.Ee)}Ae(e,t,s){let i=e.add(t.multiply(Iu.fromNumber(s)));return i.compare(jMe)===1&&(i=new Iu([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const t=C4(e),[s,i]=I4(t);for(let r=0;r<this.hashCount;r++){const o=this.Ae(s,i,r);if(!this.Re(o))return!1}return!0}static create(e,t,s){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new SP(r,i,t);return s.forEach(a=>o.insert(a)),o}insert(e){if(this.Ee===0)return;const t=C4(e),[s,i]=I4(t);for(let r=0;r<this.hashCount;r++){const o=this.Ae(s,i,r);this.Ve(o)}}Ve(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Pb extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e,t,s,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const i=new Map;return i.set(e,Kx.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new lI(at.min(),i,new xs(Dt),cc(),At())}}class Kx{constructor(e,t,s,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Kx(s,t,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,t,s,i){this.me=e,this.removedTargetIds=t,this.key=s,this.fe=i}}class TX{constructor(e,t){this.targetId=e,this.ge=t}}class SX{constructor(e,t,s=pi.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=i}}class k4{constructor(){this.pe=0,this.ye=N4(),this.we=pi.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=At(),t=At(),s=At();return this.ye.forEach((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:s=s.add(i);break;default:rt()}}),new Kx(this.we,this.Se,e,t,s)}Me(){this.be=!1,this.ye=N4()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,en(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class GMe{constructor(e){this.ke=e,this.qe=new Map,this.Qe=cc(),this.$e=X_(),this.Ke=X_(),this.Ue=new xs(Dt)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{const s=this.He(t);switch(e.state){case 0:this.Je(t)&&s.Ce(e.resumeToken);break;case 1:s.Be(),s.De||s.Me(),s.Ce(e.resumeToken);break;case 2:s.Be(),s.De||this.removeTarget(t);break;case 3:this.Je(t)&&(s.Le(),s.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),s.Ce(e.resumeToken));break;default:rt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((s,i)=>{this.Je(i)&&t(i)})}Ze(e){const t=e.targetId,s=e.ge.count,i=this.Xe(t);if(i){const r=i.target;if(u2(r))if(s===0){const o=new et(r.path);this.ze(t,o,Ii.newNoDocument(o,at.min()))}else en(s===1);else{const o=this.et(t);if(o!==s){const a=this.tt(e),l=a?this.nt(a,e,o):1;if(l!==0){this.Ye(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(t,c)}}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:r=0}=t;let o,a;try{o=Yu(s).toUint8Array()}catch(l){if(l instanceof XK)return um("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new SP(o,i,r)}catch(l){return um(l instanceof Pb?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ee===0?null:a}nt(e,t,s){return t.ge.count===s-this.st(e,t.targetId)?0:2}st(e,t){const s=this.ke.getRemoteKeysForTarget(t);let i=0;return s.forEach(r=>{const o=this.ke.it(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(a)||(this.ze(t,r,null),i++)}),i}ot(e){const t=new Map;this.qe.forEach((r,o)=>{const a=this.Xe(o);if(a){if(r.current&&u2(a.target)){const l=new et(a.target.path);this._t(l).has(o)||this.ut(o,l)||this.ze(o,l,Ii.newNoDocument(l,e))}r.ve&&(t.set(o,r.Fe()),r.Me())}});let s=At();this.Ke.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xe(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(r))}),this.Qe.forEach((r,o)=>o.setReadTime(e));const i=new lI(e,t,this.Ue,this.Qe,s);return this.Qe=cc(),this.$e=X_(),this.Ke=X_(),this.Ue=new xs(Dt),i}Ge(e,t){if(!this.Je(e))return;const s=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,s),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ke=this.Ke.insert(t.key,this.ct(t.key).add(e))}ze(e,t,s){if(!this.Je(e))return;const i=this.He(e);this.ut(e,t)?i.xe(t,1):i.Oe(t),this.Ke=this.Ke.insert(t,this.ct(t).delete(e)),this.Ke=this.Ke.insert(t,this.ct(t).add(e)),s&&(this.Qe=this.Qe.insert(t,s))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new k4,this.qe.set(e,t)),t}ct(e){let t=this.Ke.get(e);return t||(t=new Ds(Dt),this.Ke=this.Ke.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new Ds(Dt),this.$e=this.$e.insert(e,t)),t}Je(e){const t=this.Xe(e)!==null;return t||Ue("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new k4),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function X_(){return new xs(et.comparator)}function N4(){return new xs(et.comparator)}const qMe={asc:"ASCENDING",desc:"DESCENDING"},KMe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XMe={and:"AND",or:"OR"};class YMe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function f2(n,e){return n.useProto3Json||nI(e)?e:{value:e}}function qT(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function EX(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function QMe(n,e){return qT(n,e.toTimestamp())}function ja(n){return en(!!n),at.fromTimestamp(function(t){const s=Xu(t);return new Rs(s.seconds,s.nanos)}(n))}function EP(n,e){return p2(n,e).canonicalString()}function p2(n,e){const t=function(i){return new Cn(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function CX(n){const e=Cn.fromString(n);return en(RX(e)),e}function m2(n,e){return EP(n.databaseId,e.path)}function hA(n,e){const t=CX(e);if(t.get(1)!==n.databaseId.projectId)throw new Ke(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ke(Ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new et(kX(t))}function IX(n,e){return EP(n.databaseId,e)}function ZMe(n){const e=CX(n);return e.length===4?Cn.emptyPath():kX(e)}function g2(n){return new Cn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function kX(n){return en(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function A4(n,e,t){return{name:m2(n,e),fields:t.value.mapValue.fields}}function JMe(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:rt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],r=function(c,h){return c.useProto3Json?(en(h===void 0||typeof h=="string"),pi.fromBase64String(h||"")):(en(h===void 0||h instanceof Buffer||h instanceof Uint8Array),pi.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=c.code===void 0?Ae.UNKNOWN:_X(c.code);return new Ke(h,c.message||"")}(o);t=new SX(s,i,r,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=hA(n,s.document.name),r=ja(s.document.updateTime),o=s.document.createTime?ja(s.document.createTime):at.min(),a=new go({mapValue:{fields:s.document.fields}}),l=Ii.newFoundDocument(i,r,o,a),c=s.targetIds||[],h=s.removedTargetIds||[];t=new V1(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=hA(n,s.document),r=s.readTime?ja(s.readTime):at.min(),o=Ii.newNoDocument(i,r),a=s.removedTargetIds||[];t=new V1([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=hA(n,s.document),r=s.removedTargetIds||[];t=new V1([],r,i,null)}else{if(!("filter"in e))return rt();{e.filter;const s=e.filter;s.targetId;const{count:i=0,unchangedNames:r}=s,o=new UMe(i,r),a=s.targetId;t=new TX(a,o)}}return t}function eFe(n,e){let t;if(e instanceof qx)t={update:A4(n,e.key,e.value)};else if(e instanceof _P)t={delete:m2(n,e.key)};else if(e instanceof Tf)t={update:A4(n,e.key,e.data),updateMask:cFe(e.fieldMask)};else{if(!(e instanceof VMe))return rt();t={verify:m2(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(r,o){const a=o.transform;if(a instanceof jT)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof P0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof L0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof GT)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw rt()}(0,s))),e.precondition.isNone||(t.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:QMe(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:rt()}(n,e.precondition)),t}function tFe(n,e){return n&&n.length>0?(en(e!==void 0),n.map(t=>function(i,r){let o=i.updateTime?ja(i.updateTime):ja(r);return o.isEqual(at.min())&&(o=ja(r)),new LMe(o,i.transformResults||[])}(t,e))):[]}function nFe(n,e){return{documents:[IX(n,e.path)]}}function sFe(n,e){const t={structuredQuery:{}},s=e.path;let i;e.collectionGroup!==null?(i=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=IX(n,i);const r=function(c){if(c.length!==0)return AX(ia.create(c,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const o=function(c){if(c.length!==0)return c.map(h=>function(p){return{field:Sp(p.field),direction:oFe(p.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=f2(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ht:t,parent:i}}function iFe(n){let e=ZMe(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let i=null;if(s>0){en(s===1);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let r=[];t.where&&(r=function(f){const p=NX(f);return p instanceof ia&&rX(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(p=>function(y){return new HT(Ep(y.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,nI(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(f){const p=!!f.before,g=f.values||[];return new WT(g,p)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const p=!f.before,g=f.values||[];return new WT(g,p)}(t.endAt)),TMe(e,i,o,r,a,"F",l,c)}function rFe(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function NX(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Ep(t.unaryFilter.field);return ps.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=Ep(t.unaryFilter.field);return ps.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ep(t.unaryFilter.field);return ps.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ep(t.unaryFilter.field);return ps.create(o,"!=",{nullValue:"NULL_VALUE"});default:return rt()}}(n):n.fieldFilter!==void 0?function(t){return ps.create(Ep(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return rt()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ia.create(t.compositeFilter.filters.map(s=>NX(s)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return rt()}}(t.compositeFilter.op))}(n):rt()}function oFe(n){return qMe[n]}function aFe(n){return KMe[n]}function lFe(n){return XMe[n]}function Sp(n){return{fieldPath:n.canonicalString()}}function Ep(n){return di.fromServerFormat(n.fieldPath)}function AX(n){return n instanceof ps?function(t){if(t.op==="=="){if(y4(t.value))return{unaryFilter:{field:Sp(t.field),op:"IS_NAN"}};if(g4(t.value))return{unaryFilter:{field:Sp(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(y4(t.value))return{unaryFilter:{field:Sp(t.field),op:"IS_NOT_NAN"}};if(g4(t.value))return{unaryFilter:{field:Sp(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Sp(t.field),op:aFe(t.op),value:t.value}}}(n):n instanceof ia?function(t){const s=t.getFilters().map(i=>AX(i));return s.length===1?s[0]:{compositeFilter:{op:lFe(t.op),filters:s}}}(n):rt()}function cFe(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function RX(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,t,s,i,r=at.min(),o=at.min(),a=pi.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new vu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new vu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uFe{constructor(e){this.Tt=e}}function hFe(n){const e=iFe({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?d2(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dFe{constructor(){this.Tn=new fFe}addToCollectionParentIndex(e,t){return this.Tn.add(t),Ie.resolve()}getCollectionParents(e,t){return Ie.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return Ie.resolve()}deleteFieldIndex(e,t){return Ie.resolve()}deleteAllFieldIndexes(e){return Ie.resolve()}createTargetIndexes(e,t){return Ie.resolve()}getDocumentsMatchingTarget(e,t){return Ie.resolve(null)}getIndexType(e,t){return Ie.resolve(0)}getFieldIndexes(e,t){return Ie.resolve([])}getNextCollectionGroupToUpdate(e){return Ie.resolve(null)}getMinOffset(e,t){return Ie.resolve(Ku.min())}getMinOffsetFromCollectionGroup(e,t){return Ie.resolve(Ku.min())}updateCollectionGroup(e,t,s){return Ie.resolve()}updateIndexEntries(e,t){return Ie.resolve()}}class fFe{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t]||new Ds(Cn.comparator),r=!i.has(s);return this.index[t]=i.add(s),r}has(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t];return i&&i.has(s)}getEntries(e){return(this.index[e]||new Ds(Cn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},DX=41943040;class fr{static withCacheSize(e){return new fr(e,fr.DEFAULT_COLLECTION_PERCENTILE,fr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fr.DEFAULT_COLLECTION_PERCENTILE=10,fr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fr.DEFAULT=new fr(DX,fr.DEFAULT_COLLECTION_PERCENTILE,fr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fr.DISABLED=new fr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Kn(){return new pm(0)}static Un(){return new pm(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4="LruGarbageCollector",pFe=1048576;function $4([n,e],[t,s]){const i=Dt(n,t);return i===0?Dt(e,s):i}class mFe{constructor(e){this.Hn=e,this.buffer=new Ds($4),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();$4(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class gFe{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){Ue(D4,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Gg(t)?Ue(D4,"Ignoring IndexedDB error during garbage collection: ",t):await jg(t)}await this.er(3e5)})}}class yFe{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(s=>Math.floor(t/100*s))}nthSequenceNumber(e,t){if(t===0)return Ie.resolve(tI.ae);const s=new mFe(t);return this.tr.forEachTarget(e,i=>s.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>s.Zn(i))).next(()=>s.maxValue)}removeTargets(e,t,s){return this.tr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ue("LruGarbageCollector","Garbage collection skipped; disabled"),Ie.resolve(R4)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(Ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),R4):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let s,i,r,o,a,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(s=f,a=Date.now(),this.removeTargets(e,s,t))).next(f=>(r=f,l=Date.now(),this.removeOrphanedDocuments(e,s))).next(f=>(c=Date.now(),_p()<=It.DEBUG&&Ue("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${r} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),Ie.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:f})))}}function bFe(n,e){return new yFe(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vFe{constructor(){this.changes=new _f(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ii.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?Ie.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xFe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wFe{constructor(e,t,s,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=i}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(s=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(s!==null&&Gb(s.mutation,i,jo.empty(),Rs.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,At()).next(()=>s))}getLocalViewOfDocuments(e,t,s=At()){const i=bd();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,s).next(r=>{let o=Ob();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=bd();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,At()))}populateOverlays(e,t,s){const i=[];return s.forEach(r=>{t.has(r)||i.push(r)}),this.documentOverlayCache.getOverlays(e,i).next(r=>{r.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,s,i){let r=cc();const o=jb(),a=function(){return jb()}();return t.forEach((l,c)=>{const h=s.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof Tf)?r=r.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),Gb(h.mutation,c,h.mutation.getFieldMask(),Rs.now())):o.set(c.key,jo.empty())}),this.recalculateAndSaveOverlays(e,r).next(l=>(l.forEach((c,h)=>o.set(c,h)),t.forEach((c,h)=>{var f;return a.set(c,new xFe(h,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const s=jb();let i=new xs((o,a)=>o-a),r=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let h=s.get(l)||jo.empty();h=a.applyToLocalView(c,h),s.set(l,h);const f=(i.get(a.batchId)||At()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,f=pX();h.forEach(p=>{if(!r.has(p)){const g=xX(t.get(p),s.get(p));g!==null&&f.set(p,g),r=r.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return Ie.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,i){return function(o){return et.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cX(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,i):this.getDocumentsMatchingCollectionQuery(e,t,s,i)}getNextDocuments(e,t,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,i).next(r=>{const o=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,i-r.size):Ie.resolve(bd());let a=R0,l=r;return o.next(c=>Ie.forEach(c,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),r.get(h)?Ie.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(e,c,r)).next(()=>this.computeViews(e,l,c,At())).next(h=>({batchId:a,changes:fX(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new et(t)).next(s=>{let i=Ob();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,s,i){const r=t.collectionGroup;let o=Ob();return this.indexManager.getCollectionParents(e,r).next(a=>Ie.forEach(a,l=>{const c=function(f,p){return new Gx(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(r));return this.getDocumentsMatchingCollectionQuery(e,c,s,i).next(h=>{h.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,s,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,r,i))).next(o=>{r.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,Ii.newInvalidDocument(h)))});let a=Ob();return o.forEach((l,c)=>{const h=r.get(l);h!==void 0&&Gb(h.mutation,c,jo.empty(),Rs.now()),rI(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Fe{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return Ie.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ja(i.createTime)}}(t)),Ie.resolve()}getNamedQuery(e,t){return Ie.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:hFe(i.bundledQuery),readTime:ja(i.readTime)}}(t)),Ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TFe{constructor(){this.overlays=new xs(et.comparator),this.Rr=new Map}getOverlay(e,t){return Ie.resolve(this.overlays.get(t))}getOverlays(e,t){const s=bd();return Ie.forEach(t,i=>this.getOverlay(e,i).next(r=>{r!==null&&s.set(i,r)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((i,r)=>{this.Et(e,t,r)}),Ie.resolve()}removeOverlaysForBatchId(e,t,s){const i=this.Rr.get(s);return i!==void 0&&(i.forEach(r=>this.overlays=this.overlays.remove(r)),this.Rr.delete(s)),Ie.resolve()}getOverlaysForCollection(e,t,s){const i=bd(),r=t.length+1,o=new et(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===r&&l.largestBatchId>s&&i.set(l.getKey(),l)}return Ie.resolve(i)}getOverlaysForCollectionGroup(e,t,s,i){let r=new xs((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>s){let h=r.get(c.largestBatchId);h===null&&(h=bd(),r=r.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=bd(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=i)););return Ie.resolve(a)}Et(e,t,s){const i=this.overlays.get(s.key);if(i!==null){const o=this.Rr.get(i.largestBatchId).delete(s.key);this.Rr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new BMe(t,s));let r=this.Rr.get(t);r===void 0&&(r=At(),this.Rr.set(t,r)),this.Rr.set(t,r.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SFe{constructor(){this.sessionToken=pi.EMPTY_BYTE_STRING}getSessionToken(e){return Ie.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(){this.Vr=new Ds(Gs.mr),this.gr=new Ds(Gs.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const s=new Gs(e,t);this.Vr=this.Vr.add(s),this.gr=this.gr.add(s)}yr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.wr(new Gs(e,t))}Sr(e,t){e.forEach(s=>this.removeReference(s,t))}br(e){const t=new et(new Cn([])),s=new Gs(t,e),i=new Gs(t,e+1),r=[];return this.gr.forEachInRange([s,i],o=>{this.wr(o),r.push(o.key)}),r}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new et(new Cn([])),s=new Gs(t,e),i=new Gs(t,e+1);let r=At();return this.gr.forEachInRange([s,i],o=>{r=r.add(o.key)}),r}containsKey(e){const t=new Gs(e,0),s=this.Vr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Gs{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return et.comparator(e.key,t.key)||Dt(e.Cr,t.Cr)}static pr(e,t){return Dt(e.Cr,t.Cr)||et.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EFe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new Ds(Gs.mr)}checkEmpty(e){return Ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,i){const r=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new zMe(r,t,s,i);this.mutationQueue.push(o);for(const a of i)this.Mr=this.Mr.add(new Gs(a.key,r)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Ie.resolve(o)}lookupMutationBatch(e,t){return Ie.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=this.Nr(s),r=i<0?0:i;return Ie.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Ie.resolve(this.mutationQueue.length===0?mP:this.Fr-1)}getAllMutationBatches(e){return Ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Gs(t,0),i=new Gs(t,Number.POSITIVE_INFINITY),r=[];return this.Mr.forEachInRange([s,i],o=>{const a=this.Or(o.Cr);r.push(a)}),Ie.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Ds(Dt);return t.forEach(i=>{const r=new Gs(i,0),o=new Gs(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([r,o],a=>{s=s.add(a.Cr)})}),Ie.resolve(this.Br(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1;let r=s;et.isDocumentKey(r)||(r=r.child(""));const o=new Gs(new et(r),0);let a=new Ds(Dt);return this.Mr.forEachWhile(l=>{const c=l.key.path;return!!s.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.Cr)),!0)},o),Ie.resolve(this.Br(a))}Br(e){const t=[];return e.forEach(s=>{const i=this.Or(s);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){en(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let s=this.Mr;return Ie.forEach(t.mutations,i=>{const r=new Gs(i.key,t.batchId);return s=s.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=s})}qn(e){}containsKey(e,t){const s=new Gs(t,0),i=this.Mr.firstAfterOrEqual(s);return Ie.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ie.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CFe{constructor(e){this.kr=e,this.docs=function(){return new xs(et.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,i=this.docs.get(s),r=i?i.size:0,o=this.kr(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return Ie.resolve(s?s.document.mutableCopy():Ii.newInvalidDocument(t))}getEntries(e,t){let s=cc();return t.forEach(i=>{const r=this.docs.get(i);s=s.insert(i,r?r.document.mutableCopy():Ii.newInvalidDocument(i))}),Ie.resolve(s)}getDocumentsMatchingQuery(e,t,s,i){let r=cc();const o=t.path,a=new et(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||tMe(eMe(h),s)<=0||(i.has(h.key)||rI(t,h))&&(r=r.insert(h.key,h.mutableCopy()))}return Ie.resolve(r)}getAllFromCollectionGroup(e,t,s,i){rt()}qr(e,t){return Ie.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new IFe(this)}getSize(e){return Ie.resolve(this.size)}}class IFe extends vFe{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((s,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(s)}),Ie.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kFe{constructor(e){this.persistence=e,this.Qr=new _f(t=>bP(t),vP),this.lastRemoteSnapshotVersion=at.min(),this.highestTargetId=0,this.$r=0,this.Kr=new CP,this.targetCount=0,this.Ur=pm.Kn()}forEachTarget(e,t){return this.Qr.forEach((s,i)=>t(i)),Ie.resolve()}getLastRemoteSnapshotVersion(e){return Ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ie.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Ur.next(),Ie.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.$r&&(this.$r=t),Ie.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ur=new pm(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,Ie.resolve()}updateTargetData(e,t){return this.zn(t),Ie.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Kr.br(t.targetId),this.targetCount-=1,Ie.resolve()}removeTargets(e,t,s){let i=0;const r=[];return this.Qr.forEach((o,a)=>{a.sequenceNumber<=t&&s.get(a.targetId)===null&&(this.Qr.delete(o),r.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),Ie.waitFor(r).next(()=>i)}getTargetCount(e){return Ie.resolve(this.targetCount)}getTargetData(e,t){const s=this.Qr.get(t)||null;return Ie.resolve(s)}addMatchingKeys(e,t,s){return this.Kr.yr(t,s),Ie.resolve()}removeMatchingKeys(e,t,s){this.Kr.Sr(t,s);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach(o=>{r.push(i.markPotentiallyOrphaned(e,o))}),Ie.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.Kr.br(t),Ie.resolve()}getMatchingKeysForTargetId(e,t){const s=this.Kr.vr(t);return Ie.resolve(s)}containsKey(e,t){return Ie.resolve(this.Kr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $X{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new tI(0),this.zr=!1,this.zr=!0,this.jr=new SFe,this.referenceDelegate=e(this),this.Hr=new kFe(this),this.indexManager=new dFe,this.remoteDocumentCache=function(i){return new CFe(i)}(s=>this.referenceDelegate.Jr(s)),this.serializer=new uFe(t),this.Yr=new _Fe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new TFe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.Wr[e.toKey()];return s||(s=new EFe(t,this.referenceDelegate),this.Wr[e.toKey()]=s),s}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,s){Ue("MemoryPersistence","Starting transaction:",e);const i=new NFe(this.Gr.next());return this.referenceDelegate.Zr(),s(i).next(r=>this.referenceDelegate.Xr(i).next(()=>r)).toPromise().then(r=>(i.raiseOnCommittedEvent(),r))}ei(e,t){return Ie.or(Object.values(this.Wr).map(s=>()=>s.containsKey(e,t)))}}class NFe extends sMe{constructor(e){super(),this.currentSequenceNumber=e}}class IP{constructor(e){this.persistence=e,this.ti=new CP,this.ni=null}static ri(e){return new IP(e)}get ii(){if(this.ni)return this.ni;throw rt()}addReference(e,t,s){return this.ti.addReference(s,t),this.ii.delete(s.toString()),Ie.resolve()}removeReference(e,t,s){return this.ti.removeReference(s,t),this.ii.add(s.toString()),Ie.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),Ie.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(i=>this.ii.add(i.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(r=>this.ii.add(r.toString()))}).next(()=>s.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ie.forEach(this.ii,s=>{const i=et.fromPath(s);return this.si(e,i).next(r=>{r||t.removeEntry(i,at.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(s=>{s?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return Ie.or([()=>Ie.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class KT{constructor(e,t){this.persistence=e,this.oi=new _f(s=>oMe(s.path),(s,i)=>s.isEqual(i)),this.garbageCollector=bFe(this,t)}static ri(e,t){return new KT(e,t)}Zr(){}Xr(e){return Ie.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>t.next(i=>s+i))}sr(e){let t=0;return this.rr(e,s=>{t++}).next(()=>t)}rr(e,t){return Ie.forEach(this.oi,(s,i)=>this.ar(e,s,i).next(r=>r?Ie.resolve():t(i)))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const i=this.persistence.getRemoteDocumentCache(),r=i.newChangeBuffer();return i.qr(e,o=>this.ar(e,o,t).next(a=>{a||(s++,r.removeEntry(o,at.min()))})).next(()=>r.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),Ie.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.oi.set(s,e.currentSequenceNumber),Ie.resolve()}removeReference(e,t,s){return this.oi.set(s,e.currentSequenceNumber),Ie.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),Ie.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=L1(e.data.value)),t}ar(e,t,s){return Ie.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.oi.get(t);return Ie.resolve(i!==void 0&&i>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,t,s,i){this.targetId=e,this.fromCache=t,this.Hi=s,this.Ji=i}static Yi(e,t){let s=At(),i=At();for(const r of t.docChanges)switch(r.type){case 0:s=s.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new kP(e,t.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AFe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RFe{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return wPe()?8:iMe(Fi())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,s,i){const r={result:null};return this.rs(e,t).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.ss(e,t,i,s).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new AFe;return this._s(e,t,o).next(a=>{if(r.result=a,this.Xi)return this.us(e,t,o,a.size)})}).next(()=>r.result)}us(e,t,s,i){return s.documentReadCount<this.es?(_p()<=It.DEBUG&&Ue("QueryEngine","SDK will not create cache indexes for query:",Tp(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),Ie.resolve()):(_p()<=It.DEBUG&&Ue("QueryEngine","Query:",Tp(t),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.ts*i?(_p()<=It.DEBUG&&Ue("QueryEngine","The SDK decides to create cache indexes for query:",Tp(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wa(t))):Ie.resolve())}rs(e,t){if(w4(t))return Ie.resolve(null);let s=Wa(t);return this.indexManager.getIndexType(e,s).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=d2(t,null,"F"),s=Wa(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(r=>{const o=At(...r);return this.ns.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(l=>{const c=this.cs(t,a);return this.ls(t,c,o,l.readTime)?this.rs(e,d2(t,null,"F")):this.hs(e,c,t,l)}))})))}ss(e,t,s,i){return w4(t)||i.isEqual(at.min())?Ie.resolve(null):this.ns.getDocuments(e,s).next(r=>{const o=this.cs(t,r);return this.ls(t,o,s,i)?Ie.resolve(null):(_p()<=It.DEBUG&&Ue("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Tp(t)),this.hs(e,o,t,JLe(i,R0)).next(a=>a))})}cs(e,t){let s=new Ds(hX(e));return t.forEach((i,r)=>{rI(e,r)&&(s=s.add(r))}),s}ls(e,t,s,i){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}_s(e,t,s){return _p()<=It.DEBUG&&Ue("QueryEngine","Using full collection scan to execute query:",Tp(t)),this.ns.getDocumentsMatchingQuery(e,t,Ku.min(),s)}hs(e,t,s,i){return this.ns.getDocumentsMatchingQuery(e,s,i).next(r=>(t.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP="LocalStore",DFe=3e8;class $Fe{constructor(e,t,s,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new xs(Dt),this.Is=new _f(r=>bP(r),vP),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(s)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wFe(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function OFe(n,e,t,s){return new $Fe(n,e,t,s)}async function OX(n,e){const t=ct(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let i;return t.mutationQueue.getAllMutationBatches(s).next(r=>(i=r,t.As(e),t.mutationQueue.getAllMutationBatches(s))).next(r=>{const o=[],a=[];let l=At();for(const c of i){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of r){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(s,l).next(c=>({Rs:c,removedBatchIds:o,addedBatchIds:a}))})})}function PFe(n,e){const t=ct(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const i=e.batch.keys(),r=t.ds.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const f=c.batch,p=f.keys();let g=Ie.resolve();return p.forEach(y=>{g=g.next(()=>h.getEntry(l,y)).next(x=>{const v=c.docVersions.get(y);en(v!==null),x.version.compareTo(v)<0&&(f.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),h.addEntry(x)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,s,e,r).next(()=>r.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(a){let l=At();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(s,i))})}function PX(n){const e=ct(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function LFe(n,e){const t=ct(n),s=e.snapshotVersion;let i=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=t.ds.newChangeBuffer({trackRemovals:!0});i=t.Ts;const a=[];e.targetChanges.forEach((h,f)=>{const p=i.get(f);if(!p)return;a.push(t.Hr.removeMatchingKeys(r,h.removedDocuments,f).next(()=>t.Hr.addMatchingKeys(r,h.addedDocuments,f)));let g=p.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(pi.EMPTY_BYTE_STRING,at.min()).withLastLimboFreeSnapshotVersion(at.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,s)),i=i.insert(f,g),function(x,v,w){return x.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=DFe?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(p,g,h)&&a.push(t.Hr.updateTargetData(r,g))});let l=cc(),c=At();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(r,h))}),a.push(MFe(r,o,e.documentUpdates).next(h=>{l=h.Vs,c=h.fs})),!s.isEqual(at.min())){const h=t.Hr.getLastRemoteSnapshotVersion(r).next(f=>t.Hr.setTargetsMetadata(r,r.currentSequenceNumber,s));a.push(h)}return Ie.waitFor(a).next(()=>o.apply(r)).next(()=>t.localDocuments.getLocalViewOfDocuments(r,l,c)).next(()=>l)}).then(r=>(t.Ts=i,r))}function MFe(n,e,t){let s=At(),i=At();return t.forEach(r=>s=s.add(r)),e.getEntries(n,s).next(r=>{let o=cc();return t.forEach((a,l)=>{const c=r.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(at.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Ue(NP,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Vs:o,fs:i}})}function FFe(n,e){const t=ct(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=mP),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function VFe(n,e){const t=ct(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let i;return t.Hr.getTargetData(s,e).next(r=>r?(i=r,Ie.resolve(i)):t.Hr.allocateTargetId(s).next(o=>(i=new vu(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.Hr.addTargetData(s,i).next(()=>i))))}).then(s=>{const i=t.Ts.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(s.targetId,s),t.Is.set(e,s.targetId)),s})}async function y2(n,e,t){const s=ct(n),i=s.Ts.get(e),r=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",r,o=>s.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Gg(o))throw o;Ue(NP,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ts=s.Ts.remove(e),s.Is.delete(i.target)}function O4(n,e,t){const s=ct(n);let i=at.min(),r=At();return s.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const f=ct(l),p=f.Is.get(h);return p!==void 0?Ie.resolve(f.Ts.get(p)):f.Hr.getTargetData(c,h)}(s,o,Wa(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,s.Hr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>s.Ps.getDocumentsMatchingQuery(o,e,t?i:at.min(),t?r:At())).next(a=>(zFe(s,EMe(e),a),{documents:a,gs:r})))}function zFe(n,e,t){let s=n.Es.get(e)||at.min();t.forEach((i,r)=>{r.readTime.compareTo(s)>0&&(s=r.readTime)}),n.Es.set(e,s)}class P4{constructor(){this.activeTargetIds=RMe()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class BFe{constructor(){this.ho=new P4,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,s){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new P4,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UFe{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L4="ConnectivityMonitor";class M4{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){Ue(L4,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){Ue(L4,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Y_=null;function b2(){return Y_===null?Y_=function(){return 268435456+Math.round(2147483648*Math.random())}():Y_++,"0x"+Y_.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA="RestConnection",WFe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class HFe{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${s}/databases/${i}`,this.wo=this.databaseId.database===BT?`project_id=${s}`:`project_id=${s}&database_id=${i}`}So(e,t,s,i,r){const o=b2(),a=this.bo(e,t.toUriEncodedString());Ue(dA,`Sending RPC '${e}' ${o}:`,a,s);const l={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(l,i,r),this.vo(e,a,l,s).then(c=>(Ue(dA,`Received RPC '${e}' ${o}: `,c),c),c=>{throw um(dA,`RPC '${e}' ${o} failed with error: `,c,"url: ",a,"request:",s),c})}Co(e,t,s,i,r,o){return this.So(e,t,s,i,r)}Do(e,t,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Hg}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,r)=>e[r]=i),s&&s.headers.forEach((i,r)=>e[r]=i)}bo(e,t){const s=WFe[e];return`${this.po}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jFe{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Ko(e){this.ko(e)}Uo(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi="WebChannelConnection";class GFe extends HFe{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,s,i){const r=b2();return new Promise((o,a)=>{const l=new zK;l.setWithCredentials(!0),l.listenOnce(BK.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case P1.NO_ERROR:const h=l.getResponseJson();Ue(xi,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(h)),o(h);break;case P1.TIMEOUT:Ue(xi,`RPC '${e}' ${r} timed out`),a(new Ke(Ae.DEADLINE_EXCEEDED,"Request time out"));break;case P1.HTTP_ERROR:const f=l.getStatus();if(Ue(xi,`RPC '${e}' ${r} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const y=function(v){const w=v.toLowerCase().replace(/_/g,"-");return Object.values(Ae).indexOf(w)>=0?w:Ae.UNKNOWN}(g.status);a(new Ke(y,g.message))}else a(new Ke(Ae.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Ke(Ae.UNAVAILABLE,"Connection failed."));break;default:rt()}}finally{Ue(xi,`RPC '${e}' ${r} completed.`)}});const c=JSON.stringify(i);Ue(xi,`RPC '${e}' ${r} sending request:`,i),l.send(t,"POST",c,s,15)})}Wo(e,t,s){const i=b2(),r=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=HK(),a=WK(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Do(l.initMessageHeaders,t,s),l.encodeInitMessageHeaders=!0;const h=r.join("");Ue(xi,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=o.createWebChannel(h,l);let p=!1,g=!1;const y=new jFe({Fo:v=>{g?Ue(xi,`Not sending because RPC '${e}' stream ${i} is closed:`,v):(p||(Ue(xi,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),Ue(xi,`RPC '${e}' stream ${i} sending:`,v),f.send(v))},Mo:()=>f.close()}),x=(v,w,S)=>{v.listen(w,C=>{try{S(C)}catch(I){setTimeout(()=>{throw I},0)}})};return x(f,$b.EventType.OPEN,()=>{g||(Ue(xi,`RPC '${e}' stream ${i} transport opened.`),y.Qo())}),x(f,$b.EventType.CLOSE,()=>{g||(g=!0,Ue(xi,`RPC '${e}' stream ${i} transport closed`),y.Ko())}),x(f,$b.EventType.ERROR,v=>{g||(g=!0,um(xi,`RPC '${e}' stream ${i} transport errored:`,v),y.Ko(new Ke(Ae.UNAVAILABLE,"The operation could not be completed")))}),x(f,$b.EventType.MESSAGE,v=>{var w;if(!g){const S=v.data[0];en(!!S);const C=S,I=(C==null?void 0:C.error)||((w=C[0])===null||w===void 0?void 0:w.error);if(I){Ue(xi,`RPC '${e}' stream ${i} received error:`,I);const A=I.status;let L=function(k){const $=fs[k];if($!==void 0)return _X($)}(A),O=I.message;L===void 0&&(L=Ae.INTERNAL,O="Unknown error status: "+A+" with message "+I.message),g=!0,y.Ko(new Ke(L,O)),f.close()}else Ue(xi,`RPC '${e}' stream ${i} received:`,S),y.Uo(S)}}),x(a,UK.STAT_EVENT,v=>{v.stat===r2.PROXY?Ue(xi,`RPC '${e}' stream ${i} detected buffering proxy`):v.stat===r2.NOPROXY&&Ue(xi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.$o()},0),y}}function fA(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cI(n){return new YMe(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LX{constructor(e,t,s=1e3,i=1.5,r=6e4){this.Ti=e,this.timerId=t,this.Go=s,this.zo=i,this.jo=r,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),s=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-s);i>0&&Ue("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4="PersistentStream";class MX{constructor(e,t,s,i,r,o,a,l){this.Ti=e,this.n_=s,this.r_=i,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new LX(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===Ae.RESOURCE_EXHAUSTED?(lc(t.toString()),lc("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===Ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,i])=>{this.i_===t&&this.V_(s,i)},s=>{e(()=>{const i=new Ke(Ae.UNKNOWN,"Fetching auth token failed: "+s.message);return this.m_(i)})})}V_(e,t){const s=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{s(()=>this.listener.xo())}),this.stream.No(()=>{s(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{s(()=>this.m_(i))}),this.stream.onMessage(i=>{s(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return Ue(F4,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(Ue(F4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class qFe extends MX{constructor(e,t,s,i,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,i,o),this.serializer=r}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=JMe(this.serializer,e),s=function(r){if(!("targetChange"in r))return at.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?at.min():o.readTime?ja(o.readTime):at.min()}(e);return this.listener.p_(t,s)}y_(e){const t={};t.database=g2(this.serializer),t.addTarget=function(r,o){let a;const l=o.target;if(a=u2(l)?{documents:nFe(r,l)}:{query:sFe(r,l).ht},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=EX(r,o.resumeToken);const c=f2(r,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(at.min())>0){a.readTime=qT(r,o.snapshotVersion.toTimestamp());const c=f2(r,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const s=rFe(this.serializer,e);s&&(t.labels=s),this.I_(t)}w_(e){const t={};t.database=g2(this.serializer),t.removeTarget=e,this.I_(t)}}class KFe extends MX{constructor(e,t,s,i,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,i,o),this.serializer=r}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return en(!!e.streamToken),this.lastStreamToken=e.streamToken,en(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){en(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=tFe(e.writeResults,e.commitTime),s=ja(e.commitTime);return this.listener.v_(s,t)}C_(){const e={};e.database=g2(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>eFe(this.serializer,s))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XFe{}class YFe extends XFe{constructor(e,t,s,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new Ke(Ae.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,s,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.So(e,p2(t,s),i,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new Ke(Ae.UNKNOWN,r.toString())})}Co(e,t,s,i,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Co(e,p2(t,s),i,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ke(Ae.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class QFe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(lc(t),this.N_=!1):Ue("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd="RemoteStore";class ZFe{constructor(e,t,s,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=r,this.z_.To(o=>{s.enqueueAndForget(async()=>{Sf(this)&&(Ue(Qd,"Restarting streams for network reachability change."),await async function(l){const c=ct(l);c.W_.add(4),await Xx(c),c.j_.set("Unknown"),c.W_.delete(4),await uI(c)}(this))})}),this.j_=new QFe(s,i)}}async function uI(n){if(Sf(n))for(const e of n.G_)await e(!0)}async function Xx(n){for(const e of n.G_)await e(!1)}function FX(n,e){const t=ct(n);t.U_.has(e.targetId)||(t.U_.set(e.targetId,e),$P(t)?DP(t):qg(t).c_()&&RP(t,e))}function AP(n,e){const t=ct(n),s=qg(t);t.U_.delete(e),s.c_()&&VX(t,e),t.U_.size===0&&(s.c_()?s.P_():Sf(t)&&t.j_.set("Unknown"))}function RP(n,e){if(n.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(at.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}qg(n).y_(e)}function VX(n,e){n.H_.Ne(e),qg(n).w_(e)}function DP(n){n.H_=new GMe({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>n.U_.get(e)||null,it:()=>n.datastore.serializer.databaseId}),qg(n).start(),n.j_.B_()}function $P(n){return Sf(n)&&!qg(n).u_()&&n.U_.size>0}function Sf(n){return ct(n).W_.size===0}function zX(n){n.H_=void 0}async function JFe(n){n.j_.set("Online")}async function eVe(n){n.U_.forEach((e,t)=>{RP(n,e)})}async function tVe(n,e){zX(n),$P(n)?(n.j_.q_(e),DP(n)):n.j_.set("Unknown")}async function nVe(n,e,t){if(n.j_.set("Online"),e instanceof SX&&e.state===2&&e.cause)try{await async function(i,r){const o=r.cause;for(const a of r.targetIds)i.U_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.U_.delete(a),i.H_.removeTarget(a))}(n,e)}catch(s){Ue(Qd,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await XT(n,s)}else if(e instanceof V1?n.H_.We(e):e instanceof TX?n.H_.Ze(e):n.H_.je(e),!t.isEqual(at.min()))try{const s=await PX(n.localStore);t.compareTo(s)>=0&&await function(r,o){const a=r.H_.ot(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=r.U_.get(c);h&&r.U_.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=r.U_.get(l);if(!h)return;r.U_.set(l,h.withResumeToken(pi.EMPTY_BYTE_STRING,h.snapshotVersion)),VX(r,l);const f=new vu(h.target,l,c,h.sequenceNumber);RP(r,f)}),r.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(s){Ue(Qd,"Failed to raise snapshot:",s),await XT(n,s)}}async function XT(n,e,t){if(!Gg(e))throw e;n.W_.add(1),await Xx(n),n.j_.set("Offline"),t||(t=()=>PX(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Ue(Qd,"Retrying IndexedDB access"),await t(),n.W_.delete(1),await uI(n)})}function BX(n,e){return e().catch(t=>XT(n,t,e))}async function hI(n){const e=ct(n),t=Zu(e);let s=e.K_.length>0?e.K_[e.K_.length-1].batchId:mP;for(;sVe(e);)try{const i=await FFe(e.localStore,s);if(i===null){e.K_.length===0&&t.P_();break}s=i.batchId,iVe(e,i)}catch(i){await XT(e,i)}UX(e)&&WX(e)}function sVe(n){return Sf(n)&&n.K_.length<10}function iVe(n,e){n.K_.push(e);const t=Zu(n);t.c_()&&t.S_&&t.b_(e.mutations)}function UX(n){return Sf(n)&&!Zu(n).u_()&&n.K_.length>0}function WX(n){Zu(n).start()}async function rVe(n){Zu(n).C_()}async function oVe(n){const e=Zu(n);for(const t of n.K_)e.b_(t.mutations)}async function aVe(n,e,t){const s=n.K_.shift(),i=TP.from(s,e,t);await BX(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await hI(n)}async function lVe(n,e){e&&Zu(n).S_&&await async function(s,i){if(function(o){return WMe(o)&&o!==Ae.ABORTED}(i.code)){const r=s.K_.shift();Zu(s).h_(),await BX(s,()=>s.remoteSyncer.rejectFailedWrite(r.batchId,i)),await hI(s)}}(n,e),UX(n)&&WX(n)}async function V4(n,e){const t=ct(n);t.asyncQueue.verifyOperationInProgress(),Ue(Qd,"RemoteStore received new credentials");const s=Sf(t);t.W_.add(3),await Xx(t),s&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await uI(t)}async function cVe(n,e){const t=ct(n);e?(t.W_.delete(2),await uI(t)):e||(t.W_.add(2),await Xx(t),t.j_.set("Unknown"))}function qg(n){return n.J_||(n.J_=function(t,s,i){const r=ct(t);return r.M_(),new qFe(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{xo:JFe.bind(null,n),No:eVe.bind(null,n),Lo:tVe.bind(null,n),p_:nVe.bind(null,n)}),n.G_.push(async e=>{e?(n.J_.h_(),$P(n)?DP(n):n.j_.set("Unknown")):(await n.J_.stop(),zX(n))})),n.J_}function Zu(n){return n.Y_||(n.Y_=function(t,s,i){const r=ct(t);return r.M_(),new KFe(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{xo:()=>Promise.resolve(),No:rVe.bind(null,n),Lo:lVe.bind(null,n),D_:oVe.bind(null,n),v_:aVe.bind(null,n)}),n.G_.push(async e=>{e?(n.Y_.h_(),await hI(n)):(await n.Y_.stop(),n.K_.length>0&&(Ue(Qd,`Stopping write stream with ${n.K_.length} pending writes`),n.K_=[]))})),n.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,t,s,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=i,this.removalCallback=r,this.deferred=new Ad,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,i,r){const o=Date.now()+s,a=new OP(e,t,o,i,r);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ke(Ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function PP(n,e){if(lc("AsyncQueue",`${e}: ${n}`),Gg(n))return new Ke(Ae.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{static emptySet(e){return new zp(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||et.comparator(t.key,s.key):(t,s)=>et.comparator(t.key,s.key),this.keyedMap=Ob(),this.sortedSet=new xs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zp)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,r=s.getNext().key;if(!i.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new zp;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(){this.Z_=new xs(et.comparator)}track(e){const t=e.doc.key,s=this.Z_.get(t);s?e.type!==0&&s.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&s.type!==1?this.Z_=this.Z_.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.Z_=this.Z_.remove(t):e.type===1&&s.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):rt():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal((t,s)=>{e.push(s)}),e}}class mm{constructor(e,t,s,i,r,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,s,i,r){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new mm(e,t,zp.emptySet(t),o,s,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&iI(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==s[i].type||!t[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uVe{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class hVe{constructor(){this.queries=B4(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,s){const i=ct(t),r=i.queries;i.queries=B4(),r.forEach((o,a)=>{for(const l of a.ta)l.onError(s)})})(this,new Ke(Ae.ABORTED,"Firestore shutting down"))}}function B4(){return new _f(n=>uX(n),iI)}async function dVe(n,e){const t=ct(n);let s=3;const i=e.query;let r=t.queries.get(i);r?!r.na()&&e.ra()&&(s=2):(r=new uVe,s=e.ra()?0:1);try{switch(s){case 0:r.ea=await t.onListen(i,!0);break;case 1:r.ea=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=PP(o,`Initialization of query '${Tp(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,r),r.ta.push(e),e.sa(t.onlineState),r.ea&&e.oa(r.ea)&&LP(t)}async function fVe(n,e){const t=ct(n),s=e.query;let i=3;const r=t.queries.get(s);if(r){const o=r.ta.indexOf(e);o>=0&&(r.ta.splice(o,1),r.ta.length===0?i=e.ra()?0:1:!r.na()&&e.ra()&&(i=2))}switch(i){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function pVe(n,e){const t=ct(n);let s=!1;for(const i of e){const r=i.query,o=t.queries.get(r);if(o){for(const a of o.ta)a.oa(i)&&(s=!0);o.ea=i}}s&&LP(t)}function mVe(n,e,t){const s=ct(n),i=s.queries.get(e);if(i)for(const r of i.ta)r.onError(t);s.queries.delete(e)}function LP(n){n.ia.forEach(e=>{e.next()})}var v2,U4;(U4=v2||(v2={}))._a="default",U4.Cache="cache";class gVe{constructor(e,t,s){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=s||{}}oa(e){if(!this.options.includeMetadataChanges){const s=[];for(const i of e.docChanges)i.type!==3&&s.push(i);e=new mm(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;const s=t!=="Offline";return(!this.options.Ta||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=mm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==v2.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HX{constructor(e){this.key=e}}class jX{constructor(e){this.key=e}}class yVe{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=At(),this.mutatedKeys=At(),this.ya=hX(e),this.wa=new zp(this.ya)}get Sa(){return this.fa}ba(e,t){const s=t?t.Da:new z4,i=t?t.wa:this.wa;let r=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const p=i.get(h),g=rI(this.query,f)?f:null,y=!!p&&this.mutatedKeys.has(p.key),x=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let v=!1;p&&g?p.data.isEqual(g.data)?y!==x&&(s.track({type:3,doc:g}),v=!0):this.va(p,g)||(s.track({type:2,doc:g}),v=!0,(l&&this.ya(g,l)>0||c&&this.ya(g,c)<0)&&(a=!0)):!p&&g?(s.track({type:0,doc:g}),v=!0):p&&!g&&(s.track({type:1,doc:p}),v=!0,(l||c)&&(a=!0)),v&&(g?(o=o.add(g),r=x?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),s.track({type:1,doc:h})}return{wa:o,Da:s,ls:a,mutatedKeys:r}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,i){const r=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort((h,f)=>function(g,y){const x=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt()}};return x(g)-x(y)}(h.type,f.type)||this.ya(h.doc,f.doc)),this.Ca(s),i=i!=null&&i;const a=t&&!i?this.Fa():[],l=this.pa.size===0&&this.current&&!i?1:0,c=l!==this.ga;return this.ga=l,o.length!==0||c?{snapshot:new mm(this.query,e.wa,r,o,e.mutatedKeys,l===0,c,!1,!!s&&s.resumeToken.approximateByteSize()>0),Ma:a}:{Ma:a}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new z4,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=At(),this.wa.forEach(s=>{this.xa(s.key)&&(this.pa=this.pa.add(s.key))});const t=[];return e.forEach(s=>{this.pa.has(s)||t.push(new jX(s))}),this.pa.forEach(s=>{e.has(s)||t.push(new HX(s))}),t}Oa(e){this.fa=e.gs,this.pa=At();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return mm.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const MP="SyncEngine";class bVe{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class vVe{constructor(e){this.key=e,this.Ba=!1}}class xVe{constructor(e,t,s,i,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new _f(a=>uX(a),iI),this.qa=new Map,this.Qa=new Set,this.$a=new xs(et.comparator),this.Ka=new Map,this.Ua=new CP,this.Wa={},this.Ga=new Map,this.za=pm.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function wVe(n,e,t=!0){const s=QX(n);let i;const r=s.ka.get(e);return r?(s.sharedClientState.addLocalQueryTarget(r.targetId),i=r.view.Na()):i=await GX(s,e,t,!0),i}async function _Ve(n,e){const t=QX(n);await GX(t,e,!0,!1)}async function GX(n,e,t,s){const i=await VFe(n.localStore,Wa(e)),r=i.targetId,o=n.sharedClientState.addLocalQueryTarget(r,t);let a;return s&&(a=await TVe(n,e,r,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&FX(n.remoteStore,i),a}async function TVe(n,e,t,s,i){n.Ha=(f,p,g)=>async function(x,v,w,S){let C=v.view.ba(w);C.ls&&(C=await O4(x.localStore,v.query,!1).then(({documents:O})=>v.view.ba(O,C)));const I=S&&S.targetChanges.get(v.targetId),A=S&&S.targetMismatches.get(v.targetId)!=null,L=v.view.applyChanges(C,x.isPrimaryClient,I,A);return H4(x,v.targetId,L.Ma),L.snapshot}(n,f,p,g);const r=await O4(n.localStore,e,!0),o=new yVe(e,r.gs),a=o.ba(r.documents),l=Kx.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",i),c=o.applyChanges(a,n.isPrimaryClient,l);H4(n,t,c.Ma);const h=new bVe(e,t,o);return n.ka.set(e,h),n.qa.has(t)?n.qa.get(t).push(e):n.qa.set(t,[e]),c.snapshot}async function SVe(n,e,t){const s=ct(n),i=s.ka.get(e),r=s.qa.get(i.targetId);if(r.length>1)return s.qa.set(i.targetId,r.filter(o=>!iI(o,e))),void s.ka.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await y2(s.localStore,i.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(i.targetId),t&&AP(s.remoteStore,i.targetId),x2(s,i.targetId)}).catch(jg)):(x2(s,i.targetId),await y2(s.localStore,i.targetId,!0))}async function EVe(n,e){const t=ct(n),s=t.ka.get(e),i=t.qa.get(s.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),AP(t.remoteStore,s.targetId))}async function CVe(n,e,t){const s=$Ve(n);try{const i=await function(o,a){const l=ct(o),c=Rs.now(),h=a.reduce((g,y)=>g.add(y.key),At());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=cc(),x=At();return l.ds.getEntries(g,h).next(v=>{y=v,y.forEach((w,S)=>{S.isValidDocument()||(x=x.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,y)).next(v=>{f=v;const w=[];for(const S of a){const C=FMe(S,f.get(S.key).overlayedDocument);C!=null&&w.push(new Tf(S.key,C,nX(C.value.mapValue),Ha.exists(!0)))}return l.mutationQueue.addMutationBatch(g,c,w,a)}).next(v=>{p=v;const w=v.applyToLocalDocumentSet(f,x);return l.documentOverlayCache.saveOverlays(g,v.batchId,w)})}).then(()=>({batchId:p.batchId,changes:fX(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Wa[o.currentUser.toKey()];c||(c=new xs(Dt)),c=c.insert(a,l),o.Wa[o.currentUser.toKey()]=c}(s,i.batchId,t),await Yx(s,i.changes),await hI(s.remoteStore)}catch(i){const r=PP(i,"Failed to persist write");t.reject(r)}}async function qX(n,e){const t=ct(n);try{const s=await LFe(t.localStore,e);e.targetChanges.forEach((i,r)=>{const o=t.Ka.get(r);o&&(en(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ba=!0:i.modifiedDocuments.size>0?en(o.Ba):i.removedDocuments.size>0&&(en(o.Ba),o.Ba=!1))}),await Yx(t,s,e)}catch(s){await jg(s)}}function W4(n,e,t){const s=ct(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const i=[];s.ka.forEach((r,o)=>{const a=o.view.sa(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ct(o);l.onlineState=a;let c=!1;l.queries.forEach((h,f)=>{for(const p of f.ta)p.sa(a)&&(c=!0)}),c&&LP(l)}(s.eventManager,e),i.length&&s.La.p_(i),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function IVe(n,e,t){const s=ct(n);s.sharedClientState.updateQueryState(e,"rejected",t);const i=s.Ka.get(e),r=i&&i.key;if(r){let o=new xs(et.comparator);o=o.insert(r,Ii.newNoDocument(r,at.min()));const a=At().add(r),l=new lI(at.min(),new Map,new xs(Dt),o,a);await qX(s,l),s.$a=s.$a.remove(r),s.Ka.delete(e),FP(s)}else await y2(s.localStore,e,!1).then(()=>x2(s,e,t)).catch(jg)}async function kVe(n,e){const t=ct(n),s=e.batch.batchId;try{const i=await PFe(t.localStore,e);XX(t,s,null),KX(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Yx(t,i)}catch(i){await jg(i)}}async function NVe(n,e,t){const s=ct(n);try{const i=await function(o,a){const l=ct(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(en(f!==null),h=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(s.localStore,e);XX(s,e,t),KX(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Yx(s,i)}catch(i){await jg(i)}}function KX(n,e){(n.Ga.get(e)||[]).forEach(t=>{t.resolve()}),n.Ga.delete(e)}function XX(n,e,t){const s=ct(n);let i=s.Wa[s.currentUser.toKey()];if(i){const r=i.get(e);r&&(t?r.reject(t):r.resolve(),i=i.remove(e)),s.Wa[s.currentUser.toKey()]=i}}function x2(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.qa.get(e))n.ka.delete(s),t&&n.La.Ja(s,t);n.qa.delete(e),n.isPrimaryClient&&n.Ua.br(e).forEach(s=>{n.Ua.containsKey(s)||YX(n,s)})}function YX(n,e){n.Qa.delete(e.path.canonicalString());const t=n.$a.get(e);t!==null&&(AP(n.remoteStore,t),n.$a=n.$a.remove(e),n.Ka.delete(t),FP(n))}function H4(n,e,t){for(const s of t)s instanceof HX?(n.Ua.addReference(s.key,e),AVe(n,s)):s instanceof jX?(Ue(MP,"Document no longer in limbo: "+s.key),n.Ua.removeReference(s.key,e),n.Ua.containsKey(s.key)||YX(n,s.key)):rt()}function AVe(n,e){const t=e.key,s=t.path.canonicalString();n.$a.get(t)||n.Qa.has(s)||(Ue(MP,"New document in limbo: "+t),n.Qa.add(s),FP(n))}function FP(n){for(;n.Qa.size>0&&n.$a.size<n.maxConcurrentLimboResolutions;){const e=n.Qa.values().next().value;n.Qa.delete(e);const t=new et(Cn.fromString(e)),s=n.za.next();n.Ka.set(s,new vVe(t)),n.$a=n.$a.insert(t,s),FX(n.remoteStore,new vu(Wa(xP(t.path)),s,"TargetPurposeLimboResolution",tI.ae))}}async function Yx(n,e,t){const s=ct(n),i=[],r=[],o=[];s.ka.isEmpty()||(s.ka.forEach((a,l)=>{o.push(s.Ha(l,e,t).then(c=>{var h;if((c||t)&&s.isPrimaryClient){const f=c?!c.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;s.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){i.push(c);const f=kP.Yi(l.targetId,c);r.push(f)}}))}),await Promise.all(o),s.La.p_(i),await async function(l,c){const h=ct(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Ie.forEach(c,p=>Ie.forEach(p.Hi,g=>h.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>Ie.forEach(p.Ji,g=>h.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!Gg(f))throw f;Ue(NP,"Failed to update sequence numbers: "+f)}for(const f of c){const p=f.targetId;if(!f.fromCache){const g=h.Ts.get(p),y=g.snapshotVersion,x=g.withLastLimboFreeSnapshotVersion(y);h.Ts=h.Ts.insert(p,x)}}}(s.localStore,r))}async function RVe(n,e){const t=ct(n);if(!t.currentUser.isEqual(e)){Ue(MP,"User change. New user:",e.toKey());const s=await OX(t.localStore,e);t.currentUser=e,function(r,o){r.Ga.forEach(a=>{a.forEach(l=>{l.reject(new Ke(Ae.CANCELLED,o))})}),r.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Yx(t,s.Rs)}}function DVe(n,e){const t=ct(n),s=t.Ka.get(e);if(s&&s.Ba)return At().add(s.key);{let i=At();const r=t.qa.get(e);if(!r)return i;for(const o of r){const a=t.ka.get(o);i=i.unionWith(a.view.Sa)}return i}}function QX(n){const e=ct(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=qX.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DVe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=IVe.bind(null,e),e.La.p_=pVe.bind(null,e.eventManager),e.La.Ja=mVe.bind(null,e.eventManager),e}function $Ve(n){const e=ct(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kVe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NVe.bind(null,e),e}class YT{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=cI(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return OFe(this.persistence,new RFe,e.initialUser,this.serializer)}Xa(e){return new $X(IP.ri,this.serializer)}Za(e){return new BFe}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}YT.provider={build:()=>new YT};class OVe extends YT{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){en(this.persistence.referenceDelegate instanceof KT);const s=this.persistence.referenceDelegate.garbageCollector;return new gFe(s,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?fr.withCacheSize(this.cacheSizeBytes):fr.DEFAULT;return new $X(s=>KT.ri(s,t),this.serializer)}}class w2{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>W4(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=RVe.bind(null,this.syncEngine),await cVe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new hVe}()}createDatastore(e){const t=cI(e.databaseInfo.databaseId),s=function(r){return new GFe(r)}(e.databaseInfo);return function(r,o,a,l){return new YFe(r,o,a,l)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,i,r,o,a){return new ZFe(s,i,r,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>W4(this.syncEngine,t,0),function(){return M4.D()?new M4:new UFe}())}createSyncEngine(e,t){return function(i,r,o,a,l,c,h){const f=new xVe(i,r,o,a,l,c);return h&&(f.ja=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const r=ct(i);Ue(Qd,"RemoteStore shutting down."),r.W_.add(5),await Xx(r),r.z_.shutdown(),r.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}w2.provider={build:()=>new w2};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PVe{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):lc("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju="FirestoreClient";class LVe{constructor(e,t,s,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=i,this.user=Ti.UNAUTHENTICATED,this.clientId=GK.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(s,async o=>{Ue(Ju,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(Ue(Ju,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ad;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=PP(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function pA(n,e){n.asyncQueue.verifyOperationInProgress(),Ue(Ju,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async i=>{s.isEqual(i)||(await OX(e.localStore,i),s=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function j4(n,e){n.asyncQueue.verifyOperationInProgress();const t=await MVe(n);Ue(Ju,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>V4(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>V4(e.remoteStore,i)),n._onlineComponents=e}async function MVe(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ue(Ju,"Using user provided OfflineComponentProvider");try{await pA(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ae.FAILED_PRECONDITION||i.code===Ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;um("Error using user provided cache. Falling back to memory cache: "+t),await pA(n,new YT)}}else Ue(Ju,"Using default OfflineComponentProvider"),await pA(n,new OVe(void 0));return n._offlineComponents}async function ZX(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ue(Ju,"Using user provided OnlineComponentProvider"),await j4(n,n._uninitializedComponentsProvider._online)):(Ue(Ju,"Using default OnlineComponentProvider"),await j4(n,new w2))),n._onlineComponents}function FVe(n){return ZX(n).then(e=>e.syncEngine)}async function G4(n){const e=await ZX(n),t=e.eventManager;return t.onListen=wVe.bind(null,e.syncEngine),t.onUnlisten=SVe.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=_Ve.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=EVe.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JX(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eY(n,e,t){if(!t)throw new Ke(Ae.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function VVe(n,e,t,s){if(e===!0&&s===!0)throw new Ke(Ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function K4(n){if(!et.isDocumentKey(n))throw new Ke(Ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function X4(n){if(et.isDocumentKey(n))throw new Ke(Ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function dI(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":rt()}function Bp(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ke(Ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=dI(n);throw new Ke(Ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tY="firestore.googleapis.com",Y4=!0;class Q4{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Ke(Ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=tY,this.ssl=Y4}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Y4;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=DX;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<pFe)throw new Ke(Ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VVe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=JX((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ke(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ke(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ke(Ae.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,i){return s.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fI{constructor(e,t,s,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Q4({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ke(Ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ke(Ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Q4(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new jLe;switch(s.type){case"firstParty":return new XLe(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ke(Ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=q4.get(t);s&&(Ue("ComponentProvider","Removing Datastore"),q4.delete(t),s.terminate())}(this),Promise.resolve()}}function zVe(n,e,t,s={}){var i;const r=(n=Bp(n,fI))._getSettings(),o=`${e}:${t}`;if(r.host!==tY&&r.host!==o&&um("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),s.mockUserToken){let a,l;if(typeof s.mockUserToken=="string")a=s.mockUserToken,l=Ti.MOCK_USER;else{a=hP(s.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const c=s.mockUserToken.sub||s.mockUserToken.user_id;if(!c)throw new Ke(Ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Ti(c)}n._authCredentials=new GLe(new jK(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Kg(this.firestore,e,this._query)}}class zr{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new zr(this.firestore,e,this._key)}}class Nu extends Kg{constructor(e,t,s){super(e,t,xP(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new zr(this.firestore,null,new et(e))}withConverter(e){return new Nu(this.firestore,e,this._path)}}function _2(n,e,...t){if(n=Bn(n),eY("collection","path",e),n instanceof fI){const s=Cn.fromString(e,...t);return X4(s),new Nu(n,null,s)}{if(!(n instanceof zr||n instanceof Nu))throw new Ke(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Cn.fromString(e,...t));return X4(s),new Nu(n.firestore,null,s)}}function VP(n,e,...t){if(n=Bn(n),arguments.length===1&&(e=GK.newId()),eY("doc","path",e),n instanceof fI){const s=Cn.fromString(e,...t);return K4(s),new zr(n,null,new et(s))}{if(!(n instanceof zr||n instanceof Nu))throw new Ke(Ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Cn.fromString(e,...t));return K4(s),new zr(n.firestore,n instanceof Nu?n.converter:null,new et(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4="AsyncQueue";class J4{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new LX(this,"async_queue_retry"),this.Su=()=>{const s=fA();s&&Ue(Z4,"Visibility state changed to "+s.visibilityState),this.a_.t_()},this.bu=e;const t=fA();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=fA();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new Ad;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Gg(e))throw e;Ue(Z4,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.bu.then(()=>(this.pu=!0,e().catch(s=>{this.gu=s,this.pu=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(s);throw lc("INTERNAL UNHANDLED ERROR: ",i),s}).then(s=>(this.pu=!1,s))));return this.bu=t,t}enqueueAfterDelay(e,t,s){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const i=OP.createAndSchedule(this,e,t,s,r=>this.Fu(r));return this.fu.push(i),i}Du(){this.gu&&rt()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}function eU(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const i=t;for(const r of s)if(r in i&&typeof i[r]=="function")return!0;return!1}(n,["next","error","complete"])}class M0 extends fI{constructor(e,t,s,i){super(e,t,s,i),this.type="firestore",this._queue=new J4,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new J4(e),this._firestoreClient=void 0,await e}}}function BVe(n,e){const t=typeof n=="object"?n:eI(),s=typeof n=="string"?n:BT,i=jx(t,"firestore").getImmediate({identifier:s});if(!i._initialized){const r=cP("firestore");r&&zVe(i,...r)}return i}function nY(n){if(n._terminated)throw new Ke(Ae.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||UVe(n),n._firestoreClient}function UVe(n){var e,t,s;const i=n._freezeSettings(),r=function(a,l,c,h){return new cMe(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,JX(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=i.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new LVe(n._authCredentials,n._appCheckCredentials,n._queue,r,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gm(pi.fromBase64String(e))}catch(t){throw new Ke(Ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new gm(pi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ke(Ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new di(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sY{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ke(Ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ke(Ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Dt(this._lat,e._lat)||Dt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,i){if(s.length!==i.length)return!1;for(let r=0;r<s.length;++r)if(s[r]!==i[r])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WVe=/^__.*__$/;class HVe{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Tf(e,this.data,this.fieldMask,t,this.fieldTransforms):new qx(e,this.data,t,this.fieldTransforms)}}function iY(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt()}}class WP{constructor(e,t,s,i,r,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=i,r===void 0&&this.Bu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new WP(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:s,Qu:!1});return i.$u(e),i}Ku(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:s,Qu:!1});return i.Bu(),i}Uu(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return QT(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(iY(this.Lu)&&WVe.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class jVe{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||cI(e)}ju(e,t,s,i=!1){return new WP({Lu:e,methodName:t,zu:s,path:di.emptyPath(),Qu:!1,Gu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rY(n){const e=n._freezeSettings(),t=cI(n._databaseId);return new jVe(n._databaseId,!!e.ignoreUndefinedProperties,t)}function GVe(n,e,t,s,i,r={}){const o=n.ju(r.merge||r.mergeFields?2:0,e,t,i);lY("Data must be an object, but it was:",o,s);const a=oY(s,o);let l,c;if(r.merge)l=new jo(o.fieldMask),c=o.fieldTransforms;else if(r.mergeFields){const h=[];for(const f of r.mergeFields){const p=KVe(e,f,t);if(!o.contains(p))throw new Ke(Ae.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);YVe(h,p)||h.push(p)}l=new jo(h),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new HVe(new go(a),l,c)}function qVe(n,e,t,s=!1){return HP(t,n.ju(s?4:3,e))}function HP(n,e){if(aY(n=Bn(n)))return lY("Unsupported field value:",e,n),oY(n,e);if(n instanceof sY)return function(s,i){if(!iY(i.Lu))throw i.Wu(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Wu(`${s._methodName}() is not currently supported inside arrays`);const r=s._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(s,i){const r=[];let o=0;for(const a of s){let l=HP(a,i.Uu(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}}(n,e)}return function(s,i){if((s=Bn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return DMe(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const r=Rs.fromDate(s);return{timestampValue:qT(i.serializer,r)}}if(s instanceof Rs){const r=new Rs(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:qT(i.serializer,r)}}if(s instanceof BP)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof gm)return{bytesValue:EX(i.serializer,s._byteString)};if(s instanceof zr){const r=i.databaseId,o=s.firestore._databaseId;if(!o.isEqual(r))throw i.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:EP(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof UP)return function(o,a){return{mapValue:{fields:{[eX]:{stringValue:tX},[UT]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Wu("VectorValues must only contain numeric values.");return wP(a.serializer,c)})}}}}}}(s,i);throw i.Wu(`Unsupported field value: ${dI(s)}`)}(n,e)}function oY(n,e){const t={};return KK(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wf(n,(s,i)=>{const r=HP(i,e.qu(s));r!=null&&(t[s]=r)}),{mapValue:{fields:t}}}function aY(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Rs||n instanceof BP||n instanceof gm||n instanceof zr||n instanceof sY||n instanceof UP)}function lY(n,e,t){if(!aY(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const s=dI(t);throw s==="an object"?e.Wu(n+" a custom object"):e.Wu(n+" "+s)}}function KVe(n,e,t){if((e=Bn(e))instanceof zP)return e._internalPath;if(typeof e=="string")return cY(n,e);throw QT("Field path arguments must be of type string or ",n,!1,void 0,t)}const XVe=new RegExp("[~\\*/\\[\\]]");function cY(n,e,t){if(e.search(XVe)>=0)throw QT(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new zP(...e.split("."))._internalPath}catch{throw QT(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function QT(n,e,t,s,i){const r=s&&!s.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${s}`),o&&(l+=` in document ${i}`),l+=")"),new Ke(Ae.INVALID_ARGUMENT,a+n+l)}function YVe(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uY{constructor(e,t,s,i,r){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new zr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QVe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(jP("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class QVe extends uY{data(){return super.data()}}function jP(n,e){return typeof e=="string"?cY(n,e):e instanceof zP?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZVe(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ke(Ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class GP{}class JVe extends GP{}function e3e(n,e,...t){let s=[];e instanceof GP&&s.push(e),s=s.concat(t),function(r){const o=r.filter(l=>l instanceof qP).length,a=r.filter(l=>l instanceof pI).length;if(o>1||o>0&&a>0)throw new Ke(Ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const i of s)n=i._apply(n);return n}class pI extends JVe{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new pI(e,t,s)}_apply(e){const t=this._parse(e);return hY(e._query,t),new Kg(e.firestore,e.converter,h2(e._query,t))}_parse(e){const t=rY(e.firestore);return function(r,o,a,l,c,h,f){let p;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ke(Ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){nU(f,h);const y=[];for(const x of f)y.push(tU(l,r,x));p={arrayValue:{values:y}}}else p=tU(l,r,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||nU(f,h),p=qVe(a,o,f,h==="in"||h==="not-in");return ps.create(c,h,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function t3e(n,e,t){const s=e,i=jP("where",n);return pI._create(i,s,t)}class qP extends GP{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qP(e,t)}_parse(e){const t=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return t.length===1?t[0]:ia.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,r){let o=i;const a=r.getFlattenedFilters();for(const l of a)hY(o,l),o=h2(o,l)}(e._query,t),new Kg(e.firestore,e.converter,h2(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function tU(n,e,t){if(typeof(t=Bn(t))=="string"){if(t==="")throw new Ke(Ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cX(e)&&t.indexOf("/")!==-1)throw new Ke(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Cn.fromString(t));if(!et.isDocumentKey(s))throw new Ke(Ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return m4(n,new et(s))}if(t instanceof zr)return m4(n,t._key);throw new Ke(Ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${dI(t)}.`)}function nU(n,e){if(!Array.isArray(n)||n.length===0)throw new Ke(Ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hY(n,e){const t=function(i,r){for(const o of i)for(const a of o.getFlattenedFilters())if(r.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ke(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ke(Ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class n3e{convertValue(e,t="none"){switch(Qu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw rt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return wf(e,(i,r)=>{s[i]=this.convertValue(r,t)}),s}convertVectorValue(e){var t,s,i;const r=(i=(s=(t=e.fields)===null||t===void 0?void 0:t[UT].arrayValue)===null||s===void 0?void 0:s.values)===null||i===void 0?void 0:i.map(o=>rs(o.doubleValue));return new UP(r)}convertGeoPoint(e){return new BP(rs(e.latitude),rs(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=sI(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(D0(e));default:return null}}convertTimestamp(e){const t=Xu(e);return new Rs(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Cn.fromString(e);en(RX(s));const i=new $0(s.get(1),s.get(3)),r=new et(s.popFirst(5));return i.isEqual(t)||lc(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s3e(n,e,t){let s;return s=n?n.toFirestore(e):e,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dY extends uY{constructor(e,t,s,i,r,o){super(e,t,s,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new z1(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(jP("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}}class z1 extends dY{data(e={}){return super.data(e)}}class i3e{constructor(e,t,s,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Lb(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new z1(this._firestore,this._userDataWriter,s.key,s,new Lb(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ke(Ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new z1(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Lb(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>r||a.type!==3).map(a=>{const l=new z1(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Lb(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:r3e(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function r3e(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt()}}class fY extends n3e{constructor(e){super(),this.firestore=e}convertBytes(e){return new gm(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new zr(this.firestore,null,t)}}function pY(n){return gY(Bp(n.firestore,M0),[new _P(n._key,Ha.none())])}function o3e(n,e){const t=Bp(n.firestore,M0),s=VP(n),i=s3e(n.converter,e);return gY(t,[GVe(rY(n.firestore),"addDoc",s._key,i,n.converter!==null,{}).toMutation(s._key,Ha.exists(!1))]).then(()=>s)}function mY(n,...e){var t,s,i;n=Bn(n);let r={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||eU(e[o])||(r=e[o],o++);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(eU(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(s=f.error)===null||s===void 0?void 0:s.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let l,c,h;if(n instanceof zr)c=Bp(n.firestore,M0),h=xP(n._key.path),l={next:f=>{e[o]&&e[o](a3e(c,n,f))},error:e[o+1],complete:e[o+2]};else{const f=Bp(n,Kg);c=Bp(f.firestore,M0),h=f._query;const p=new fY(c);l={next:g=>{e[o]&&e[o](new i3e(c,p,f,g))},error:e[o+1],complete:e[o+2]},ZVe(n._query)}return function(p,g,y,x){const v=new PVe(x),w=new gVe(g,v,y);return p.asyncQueue.enqueueAndForget(async()=>dVe(await G4(p),w)),()=>{v.su(),p.asyncQueue.enqueueAndForget(async()=>fVe(await G4(p),w))}}(nY(c),h,a,l)}function gY(n,e){return function(s,i){const r=new Ad;return s.asyncQueue.enqueueAndForget(async()=>CVe(await FVe(s),i,r)),r.promise}(nY(n),e)}function a3e(n,e,t){const s=t.docs.get(e._key),i=new fY(n);return new dY(n,i,e._key,s,new Lb(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Hg=i})(ph),qu(new oc("firestore",(s,{instanceIdentifier:i,options:r})=>{const o=s.getProvider("app").getImmediate(),a=new M0(new qLe(s.getProvider("auth-internal")),new YLe(o,s.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ke(Ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $0(c.options.projectId,h)}(o,i),o);return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),To(i4,r4,e),To(i4,r4,"esm2017")})();var sU={};const iU="@firebase/database",rU="1.0.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yY="";function l3e(n){yY=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3e{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),hi(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:N0(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3e{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Sc(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bY=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new c3e(e)}}catch{}return new u3e},vd=bY("localStorage"),h3e=bY("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up=new JC("@firebase/database"),d3e=function(){let n=1;return function(){return n++}}(),vY=function(n){const e=OPe(n),t=new NPe;t.update(e);const s=t.digest();return lP.encodeByteArray(s)},Qx=function(...n){let e="";for(let t=0;t<n.length;t++){const s=n[t];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=Qx.apply(null,s):typeof s=="object"?e+=hi(s):e+=s,e+=" "}return e};let qb=null,oU=!0;const f3e=function(n,e){Fe(!0,"Can't turn on custom loggers persistently."),Up.logLevel=It.VERBOSE,qb=Up.log.bind(Up)},ki=function(...n){if(oU===!0&&(oU=!1,qb===null&&h3e.get("logging_enabled")===!0&&f3e()),qb){const e=Qx.apply(null,n);qb(e)}},Zx=function(n){return function(...e){ki(n,...e)}},T2=function(...n){const e="FIREBASE INTERNAL ERROR: "+Qx(...n);Up.error(e)},uc=function(...n){const e=`FIREBASE FATAL ERROR: ${Qx(...n)}`;throw Up.error(e),new Error(e)},Br=function(...n){const e="FIREBASE WARNING: "+Qx(...n);Up.warn(e)},p3e=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Br("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},xY=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},m3e=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},ym="[MIN_NAME]",Zd="[MAX_NAME]",Xg=function(n,e){if(n===e)return 0;if(n===ym||e===Zd)return-1;if(e===ym||n===Zd)return 1;{const t=aU(n),s=aU(e);return t!==null?s!==null?t-s===0?n.length-e.length:t-s:-1:s!==null?1:n<e?-1:1}},g3e=function(n,e){return n===e?0:n<e?-1:1},pb=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+hi(e))},KP=function(n){if(typeof n!="object"||n===null)return hi(n);const e=[];for(const s in n)e.push(s);e.sort();let t="{";for(let s=0;s<e.length;s++)s!==0&&(t+=","),t+=hi(e[s]),t+=":",t+=KP(n[e[s]]);return t+="}",t},wY=function(n,e){const t=n.length;if(t<=e)return[n];const s=[];for(let i=0;i<t;i+=e)i+e>t?s.push(n.substring(i,t)):s.push(n.substring(i,i+e));return s};function Eo(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const _Y=function(n){Fe(!xY(n),"Invalid JSON number");const e=11,t=52,s=(1<<e-1)-1;let i,r,o,a,l;n===0?(r=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),s),r=a+s,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(r=0,o=Math.round(n/Math.pow(2,1-s-t))));const c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(i?1:0),c.reverse();const h=c.join("");let f="";for(l=0;l<64;l+=8){let p=parseInt(h.substr(l,8),2).toString(16);p.length===1&&(p="0"+p),f=f+p}return f.toLowerCase()},y3e=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},b3e=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},v3e=new RegExp("^-?(0*)\\d{1,10}$"),x3e=-2147483648,w3e=2147483647,aU=function(n){if(v3e.test(n)){const e=Number(n);if(e>=x3e&&e<=w3e)return e}return null},Jx=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Br("Exception was thrown by user callback.",t),e},Math.floor(0))}},_3e=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Kb=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3e{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Xi(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Br(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S3e{constructor(e,t,s){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(ki("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,s):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Br(e)}}class B1{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}B1.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP="5",TY="v",SY="s",EY="r",CY="f",IY=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,kY="ls",NY="p",S2="ac",AY="websocket",RY="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(e,t,s,i,r=!1,o="",a=!1,l=!1){this.secure=t,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=vd.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&vd.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function E3e(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function $Y(n,e,t){Fe(typeof e=="string","typeof type must == string"),Fe(typeof t=="object","typeof params must == object");let s;if(e===AY)s=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===RY)s=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);E3e(n)&&(t.ns=n.namespace);const i=[];return Eo(t,(r,o)=>{i.push(r+"="+o)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C3e{constructor(){this.counters_={}}incrementCounter(e,t=1){Sc(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return uPe(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA={},gA={};function YP(n){const e=n.toString();return mA[e]||(mA[e]=new C3e),mA[e]}function I3e(n,e){const t=n.toString();return gA[t]||(gA[t]=e()),gA[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3e{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&Jx(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU="start",N3e="close",A3e="pLPCommand",R3e="pRTLPCB",OY="id",PY="pw",LY="ser",D3e="cb",$3e="seg",O3e="ts",P3e="d",L3e="dframe",MY=1870,FY=30,M3e=MY-FY,F3e=25e3,V3e=3e4;class Cp{constructor(e,t,s,i,r,o,a){this.connId=e,this.repoInfo=t,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Zx(e),this.stats_=YP(t),this.urlFn=l=>(this.appCheckToken&&(l[S2]=this.appCheckToken),$Y(t,RY,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new k3e(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(V3e)),m3e(()=>{if(this.isClosed_)return;this.scriptTagHolder=new QP((...r)=>{const[o,a,l,c,h]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===lU)this.id=a,this.password=l;else if(o===N3e)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[lU]="t",s[LY]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[D3e]=this.scriptTagHolder.uniqueCallbackIdentifier),s[TY]=XP,this.transportSessionId&&(s[SY]=this.transportSessionId),this.lastSessionId&&(s[kY]=this.lastSessionId),this.applicationId&&(s[NY]=this.applicationId),this.appCheckToken&&(s[S2]=this.appCheckToken),typeof location<"u"&&location.hostname&&IY.test(location.hostname)&&(s[EY]=CY);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Cp.forceAllow_=!0}static forceDisallow(){Cp.forceDisallow_=!0}static isAvailable(){return Cp.forceAllow_?!0:!Cp.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!y3e()&&!b3e()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=hi(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=IK(t),i=wY(s,M3e);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const s={};s[L3e]="t",s[OY]=e,s[PY]=t,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=hi(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class QP{constructor(e,t,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=d3e(),window[A3e+this.uniqueCallbackIdentifier]=e,window[R3e+this.uniqueCallbackIdentifier]=t,this.myIFrame=QP.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ki("frame writing exception"),a.stack&&ki(a.stack),ki(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ki("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[OY]=this.myID,e[PY]=this.myPW,e[LY]=this.currentSerial;let t=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+FY+s.length<=MY;){const o=this.pendingSegs.shift();s=s+"&"+$3e+i+"="+o.seg+"&"+O3e+i+"="+o.ts+"&"+P3e+i+"="+o.d,i++}return t=t+s,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,s){this.pendingSegs.push({seg:e,ts:t,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const s=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(s,Math.floor(F3e)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),t())},s.onerror=()=>{ki("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3e=16384,B3e=45e3;let ZT=null;typeof MozWebSocket<"u"?ZT=MozWebSocket:typeof WebSocket<"u"&&(ZT=WebSocket);class Ho{constructor(e,t,s,i,r,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Zx(this.connId),this.stats_=YP(t),this.connURL=Ho.connectionURL_(t,o,a,i,s),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,s,i,r){const o={};return o[TY]=XP,typeof location<"u"&&location.hostname&&IY.test(location.hostname)&&(o[EY]=CY),t&&(o[SY]=t),s&&(o[kY]=s),i&&(o[S2]=i),r&&(o[NY]=r),$Y(e,AY,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,vd.set("previous_websocket_failure",!0);try{let s;xPe(),this.mySock=new ZT(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Ho.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(t);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&ZT!==null&&!Ho.forceDisallow_}static previouslyFailed(){return vd.isInMemoryStorage||vd.get("previous_websocket_failure")===!0}markConnectionHealthy(){vd.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const s=N0(t);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Fe(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const s=this.extractFrameCount_(t);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const t=hi(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=wY(t,z3e);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(B3e))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ho.responsesRequiredToBeHealthy=2;Ho.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{static get ALL_TRANSPORTS(){return[Cp,Ho]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Ho&&Ho.isAvailable();let s=t&&!Ho.previouslyFailed();if(e.webSocketOnly&&(t||Br("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Ho];else{const i=this.transports_=[];for(const r of F0.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);F0.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}F0.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U3e=6e4,W3e=5e3,H3e=10*1024,j3e=100*1024,yA="t",cU="d",G3e="s",uU="r",q3e="e",hU="o",dU="a",fU="n",pU="p",K3e="h";class X3e{constructor(e,t,s,i,r,o,a,l,c,h){this.id=e,this.repoInfo_=t,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Zx("c:"+this.id+":"),this.transportManager_=new F0(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Kb(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>j3e?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>H3e?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(yA in e){const t=e[yA];t===dU?this.upgradeIfSecondaryHealthy_():t===uU?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===hU&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=pb("t",e),s=pb("d",e);if(t==="c")this.onSecondaryControl_(s);else if(t==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:pU,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:dU,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:fU,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=pb("t",e),s=pb("d",e);t==="c"?this.onControl_(s):t==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=pb(yA,e);if(cU in e){const s=e[cU];if(t===K3e){const i=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===fU){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===G3e?this.onConnectionShutdown_(s):t===uU?this.onReset_(s):t===q3e?T2("Server Error: "+s):t===hU?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):T2("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),XP!==s&&Br("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,s),Kb(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(U3e))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Kb(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(W3e))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:pU,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(vd.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VY{put(e,t,s,i){}merge(e,t,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,s){}onDisconnectMerge(e,t,s){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zY{constructor(e){this.allowedEvents_=e,this.listeners_={},Fe(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,t)}}on(e,t,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:s});const i=this.getInitialEvent(e);i&&t.apply(s,i)}off(e,t,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===t&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){Fe(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT extends zY{static getInstance(){return new JT}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!dP()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Fe(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mU=32,gU=768;class Nn{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function un(){return new Nn("")}function Vt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function eh(n){return n.pieces_.length-n.pieceNum_}function En(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Nn(n.pieces_,e)}function BY(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Y3e(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function UY(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function WY(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Nn(e,0)}function Ys(n,e){const t=[];for(let s=n.pieceNum_;s<n.pieces_.length;s++)t.push(n.pieces_[s]);if(e instanceof Nn)for(let s=e.pieceNum_;s<e.pieces_.length;s++)t.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&t.push(s[i])}return new Nn(t,0)}function $t(n){return n.pieceNum_>=n.pieces_.length}function xo(n,e){const t=Vt(n),s=Vt(e);if(t===null)return e;if(t===s)return xo(En(n),En(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function HY(n,e){if(eh(n)!==eh(e))return!1;for(let t=n.pieceNum_,s=e.pieceNum_;t<=n.pieces_.length;t++,s++)if(n.pieces_[t]!==e.pieces_[s])return!1;return!0}function Go(n,e){let t=n.pieceNum_,s=e.pieceNum_;if(eh(n)>eh(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[s])return!1;++t,++s}return!0}class Q3e{constructor(e,t){this.errorPrefix_=t,this.parts_=UY(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=ZC(this.parts_[s]);jY(this)}}function Z3e(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=ZC(e),jY(n)}function J3e(n){const e=n.parts_.pop();n.byteLength_-=ZC(e),n.parts_.length>0&&(n.byteLength_-=1)}function jY(n){if(n.byteLength_>gU)throw new Error(n.errorPrefix_+"has a key path longer than "+gU+" bytes ("+n.byteLength_+").");if(n.parts_.length>mU)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+mU+") or object contains a cycle "+ad(n))}function ad(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP extends zY{static getInstance(){return new ZP}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return Fe(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb=1e3,eze=60*5*1e3,yU=30*1e3,tze=1.3,nze=3e4,sze="server_kill",bU=3;class Ql extends VY{constructor(e,t,s,i,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Ql.nextPersistentConnectionId_++,this.log_=Zx("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=mb,this.maxReconnectDelay_=eze,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ZP.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&JT.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,s){const i=++this.requestNumber_,r={r:i,a:e,b:t};this.log_(hi(r)),Fe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const t=new uP,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,s,i){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),Fe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Fe(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:s};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(s)})}sendListen_(e){const t=e.query,s=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},o="q";e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const l=a.d,c=a.s;Ql.warnOnListenWarnings_(l,t),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Sc(e,"w")){const s=cm(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+t._queryParams.getIndex().toString()+'"',r=t._path.toString();Br(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||kPe(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=yU)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=IPe(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(t,s,i=>{const r=i.s,o=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,s=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,s)})}unlisten(e,t){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),Fe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,t)}sendUnlisten_(e,t,s,i){this.log_("Unlisten on "+e+" for "+t);const r={p:e},o="n";i&&(r.q=s,r.t=i),this.sendRequest(o,r)}onDisconnectPut(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:s})}onDisconnectMerge(e,t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:s})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,s,i){const r={p:t,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,t,s,i){this.putInternal("p",e,t,s,i)}merge(e,t,s,i){this.putInternal("m",e,t,s,i)}putInternal(e,t,s,i,r){this.initConnection_();const o={p:t,d:s};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,s,r=>{this.log_(t+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+hi(e));const t=e.r,s=this.requestCBHash_[t];s&&(delete this.requestCBHash_[t],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):T2("Unrecognized action received from server: "+hi(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Fe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=mb,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=mb,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>nze&&(this.reconnectDelay_=mb),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*tze)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Ql.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,s())},c=function(f){Fe(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(f)};this.realtime_={close:l,sendRequest:c};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,p]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?ki("getToken() completed but was canceled"):(ki("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=p&&p.token,a=new X3e(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,s,g=>{Br(g+" ("+this.repoInfo_.toString()+")"),this.interrupt(sze)},r))}catch(f){this.log_("Failed to get token: "+f),o||(this.repoInfo_.nodeAdmin&&Br(f),l())}}}interrupt(e){ki("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ki("Resuming connection for reason: "+e),delete this.interruptReasons_[e],JR(this.interruptReasons_)&&(this.reconnectDelay_=mb,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let s;t?s=t.map(r=>KP(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const s=new Nn(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(t),r.delete(t),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,t){ki("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=bU&&(this.reconnectDelay_=yU,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){ki("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=bU&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+yY.replace(/\./g,"-")]=1,dP()?e["framework.cordova"]=1:DK()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=JT.getInstance().currentlyOnline();return JR(this.interruptReasons_)&&e}}Ql.nextPersistentConnectionId_=0;Ql.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new zt(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const s=new zt(ym,e),i=new zt(ym,t);return this.compare(s,i)!==0}minPost(){return zt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q_;class GY extends mI{static get __EMPTY_NODE(){return Q_}static set __EMPTY_NODE(e){Q_=e}compare(e,t){return Xg(e.name,t.name)}isDefinedOn(e){throw Ug("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return zt.MIN}maxPost(){return new zt(Zd,Q_)}makePost(e,t){return Fe(typeof e=="string","KeyIndex indexValue must always be a string."),new zt(e,Q_)}toString(){return".key"}}const Wp=new GY;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,t,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?s(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class qs{constructor(e,t,s,i,r){this.key=e,this.value=t,this.color=s??qs.RED,this.left=i??gr.EMPTY_NODE,this.right=r??gr.EMPTY_NODE}copy(e,t,s,i,r){return new qs(e??this.key,t??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,t,s),null):r===0?i=i.copy(null,t,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return gr.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let s,i;if(s=this,t(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),t(e,s.key)===0){if(s.right.isEmpty())return gr.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,qs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,qs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}qs.RED=!0;qs.BLACK=!1;class ize{copy(e,t,s,i,r){return this}insert(e,t,s){return new qs(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class gr{constructor(e,t=gr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new gr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,qs.BLACK,null,null))}remove(e){return new gr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,qs.BLACK,null,null))}get(e){let t,s=this.root_;for(;!s.isEmpty();){if(t=this.comparator_(e,s.key),t===0)return s.value;t<0?s=s.left:t>0&&(s=s.right)}return null}getPredecessorKey(e){let t,s=this.root_,i=null;for(;!s.isEmpty();)if(t=this.comparator_(e,s.key),t===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else t<0?s=s.left:t>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Z_(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Z_(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Z_(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Z_(this.root_,null,this.comparator_,!0,e)}}gr.EMPTY_NODE=new ize;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rze(n,e){return Xg(n.name,e.name)}function JP(n,e){return Xg(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E2;function oze(n){E2=n}const qY=function(n){return typeof n=="number"?"number:"+_Y(n):"string:"+n},KY=function(n){if(n.isLeafNode()){const e=n.val();Fe(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Sc(e,".sv"),"Priority must be a string or number.")}else Fe(n===E2||n.isEmpty(),"priority of unexpected type.");Fe(n===E2||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vU;class js{static set __childrenNodeConstructor(e){vU=e}static get __childrenNodeConstructor(){return vU}constructor(e,t=js.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Fe(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),KY(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new js(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:js.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return $t(e)?this:Vt(e)===".priority"?this.priorityNode_:js.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:js.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const s=Vt(e);return s===null?t:t.isEmpty()&&s!==".priority"?this:(Fe(s!==".priority"||eh(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,js.__childrenNodeConstructor.EMPTY_NODE.updateChild(En(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+qY(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=_Y(this.value_):e+=this.value_,this.lazyHash_=vY(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===js.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof js.__childrenNodeConstructor?-1:(Fe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,s=typeof this.value_,i=js.VALUE_TYPE_ORDER.indexOf(t),r=js.VALUE_TYPE_ORDER.indexOf(s);return Fe(i>=0,"Unknown leaf type: "+t),Fe(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}js.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let XY,YY;function aze(n){XY=n}function lze(n){YY=n}class cze extends mI{compare(e,t){const s=e.node.getPriority(),i=t.node.getPriority(),r=s.compareTo(i);return r===0?Xg(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return zt.MIN}maxPost(){return new zt(Zd,new js("[PRIORITY-POST]",YY))}makePost(e,t){const s=XY(e);return new zt(t,new js("[PRIORITY-POST]",s))}toString(){return".priority"}}const $i=new cze;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uze=Math.log(2);class hze{constructor(e){const t=r=>parseInt(Math.log(r)/uze,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const eS=function(n,e,t,s){n.sort(e);const i=function(l,c){const h=c-l;let f,p;if(h===0)return null;if(h===1)return f=n[l],p=t?t(f):f,new qs(p,f.node,qs.BLACK,null,null);{const g=parseInt(h/2,10)+l,y=i(l,g),x=i(g+1,c);return f=n[g],p=t?t(f):f,new qs(p,f.node,qs.BLACK,y,x)}},r=function(l){let c=null,h=null,f=n.length;const p=function(y,x){const v=f-y,w=f;f-=y;const S=i(v+1,w),C=n[v],I=t?t(C):C;g(new qs(I,C.node,x,null,S))},g=function(y){c?(c.left=y,c=y):(h=y,c=y)};for(let y=0;y<l.count;++y){const x=l.nextBitIsOne(),v=Math.pow(2,l.count-(y+1));x?p(v,qs.BLACK):(p(v,qs.BLACK),p(v,qs.RED))}return h},o=new hze(n.length),a=r(o);return new gr(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bA;const yp={};class Hl{static get Default(){return Fe(yp&&$i,"ChildrenNode.ts has not been loaded"),bA=bA||new Hl({".priority":yp},{".priority":$i}),bA}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=cm(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof gr?t:null}hasIndex(e){return Sc(this.indexSet_,e.toString())}addIndex(e,t){Fe(e!==Wp,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=t.getIterator(zt.Wrap);let o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),s.push(o),o=r.getNext();let a;i?a=eS(s,e.getCompare()):a=yp;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const h=Object.assign({},this.indexes_);return h[l]=a,new Hl(h,c)}addToIndexes(e,t){const s=MT(this.indexes_,(i,r)=>{const o=cm(this.indexSet_,r);if(Fe(o,"Missing index implementation for "+r),i===yp)if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(zt.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),eS(a,o.getCompare())}else return yp;else{const a=t.get(e.name);let l=i;return a&&(l=l.remove(new zt(e.name,a))),l.insert(e,e.node)}});return new Hl(s,this.indexSet_)}removeFromIndexes(e,t){const s=MT(this.indexes_,i=>{if(i===yp)return i;{const r=t.get(e.name);return r?i.remove(new zt(e.name,r)):i}});return new Hl(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gb;class Jt{static get EMPTY_NODE(){return gb||(gb=new Jt(new gr(JP),null,Hl.Default))}constructor(e,t,s){this.children_=e,this.priorityNode_=t,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&KY(this.priorityNode_),this.children_.isEmpty()&&Fe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||gb}updatePriority(e){return this.children_.isEmpty()?this:new Jt(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?gb:t}}getChild(e){const t=Vt(e);return t===null?this:this.getImmediateChild(t).getChild(En(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(Fe(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const s=new zt(e,t);let i,r;t.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(s,this.children_));const o=i.isEmpty()?gb:this.priorityNode_;return new Jt(i,o,r)}}updateChild(e,t){const s=Vt(e);if(s===null)return t;{Fe(Vt(e)!==".priority"||eh(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(En(e),t);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let s=0,i=0,r=!0;if(this.forEachChild($i,(o,a)=>{t[o]=a.val(e),s++,r&&Jt.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):r=!1}),!e&&r&&i<2*s){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+qY(this.getPriority().val())+":"),this.forEachChild($i,(t,s)=>{const i=s.hash();i!==""&&(e+=":"+t+":"+i)}),this.lazyHash_=e===""?"":vY(e)}return this.lazyHash_}getPredecessorChildName(e,t,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new zt(e,t));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new zt(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const s=t.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new zt(t,this.children_.get(t)):null}forEachChild(e,t){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>t(i.name,i.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,zt.Wrap);let r=i.peek();for(;r!=null&&t.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const s=this.resolveIndex_(t);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,zt.Wrap);let r=i.peek();for(;r!=null&&t.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ew?-1:0}withIndex(e){if(e===Wp||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Jt(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Wp||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const s=this.getIterator($i),i=t.getIterator($i);let r=s.getNext(),o=i.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=s.getNext(),o=i.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Wp?null:this.indexMap_.get(e.toString())}}Jt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class dze extends Jt{constructor(){super(new gr(JP),Jt.EMPTY_NODE,Hl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Jt.EMPTY_NODE}isEmpty(){return!1}}const ew=new dze;Object.defineProperties(zt,{MIN:{value:new zt(ym,Jt.EMPTY_NODE)},MAX:{value:new zt(Zd,ew)}});GY.__EMPTY_NODE=Jt.EMPTY_NODE;js.__childrenNodeConstructor=Jt;oze(ew);lze(ew);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fze=!0;function Ni(n,e=null){if(n===null)return Jt.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),Fe(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new js(t,Ni(e))}if(!(n instanceof Array)&&fze){const t=[];let s=!1;if(Eo(n,(o,a)=>{if(o.substring(0,1)!=="."){const l=Ni(a);l.isEmpty()||(s=s||!l.getPriority().isEmpty(),t.push(new zt(o,l)))}}),t.length===0)return Jt.EMPTY_NODE;const r=eS(t,rze,o=>o.name,JP);if(s){const o=eS(t,$i.getCompare());return new Jt(r,Ni(e),new Hl({".priority":o},{".priority":$i}))}else return new Jt(r,Ni(e),Hl.Default)}else{let t=Jt.EMPTY_NODE;return Eo(n,(s,i)=>{if(Sc(n,s)&&s.substring(0,1)!=="."){const r=Ni(i);(r.isLeafNode()||!r.isEmpty())&&(t=t.updateImmediateChild(s,r))}}),t.updatePriority(Ni(e))}}aze(Ni);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pze extends mI{constructor(e){super(),this.indexPath_=e,Fe(!$t(e)&&Vt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const s=this.extractChild(e.node),i=this.extractChild(t.node),r=s.compareTo(i);return r===0?Xg(e.name,t.name):r}makePost(e,t){const s=Ni(e),i=Jt.EMPTY_NODE.updateChild(this.indexPath_,s);return new zt(t,i)}maxPost(){const e=Jt.EMPTY_NODE.updateChild(this.indexPath_,ew);return new zt(Zd,e)}toString(){return UY(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mze extends mI{compare(e,t){const s=e.node.compareTo(t.node);return s===0?Xg(e.name,t.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return zt.MIN}maxPost(){return zt.MAX}makePost(e,t){const s=Ni(e);return new zt(t,s)}toString(){return".value"}}const gze=new mze;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yze(n){return{type:"value",snapshotNode:n}}function bze(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function vze(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function xU(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function xze(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=$i}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Fe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Fe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ym}hasEnd(){return this.endSet_}getIndexEndValue(){return Fe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Fe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Zd}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Fe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===$i}copy(){const e=new eL;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function wU(n){const e={};if(n.isDefault())return e;let t;if(n.index_===$i?t="$priority":n.index_===gze?t="$value":n.index_===Wp?t="$key":(Fe(n.index_ instanceof pze,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=hi(t),n.startSet_){const s=n.startAfterSet_?"startAfter":"startAt";e[s]=hi(n.indexStartValue_),n.startNameSet_&&(e[s]+=","+hi(n.indexStartName_))}if(n.endSet_){const s=n.endBeforeSet_?"endBefore":"endAt";e[s]=hi(n.indexEndValue_),n.endNameSet_&&(e[s]+=","+hi(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function _U(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==$i&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS extends VY{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(Fe(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=Zx("p:rest:"),this.listens_={}}listen(e,t,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=tS.getListenId_(e,s),a={};this.listens_[o]=a;const l=wU(e._queryParams);this.restRequest_(r+".json",l,(c,h)=>{let f=h;if(c===404&&(f=null,c=null),c===null&&this.onDataUpdate_(r,f,!1,s),cm(this.listens_,o)===a){let p;c?c===401?p="permission_denied":p="rest_error:"+c:p="ok",i(p,null)}})}unlisten(e,t){const s=tS.getListenId_(e,t);delete this.listens_[s]}get(e){const t=wU(e._queryParams),s=e._path.toString(),i=new uP;return this.restRequest_(s+".json",t,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(s,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},s){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(t.auth=i.accessToken),r&&r.token&&(t.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Wg(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=N0(a.responseText)}catch{Br("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,l)}else a.status!==401&&a.status!==404&&Br("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wze{constructor(){this.rootNode_=Jt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(){return{value:null,children:new Map}}function QY(n,e,t){if($t(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const s=Vt(e);n.children.has(s)||n.children.set(s,nS());const i=n.children.get(s);e=En(e),QY(i,e,t)}}function C2(n,e,t){n.value!==null?t(e,n.value):_ze(n,(s,i)=>{const r=new Nn(e.toString()+"/"+s);C2(i,r,t)})}function _ze(n,e){n.children.forEach((t,s)=>{e(s,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tze{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Eo(this.last_,(s,i)=>{t[s]=t[s]-i}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TU=10*1e3,Sze=30*1e3,Eze=5*60*1e3;class Cze{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Tze(e);const s=TU+(Sze-TU)*Math.random();Kb(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),t={};let s=!1;Eo(e,(i,r)=>{r>0&&Sc(this.statsToReport_,i)&&(t[i]=r,s=!0)}),s&&this.server_.reportStats(t),Kb(this.reportStats_.bind(this),Math.floor(Math.random()*2*Eze))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var La;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(La||(La={}));function ZY(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function JY(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function eQ(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,t,s){this.path=e,this.affectedTree=t,this.revert=s,this.type=La.ACK_USER_WRITE,this.source=ZY()}operationForChild(e){if($t(this.path)){if(this.affectedTree.value!=null)return Fe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Nn(e));return new sS(un(),t,this.revert)}}else return Fe(Vt(this.path)===e,"operationForChild called for unrelated child."),new sS(En(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jd{constructor(e,t,s){this.source=e,this.path=t,this.snap=s,this.type=La.OVERWRITE}operationForChild(e){return $t(this.path)?new Jd(this.source,un(),this.snap.getImmediateChild(e)):new Jd(this.source,En(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e,t,s){this.source=e,this.path=t,this.children=s,this.type=La.MERGE}operationForChild(e){if($t(this.path)){const t=this.children.subtree(new Nn(e));return t.isEmpty()?null:t.value?new Jd(this.source,un(),t.value):new V0(this.source,un(),t)}else return Fe(Vt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new V0(this.source,En(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tL{constructor(e,t,s){this.node_=e,this.fullyInitialized_=t,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if($t(e))return this.isFullyInitialized()&&!this.filtered_;const t=Vt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function Ize(n,e,t,s){const i=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(xze(o.childName,o.snapshotNode))}),yb(n,i,"child_removed",e,s,t),yb(n,i,"child_added",e,s,t),yb(n,i,"child_moved",r,s,t),yb(n,i,"child_changed",e,s,t),yb(n,i,"value",e,s,t),i}function yb(n,e,t,s,i,r){const o=s.filter(a=>a.type===t);o.sort((a,l)=>Nze(n,a,l)),o.forEach(a=>{const l=kze(n,a,r);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function kze(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Nze(n,e,t){if(e.childName==null||t.childName==null)throw Ug("Should only compare child_ events.");const s=new zt(e.childName,e.snapshotNode),i=new zt(t.childName,t.snapshotNode);return n.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tQ(n,e){return{eventCache:n,serverCache:e}}function Xb(n,e,t,s){return tQ(new tL(e,t,s),n.serverCache)}function nQ(n,e,t,s){return tQ(n.eventCache,new tL(e,t,s))}function I2(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function ef(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vA;const Aze=()=>(vA||(vA=new gr(g3e)),vA);class Tn{static fromObject(e){let t=new Tn(null);return Eo(e,(s,i)=>{t=t.set(new Nn(s),i)}),t}constructor(e,t=Aze()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:un(),value:this.value};if($t(e))return null;{const s=Vt(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(En(e),t);return r!=null?{path:Ys(new Nn(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if($t(e))return this;{const t=Vt(e),s=this.children.get(t);return s!==null?s.subtree(En(e)):new Tn(null)}}set(e,t){if($t(e))return new Tn(t,this.children);{const s=Vt(e),r=(this.children.get(s)||new Tn(null)).set(En(e),t),o=this.children.insert(s,r);return new Tn(this.value,o)}}remove(e){if($t(e))return this.children.isEmpty()?new Tn(null):new Tn(null,this.children);{const t=Vt(e),s=this.children.get(t);if(s){const i=s.remove(En(e));let r;return i.isEmpty()?r=this.children.remove(t):r=this.children.insert(t,i),this.value===null&&r.isEmpty()?new Tn(null):new Tn(this.value,r)}else return this}}get(e){if($t(e))return this.value;{const t=Vt(e),s=this.children.get(t);return s?s.get(En(e)):null}}setTree(e,t){if($t(e))return t;{const s=Vt(e),r=(this.children.get(s)||new Tn(null)).setTree(En(e),t);let o;return r.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,r),new Tn(this.value,o)}}fold(e){return this.fold_(un(),e)}fold_(e,t){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(Ys(e,i),t)}),t(e,this.value,s)}findOnPath(e,t){return this.findOnPath_(e,un(),t)}findOnPath_(e,t,s){const i=this.value?s(t,this.value):!1;if(i)return i;if($t(e))return null;{const r=Vt(e),o=this.children.get(r);return o?o.findOnPath_(En(e),Ys(t,r),s):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,un(),t)}foreachOnPath_(e,t,s){if($t(e))return this;{this.value&&s(t,this.value);const i=Vt(e),r=this.children.get(i);return r?r.foreachOnPath_(En(e),Ys(t,i),s):new Tn(null)}}foreach(e){this.foreach_(un(),e)}foreach_(e,t){this.children.inorderTraversal((s,i)=>{i.foreach_(Ys(e,s),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,s)=>{s.value&&e(t,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e){this.writeTree_=e}static empty(){return new Zo(new Tn(null))}}function Yb(n,e,t){if($t(e))return new Zo(new Tn(t));{const s=n.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const o=xo(i,e);return r=r.updateChild(o,t),new Zo(n.writeTree_.set(i,r))}else{const i=new Tn(t),r=n.writeTree_.setTree(e,i);return new Zo(r)}}}function SU(n,e,t){let s=n;return Eo(t,(i,r)=>{s=Yb(s,Ys(e,i),r)}),s}function EU(n,e){if($t(e))return Zo.empty();{const t=n.writeTree_.setTree(e,new Tn(null));return new Zo(t)}}function k2(n,e){return Ef(n,e)!=null}function Ef(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(xo(t.path,e)):null}function CU(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild($i,(s,i)=>{e.push(new zt(s,i))}):n.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new zt(s,i.value))}),e}function Au(n,e){if($t(e))return n;{const t=Ef(n,e);return t!=null?new Zo(new Tn(t)):new Zo(n.writeTree_.subtree(e))}}function N2(n){return n.writeTree_.isEmpty()}function bm(n,e){return sQ(un(),n.writeTree_,e)}function sQ(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(Fe(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):t=sQ(Ys(n,i),r,t)}),!t.getChild(n).isEmpty()&&s!==null&&(t=t.updateChild(Ys(n,".priority"),s)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iQ(n,e){return cQ(e,n)}function Rze(n,e,t,s,i){Fe(s>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:s,visible:i}),i&&(n.visibleWrites=Yb(n.visibleWrites,e,t)),n.lastWriteId=s}function Dze(n,e){for(let t=0;t<n.allWrites.length;t++){const s=n.allWrites[t];if(s.writeId===e)return s}return null}function $ze(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);Fe(t>=0,"removeWrite called with nonexistent writeId.");const s=n.allWrites[t];n.allWrites.splice(t,1);let i=s.visible,r=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&Oze(a,s.path)?i=!1:Go(s.path,a.path)&&(r=!0)),o--}if(i){if(r)return Pze(n),!0;if(s.snap)n.visibleWrites=EU(n.visibleWrites,s.path);else{const a=s.children;Eo(a,l=>{n.visibleWrites=EU(n.visibleWrites,Ys(s.path,l))})}return!0}else return!1}function Oze(n,e){if(n.snap)return Go(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Go(Ys(n.path,t),e))return!0;return!1}function Pze(n){n.visibleWrites=rQ(n.allWrites,Lze,un()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Lze(n){return n.visible}function rQ(n,e,t){let s=Zo.empty();for(let i=0;i<n.length;++i){const r=n[i];if(e(r)){const o=r.path;let a;if(r.snap)Go(t,o)?(a=xo(t,o),s=Yb(s,a,r.snap)):Go(o,t)&&(a=xo(o,t),s=Yb(s,un(),r.snap.getChild(a)));else if(r.children){if(Go(t,o))a=xo(t,o),s=SU(s,a,r.children);else if(Go(o,t))if(a=xo(o,t),$t(a))s=SU(s,un(),r.children);else{const l=cm(r.children,Vt(a));if(l){const c=l.getChild(En(a));s=Yb(s,un(),c)}}}else throw Ug("WriteRecord should have .snap or .children")}}return s}function oQ(n,e,t,s,i){if(!s&&!i){const r=Ef(n.visibleWrites,e);if(r!=null)return r;{const o=Au(n.visibleWrites,e);if(N2(o))return t;if(t==null&&!k2(o,un()))return null;{const a=t||Jt.EMPTY_NODE;return bm(o,a)}}}else{const r=Au(n.visibleWrites,e);if(!i&&N2(r))return t;if(!i&&t==null&&!k2(r,un()))return null;{const o=function(c){return(c.visible||i)&&(!s||!~s.indexOf(c.writeId))&&(Go(c.path,e)||Go(e,c.path))},a=rQ(n.allWrites,o,e),l=t||Jt.EMPTY_NODE;return bm(a,l)}}}function Mze(n,e,t){let s=Jt.EMPTY_NODE;const i=Ef(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild($i,(r,o)=>{s=s.updateImmediateChild(r,o)}),s;if(t){const r=Au(n.visibleWrites,e);return t.forEachChild($i,(o,a)=>{const l=bm(Au(r,new Nn(o)),a);s=s.updateImmediateChild(o,l)}),CU(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const r=Au(n.visibleWrites,e);return CU(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function Fze(n,e,t,s,i){Fe(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=Ys(e,t);if(k2(n.visibleWrites,r))return null;{const o=Au(n.visibleWrites,r);return N2(o)?i.getChild(t):bm(o,i.getChild(t))}}function Vze(n,e,t,s){const i=Ys(e,t),r=Ef(n.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(t)){const o=Au(n.visibleWrites,i);return bm(o,s.getNode().getImmediateChild(t))}else return null}function zze(n,e){return Ef(n.visibleWrites,e)}function Bze(n,e,t,s,i,r,o){let a;const l=Au(n.visibleWrites,e),c=Ef(l,un());if(c!=null)a=c;else if(t!=null)a=bm(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],f=o.getCompare(),p=r?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let g=p.getNext();for(;g&&h.length<i;)f(g,s)!==0&&h.push(g),g=p.getNext();return h}else return[]}function Uze(){return{visibleWrites:Zo.empty(),allWrites:[],lastWriteId:-1}}function A2(n,e,t,s){return oQ(n.writeTree,n.treePath,e,t,s)}function aQ(n,e){return Mze(n.writeTree,n.treePath,e)}function IU(n,e,t,s){return Fze(n.writeTree,n.treePath,e,t,s)}function iS(n,e){return zze(n.writeTree,Ys(n.treePath,e))}function Wze(n,e,t,s,i,r){return Bze(n.writeTree,n.treePath,e,t,s,i,r)}function nL(n,e,t){return Vze(n.writeTree,n.treePath,e,t)}function lQ(n,e){return cQ(Ys(n.treePath,e),n.writeTree)}function cQ(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hze{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,s=e.childName;Fe(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),Fe(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(t==="child_added"&&r==="child_removed")this.changeMap.set(s,xU(s,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(t==="child_removed"&&r==="child_changed")this.changeMap.set(s,vze(s,i.oldSnap));else if(t==="child_changed"&&r==="child_added")this.changeMap.set(s,bze(s,e.snapshotNode));else if(t==="child_changed"&&r==="child_changed")this.changeMap.set(s,xU(s,e.snapshotNode,i.oldSnap));else throw Ug("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jze{getCompleteChild(e){return null}getChildAfterChild(e,t,s){return null}}const uQ=new jze;class sL{constructor(e,t,s=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=s}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new tL(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return nL(this.writes_,e,s)}}getChildAfterChild(e,t,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ef(this.viewCache_),r=Wze(this.writes_,i,t,1,s,e);return r.length===0?null:r[0]}}function Gze(n,e){Fe(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),Fe(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function qze(n,e,t,s,i){const r=new Hze;let o,a;if(t.type===La.OVERWRITE){const c=t;c.source.fromUser?o=R2(n,e,c.path,c.snap,s,i,r):(Fe(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!$t(c.path),o=rS(n,e,c.path,c.snap,s,i,a,r))}else if(t.type===La.MERGE){const c=t;c.source.fromUser?o=Xze(n,e,c.path,c.children,s,i,r):(Fe(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=D2(n,e,c.path,c.children,s,i,a,r))}else if(t.type===La.ACK_USER_WRITE){const c=t;c.revert?o=Zze(n,e,c.path,s,i,r):o=Yze(n,e,c.path,c.affectedTree,s,i,r)}else if(t.type===La.LISTEN_COMPLETE)o=Qze(n,e,t.path,s,r);else throw Ug("Unknown operation type: "+t.type);const l=r.getChanges();return Kze(e,o,l),{viewCache:o,changes:l}}function Kze(n,e,t){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=I2(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&t.push(yze(I2(e)))}}function hQ(n,e,t,s,i,r){const o=e.eventCache;if(iS(s,t)!=null)return e;{let a,l;if($t(t))if(Fe(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=ef(e),h=c instanceof Jt?c:Jt.EMPTY_NODE,f=aQ(s,h);a=n.filter.updateFullNode(e.eventCache.getNode(),f,r)}else{const c=A2(s,ef(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=Vt(t);if(c===".priority"){Fe(eh(t)===1,"Can't have a priority with additional path components");const h=o.getNode();l=e.serverCache.getNode();const f=IU(s,t,h,l);f!=null?a=n.filter.updatePriority(h,f):a=o.getNode()}else{const h=En(t);let f;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const p=IU(s,t,o.getNode(),l);p!=null?f=o.getNode().getImmediateChild(c).updateChild(h,p):f=o.getNode().getImmediateChild(c)}else f=nL(s,c,e.serverCache);f!=null?a=n.filter.updateChild(o.getNode(),c,f,h,i,r):a=o.getNode()}}return Xb(e,a,o.isFullyInitialized()||$t(t),n.filter.filtersNodes())}}function rS(n,e,t,s,i,r,o,a){const l=e.serverCache;let c;const h=o?n.filter:n.filter.getIndexedFilter();if($t(t))c=h.updateFullNode(l.getNode(),s,null);else if(h.filtersNodes()&&!l.isFiltered()){const g=l.getNode().updateChild(t,s);c=h.updateFullNode(l.getNode(),g,null)}else{const g=Vt(t);if(!l.isCompleteForPath(t)&&eh(t)>1)return e;const y=En(t),v=l.getNode().getImmediateChild(g).updateChild(y,s);g===".priority"?c=h.updatePriority(l.getNode(),v):c=h.updateChild(l.getNode(),g,v,y,uQ,null)}const f=nQ(e,c,l.isFullyInitialized()||$t(t),h.filtersNodes()),p=new sL(i,f,r);return hQ(n,f,t,i,p,a)}function R2(n,e,t,s,i,r,o){const a=e.eventCache;let l,c;const h=new sL(i,e,r);if($t(t))c=n.filter.updateFullNode(e.eventCache.getNode(),s,o),l=Xb(e,c,!0,n.filter.filtersNodes());else{const f=Vt(t);if(f===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),s),l=Xb(e,c,a.isFullyInitialized(),a.isFiltered());else{const p=En(t),g=a.getNode().getImmediateChild(f);let y;if($t(p))y=s;else{const x=h.getCompleteChild(f);x!=null?BY(p)===".priority"&&x.getChild(WY(p)).isEmpty()?y=x:y=x.updateChild(p,s):y=Jt.EMPTY_NODE}if(g.equals(y))l=e;else{const x=n.filter.updateChild(a.getNode(),f,y,p,h,o);l=Xb(e,x,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function kU(n,e){return n.eventCache.isCompleteForChild(e)}function Xze(n,e,t,s,i,r,o){let a=e;return s.foreach((l,c)=>{const h=Ys(t,l);kU(e,Vt(h))&&(a=R2(n,a,h,c,i,r,o))}),s.foreach((l,c)=>{const h=Ys(t,l);kU(e,Vt(h))||(a=R2(n,a,h,c,i,r,o))}),a}function NU(n,e,t){return t.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function D2(n,e,t,s,i,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;$t(t)?c=s:c=new Tn(null).setTree(t,s);const h=e.serverCache.getNode();return c.children.inorderTraversal((f,p)=>{if(h.hasChild(f)){const g=e.serverCache.getNode().getImmediateChild(f),y=NU(n,g,p);l=rS(n,l,new Nn(f),y,i,r,o,a)}}),c.children.inorderTraversal((f,p)=>{const g=!e.serverCache.isCompleteForChild(f)&&p.value===null;if(!h.hasChild(f)&&!g){const y=e.serverCache.getNode().getImmediateChild(f),x=NU(n,y,p);l=rS(n,l,new Nn(f),x,i,r,o,a)}}),l}function Yze(n,e,t,s,i,r,o){if(iS(i,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(s.value!=null){if($t(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return rS(n,e,t,l.getNode().getChild(t),i,r,a,o);if($t(t)){let c=new Tn(null);return l.getNode().forEachChild(Wp,(h,f)=>{c=c.set(new Nn(h),f)}),D2(n,e,t,c,i,r,a,o)}else return e}else{let c=new Tn(null);return s.foreach((h,f)=>{const p=Ys(t,h);l.isCompleteForPath(p)&&(c=c.set(h,l.getNode().getChild(p)))}),D2(n,e,t,c,i,r,a,o)}}function Qze(n,e,t,s,i){const r=e.serverCache,o=nQ(e,r.getNode(),r.isFullyInitialized()||$t(t),r.isFiltered());return hQ(n,o,t,s,uQ,i)}function Zze(n,e,t,s,i,r){let o;if(iS(s,t)!=null)return e;{const a=new sL(s,e,i),l=e.eventCache.getNode();let c;if($t(t)||Vt(t)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=A2(s,ef(e));else{const f=e.serverCache.getNode();Fe(f instanceof Jt,"serverChildren would be complete if leaf node"),h=aQ(s,f)}h=h,c=n.filter.updateFullNode(l,h,r)}else{const h=Vt(t);let f=nL(s,h,e.serverCache);f==null&&e.serverCache.isCompleteForChild(h)&&(f=l.getImmediateChild(h)),f!=null?c=n.filter.updateChild(l,h,f,En(t),a,r):e.eventCache.getNode().hasChild(h)?c=n.filter.updateChild(l,h,Jt.EMPTY_NODE,En(t),a,r):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=A2(s,ef(e)),o.isLeafNode()&&(c=n.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||iS(s,un())!=null,Xb(e,c,o,n.filter.filtersNodes())}}function Jze(n,e){const t=ef(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!$t(e)&&!t.getImmediateChild(Vt(e)).isEmpty())?t.getChild(e):null}function AU(n,e,t,s){e.type===La.MERGE&&e.source.queryId!==null&&(Fe(ef(n.viewCache_),"We should always have a full cache before handling merges"),Fe(I2(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,r=qze(n.processor_,i,e,t,s);return Gze(n.processor_,r.viewCache),Fe(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=r.viewCache,eBe(n,r.changes,r.viewCache.eventCache.getNode())}function eBe(n,e,t,s){const i=n.eventRegistrations_;return Ize(n.eventGenerator_,e,t,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RU;function tBe(n){Fe(!RU,"__referenceConstructor has already been defined"),RU=n}function iL(n,e,t,s){const i=e.source.queryId;if(i!==null){const r=n.views.get(i);return Fe(r!=null,"SyncTree gave us an op for an invalid query."),AU(r,e,t,s)}else{let r=[];for(const o of n.views.values())r=r.concat(AU(o,e,t,s));return r}}function rL(n,e){let t=null;for(const s of n.views.values())t=t||Jze(s,e);return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DU;function nBe(n){Fe(!DU,"__referenceConstructor has already been defined"),DU=n}class $U{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Tn(null),this.pendingWriteTree_=Uze(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function sBe(n,e,t,s,i){return Rze(n.pendingWriteTree_,e,t,s,i),i?yI(n,new Jd(ZY(),e,t)):[]}function Ip(n,e,t=!1){const s=Dze(n.pendingWriteTree_,e);if($ze(n.pendingWriteTree_,e)){let r=new Tn(null);return s.snap!=null?r=r.set(un(),!0):Eo(s.children,o=>{r=r.set(new Nn(o),!0)}),yI(n,new sS(s.path,r,t))}else return[]}function gI(n,e,t){return yI(n,new Jd(JY(),e,t))}function iBe(n,e,t){const s=Tn.fromObject(t);return yI(n,new V0(JY(),e,s))}function rBe(n,e,t,s){const i=mQ(n,s);if(i!=null){const r=gQ(i),o=r.path,a=r.queryId,l=xo(o,e),c=new Jd(eQ(a),l,t);return yQ(n,o,c)}else return[]}function oBe(n,e,t,s){const i=mQ(n,s);if(i){const r=gQ(i),o=r.path,a=r.queryId,l=xo(o,e),c=Tn.fromObject(t),h=new V0(eQ(a),l,c);return yQ(n,o,h)}else return[]}function dQ(n,e,t){const i=n.pendingWriteTree_,r=n.syncPointTree_.findOnPath(e,(o,a)=>{const l=xo(o,e),c=rL(a,l);if(c)return c});return oQ(i,e,r,t,!0)}function yI(n,e){return fQ(e,n.syncPointTree_,null,iQ(n.pendingWriteTree_,un()))}function fQ(n,e,t,s){if($t(n.path))return pQ(n,e,t,s);{const i=e.get(un());t==null&&i!=null&&(t=rL(i,un()));let r=[];const o=Vt(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){const c=t?t.getImmediateChild(o):null,h=lQ(s,o);r=r.concat(fQ(a,l,c,h))}return i&&(r=r.concat(iL(i,n,s,t))),r}}function pQ(n,e,t,s){const i=e.get(un());t==null&&i!=null&&(t=rL(i,un()));let r=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,c=lQ(s,o),h=n.operationForChild(o);h&&(r=r.concat(pQ(h,a,l,c)))}),i&&(r=r.concat(iL(i,n,s,t))),r}function mQ(n,e){return n.tagToQueryMap.get(e)}function gQ(n){const e=n.indexOf("$");return Fe(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Nn(n.substr(0,e))}}function yQ(n,e,t){const s=n.syncPointTree_.get(e);Fe(s,"Missing sync point for query tag that we're tracking");const i=iQ(n.pendingWriteTree_,e);return iL(s,t,i,null)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new oL(t)}node(){return this.node_}}class aL{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ys(this.path_,e);return new aL(this.syncTree_,t)}node(){return dQ(this.syncTree_,this.path_)}}const aBe=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},OU=function(n,e,t){if(!n||typeof n!="object")return n;if(Fe(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return lBe(n[".sv"],e,t);if(typeof n[".sv"]=="object")return cBe(n[".sv"],e);Fe(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},lBe=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:Fe(!1,"Unexpected server value: "+n)}},cBe=function(n,e,t){n.hasOwnProperty("increment")||Fe(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const s=n.increment;typeof s!="number"&&Fe(!1,"Unexpected increment value: "+s);const i=e.node();if(Fe(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const o=i.getValue();return typeof o!="number"?s:o+s},uBe=function(n,e,t,s){return lL(e,new aL(t,n),s)},hBe=function(n,e,t){return lL(n,new oL(e),t)};function lL(n,e,t){const s=n.getPriority().val(),i=OU(s,e.getImmediateChild(".priority"),t);let r;if(n.isLeafNode()){const o=n,a=OU(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new js(a,Ni(i)):n}else{const o=n;return r=o,i!==o.getPriority().val()&&(r=r.updatePriority(new js(i))),o.forEachChild($i,(a,l)=>{const c=lL(l,e.getImmediateChild(a),t);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{constructor(e="",t=null,s={children:{},childCount:0}){this.name=e,this.parent=t,this.node=s}}function uL(n,e){let t=e instanceof Nn?e:new Nn(e),s=n,i=Vt(t);for(;i!==null;){const r=cm(s.node.children,i)||{children:{},childCount:0};s=new cL(i,s,r),t=En(t),i=Vt(t)}return s}function Yg(n){return n.node.value}function bQ(n,e){n.node.value=e,$2(n)}function vQ(n){return n.node.childCount>0}function dBe(n){return Yg(n)===void 0&&!vQ(n)}function bI(n,e){Eo(n.node.children,(t,s)=>{e(new cL(t,n,s))})}function xQ(n,e,t,s){t&&e(n),bI(n,i=>{xQ(i,e,!0)})}function fBe(n,e,t){let s=n.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function tw(n){return new Nn(n.parent===null?n.name:tw(n.parent)+"/"+n.name)}function $2(n){n.parent!==null&&pBe(n.parent,n.name,n)}function pBe(n,e,t){const s=dBe(t),i=Sc(n.node.children,e);s&&i?(delete n.node.children[e],n.node.childCount--,$2(n)):!s&&!i&&(n.node.children[e]=t.node,n.node.childCount++,$2(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mBe=/[\[\].#$\/\u0000-\u001F\u007F]/,gBe=/[\[\].#$\u0000-\u001F\u007F]/,xA=10*1024*1024,wQ=function(n){return typeof n=="string"&&n.length!==0&&!mBe.test(n)},yBe=function(n){return typeof n=="string"&&n.length!==0&&!gBe.test(n)},bBe=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),yBe(n)},_Q=function(n,e,t){const s=t instanceof Nn?new Q3e(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+ad(s));if(typeof e=="function")throw new Error(n+"contains a function "+ad(s)+" with contents = "+e.toString());if(xY(e))throw new Error(n+"contains "+e.toString()+" "+ad(s));if(typeof e=="string"&&e.length>xA/3&&ZC(e)>xA)throw new Error(n+"contains a string greater than "+xA+" utf8 bytes "+ad(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(Eo(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!wQ(o)))throw new Error(n+" contains an invalid key ("+o+") "+ad(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Z3e(s,o),_Q(n,a,s),J3e(s)}),i&&r)throw new Error(n+' contains ".value" child '+ad(s)+" in addition to actual children.")}},vBe=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!wQ(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!bBe(t))throw new Error($Pe(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xBe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function wBe(n,e){let t=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();t!==null&&!HY(r,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:r}),t.events.push(i)}t&&n.eventLists_.push(t)}function Cf(n,e,t){wBe(n,t),_Be(n,s=>Go(s,e)||Go(e,s))}function _Be(n,e){n.recursionDepth_++;let t=!0;for(let s=0;s<n.eventLists_.length;s++){const i=n.eventLists_[s];if(i){const r=i.path;e(r)?(TBe(n.eventLists_[s]),n.eventLists_[s]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function TBe(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const s=t.getEventRunner();qb&&ki("event: "+t.toString()),Jx(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SBe="repo_interrupt",EBe=25;class CBe{constructor(e,t,s,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new xBe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=nS(),this.transactionQueueTree_=new cL,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function IBe(n,e,t){if(n.stats_=YP(n.repoInfo_),n.forceRestClient_||_3e())n.server_=new tS(n.repoInfo_,(s,i,r,o)=>{PU(n,s,i,r,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>LU(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{hi(t)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}n.persistentConnection_=new Ql(n.repoInfo_,e,(s,i,r,o)=>{PU(n,s,i,r,o)},s=>{LU(n,s)},s=>{NBe(n,s)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(s=>{n.server_.refreshAuthToken(s)}),n.appCheckProvider_.addTokenChangeListener(s=>{n.server_.refreshAppCheckToken(s.token)}),n.statsReporter_=I3e(n.repoInfo_,()=>new Cze(n.stats_,n.server_)),n.infoData_=new wze,n.infoSyncTree_=new $U({startListening:(s,i,r,o)=>{let a=[];const l=n.infoData_.getNode(s._path);return l.isEmpty()||(a=gI(n.infoSyncTree_,s._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),hL(n,"connected",!1),n.serverSyncTree_=new $U({startListening:(s,i,r,o)=>(n.server_.listen(s,r,i,(a,l)=>{const c=o(a,l);Cf(n.eventQueue_,s._path,c)}),[]),stopListening:(s,i)=>{n.server_.unlisten(s,i)}})}function kBe(n){const t=n.infoData_.getNode(new Nn(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function TQ(n){return aBe({timestamp:kBe(n)})}function PU(n,e,t,s,i){n.dataUpdateCount++;const r=new Nn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(s){const l=MT(t,c=>Ni(c));o=oBe(n.serverSyncTree_,r,l,i)}else{const l=Ni(t);o=rBe(n.serverSyncTree_,r,l,i)}else if(s){const l=MT(t,c=>Ni(c));o=iBe(n.serverSyncTree_,r,l)}else{const l=Ni(t);o=gI(n.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=fL(n,r)),Cf(n.eventQueue_,a,o)}function LU(n,e){hL(n,"connected",e),e===!1&&RBe(n)}function NBe(n,e){Eo(e,(t,s)=>{hL(n,t,s)})}function hL(n,e,t){const s=new Nn("/.info/"+e),i=Ni(t);n.infoData_.updateSnapshot(s,i);const r=gI(n.infoSyncTree_,s,i);Cf(n.eventQueue_,s,r)}function ABe(n){return n.nextWriteId_++}function RBe(n){SQ(n,"onDisconnectEvents");const e=TQ(n),t=nS();C2(n.onDisconnect_,un(),(i,r)=>{const o=uBe(i,r,n.serverSyncTree_,e);QY(t,i,o)});let s=[];C2(t,un(),(i,r)=>{s=s.concat(gI(n.serverSyncTree_,i,r));const o=PBe(n,i);fL(n,o)}),n.onDisconnect_=nS(),Cf(n.eventQueue_,un(),s)}function DBe(n){n.persistentConnection_&&n.persistentConnection_.interrupt(SBe)}function SQ(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),ki(t,...e)}function EQ(n,e,t){return dQ(n.serverSyncTree_,e,t)||Jt.EMPTY_NODE}function dL(n,e=n.transactionQueueTree_){if(e||vI(n,e),Yg(e)){const t=IQ(n,e);Fe(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&$Be(n,tw(e),t)}else vQ(e)&&bI(e,t=>{dL(n,t)})}function $Be(n,e,t){const s=t.map(c=>c.currentWriteId),i=EQ(n,e,s);let r=i;const o=i.hash();for(let c=0;c<t.length;c++){const h=t[c];Fe(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const f=xo(e,h.path);r=r.updateChild(f,h.currentOutputSnapshotRaw)}const a=r.val(!0),l=e;n.server_.put(l.toString(),a,c=>{SQ(n,"transaction put response",{path:l.toString(),status:c});let h=[];if(c==="ok"){const f=[];for(let p=0;p<t.length;p++)t[p].status=2,h=h.concat(Ip(n.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&f.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();vI(n,uL(n.transactionQueueTree_,e)),dL(n,n.transactionQueueTree_),Cf(n.eventQueue_,e,h);for(let p=0;p<f.length;p++)Jx(f[p])}else{if(c==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{Br("transaction at "+l.toString()+" failed: "+c);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=c}fL(n,e)}},o)}function fL(n,e){const t=CQ(n,e),s=tw(t),i=IQ(n,t);return OBe(n,i,s),s}function OBe(n,e,t){if(e.length===0)return;const s=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=xo(t,l.path);let h=!1,f;if(Fe(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,f=l.abortReason,i=i.concat(Ip(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=EBe)h=!0,f="maxretry",i=i.concat(Ip(n.serverSyncTree_,l.currentWriteId,!0));else{const p=EQ(n,l.path,o);l.currentInputSnapshot=p;const g=e[a].update(p.val());if(g!==void 0){_Q("transaction failed: Data returned ",g,l.path);let y=Ni(g);typeof g=="object"&&g!=null&&Sc(g,".priority")||(y=y.updatePriority(p.getPriority()));const v=l.currentWriteId,w=TQ(n),S=hBe(y,p,w);l.currentOutputSnapshotRaw=y,l.currentOutputSnapshotResolved=S,l.currentWriteId=ABe(n),o.splice(o.indexOf(v),1),i=i.concat(sBe(n.serverSyncTree_,l.path,S,l.currentWriteId,l.applyLocally)),i=i.concat(Ip(n.serverSyncTree_,v,!0))}else h=!0,f="nodata",i=i.concat(Ip(n.serverSyncTree_,l.currentWriteId,!0))}Cf(n.eventQueue_,t,i),i=[],h&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(f),!1,null))))}vI(n,n.transactionQueueTree_);for(let a=0;a<s.length;a++)Jx(s[a]);dL(n,n.transactionQueueTree_)}function CQ(n,e){let t,s=n.transactionQueueTree_;for(t=Vt(e);t!==null&&Yg(s)===void 0;)s=uL(s,t),e=En(e),t=Vt(e);return s}function IQ(n,e){const t=[];return kQ(n,e,t),t.sort((s,i)=>s.order-i.order),t}function kQ(n,e,t){const s=Yg(e);if(s)for(let i=0;i<s.length;i++)t.push(s[i]);bI(e,i=>{kQ(n,i,t)})}function vI(n,e){const t=Yg(e);if(t){let s=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[s]=t[i],s++);t.length=s,bQ(e,t.length>0?t:void 0)}bI(e,s=>{vI(n,s)})}function PBe(n,e){const t=tw(CQ(n,e)),s=uL(n.transactionQueueTree_,e);return fBe(s,i=>{wA(n,i)}),wA(n,s),xQ(s,i=>{wA(n,i)}),t}function wA(n,e){const t=Yg(e);if(t){const s=[];let i=[],r=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(Fe(r===o-1,"All SENT items should be at beginning of queue."),r=o,t[o].status=3,t[o].abortReason="set"):(Fe(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Ip(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&s.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?bQ(e,void 0):t.length=r+1,Cf(n.eventQueue_,tw(e),i);for(let o=0;o<s.length;o++)Jx(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LBe(n){let e="";const t=n.split("/");for(let s=0;s<t.length;s++)if(t[s].length>0){let i=t[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function MBe(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const s=t.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Br(`Invalid query segment '${t}' in query '${n}'`)}return e}const MU=function(n,e){const t=FBe(n),s=t.namespace;t.domain==="firebase.com"&&uc(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&t.domain!=="localhost"&&uc("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||p3e();const i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new DY(t.host,t.secure,s,i,e,"",s!==t.subdomain),path:new Nn(t.pathString)}},FBe=function(n){let e="",t="",s="",i="",r="",o=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let h=n.indexOf("/");h===-1&&(h=n.length);let f=n.indexOf("?");f===-1&&(f=n.length),e=n.substring(0,Math.min(h,f)),h<f&&(i=LBe(n.substring(h,f)));const p=MBe(n.substring(Math.min(n.length,f)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const g=e.slice(0,c);if(g.toLowerCase()==="localhost")t="localhost";else if(g.split(".").length<=2)t=g;else{const y=e.indexOf(".");s=e.substring(0,y).toLowerCase(),t=e.substring(y+1),r=s}"ns"in p&&(r=p.ns)}return{host:e,port:l,domain:t,subdomain:s,secure:o,scheme:a,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e,t,s,i){this._repo=e,this._path=t,this._queryParams=s,this._orderByCalled=i}get key(){return $t(this._path)?null:BY(this._path)}get ref(){return new Qg(this._repo,this._path)}get _queryIdentifier(){const e=_U(this._queryParams),t=KP(e);return t==="{}"?"default":t}get _queryObject(){return _U(this._queryParams)}isEqual(e){if(e=Bn(e),!(e instanceof pL))return!1;const t=this._repo===e._repo,s=HY(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+Y3e(this._path)}}class Qg extends pL{constructor(e,t){super(e,t,new eL,!1)}get parent(){const e=WY(this._path);return e===null?null:new Qg(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}tBe(Qg);nBe(Qg);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VBe="FIREBASE_DATABASE_EMULATOR_HOST",O2={};let zBe=!1;function BBe(n,e,t,s){n.repoInfo_=new DY(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),s&&(n.authTokenProvider_=s)}function UBe(n,e,t,s,i){let r=s||n.options.databaseURL;r===void 0&&(n.options.projectId||uc("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ki("Using default host for project ",n.options.projectId),r=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=MU(r,i),a=o.repoInfo,l;typeof process<"u"&&sU&&(l=sU[VBe]),l?(r=`http://${l}?ns=${a.namespace}`,o=MU(r,i),a=o.repoInfo):o.repoInfo.secure;const c=new S3e(n.name,n.options,e);vBe("Invalid Firebase Database URL",o),$t(o.path)||uc("Database URL must point to the root of a Firebase Database (not including a child path).");const h=HBe(a,n,c,new T3e(n,t));return new jBe(h,n)}function WBe(n,e){const t=O2[e];(!t||t[n.key]!==n)&&uc(`Database ${e}(${n.repoInfo_}) has already been deleted.`),DBe(n),delete t[n.key]}function HBe(n,e,t,s){let i=O2[e.name];i||(i={},O2[e.name]=i);let r=i[n.toURLString()];return r&&uc("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new CBe(n,zBe,t,s),i[n.toURLString()]=r,r}class jBe{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(IBe(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Qg(this._repo,un())),this._rootInternal}_delete(){return this._rootInternal!==null&&(WBe(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&uc("Cannot call "+e+" on a deleted database.")}}function GBe(n=eI(),e){const t=jx(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const s=cP("database");s&&qBe(t,...s)}return t}function qBe(n,e,t,s={}){n=Bn(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&uc("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let r;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&uc('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new B1(B1.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:hP(s.mockUserToken,n.app.options.projectId);r=new B1(o)}BBe(i,e,t,r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KBe(n){l3e(ph),qu(new oc("database",(e,{instanceIdentifier:t})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return UBe(s,i,r,t)},"PUBLIC").setMultipleInstances(!0)),To(iU,rU,n),To(iU,rU,"esm2017")}Ql.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Ql.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};KBe();function mL(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t}function NQ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const XBe=NQ,AQ=new Hx("auth","Firebase",NQ());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS=new JC("@firebase/auth");function YBe(n,...e){oS.logLevel<=It.WARN&&oS.warn(`Auth (${ph}): ${n}`,...e)}function U1(n,...e){oS.logLevel<=It.ERROR&&oS.error(`Auth (${ph}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Co(n,...e){throw yL(n,...e)}function Jo(n,...e){return yL(n,...e)}function gL(n,e,t){const s=Object.assign(Object.assign({},XBe()),{[e]:t});return new Hx("auth","Firebase",s).create(e,{appName:n.name})}function Zl(n){return gL(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function QBe(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Co(n,"argument-error"),gL(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function yL(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return AQ.create(n,...e)}function it(n,e,...t){if(!n)throw yL(e,...t)}function jl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw U1(e),new Error(e)}function hc(n,e){n||jl(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function ZBe(){return FU()==="http:"||FU()==="https:"}function FU(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JBe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ZBe()||bPe()||"connection"in navigator)?navigator.onLine:!0}function e4e(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(e,t){this.shortDelay=e,this.longDelay=t,hc(t>e,"Short delay should be less than long delay!"),this.isMobile=dP()||DK()}get(){return JBe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bL(n,e){hc(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RQ{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;jl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;jl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;jl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t4e={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4e=new nw(3e4,6e4);function mh(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ec(n,e,t,s,i={}){return DQ(n,i,async()=>{let r={},o={};s&&(e==="GET"?o=s:r={body:JSON.stringify(s)});const a=Wg(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const c=Object.assign({method:e,headers:l},r);return yPe()||(c.referrerPolicy="no-referrer"),RQ.fetch()($Q(n,n.config.apiHost,t,a),c)})}async function DQ(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},t4e),e);try{const i=new i4e(n),r=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw J_(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw J_(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw J_(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw J_(n,"user-disabled",o);const h=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw gL(n,h,c);Co(n,h)}}catch(i){if(i instanceof ol)throw i;Co(n,"network-request-failed",{message:String(i)})}}async function sw(n,e,t,s,i={}){const r=await Ec(n,e,t,s,i);return"mfaPendingCredential"in r&&Co(n,"multi-factor-auth-required",{_serverResponse:r}),r}function $Q(n,e,t,s){const i=`${e}${t}?${s}`;return n.config.emulator?bL(n.config,i):`${n.config.apiScheme}://${i}`}function s4e(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class i4e{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Jo(this.auth,"network-request-failed")),n4e.get())})}}function J_(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const i=Jo(n,e,s);return i.customData._tokenResponse=t,i}function VU(n){return n!==void 0&&n.enterprise!==void 0}class r4e{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return s4e(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function o4e(n,e){return Ec(n,"GET","/v2/recaptchaConfig",mh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a4e(n,e){return Ec(n,"POST","/v1/accounts:delete",e)}async function OQ(n,e){return Ec(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qb(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function l4e(n,e=!1){const t=Bn(n),s=await t.getIdToken(e),i=vL(s);it(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:Qb(_A(i.auth_time)),issuedAtTime:Qb(_A(i.iat)),expirationTime:Qb(_A(i.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function _A(n){return Number(n)*1e3}function vL(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return U1("JWT malformed, contained fewer than 3 sections"),null;try{const i=LT(t);return i?JSON.parse(i):(U1("Failed to decode base64 JWT payload"),null)}catch(i){return U1("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function zU(n){const e=vL(n);return it(e,"internal-error"),it(typeof e.exp<"u","internal-error"),it(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vm(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof ol&&c4e(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function c4e({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4e{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qb(this.lastLoginAt),this.creationTime=Qb(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aS(n){var e;const t=n.auth,s=await n.getIdToken(),i=await vm(n,OQ(t,{idToken:s}));it(i==null?void 0:i.users.length,t,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const o=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?PQ(r.providerUserInfo):[],a=d4e(n.providerData,o),l=n.isAnonymous,c=!(n.email&&r.passwordHash)&&!(a!=null&&a.length),h=l?c:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new L2(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function h4e(n){const e=Bn(n);await aS(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function d4e(n,e){return[...n.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function PQ(n){return n.map(e=>{var{providerId:t}=e,s=mL(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f4e(n,e){const t=await DQ(n,{},async()=>{const s=Wg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=n.config,o=$Q(n,i,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",RQ.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function p4e(n,e){return Ec(n,"POST","/v2/accounts:revokeToken",mh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){it(e.idToken,"internal-error"),it(typeof e.idToken<"u","internal-error"),it(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):zU(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){it(e.length!==0,"internal-error");const t=zU(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(it(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:i,expiresIn:r}=await f4e(e,t);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:i,expirationTime:r}=t,o=new Hp;return s&&(it(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),i&&(it(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),r&&(it(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Hp,this.toJSON())}_performRefresh(){return jl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(n,e){it(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Gl{constructor(e){var{uid:t,auth:s,stsTokenManager:i}=e,r=mL(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new u4e(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new L2(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await vm(this,this.stsTokenManager.getToken(this.auth,e));return it(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return l4e(this,e)}reload(){return h4e(this)}_assign(e){this!==e&&(it(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Gl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){it(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await aS(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xi(this.auth.app))return Promise.reject(Zl(this.auth));const e=await this.getIdToken();return await vm(this,a4e(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,i,r,o,a,l,c,h;const f=(s=t.displayName)!==null&&s!==void 0?s:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,g=(r=t.phoneNumber)!==null&&r!==void 0?r:void 0,y=(o=t.photoURL)!==null&&o!==void 0?o:void 0,x=(a=t.tenantId)!==null&&a!==void 0?a:void 0,v=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,w=(c=t.createdAt)!==null&&c!==void 0?c:void 0,S=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:C,emailVerified:I,isAnonymous:A,providerData:L,stsTokenManager:O}=t;it(C&&O,e,"internal-error");const N=Hp.fromJSON(this.name,O);it(typeof C=="string",e,"internal-error"),au(f,e.name),au(p,e.name),it(typeof I=="boolean",e,"internal-error"),it(typeof A=="boolean",e,"internal-error"),au(g,e.name),au(y,e.name),au(x,e.name),au(v,e.name),au(w,e.name),au(S,e.name);const k=new Gl({uid:C,auth:e,email:p,emailVerified:I,displayName:f,isAnonymous:A,photoURL:y,phoneNumber:g,tenantId:x,stsTokenManager:N,createdAt:w,lastLoginAt:S});return L&&Array.isArray(L)&&(k.providerData=L.map($=>Object.assign({},$))),v&&(k._redirectEventId=v),k}static async _fromIdTokenResponse(e,t,s=!1){const i=new Hp;i.updateFromServerResponse(t);const r=new Gl({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await aS(r),r}static async _fromGetAccountInfoResponse(e,t,s){const i=t.users[0];it(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?PQ(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(r!=null&&r.length),a=new Hp;a.updateFromIdToken(s);const l=new Gl({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new L2(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(r!=null&&r.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BU=new Map;function ql(n){hc(n instanceof Function,"Expected a class definition");let e=BU.get(n);return e?(hc(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,BU.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LQ{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}LQ.type="NONE";const UU=LQ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W1(n,e,t){return`firebase:${n}:${e}:${t}`}class jp{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=W1(this.userKey,i.apiKey,r),this.fullPersistenceKey=W1("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Gl._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new jp(ql(UU),e,s);const i=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let r=i[0]||ql(UU);const o=W1(s,e.config.apiKey,e.name);let a=null;for(const c of t)try{const h=await c._get(o);if(h){const f=Gl._fromJSON(e,h);c!==r&&(a=f),r=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new jp(r,e,s):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==r)try{await c._remove(o)}catch{}})),new jp(r,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WU(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(zQ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(MQ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(UQ(e))return"Blackberry";if(WQ(e))return"Webos";if(FQ(e))return"Safari";if((e.includes("chrome/")||VQ(e))&&!e.includes("edge/"))return"Chrome";if(BQ(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function MQ(n=Fi()){return/firefox\//i.test(n)}function FQ(n=Fi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function VQ(n=Fi()){return/crios\//i.test(n)}function zQ(n=Fi()){return/iemobile/i.test(n)}function BQ(n=Fi()){return/android/i.test(n)}function UQ(n=Fi()){return/blackberry/i.test(n)}function WQ(n=Fi()){return/webos/i.test(n)}function xL(n=Fi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function m4e(n=Fi()){var e;return xL(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function g4e(){return vPe()&&document.documentMode===10}function HQ(n=Fi()){return xL(n)||BQ(n)||WQ(n)||UQ(n)||/windows phone/i.test(n)||zQ(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jQ(n,e=[]){let t;switch(n){case"Browser":t=WU(Fi());break;case"Worker":t=`${WU(Fi())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ph}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4e{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=r=>new Promise((o,a)=>{try{const l=e(r);o(l)}catch(l){a(l)}});s.onAbort=t,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b4e(n,e={}){return Ec(n,"GET","/v2/passwordPolicy",mh(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4e=6;class x4e{constructor(e){var t,s,i,r;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:v4e,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(r=e.forceUpgradeOnSignin)!==null&&r!==void 0?r:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,i,r,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(s=l.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsUppercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4e{constructor(e,t,s,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new HU(this),this.idTokenSubscription=new HU(this),this.beforeStateQueue=new y4e(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=AQ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ql(t)),this._initializationPromise=this.queue(async()=>{var s,i;if(!this._deleted&&(this.persistenceManager=await jp.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await OQ(this,{idToken:e}),s=await Gl._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Xi(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let i=s,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return it(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await aS(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=e4e()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xi(this.app))return Promise.reject(Zl(this));const t=e?Bn(e):null;return t&&it(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&it(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xi(this.app)?Promise.reject(Zl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xi(this.app)?Promise.reject(Zl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ql(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await b4e(this),t=new x4e(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Hx("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await p4e(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ql(e)||this._popupRedirectResolver;it(t,this,"argument-error"),this.redirectPersistenceManager=await jp.create(this,[ql(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,i){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(it(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,s,i);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return it(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jQ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(Xi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&YBe(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function gh(n){return Bn(n)}class HU{constructor(e){this.auth=e,this.observer=null,this.addObserver=APe(t=>this.observer=t)}get next(){return it(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xI={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _4e(n){xI=n}function GQ(n){return xI.loadJS(n)}function T4e(){return xI.recaptchaEnterpriseScript}function S4e(){return xI.gapiScript}function E4e(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class C4e{constructor(){this.enterprise=new I4e}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class I4e{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const k4e="recaptcha-enterprise",qQ="NO_RECAPTCHA";class N4e{constructor(e){this.type=k4e,this.auth=gh(e)}async verify(e="verify",t=!1){async function s(r){if(!t){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,a)=>{o4e(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new r4e(l);return r.tenantId==null?r._agentRecaptchaConfig=c:r._tenantRecaptchaConfigs[r.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function i(r,o,a){const l=window.grecaptcha;VU(l)?l.enterprise.ready(()=>{l.enterprise.execute(r,{action:e}).then(c=>{o(c)}).catch(()=>{o(qQ)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new C4e().execute("siteKey",{action:"verify"}):new Promise((r,o)=>{s(this.auth).then(a=>{if(!t&&VU(window.grecaptcha))i(a,r,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=T4e();l.length!==0&&(l+=a),GQ(l).then(()=>{i(a,r,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function jU(n,e,t,s=!1,i=!1){const r=new N4e(n);let o;if(i)o=qQ;else try{o=await r.verify(t)}catch{o=await r.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return s?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function M2(n,e,t,s,i){var r;if(!((r=n._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await jU(n,e,t,t==="getOobCode");return s(n,o)}else return s(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await jU(n,e,t,t==="getOobCode");return s(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A4e(n,e){const t=jx(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),r=t.getOptions();if(FT(r,e??{}))return i;Co(i,"already-initialized")}return t.initialize({options:e})}function R4e(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(ql);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function D4e(n,e,t){const s=gh(n);it(s._canInitEmulator,s,"emulator-config-failed"),it(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=KQ(e),{host:o,port:a}=$4e(e),l=a===null?"":`:${a}`;s.config.emulator={url:`${r}//${o}${l}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})}),O4e()}function KQ(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function $4e(n){const e=KQ(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:GU(s.substr(r.length+1))}}else{const[r,o]=s.split(":");return{host:r,port:GU(o)}}}function GU(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function O4e(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wL{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return jl("not implemented")}_getIdTokenResponse(e){return jl("not implemented")}_linkToIdToken(e,t){return jl("not implemented")}_getReauthenticationResolver(e){return jl("not implemented")}}async function P4e(n,e){return Ec(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L4e(n,e){return sw(n,"POST","/v1/accounts:signInWithPassword",mh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M4e(n,e){return sw(n,"POST","/v1/accounts:signInWithEmailLink",mh(n,e))}async function F4e(n,e){return sw(n,"POST","/v1/accounts:signInWithEmailLink",mh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0 extends wL{constructor(e,t,s,i=null){super("password",s),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new z0(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new z0(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return M2(e,t,"signInWithPassword",L4e);case"emailLink":return M4e(e,{email:this._email,oobCode:this._password});default:Co(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return M2(e,s,"signUpPassword",P4e);case"emailLink":return F4e(e,{idToken:t,email:this._email,oobCode:this._password});default:Co(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gp(n,e){return sw(n,"POST","/v1/accounts:signInWithIdp",mh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V4e="http://localhost";class tf extends wL{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new tf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Co("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i}=t,r=mL(t,["providerId","signInMethod"]);if(!s||!i)return null;const o=new tf(s,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Gp(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Gp(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gp(e,t)}buildRequest(){const e={requestUri:V4e,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Wg(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z4e(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function B4e(n){const e=Rb(Db(n)).link,t=e?Rb(Db(e)).deep_link_id:null,s=Rb(Db(n)).deep_link_id;return(s?Rb(Db(s)).link:null)||s||t||e||n}class _L{constructor(e){var t,s,i,r,o,a;const l=Rb(Db(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,h=(s=l.oobCode)!==null&&s!==void 0?s:null,f=z4e((i=l.mode)!==null&&i!==void 0?i:null);it(c&&h&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=h,this.continueUrl=(r=l.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=B4e(e);try{return new _L(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(){this.providerId=Zg.PROVIDER_ID}static credential(e,t){return z0._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=_L.parseLink(t);return it(s,"argument-error"),z0._fromEmailAndCode(e,s.code,s.tenantId)}}Zg.PROVIDER_ID="password";Zg.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zg.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TL{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw extends TL{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du extends iw{constructor(){super("facebook.com")}static credential(e){return tf._fromParams({providerId:du.PROVIDER_ID,signInMethod:du.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return du.credentialFromTaggedObject(e)}static credentialFromError(e){return du.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return du.credential(e.oauthAccessToken)}catch{return null}}}du.FACEBOOK_SIGN_IN_METHOD="facebook.com";du.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl extends iw{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return tf._fromParams({providerId:Wl.PROVIDER_ID,signInMethod:Wl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Wl.credentialFromTaggedObject(e)}static credentialFromError(e){return Wl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Wl.credential(t,s)}catch{return null}}}Wl.GOOGLE_SIGN_IN_METHOD="google.com";Wl.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu extends iw{constructor(){super("github.com")}static credential(e){return tf._fromParams({providerId:fu.PROVIDER_ID,signInMethod:fu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fu.credentialFromTaggedObject(e)}static credentialFromError(e){return fu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fu.credential(e.oauthAccessToken)}catch{return null}}}fu.GITHUB_SIGN_IN_METHOD="github.com";fu.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu extends iw{constructor(){super("twitter.com")}static credential(e,t){return tf._fromParams({providerId:pu.PROVIDER_ID,signInMethod:pu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return pu.credentialFromTaggedObject(e)}static credentialFromError(e){return pu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return pu.credential(t,s)}catch{return null}}}pu.TWITTER_SIGN_IN_METHOD="twitter.com";pu.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U4e(n,e){return sw(n,"POST","/v1/accounts:signUp",mh(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,i=!1){const r=await Gl._fromIdTokenResponse(e,s,i),o=qU(s);return new nf({user:r,providerId:o,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const i=qU(s);return new nf({user:e,providerId:i,_tokenResponse:s,operationType:t})}}function qU(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS extends ol{constructor(e,t,s,i){var r;super(t.code,t.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,lS.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,i){return new lS(e,t,s,i)}}function XQ(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?lS._fromErrorAndOperation(n,r,e,s):r})}async function W4e(n,e,t=!1){const s=await vm(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return nf._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H4e(n,e,t=!1){const{auth:s}=n;if(Xi(s.app))return Promise.reject(Zl(s));const i="reauthenticate";try{const r=await vm(n,XQ(s,i,e,n),t);it(r.idToken,s,"internal-error");const o=vL(r.idToken);it(o,s,"internal-error");const{sub:a}=o;return it(n.uid===a,s,"user-mismatch"),nf._forOperation(n,i,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&Co(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YQ(n,e,t=!1){if(Xi(n.app))return Promise.reject(Zl(n));const s="signIn",i=await XQ(n,s,e),r=await nf._fromIdTokenResponse(n,s,i);return t||await n._updateCurrentUser(r.user),r}async function j4e(n,e){return YQ(gh(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QQ(n){const e=gh(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function G4e(n,e,t){if(Xi(n.app))return Promise.reject(Zl(n));const s=gh(n),o=await M2(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",U4e).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&QQ(n),l}),a=await nf._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(a.user),a}function q4e(n,e,t){return Xi(n.app)?Promise.reject(Zl(n)):j4e(Bn(n),Zg.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&QQ(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K4e(n,e){return Ec(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X4e(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=Bn(n),r={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await vm(s,K4e(s.auth,r));s.displayName=o.displayName||null,s.photoURL=o.photoUrl||null;const a=s.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=s.displayName,a.photoURL=s.photoURL),await s._updateTokensIfNecessary(o)}function Y4e(n,e,t,s){return Bn(n).onIdTokenChanged(e,t,s)}function Q4e(n,e,t){return Bn(n).beforeAuthStateChanged(e,t)}function Z4e(n,e,t,s){return Bn(n).onAuthStateChanged(e,t,s)}function J4e(n){return Bn(n).signOut()}const cS="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZQ{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(cS,"1"),this.storage.removeItem(cS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eUe=1e3,tUe=10;class JQ extends ZQ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=HQ(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),i=this.localCache[t];s!==i&&e(t,i,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(s);!t&&this.localCache[s]===o||this.notifyListeners(s,o)},r=this.storage.getItem(s);g4e()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,tUe):i()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},eUe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}JQ.type="LOCAL";const nUe=JQ;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eZ extends ZQ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}eZ.type="SESSION";const tZ=eZ;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sUe(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const s=new wI(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:i,data:r}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const a=Array.from(o).map(async c=>c(t.origin,r)),l=await sUe(a);t.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wI.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iUe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const c=SL("",20);i.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:i,onMessage(f){const p=f;if(p.data.eventId===c)switch(p.data.status){case"ack":clearTimeout(h),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(p.data.response);break;default:clearTimeout(h),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ga(){return window}function rUe(n){Ga().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nZ(){return typeof Ga().WorkerGlobalScope<"u"&&typeof Ga().importScripts=="function"}async function oUe(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function aUe(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function lUe(){return nZ()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sZ="firebaseLocalStorageDb",cUe=1,uS="firebaseLocalStorage",iZ="fbase_key";class rw{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function _I(n,e){return n.transaction([uS],e?"readwrite":"readonly").objectStore(uS)}function uUe(){const n=indexedDB.deleteDatabase(sZ);return new rw(n).toPromise()}function F2(){const n=indexedDB.open(sZ,cUe);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(uS,{keyPath:iZ})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(uS)?e(s):(s.close(),await uUe(),e(await F2()))})})}async function KU(n,e,t){const s=_I(n,!0).put({[iZ]:e,value:t});return new rw(s).toPromise()}async function hUe(n,e){const t=_I(n,!1).get(e),s=await new rw(t).toPromise();return s===void 0?null:s.value}function XU(n,e){const t=_I(n,!0).delete(e);return new rw(t).toPromise()}const dUe=800,fUe=3;class rZ{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await F2(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>fUe)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nZ()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wI._getInstance(lUe()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await oUe(),!this.activeServiceWorker)return;this.sender=new iUe(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||aUe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await F2();return await KU(e,cS,"1"),await XU(e,cS),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>KU(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>hUe(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>XU(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=_I(i,!1).getAll();return new rw(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dUe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}rZ.type="LOCAL";const pUe=rZ;new nw(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oZ(n,e){return e?ql(e):(it(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EL extends wL{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gp(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gp(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gp(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function mUe(n){return YQ(n.auth,new EL(n),n.bypassAuthState)}function gUe(n){const{auth:e,user:t}=n;return it(t,e,"internal-error"),H4e(t,new EL(n),n.bypassAuthState)}async function yUe(n){const{auth:e,user:t}=n;return it(t,e,"internal-error"),W4e(t,new EL(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aZ{constructor(e,t,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:i,tenantId:r,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return mUe;case"linkViaPopup":case"linkViaRedirect":return yUe;case"reauthViaPopup":case"reauthViaRedirect":return gUe;default:Co(this.auth,"internal-error")}}resolve(e){hc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){hc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bUe=new nw(2e3,1e4);async function vUe(n,e,t){if(Xi(n.app))return Promise.reject(Jo(n,"operation-not-supported-in-this-environment"));const s=gh(n);QBe(n,e,TL);const i=oZ(s,t);return new xd(s,"signInViaPopup",e,i).executeNotNull()}class xd extends aZ{constructor(e,t,s,i,r){super(e,t,i,r),this.provider=s,this.authWindow=null,this.pollId=null,xd.currentPopupAction&&xd.currentPopupAction.cancel(),xd.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return it(e,this.auth,"internal-error"),e}async onExecution(){hc(this.filter.length===1,"Popup operations only handle one event");const e=SL();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Jo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Jo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xd.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,bUe.get())};e()}}xd.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xUe="pendingRedirect",H1=new Map;class wUe extends aZ{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=H1.get(this.auth._key());if(!e){try{const s=await _Ue(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}H1.set(this.auth._key(),e)}return this.bypassAuthState||H1.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _Ue(n,e){const t=EUe(e),s=SUe(n);if(!await s._isAvailable())return!1;const i=await s._get(t)==="true";return await s._remove(t),i}function TUe(n,e){H1.set(n._key(),e)}function SUe(n){return ql(n._redirectPersistence)}function EUe(n){return W1(xUe,n.config.apiKey,n.name)}async function CUe(n,e,t=!1){if(Xi(n.app))return Promise.reject(Zl(n));const s=gh(n),i=oZ(s,e),o=await new wUe(s,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IUe=10*60*1e3;class kUe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!NUe(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!lZ(e)){const i=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(Jo(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=IUe&&this.cachedEventUids.clear(),this.cachedEventUids.has(YU(e))}saveEventToCache(e){this.cachedEventUids.add(YU(e)),this.lastProcessedEventTime=Date.now()}}function YU(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function lZ({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function NUe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return lZ(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AUe(n,e={}){return Ec(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RUe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DUe=/^https?/;async function $Ue(n){if(n.config.emulator)return;const{authorizedDomains:e}=await AUe(n);for(const t of e)try{if(OUe(t))return}catch{}Co(n,"unauthorized-domain")}function OUe(n){const e=P2(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===s}if(!DUe.test(t))return!1;if(RUe.test(n))return s===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PUe=new nw(3e4,6e4);function QU(){const n=Ga().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function LUe(n){return new Promise((e,t)=>{var s,i,r;function o(){QU(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{QU(),t(Jo(n,"network-request-failed"))},timeout:PUe.get()})}if(!((i=(s=Ga().gapi)===null||s===void 0?void 0:s.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((r=Ga().gapi)===null||r===void 0)&&r.load)o();else{const a=E4e("iframefcb");return Ga()[a]=()=>{gapi.load?o():t(Jo(n,"network-request-failed"))},GQ(`${S4e()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw j1=null,e})}let j1=null;function MUe(n){return j1=j1||LUe(n),j1}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FUe=new nw(5e3,15e3),VUe="__/auth/iframe",zUe="emulator/auth/iframe",BUe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},UUe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function WUe(n){const e=n.config;it(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?bL(e,zUe):`https://${n.config.authDomain}/${VUe}`,s={apiKey:e.apiKey,appName:n.name,v:ph},i=UUe.get(n.config.apiHost);i&&(s.eid=i);const r=n._getFrameworks();return r.length&&(s.fw=r.join(",")),`${t}?${Wg(s).slice(1)}`}async function HUe(n){const e=await MUe(n),t=Ga().gapi;return it(t,n,"internal-error"),e.open({where:document.body,url:WUe(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:BUe,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const o=Jo(n,"network-request-failed"),a=Ga().setTimeout(()=>{r(o)},FUe.get());function l(){Ga().clearTimeout(a),i(s)}s.ping(l).then(l,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jUe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},GUe=500,qUe=600,KUe="_blank",XUe="http://localhost";class ZU{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function YUe(n,e,t,s=GUe,i=qUe){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l=Object.assign(Object.assign({},jUe),{width:s.toString(),height:i.toString(),top:r,left:o}),c=Fi().toLowerCase();t&&(a=VQ(c)?KUe:t),MQ(c)&&(e=e||XUe,l.scrollbars="yes");const h=Object.entries(l).reduce((p,[g,y])=>`${p}${g}=${y},`,"");if(m4e(c)&&a!=="_self")return QUe(e||"",a),new ZU(null);const f=window.open(e||"",a,h);it(f,n,"popup-blocked");try{f.focus()}catch{}return new ZU(f)}function QUe(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZUe="__/auth/handler",JUe="emulator/auth/handler",eWe=encodeURIComponent("fac");async function JU(n,e,t,s,i,r){it(n.config.authDomain,n,"auth-domain-config-required"),it(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:ph,eventId:i};if(e instanceof TL){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",JR(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof iw){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await n._getAppCheckToken(),c=l?`#${eWe}=${encodeURIComponent(l)}`:"";return`${tWe(n)}?${Wg(a).slice(1)}${c}`}function tWe({config:n}){return n.emulator?bL(n,JUe):`https://${n.authDomain}/${ZUe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA="webStorageSupport";class nWe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tZ,this._completeRedirectFn=CUe,this._overrideRedirectResult=TUe}async _openPopup(e,t,s,i){var r;hc((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const o=await JU(e,t,s,P2(),i);return YUe(e,o,SL())}async _openRedirect(e,t,s,i){await this._originValidation(e);const r=await JU(e,t,s,P2(),i);return rUe(r),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:r}=this.eventManagers[t];return i?Promise.resolve(i):(hc(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await HUe(e),s=new kUe(e);return t.register("authEvent",i=>(it(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(TA,{type:TA},i=>{var r;const o=(r=i==null?void 0:i[0])===null||r===void 0?void 0:r[TA];o!==void 0&&t(!!o),Co(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=$Ue(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return HQ()||FQ()||xL()}}const sWe=nWe;var eW="@firebase/auth",tW="1.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iWe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){it(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rWe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function oWe(n){qu(new oc("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;it(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jQ(n)},c=new w4e(s,i,r,l);return R4e(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),qu(new oc("auth-internal",e=>{const t=gh(e.getProvider("auth").getImmediate());return(s=>new iWe(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),To(eW,tW,rWe(n)),To(eW,tW,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aWe=5*60,lWe=RK("authIdTokenMaxAge")||aWe;let nW=null;const cWe=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>lWe)return;const i=t==null?void 0:t.token;nW!==i&&(nW=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function cZ(n=eI()){const e=jx(n,"auth");if(e.isInitialized())return e.getImmediate();const t=A4e(n,{popupRedirectResolver:sWe,persistence:[pUe,nUe,tZ]}),s=RK("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const o=cWe(r.toString());Q4e(t,o,()=>o(t.currentUser)),Y4e(t,a=>o(a))}}const i=NK("auth");return i&&D4e(t,`http://${i}`),t}function uWe(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}_4e({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=i=>{const r=Jo("internal-error");r.customData=i,t(r)},s.type="text/javascript",s.charset="UTF-8",uWe().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});oWe("Browser");const hWe={apiKey:"AIzaSyBSFHtHoS8t4AaOFXr2XvpCnLDE6rBeOQ8",authDomain:"fibrex-e83bd.firebaseapp.com",projectId:"fibrex-e83bd",storageBucket:"fibrex-e83bd.firebasestorage.app",messagingSenderId:"187920041382",appId:"1:187920041382:web:ead882690b5b40c3b9fb67",measurementId:"G-NWPHW3F2CE"},CL=LK(hWe),B0=cZ(CL),dWe=new Wl;GBe(CL);const Zb=BVe(CL);function uZ(n){return kS({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 20a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8h2V6h-4V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2H3v2h2zM9 4h6v2H9zM8 8h9v12H7V8z"},child:[]},{tag:"path",attr:{d:"M9 10h2v8H9zm4 0h2v8h-2z"},child:[]}]})(n)}const fWe="https://api.cloudinary.com/v1_1/dwmtiktkj/image/upload",pWe="firt_apple_upload",mWe={apple:4,banana:2.6,beans:6,rice:1.6,bread:2,pasta:2,"whole grain":3,salad:2,"chicken breast":0,"beef steak":9,"salmon fillet":14.2,egg:6.8,milk:12.3,"fried chicken":14.2,fries:3,hamburger:2,pizza:16,"hot dog":7,"ice cream":4,"fried fish":23,"chicken nuggets":12,"chicken wings":11.4,broccoli:2.4,oats:10.6,popcorn:24.6,"white rice":.6,"whole wheat bread":6.5,orange:2.4,strawberry:2,blueberry:2.4,raspberry:6.5,avocado:6.7,carrot:2.8,spinach:2.2,kale:2.6,sweet_potato:3,peas:5.7,lentils:7.9,chickpeas:7.6,black_beans:8.7,chia_seeds:34.4,flaxseeds:27.3,quinoa:2.8,barley:17.3,bulgur:4.5,farro:3.5,millet:8.5,sorghum:6.3,teff:7.1,buckwheat:10,spelt:10.7,amaranth:6.7,"vegetable soup":3.5,"chicken salad":2,"beef stew":1.5,"lentil soup":7.9,"quinoa salad":5,"black bean chili":12,"oatmeal with fruits":8,"whole grain pasta":6,"brown rice and beans":9,"vegetable stir-fry":4,"fruit smoothie":3,"jollof rice":2,"egusi soup":3.5,"pounded yam":1,fufu:1.2,suya:.5,moimoi:4.5,akara:3,"banga soup":2.5,"ofada rice":2,"efo riro":3,"ogbono soup":3.5,"pepper soup":1,"afang soup":3,"okro soup":2.5,"yam porridge":2,"beans porridge":5,"fried plantain":1.5,gari:1,"tuwo shinkafa":1.2,masa:1,kilishi:.5,nkwobi:1,"isi ewu":1},gWe=()=>{const[n,e]=oe.useState([]),[t,s]=oe.useState(""),[i,r]=oe.useState(null),[o,a]=oe.useState(!1),[l,c]=oe.useState(""),[h,f]=oe.useState("");oe.useEffect(()=>{const v=Z4e(B0,w=>{if(w){const S=e3e(_2(Zb,"loggedMeals"),t3e("userId","==",w.uid)),C=mY(S,I=>{e(I.docs.map(A=>({id:A.id,...A.data()})))});return()=>C()}});return()=>v()},[]);const p=async()=>{if(!i)return null;const v=new FormData;v.append("file",i),v.append("upload_preset",pWe);try{return(await cs.post(fWe,v)).data.secure_url}catch(w){return console.error("Error uploading to Data:",w),null}},g=async v=>{const w=document.createElement("img");w.src=URL.createObjectURL(v),await w.decode();const C=await(await fpe()).classify(w);return C.length>0?C[0].className.toLowerCase():"Unknown"},y=async()=>{if(!i)return;a(!0);const v=await p();if(!v)return;const w=await g(i);c(w);const S=mWe[w]||(Math.random()*10).toFixed(1),C=B0.currentUser;C&&(await o3e(_2(Zb,"loggedMeals"),{userId:C.uid,name:t||w,fiberContent:h||S,image:v,detectedFood:w,timestamp:new Date}),s(""),r(null),f(""),a(!1))},x=async v=>{try{await pY(VP(Zb,"loggedMeals",v)),console.log(`Meal with ID ${v} deleted`)}catch(w){console.error("Error deleting meal:",w)}};return be.jsxs("div",{className:"p-6",children:[be.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Log Your Meal"}),be.jsx("input",{type:"text",placeholder:"Enter meal name (optional)",value:t,onChange:v=>s(v.target.value),className:"w-full p-2 border rounded mb-2"}),be.jsx("input",{type:"file",accept:"image/*",onChange:v=>r(v.target.files[0]),className:"w-full p-2 border rounded mb-2"}),be.jsx("input",{type:"text",placeholder:"Enter the amount of fibers (optional)",value:h,onChange:v=>f(v.target.value),className:"w-full p-3 border rounded mb-2"}),be.jsx("button",{onClick:y,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",disabled:o,children:o?"Uploading...":"Save Meal"}),be.jsxs("h3",{className:"text-lg font-semibold mt-4",children:["Detected Food: ",l]}),be.jsx("h3",{className:"text-lg font-semibold mt-4",children:"Logged Meals"}),be.jsx("ul",{className:"p-3",children:n.map(v=>be.jsxs("li",{className:"p-2 border-b flex items-center",children:[be.jsx("img",{src:v.image,alt:v.name,className:"w-16 h-16 object-cover rounded mr-2"}),v.name," - ",v.fiberContent,"g Fiber",be.jsx(uZ,{onClick:()=>x(v.id),className:"ml-auto cursor-pointer"})]},v.id))}),be.jsx(NS,{})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function ow(n){return n+.5|0}const xu=(n,e,t)=>Math.max(Math.min(n,t),e);function Mb(n){return xu(ow(n*2.55),0,255)}function Ru(n){return xu(ow(n*255),0,255)}function zl(n){return xu(ow(n/2.55)/100,0,1)}function sW(n){return xu(ow(n*100),0,100)}const uo={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},V2=[..."0123456789ABCDEF"],yWe=n=>V2[n&15],bWe=n=>V2[(n&240)>>4]+V2[n&15],e1=n=>(n&240)>>4===(n&15),vWe=n=>e1(n.r)&&e1(n.g)&&e1(n.b)&&e1(n.a);function xWe(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&uo[n[1]]*17,g:255&uo[n[2]]*17,b:255&uo[n[3]]*17,a:e===5?uo[n[4]]*17:255}:(e===7||e===9)&&(t={r:uo[n[1]]<<4|uo[n[2]],g:uo[n[3]]<<4|uo[n[4]],b:uo[n[5]]<<4|uo[n[6]],a:e===9?uo[n[7]]<<4|uo[n[8]]:255})),t}const wWe=(n,e)=>n<255?e(n):"";function _We(n){var e=vWe(n)?yWe:bWe;return n?"#"+e(n.r)+e(n.g)+e(n.b)+wWe(n.a,e):void 0}const TWe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hZ(n,e,t){const s=e*Math.min(t,1-t),i=(r,o=(r+n/30)%12)=>t-s*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function SWe(n,e,t){const s=(i,r=(i+n/60)%6)=>t-t*e*Math.max(Math.min(r,4-r,1),0);return[s(5),s(3),s(1)]}function EWe(n,e,t){const s=hZ(n,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)s[i]*=1-e-t,s[i]+=e;return s}function CWe(n,e,t,s,i){return n===i?(e-t)/s+(e<t?6:0):e===i?(t-n)/s+2:(n-e)/s+4}function IL(n){const t=n.r/255,s=n.g/255,i=n.b/255,r=Math.max(t,s,i),o=Math.min(t,s,i),a=(r+o)/2;let l,c,h;return r!==o&&(h=r-o,c=a>.5?h/(2-r-o):h/(r+o),l=CWe(t,s,i,h,r),l=l*60+.5),[l|0,c||0,a]}function kL(n,e,t,s){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,s)).map(Ru)}function NL(n,e,t){return kL(hZ,n,e,t)}function IWe(n,e,t){return kL(EWe,n,e,t)}function kWe(n,e,t){return kL(SWe,n,e,t)}function dZ(n){return(n%360+360)%360}function NWe(n){const e=TWe.exec(n);let t=255,s;if(!e)return;e[5]!==s&&(t=e[6]?Mb(+e[5]):Ru(+e[5]));const i=dZ(+e[2]),r=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=IWe(i,r,o):e[1]==="hsv"?s=kWe(i,r,o):s=NL(i,r,o),{r:s[0],g:s[1],b:s[2],a:t}}function AWe(n,e){var t=IL(n);t[0]=dZ(t[0]+e),t=NL(t),n.r=t[0],n.g=t[1],n.b=t[2]}function RWe(n){if(!n)return;const e=IL(n),t=e[0],s=sW(e[1]),i=sW(e[2]);return n.a<255?`hsla(${t}, ${s}%, ${i}%, ${zl(n.a)})`:`hsl(${t}, ${s}%, ${i}%)`}const iW={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},rW={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function DWe(){const n={},e=Object.keys(rW),t=Object.keys(iW);let s,i,r,o,a;for(s=0;s<e.length;s++){for(o=a=e[s],i=0;i<t.length;i++)r=t[i],a=a.replace(r,iW[r]);r=parseInt(rW[o],16),n[a]=[r>>16&255,r>>8&255,r&255]}return n}let t1;function $We(n){t1||(t1=DWe(),t1.transparent=[0,0,0,0]);const e=t1[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const OWe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function PWe(n){const e=OWe.exec(n);let t=255,s,i,r;if(e){if(e[7]!==s){const o=+e[7];t=e[8]?Mb(o):xu(o*255,0,255)}return s=+e[1],i=+e[3],r=+e[5],s=255&(e[2]?Mb(s):xu(s,0,255)),i=255&(e[4]?Mb(i):xu(i,0,255)),r=255&(e[6]?Mb(r):xu(r,0,255)),{r:s,g:i,b:r,a:t}}}function LWe(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${zl(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const SA=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,bp=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function MWe(n,e,t){const s=bp(zl(n.r)),i=bp(zl(n.g)),r=bp(zl(n.b));return{r:Ru(SA(s+t*(bp(zl(e.r))-s))),g:Ru(SA(i+t*(bp(zl(e.g))-i))),b:Ru(SA(r+t*(bp(zl(e.b))-r))),a:n.a+t*(e.a-n.a)}}function n1(n,e,t){if(n){let s=IL(n);s[e]=Math.max(0,Math.min(s[e]+s[e]*t,e===0?360:1)),s=NL(s),n.r=s[0],n.g=s[1],n.b=s[2]}}function fZ(n,e){return n&&Object.assign(e||{},n)}function oW(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Ru(n[3]))):(e=fZ(n,{r:0,g:0,b:0,a:1}),e.a=Ru(e.a)),e}function FWe(n){return n.charAt(0)==="r"?PWe(n):NWe(n)}class U0{constructor(e){if(e instanceof U0)return e;const t=typeof e;let s;t==="object"?s=oW(e):t==="string"&&(s=xWe(e)||$We(e)||FWe(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=fZ(this._rgb);return e&&(e.a=zl(e.a)),e}set rgb(e){this._rgb=oW(e)}rgbString(){return this._valid?LWe(this._rgb):void 0}hexString(){return this._valid?_We(this._rgb):void 0}hslString(){return this._valid?RWe(this._rgb):void 0}mix(e,t){if(e){const s=this.rgb,i=e.rgb;let r;const o=t===r?.5:t,a=2*o-1,l=s.a-i.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;r=1-c,s.r=255&c*s.r+r*i.r+.5,s.g=255&c*s.g+r*i.g+.5,s.b=255&c*s.b+r*i.b+.5,s.a=o*s.a+(1-o)*i.a,this.rgb=s}return this}interpolate(e,t){return e&&(this._rgb=MWe(this._rgb,e._rgb,t)),this}clone(){return new U0(this.rgb)}alpha(e){return this._rgb.a=Ru(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=ow(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return n1(this._rgb,2,e),this}darken(e){return n1(this._rgb,2,-e),this}saturate(e){return n1(this._rgb,1,e),this}desaturate(e){return n1(this._rgb,1,-e),this}rotate(e){return AWe(this._rgb,e),this}}/*!
 * Chart.js v4.4.8
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function $l(){}const VWe=(()=>{let n=0;return()=>n++})();function mn(n){return n==null}function Ns(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Xt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Io(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Ia(n,e){return Io(n)?n:e}function sn(n,e){return typeof n>"u"?e:n}const zWe=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Sn(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function nn(n,e,t,s){let i,r,o;if(Ns(n))for(r=n.length,i=0;i<r;i++)e.call(t,n[i],i);else if(Xt(n))for(o=Object.keys(n),r=o.length,i=0;i<r;i++)e.call(t,n[o[i]],o[i])}function hS(n,e){let t,s,i,r;if(!n||!e||n.length!==e.length)return!1;for(t=0,s=n.length;t<s;++t)if(i=n[t],r=e[t],i.datasetIndex!==r.datasetIndex||i.index!==r.index)return!1;return!0}function dS(n){if(Ns(n))return n.map(dS);if(Xt(n)){const e=Object.create(null),t=Object.keys(n),s=t.length;let i=0;for(;i<s;++i)e[t[i]]=dS(n[t[i]]);return e}return n}function pZ(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function BWe(n,e,t,s){if(!pZ(n))return;const i=e[n],r=t[n];Xt(i)&&Xt(r)?W0(i,r,s):e[n]=dS(r)}function W0(n,e,t){const s=Ns(e)?e:[e],i=s.length;if(!Xt(n))return n;t=t||{};const r=t.merger||BWe;let o;for(let a=0;a<i;++a){if(o=s[a],!Xt(o))continue;const l=Object.keys(o);for(let c=0,h=l.length;c<h;++c)r(l[c],n,o,t)}return n}function Jb(n,e){return W0(n,e,{merger:UWe})}function UWe(n,e,t){if(!pZ(n))return;const s=e[n],i=t[n];Xt(s)&&Xt(i)?Jb(s,i):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=dS(i))}const aW={"":n=>n,x:n=>n.x,y:n=>n.y};function WWe(n){const e=n.split("."),t=[];let s="";for(const i of e)s+=i,s.endsWith("\\")?s=s.slice(0,-1)+".":(t.push(s),s="");return t}function HWe(n){const e=WWe(n);return t=>{for(const s of e){if(s==="")break;t=t&&t[s]}return t}}function xm(n,e){return(aW[e]||(aW[e]=HWe(e)))(n)}function AL(n){return n.charAt(0).toUpperCase()+n.slice(1)}const H0=n=>typeof n<"u",th=n=>typeof n=="function",lW=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function jWe(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Li=Math.PI,Du=2*Li,fS=Number.POSITIVE_INFINITY,GWe=Li/180,qo=Li/2,Jh=Li/4,cW=Li*2/3,mZ=Math.log10,$u=Math.sign;function G1(n,e,t){return Math.abs(n-e)<t}function uW(n){const e=Math.round(n);n=G1(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(mZ(n))),s=n/t;return(s<=1?1:s<=2?2:s<=5?5:10)*t}function qWe(n){const e=[],t=Math.sqrt(n);let s;for(s=1;s<t;s++)n%s===0&&(e.push(s),e.push(n/s));return t===(t|0)&&e.push(t),e.sort((i,r)=>i-r).pop(),e}function KWe(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function pS(n){return!KWe(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function XWe(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function YWe(n,e,t){let s,i,r;for(s=0,i=n.length;s<i;s++)r=n[s][t],isNaN(r)||(e.min=Math.min(e.min,r),e.max=Math.max(e.max,r))}function wd(n){return n*(Li/180)}function QWe(n){return n*(180/Li)}function hW(n){if(!Io(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function ZWe(n,e){const t=e.x-n.x,s=e.y-n.y,i=Math.sqrt(t*t+s*s);let r=Math.atan2(s,t);return r<-.5*Li&&(r+=Du),{angle:r,distance:i}}function JWe(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function ed(n){return(n%Du+Du)%Du}function eHe(n,e,t,s){const i=ed(n),r=ed(e),o=ed(t),a=ed(r-i),l=ed(o-i),c=ed(i-r),h=ed(i-o);return i===r||i===o||s||a>l&&c<h}function Ko(n,e,t){return Math.max(e,Math.min(t,n))}function tHe(n){return Ko(n,-32768,32767)}function kp(n,e,t,s=1e-6){return n>=Math.min(e,t)-s&&n<=Math.max(e,t)+s}function RL(n,e,t){t=t||(o=>n[o]<e);let s=n.length-1,i=0,r;for(;s-i>1;)r=i+s>>1,t(r)?i=r:s=r;return{lo:i,hi:s}}const z2=(n,e,t,s)=>RL(n,t,s?i=>{const r=n[i][e];return r<t||r===t&&n[i+1][e]===t}:i=>n[i][e]<t),nHe=(n,e,t)=>RL(n,t,s=>n[s][e]>=t);function sHe(n,e,t){let s=0,i=n.length;for(;s<i&&n[s]<e;)s++;for(;i>s&&n[i-1]>t;)i--;return s>0||i<n.length?n.slice(s,i):n}const gZ=["push","pop","shift","splice","unshift"];function iHe(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),gZ.forEach(t=>{const s="_onData"+AL(t),i=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...r){const o=i.apply(this,r);return n._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...r)}),o}})})}function dW(n,e){const t=n._chartjs;if(!t)return;const s=t.listeners,i=s.indexOf(e);i!==-1&&s.splice(i,1),!(s.length>0)&&(gZ.forEach(r=>{delete n[r]}),delete n._chartjs)}function yZ(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const bZ=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function vZ(n,e){let t=[],s=!1;return function(...i){t=i,s||(s=!0,bZ.call(window,()=>{s=!1,n.apply(e,t)}))}}function rHe(n,e){let t;return function(...s){return e?(clearTimeout(t),t=setTimeout(n,e,s)):n.apply(this,s),e}}const DL=n=>n==="start"?"left":n==="end"?"right":"center",wi=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,oHe=(n,e,t,s)=>n===(s?"left":"right")?t:n==="center"?(e+t)/2:e,s1=n=>n===0||n===1,fW=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Du/t)),pW=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Du/t)+1,e0={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*qo)+1,easeOutSine:n=>Math.sin(n*qo),easeInOutSine:n=>-.5*(Math.cos(Li*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>s1(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>s1(n)?n:fW(n,.075,.3),easeOutElastic:n=>s1(n)?n:pW(n,.075,.3),easeInOutElastic(n){return s1(n)?n:n<.5?.5*fW(n*2,.1125,.45):.5+.5*pW(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-e0.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?e0.easeInBounce(n*2)*.5:e0.easeOutBounce(n*2-1)*.5+.5};function xZ(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function mW(n){return xZ(n)?n:new U0(n)}function EA(n){return xZ(n)?n:new U0(n).saturate(.5).darken(.1).hexString()}const aHe=["x","y","borderWidth","radius","tension"],lHe=["color","borderColor","backgroundColor"];function cHe(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:lHe},numbers:{type:"number",properties:aHe}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function uHe(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const gW=new Map;function hHe(n,e){e=e||{};const t=n+JSON.stringify(e);let s=gW.get(t);return s||(s=new Intl.NumberFormat(n,e),gW.set(t,s)),s}function wZ(n,e,t){return hHe(e,t).format(n)}const dHe={values(n){return Ns(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const s=this.chart.options.locale;let i,r=n;if(t.length>1){const c=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),r=fHe(n,t)}const o=mZ(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),wZ(n,s,l)}};function fHe(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var _Z={formatters:dHe};function pHe(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:_Z.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const sf=Object.create(null),B2=Object.create(null);function t0(n,e){if(!e)return n;const t=e.split(".");for(let s=0,i=t.length;s<i;++s){const r=t[s];n=n[r]||(n[r]=Object.create(null))}return n}function CA(n,e,t){return typeof e=="string"?W0(t0(n,e),t):W0(t0(n,""),e)}class mHe{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,i)=>EA(i.backgroundColor),this.hoverBorderColor=(s,i)=>EA(i.borderColor),this.hoverColor=(s,i)=>EA(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return CA(this,e,t)}get(e){return t0(this,e)}describe(e,t){return CA(B2,e,t)}override(e,t){return CA(sf,e,t)}route(e,t,s,i){const r=t0(this,e),o=t0(this,s),a="_"+t;Object.defineProperties(r,{[a]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[a],c=o[i];return Xt(l)?Object.assign({},c,l):sn(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(t=>t(this))}}var os=new mHe({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[cHe,uHe,pHe]);function gHe(n){return!n||mn(n.size)||mn(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function yW(n,e,t,s,i){let r=e[i];return r||(r=e[i]=n.measureText(i).width,t.push(i)),r>s&&(s=r),s}function td(n,e,t){const s=n.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*s)/s+i}function bW(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function vW(n,e,t,s){TZ(n,e,t,s,null)}function TZ(n,e,t,s,i){let r,o,a,l,c,h,f,p;const g=e.pointStyle,y=e.rotation,x=e.radius;let v=(y||0)*GWe;if(g&&typeof g=="object"&&(r=g.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){n.save(),n.translate(t,s),n.rotate(v),n.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),n.restore();return}if(!(isNaN(x)||x<=0)){switch(n.beginPath(),g){default:i?n.ellipse(t,s,i/2,x,0,0,Du):n.arc(t,s,x,0,Du),n.closePath();break;case"triangle":h=i?i/2:x,n.moveTo(t+Math.sin(v)*h,s-Math.cos(v)*x),v+=cW,n.lineTo(t+Math.sin(v)*h,s-Math.cos(v)*x),v+=cW,n.lineTo(t+Math.sin(v)*h,s-Math.cos(v)*x),n.closePath();break;case"rectRounded":c=x*.516,l=x-c,o=Math.cos(v+Jh)*l,f=Math.cos(v+Jh)*(i?i/2-c:l),a=Math.sin(v+Jh)*l,p=Math.sin(v+Jh)*(i?i/2-c:l),n.arc(t-f,s-a,c,v-Li,v-qo),n.arc(t+p,s-o,c,v-qo,v),n.arc(t+f,s+a,c,v,v+qo),n.arc(t-p,s+o,c,v+qo,v+Li),n.closePath();break;case"rect":if(!y){l=Math.SQRT1_2*x,h=i?i/2:l,n.rect(t-h,s-l,2*h,2*l);break}v+=Jh;case"rectRot":f=Math.cos(v)*(i?i/2:x),o=Math.cos(v)*x,a=Math.sin(v)*x,p=Math.sin(v)*(i?i/2:x),n.moveTo(t-f,s-a),n.lineTo(t+p,s-o),n.lineTo(t+f,s+a),n.lineTo(t-p,s+o),n.closePath();break;case"crossRot":v+=Jh;case"cross":f=Math.cos(v)*(i?i/2:x),o=Math.cos(v)*x,a=Math.sin(v)*x,p=Math.sin(v)*(i?i/2:x),n.moveTo(t-f,s-a),n.lineTo(t+f,s+a),n.moveTo(t+p,s-o),n.lineTo(t-p,s+o);break;case"star":f=Math.cos(v)*(i?i/2:x),o=Math.cos(v)*x,a=Math.sin(v)*x,p=Math.sin(v)*(i?i/2:x),n.moveTo(t-f,s-a),n.lineTo(t+f,s+a),n.moveTo(t+p,s-o),n.lineTo(t-p,s+o),v+=Jh,f=Math.cos(v)*(i?i/2:x),o=Math.cos(v)*x,a=Math.sin(v)*x,p=Math.sin(v)*(i?i/2:x),n.moveTo(t-f,s-a),n.lineTo(t+f,s+a),n.moveTo(t+p,s-o),n.lineTo(t-p,s+o);break;case"line":o=i?i/2:Math.cos(v)*x,a=Math.sin(v)*x,n.moveTo(t-o,s-a),n.lineTo(t+o,s+a);break;case"dash":n.moveTo(t,s),n.lineTo(t+Math.cos(v)*(i?i/2:x),s+Math.sin(v)*x);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function SZ(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function $L(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function OL(n){n.restore()}function yHe(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),mn(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function bHe(n,e,t,s,i){if(i.strikethrough||i.underline){const r=n.measureText(s),o=e-r.actualBoundingBoxLeft,a=e+r.actualBoundingBoxRight,l=t-r.actualBoundingBoxAscent,c=t+r.actualBoundingBoxDescent,h=i.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(o,h),n.lineTo(a,h),n.stroke()}}function vHe(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function j0(n,e,t,s,i,r={}){const o=Ns(e)?e:[e],a=r.strokeWidth>0&&r.strokeColor!=="";let l,c;for(n.save(),n.font=i.string,yHe(n,r),l=0;l<o.length;++l)c=o[l],r.backdrop&&vHe(n,r.backdrop),a&&(r.strokeColor&&(n.strokeStyle=r.strokeColor),mn(r.strokeWidth)||(n.lineWidth=r.strokeWidth),n.strokeText(c,t,s,r.maxWidth)),n.fillText(c,t,s,r.maxWidth),bHe(n,t,s,c,r),s+=Number(i.lineHeight);n.restore()}function mS(n,e){const{x:t,y:s,w:i,h:r,radius:o}=e;n.arc(t+o.topLeft,s+o.topLeft,o.topLeft,1.5*Li,Li,!0),n.lineTo(t,s+r-o.bottomLeft),n.arc(t+o.bottomLeft,s+r-o.bottomLeft,o.bottomLeft,Li,qo,!0),n.lineTo(t+i-o.bottomRight,s+r),n.arc(t+i-o.bottomRight,s+r-o.bottomRight,o.bottomRight,qo,0,!0),n.lineTo(t+i,s+o.topRight),n.arc(t+i-o.topRight,s+o.topRight,o.topRight,0,-qo,!0),n.lineTo(t+o.topLeft,s)}const xHe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,wHe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function _He(n,e){const t=(""+n).match(xHe);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const THe=n=>+n||0;function EZ(n,e){const t={},s=Xt(e),i=s?Object.keys(e):e,r=Xt(n)?s?o=>sn(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of i)t[o]=THe(r(o));return t}function CZ(n){return EZ(n,{top:"y",right:"x",bottom:"y",left:"x"})}function qp(n){return EZ(n,["topLeft","topRight","bottomLeft","bottomRight"])}function ko(n){const e=CZ(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Oi(n,e){n=n||{},e=e||os.font;let t=sn(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let s=sn(n.style,e.style);s&&!(""+s).match(wHe)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const i={family:sn(n.family,e.family),lineHeight:_He(sn(n.lineHeight,e.lineHeight),t),size:t,style:s,weight:sn(n.weight,e.weight),string:""};return i.string=gHe(i),i}function i1(n,e,t,s){let i,r,o;for(i=0,r=n.length;i<r;++i)if(o=n[i],o!==void 0&&o!==void 0)return o}function SHe(n,e,t){const{min:s,max:i}=n,r=zWe(e,(i-s)/2),o=(a,l)=>t&&a===0?0:a+l;return{min:o(s,-Math.abs(r)),max:o(i,r)}}function Jg(n,e){return Object.assign(Object.create(n),e)}function PL(n,e=[""],t,s,i=()=>n[0]){const r=t||n;typeof s>"u"&&(s=AZ("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:r,_fallback:s,_getTarget:i,override:a=>PL([a,...n],e,r,s)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete n[0][l],!0},get(a,l){return kZ(a,l,()=>DHe(l,e,n,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,l){return wW(a).includes(l)},ownKeys(a){return wW(a)},set(a,l,c){const h=a._storage||(a._storage=i());return a[l]=h[l]=c,delete a._keys,!0}})}function wm(n,e,t,s){const i={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:IZ(n,s),setContext:r=>wm(n,r,t,s),override:r=>wm(n.override(r),e,t,s)};return new Proxy(i,{deleteProperty(r,o){return delete r[o],delete n[o],!0},get(r,o,a){return kZ(r,o,()=>CHe(r,o,a))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(r,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(r,o,a){return n[o]=a,delete r[o],!0}})}function IZ(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:s=e.indexable,_allKeys:i=e.allKeys}=n;return{allKeys:i,scriptable:t,indexable:s,isScriptable:th(t)?t:()=>t,isIndexable:th(s)?s:()=>s}}const EHe=(n,e)=>n?n+AL(e):e,LL=(n,e)=>Xt(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function kZ(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const s=t();return n[e]=s,s}function CHe(n,e,t){const{_proxy:s,_context:i,_subProxy:r,_descriptors:o}=n;let a=s[e];return th(a)&&o.isScriptable(e)&&(a=IHe(e,a,n,t)),Ns(a)&&a.length&&(a=kHe(e,a,n,o.isIndexable)),LL(e,a)&&(a=wm(a,i,r&&r[e],o)),a}function IHe(n,e,t,s){const{_proxy:i,_context:r,_subProxy:o,_stack:a}=t;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let l=e(r,o||s);return a.delete(n),LL(n,l)&&(l=ML(i._scopes,i,n,l)),l}function kHe(n,e,t,s){const{_proxy:i,_context:r,_subProxy:o,_descriptors:a}=t;if(typeof r.index<"u"&&s(n))return e[r.index%e.length];if(Xt(e[0])){const l=e,c=i._scopes.filter(h=>h!==l);e=[];for(const h of l){const f=ML(c,i,n,h);e.push(wm(f,r,o&&o[n],a))}}return e}function NZ(n,e,t){return th(n)?n(e,t):n}const NHe=(n,e)=>n===!0?e:typeof n=="string"?xm(e,n):void 0;function AHe(n,e,t,s,i){for(const r of e){const o=NHe(t,r);if(o){n.add(o);const a=NZ(o._fallback,t,i);if(typeof a<"u"&&a!==t&&a!==s)return a}else if(o===!1&&typeof s<"u"&&t!==s)return null}return!1}function ML(n,e,t,s){const i=e._rootScopes,r=NZ(e._fallback,t,s),o=[...n,...i],a=new Set;a.add(s);let l=xW(a,o,t,r||t,s);return l===null||typeof r<"u"&&r!==t&&(l=xW(a,o,r,l,s),l===null)?!1:PL(Array.from(a),[""],i,r,()=>RHe(e,t,s))}function xW(n,e,t,s,i){for(;t;)t=AHe(n,e,t,s,i);return t}function RHe(n,e,t){const s=n._getTarget();e in s||(s[e]={});const i=s[e];return Ns(i)&&Xt(t)?t:i||{}}function DHe(n,e,t,s){let i;for(const r of e)if(i=AZ(EHe(r,n),t),typeof i<"u")return LL(n,i)?ML(t,s,n,i):i}function AZ(n,e){for(const t of e){if(!t)continue;const s=t[n];if(typeof s<"u")return s}}function wW(n){let e=n._keys;return e||(e=n._keys=$He(n._scopes)),e}function $He(n){const e=new Set;for(const t of n)for(const s of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(s);return Array.from(e)}function FL(){return typeof window<"u"&&typeof document<"u"}function VL(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function gS(n,e,t){let s;return typeof n=="string"?(s=parseInt(n,10),n.indexOf("%")!==-1&&(s=s/100*e.parentNode[t])):s=n,s}const TI=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function OHe(n,e){return TI(n).getPropertyValue(e)}const PHe=["top","right","bottom","left"];function Rd(n,e,t){const s={};t=t?"-"+t:"";for(let i=0;i<4;i++){const r=PHe[i];s[r]=parseFloat(n[e+"-"+r+t])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const LHe=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function MHe(n,e){const t=n.touches,s=t&&t.length?t[0]:n,{offsetX:i,offsetY:r}=s;let o=!1,a,l;if(LHe(i,r,n.target))a=i,l=r;else{const c=e.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function ld(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:s}=e,i=TI(t),r=i.boxSizing==="border-box",o=Rd(i,"padding"),a=Rd(i,"border","width"),{x:l,y:c,box:h}=MHe(n,t),f=o.left+(h&&a.left),p=o.top+(h&&a.top);let{width:g,height:y}=e;return r&&(g-=o.width+a.width,y-=o.height+a.height),{x:Math.round((l-f)/g*t.width/s),y:Math.round((c-p)/y*t.height/s)}}function FHe(n,e,t){let s,i;if(e===void 0||t===void 0){const r=n&&VL(n);if(!r)e=n.clientWidth,t=n.clientHeight;else{const o=r.getBoundingClientRect(),a=TI(r),l=Rd(a,"border","width"),c=Rd(a,"padding");e=o.width-c.width-l.width,t=o.height-c.height-l.height,s=gS(a.maxWidth,r,"clientWidth"),i=gS(a.maxHeight,r,"clientHeight")}}return{width:e,height:t,maxWidth:s||fS,maxHeight:i||fS}}const r1=n=>Math.round(n*10)/10;function VHe(n,e,t,s){const i=TI(n),r=Rd(i,"margin"),o=gS(i.maxWidth,n,"clientWidth")||fS,a=gS(i.maxHeight,n,"clientHeight")||fS,l=FHe(n,e,t);let{width:c,height:h}=l;if(i.boxSizing==="content-box"){const p=Rd(i,"border","width"),g=Rd(i,"padding");c-=g.width+p.width,h-=g.height+p.height}return c=Math.max(0,c-r.width),h=Math.max(0,s?c/s:h-r.height),c=r1(Math.min(c,o,l.maxWidth)),h=r1(Math.min(h,a,l.maxHeight)),c&&!h&&(h=r1(c/2)),(e!==void 0||t!==void 0)&&s&&l.height&&h>l.height&&(h=l.height,c=r1(Math.floor(h*s))),{width:c,height:h}}function _W(n,e,t){const s=e||1,i=Math.floor(n.height*s),r=Math.floor(n.width*s);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==s||o.height!==i||o.width!==r?(n.currentDevicePixelRatio=s,o.height=i,o.width=r,n.ctx.setTransform(s,0,0,s,0,0),!0):!1}const zHe=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};FL()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n}();function TW(n,e){const t=OHe(n,e),s=t&&t.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const BHe=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,s){return t-s},leftForLtr(t,s){return t-s}}},UHe=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Kp(n,e,t){return n?BHe(e,t):UHe()}function RZ(n,e){let t,s;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,s=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=s)}function DZ(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}/*!
 * Chart.js v4.4.8
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class WHe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,s,i){const r=t.listeners[i],o=t.duration;r.forEach(a=>a({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(s-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=bZ.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((s,i)=>{if(!s.running||!s.items.length)return;const r=s.items;let o=r.length-1,a=!1,l;for(;o>=0;--o)l=r[o],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(r[o]=r[r.length-1],r.pop());a&&(i.draw(),this._notify(i,s,e,"progress")),r.length||(s.running=!1,this._notify(i,s,e,"complete"),s.initial=!1),t+=r.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let s=t.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,s)),s}listen(e,t,s){this._getAnims(e).listeners[t].push(s)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((s,i)=>Math.max(s,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const s=t.items;let i=s.length-1;for(;i>=0;--i)s[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Pl=new WHe;const SW="transparent",HHe={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const s=mW(n||SW),i=s.valid&&mW(e||SW);return i&&i.valid?i.mix(s,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class jHe{constructor(e,t,s,i){const r=t[s];i=i1([e.to,i,r,e.from]);const o=i1([e.from,r,i]);this._active=!0,this._fn=e.fn||HHe[e.type||typeof o],this._easing=e0[e.easing]||e0.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=s,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,s){if(this._active){this._notify(!1);const i=this._target[this._prop],r=s-this._start,o=this._duration-r;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=r,this._loop=!!e.loop,this._to=i1([e.to,t,i,e.from]),this._from=i1([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,s=this._duration,i=this._prop,r=this._from,o=this._loop,a=this._to;let l;if(this._active=r!==a&&(o||t<s),!this._active){this._target[i]=a,this._notify(!0);return}if(t<0){this._target[i]=r;return}l=t/s%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(r,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,s)=>{e.push({res:t,rej:s})})}_notify(e){const t=e?"res":"rej",s=this._promises||[];for(let i=0;i<s.length;i++)s[i][t]()}}class $Z{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Xt(e))return;const t=Object.keys(os.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const r=e[i];if(!Xt(r))return;const o={};for(const a of t)o[a]=r[a];(Ns(r.properties)&&r.properties||[i]).forEach(a=>{(a===i||!s.has(a))&&s.set(a,o)})})}_animateOptions(e,t){const s=t.options,i=qHe(e,s);if(!i)return[];const r=this._createAnimations(i,s);return s.$shared&&GHe(e.options.$animations,s).then(()=>{e.options=s},()=>{}),r}_createAnimations(e,t){const s=this._properties,i=[],r=e.$animations||(e.$animations={}),o=Object.keys(t),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(e,t));continue}const h=t[c];let f=r[c];const p=s.get(c);if(f)if(p&&f.active()){f.update(p,h,a);continue}else f.cancel();if(!p||!p.duration){e[c]=h;continue}r[c]=f=new jHe(p,e,c,h),i.push(f)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const s=this._createAnimations(e,t);if(s.length)return Pl.add(this._chart,s),!0}}function GHe(n,e){const t=[],s=Object.keys(e);for(let i=0;i<s.length;i++){const r=n[s[i]];r&&r.active()&&t.push(r.wait())}return Promise.all(t)}function qHe(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function EW(n,e){const t=n&&n.options||{},s=t.reverse,i=t.min===void 0?e:0,r=t.max===void 0?e:0;return{start:s?r:i,end:s?i:r}}function KHe(n,e,t){if(t===!1)return!1;const s=EW(n,t),i=EW(e,t);return{top:i.end,right:s.end,bottom:i.start,left:s.start}}function XHe(n){let e,t,s,i;return Xt(n)?(e=n.top,t=n.right,s=n.bottom,i=n.left):e=t=s=i=n,{top:e,right:t,bottom:s,left:i,disabled:n===!1}}function OZ(n,e){const t=[],s=n._getSortedDatasetMetas(e);let i,r;for(i=0,r=s.length;i<r;++i)t.push(s[i].index);return t}function CW(n,e,t,s={}){const i=n.keys,r=s.mode==="single";let o,a,l,c;if(e===null)return;let h=!1;for(o=0,a=i.length;o<a;++o){if(l=+i[o],l===t){if(h=!0,s.all)continue;break}c=n.values[l],Io(c)&&(r||e===0||$u(e)===$u(c))&&(e+=c)}return!h&&!s.all?0:e}function YHe(n,e){const{iScale:t,vScale:s}=e,i=t.axis==="x"?"x":"y",r=s.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let l,c,h;for(l=0,c=o.length;l<c;++l)h=o[l],a[l]={[i]:h,[r]:n[h]};return a}function IA(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function QHe(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function ZHe(n){const{min:e,max:t,minDefined:s,maxDefined:i}=n.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function JHe(n,e,t){const s=n[e]||(n[e]={});return s[t]||(s[t]={})}function IW(n,e,t,s){for(const i of e.getMatchingVisibleMetas(s).reverse()){const r=n[i.index];if(t&&r>0||!t&&r<0)return i.index}return null}function kW(n,e){const{chart:t,_cachedMeta:s}=n,i=t._stacks||(t._stacks={}),{iScale:r,vScale:o,index:a}=s,l=r.axis,c=o.axis,h=QHe(r,o,s),f=e.length;let p;for(let g=0;g<f;++g){const y=e[g],{[l]:x,[c]:v}=y,w=y._stacks||(y._stacks={});p=w[c]=JHe(i,h,x),p[a]=v,p._top=IW(p,o,!0,s.type),p._bottom=IW(p,o,!1,s.type);const S=p._visualValues||(p._visualValues={});S[a]=v}}function kA(n,e){const t=n.scales;return Object.keys(t).filter(s=>t[s].axis===e).shift()}function eje(n,e){return Jg(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function tje(n,e,t){return Jg(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function bb(n,e){const t=n.controller.index,s=n.vScale&&n.vScale.axis;if(s){e=e||n._parsed;for(const i of e){const r=i._stacks;if(!r||r[s]===void 0||r[s][t]===void 0)return;delete r[s][t],r[s]._visualValues!==void 0&&r[s]._visualValues[t]!==void 0&&delete r[s]._visualValues[t]}}}const NA=n=>n==="reset"||n==="none",NW=(n,e)=>e?n:Object.assign({},n),nje=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:OZ(t,!0),values:null};class n0{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=IA(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&bb(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,s=this.getDataset(),i=(f,p,g,y)=>f==="x"?p:f==="r"?y:g,r=t.xAxisID=sn(s.xAxisID,kA(e,"x")),o=t.yAxisID=sn(s.yAxisID,kA(e,"y")),a=t.rAxisID=sn(s.rAxisID,kA(e,"r")),l=t.indexAxis,c=t.iAxisID=i(l,r,o,a),h=t.vAxisID=i(l,o,r,a);t.xScale=this.getScaleForId(r),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(c),t.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&dW(this._data,this),e._stacked&&bb(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),s=this._data;if(Xt(t)){const i=this._cachedMeta;this._data=YHe(t,i)}else if(s!==t){if(s){dW(s,this);const i=this._cachedMeta;bb(i),i._parsed=[]}t&&Object.isExtensible(t)&&iHe(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,s=this.getDataset();let i=!1;this._dataCheck();const r=t._stacked;t._stacked=IA(t.vScale,t),t.stack!==s.stack&&(i=!0,bb(t),t.stack=s.stack),this._resyncElements(e),(i||r!==t._stacked)&&(kW(this,t._parsed),t._stacked=IA(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:s,_data:i}=this,{iScale:r,_stacked:o}=s,a=r.axis;let l=e===0&&t===i.length?!0:s._sorted,c=e>0&&s._parsed[e-1],h,f,p;if(this._parsing===!1)s._parsed=i,s._sorted=!0,p=i;else{Ns(i[e])?p=this.parseArrayData(s,i,e,t):Xt(i[e])?p=this.parseObjectData(s,i,e,t):p=this.parsePrimitiveData(s,i,e,t);const g=()=>f[a]===null||c&&f[a]<c[a];for(h=0;h<t;++h)s._parsed[h+e]=f=p[h],l&&(g()&&(l=!1),c=f);s._sorted=l}o&&kW(this,p)}parsePrimitiveData(e,t,s,i){const{iScale:r,vScale:o}=e,a=r.axis,l=o.axis,c=r.getLabels(),h=r===o,f=new Array(i);let p,g,y;for(p=0,g=i;p<g;++p)y=p+s,f[p]={[a]:h||r.parse(c[y],y),[l]:o.parse(t[y],y)};return f}parseArrayData(e,t,s,i){const{xScale:r,yScale:o}=e,a=new Array(i);let l,c,h,f;for(l=0,c=i;l<c;++l)h=l+s,f=t[h],a[l]={x:r.parse(f[0],h),y:o.parse(f[1],h)};return a}parseObjectData(e,t,s,i){const{xScale:r,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let h,f,p,g;for(h=0,f=i;h<f;++h)p=h+s,g=t[p],c[h]={x:r.parse(xm(g,a),p),y:o.parse(xm(g,l),p)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,s){const i=this.chart,r=this._cachedMeta,o=t[e.axis],a={keys:OZ(i,!0),values:t._stacks[e.axis]._visualValues};return CW(a,o,r.index,{mode:s})}updateRangeFromParsed(e,t,s,i){const r=s[t.axis];let o=r===null?NaN:r;const a=i&&s._stacks[t.axis];i&&a&&(i.values=a,o=CW(i,r,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const s=this._cachedMeta,i=s._parsed,r=s._sorted&&e===s.iScale,o=i.length,a=this._getOtherScale(e),l=nje(t,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:f}=ZHe(a);let p,g;function y(){g=i[p];const x=g[a.axis];return!Io(g[e.axis])||h>x||f<x}for(p=0;p<o&&!(!y()&&(this.updateRangeFromParsed(c,e,g,l),r));++p);if(r){for(p=o-1;p>=0;--p)if(!y()){this.updateRangeFromParsed(c,e,g,l);break}}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,s=[];let i,r,o;for(i=0,r=t.length;i<r;++i)o=t[i][e.axis],Io(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,s=t.iScale,i=t.vScale,r=this.getParsed(e);return{label:s?""+s.getLabelForValue(r[s.axis]):"",value:i?""+i.getLabelForValue(r[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=XHe(sn(this.options.clip,KHe(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,s=this._cachedMeta,i=s.data||[],r=t.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||i.length-a,c=this.options.drawActiveElementsOnTop;let h;for(s.dataset&&s.dataset.draw(e,r,a,l),h=a;h<a+l;++h){const f=i[h];f.hidden||(f.active&&c?o.push(f):f.draw(e,r))}for(h=0;h<o.length;++h)o[h].draw(e,r)}getStyle(e,t){const s=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,t,s){const i=this.getDataset();let r;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];r=o.$context||(o.$context=tje(this.getContext(),e,o)),r.parsed=this.getParsed(e),r.raw=i.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=eje(this.chart.getContext(),this.index)),r.dataset=i,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=s,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",s){const i=t==="active",r=this._cachedDataOpts,o=e+"-"+t,a=r[o],l=this.enableOptionSharing&&H0(s);if(a)return NW(a,l);const c=this.chart.config,h=c.datasetElementScopeKeys(this._type,e),f=i?[`${e}Hover`,"hover",e,""]:[e,""],p=c.getOptionScopes(this.getDataset(),h),g=Object.keys(os.elements[e]),y=()=>this.getContext(s,i,t),x=c.resolveNamedOptions(p,g,y,f);return x.$shared&&(x.$shared=l,r[o]=Object.freeze(NW(x,l))),x}_resolveAnimations(e,t,s){const i=this.chart,r=this._cachedDataOpts,o=`animation-${t}`,a=r[o];if(a)return a;let l;if(i.options.animation!==!1){const h=this.chart.config,f=h.datasetAnimationScopeKeys(this._type,t),p=h.getOptionScopes(this.getDataset(),f);l=h.createResolver(p,this.getContext(e,s,t))}const c=new $Z(i,l&&l.animations);return l&&l._cacheable&&(r[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||NA(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const s=this.resolveDataElementOptions(e,t),i=this._sharedOptions,r=this.getSharedOptions(s),o=this.includeOptions(t,r)||r!==i;return this.updateSharedOptions(r,t,s),{sharedOptions:r,includeOptions:o}}updateElement(e,t,s,i){NA(i)?Object.assign(e,s):this._resolveAnimations(t,i).update(e,s)}updateSharedOptions(e,t,s){e&&!NA(t)&&this._resolveAnimations(void 0,t).update(e,s)}_setStyle(e,t,s,i){e.active=i;const r=this.getStyle(t,i);this._resolveAnimations(t,s,i).update(e,{options:!i&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,t,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const i=s.length,r=t.length,o=Math.min(r,i);o&&this.parse(0,o),r>i?this._insertElements(i,r-i,e):r<i&&this._removeElements(r,i-r)}_insertElements(e,t,s=!0){const i=this._cachedMeta,r=i.data,o=e+t;let a;const l=c=>{for(c.length+=t,a=c.length-1;a>=o;a--)c[a]=c[a-t]};for(l(r),a=e;a<o;++a)r[a]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(e,t),s&&this.updateElements(r,e,t,"reset")}updateElements(e,t,s,i){}_removeElements(e,t){const s=this._cachedMeta;if(this._parsing){const i=s._parsed.splice(e,t);s._stacked&&bb(s,i)}s.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,s,i]=e;this[t](s,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Ut(n0,"defaults",{}),Ut(n0,"datasetElementType",null),Ut(n0,"dataElementType",null);function sje(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let s=[];for(let i=0,r=t.length;i<r;i++)s=s.concat(t[i].controller.getAllParsedValues(n));n._cache.$bar=yZ(s.sort((i,r)=>i-r))}return n._cache.$bar}function ije(n){const e=n.iScale,t=sje(e,n.type);let s=e._length,i,r,o,a;const l=()=>{o===32767||o===-32768||(H0(a)&&(s=Math.min(s,Math.abs(o-a)||s)),a=o)};for(i=0,r=t.length;i<r;++i)o=e.getPixelForValue(t[i]),l();for(a=void 0,i=0,r=e.ticks.length;i<r;++i)o=e.getPixelForTick(i),l();return s}function rje(n,e,t,s){const i=t.barThickness;let r,o;return mn(i)?(r=e.min*t.categoryPercentage,o=t.barPercentage):(r=i*s,o=1),{chunk:r/s,ratio:o,start:e.pixels[n]-r/2}}function oje(n,e,t,s){const i=e.pixels,r=i[n];let o=n>0?i[n-1]:null,a=n<i.length-1?i[n+1]:null;const l=t.categoryPercentage;o===null&&(o=r-(a===null?e.end-e.start:a-r)),a===null&&(a=r+r-o);const c=r-(r-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/s,ratio:t.barPercentage,start:c}}function aje(n,e,t,s){const i=t.parse(n[0],s),r=t.parse(n[1],s),o=Math.min(i,r),a=Math.max(i,r);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[t.axis]=c,e._custom={barStart:l,barEnd:c,start:i,end:r,min:o,max:a}}function PZ(n,e,t,s){return Ns(n)?aje(n,e,t,s):e[t.axis]=t.parse(n,s),e}function AW(n,e,t,s){const i=n.iScale,r=n.vScale,o=i.getLabels(),a=i===r,l=[];let c,h,f,p;for(c=t,h=t+s;c<h;++c)p=e[c],f={},f[i.axis]=a||i.parse(o[c],c),l.push(PZ(p,f,r,c));return l}function AA(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function lje(n,e,t){return n!==0?$u(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function cje(n){let e,t,s,i,r;return n.horizontal?(e=n.base>n.x,t="left",s="right"):(e=n.base<n.y,t="bottom",s="top"),e?(i="end",r="start"):(i="start",r="end"),{start:t,end:s,reverse:e,top:i,bottom:r}}function uje(n,e,t,s){let i=e.borderSkipped;const r={};if(!i){n.borderSkipped=r;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:h}=cje(n);i==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===s?i=c:(t._bottom||0)===s?i=h:(r[RW(h,o,a,l)]=!0,i=c)),r[RW(i,o,a,l)]=!0,n.borderSkipped=r}function RW(n,e,t,s){return s?(n=hje(n,e,t),n=DW(n,t,e)):n=DW(n,e,t),n}function hje(n,e,t){return n===e?t:n===t?e:n}function DW(n,e,t){return n==="start"?e:n==="end"?t:n}function dje(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class q1 extends n0{parsePrimitiveData(e,t,s,i){return AW(e,t,s,i)}parseArrayData(e,t,s,i){return AW(e,t,s,i)}parseObjectData(e,t,s,i){const{iScale:r,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=r.axis==="x"?a:l,h=o.axis==="x"?a:l,f=[];let p,g,y,x;for(p=s,g=s+i;p<g;++p)x=t[p],y={},y[r.axis]=r.parse(xm(x,c),p),f.push(PZ(xm(x,h),y,o,p));return f}updateRangeFromParsed(e,t,s,i){super.updateRangeFromParsed(e,t,s,i);const r=s._custom;r&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:s,vScale:i}=t,r=this.getParsed(e),o=r._custom,a=AA(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(r[i.axis]);return{label:""+s.getLabelForValue(r[s.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,s,i){const r=i==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),h=this._getRuler(),{sharedOptions:f,includeOptions:p}=this._getSharedOptions(t,i);for(let g=t;g<t+s;g++){const y=this.getParsed(g),x=r||mn(y[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(g),v=this._calculateBarIndexPixels(g,h),w=(y._stacks||{})[a.axis],S={horizontal:c,base:x.base,enableBorderRadius:!w||AA(y._custom)||o===w._top||o===w._bottom,x:c?x.head:v.center,y:c?v.center:x.head,height:c?v.size:Math.abs(x.size),width:c?Math.abs(x.size):v.size};p&&(S.options=f||this.resolveDataElementOptions(g,e[g].active?"active":i));const C=S.options||e[g].options;uje(S,C,w,o),dje(S,C,h.ratio),this.updateElement(e[g],g,S,i)}}_getStacks(e,t){const{iScale:s}=this._cachedMeta,i=s.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),r=s.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(t),l=a&&a[s.axis],c=h=>{const f=h._parsed.find(g=>g[s.axis]===l),p=f&&f[h.vScale.axis];if(mn(p)||isNaN(p))return!0};for(const h of i)if(!(t!==void 0&&c(h))&&((r===!1||o.indexOf(h.stack)===-1||r===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,s){const i=this._getStacks(e,s),r=t!==void 0?i.indexOf(t):-1;return r===-1?i.length-1:r}_getRuler(){const e=this.options,t=this._cachedMeta,s=t.iScale,i=[];let r,o;for(r=0,o=t.data.length;r<o;++r)i.push(s.getPixelForValue(this.getParsed(r)[s.axis],r));const a=e.barThickness;return{min:a||ije(t),pixels:i,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:s,index:i},options:{base:r,minBarLength:o}}=this,a=r||0,l=this.getParsed(e),c=l._custom,h=AA(c);let f=l[t.axis],p=0,g=s?this.applyStack(t,l,s):f,y,x;g!==f&&(p=g-f,g=f),h&&(f=c.barStart,g=c.barEnd-c.barStart,f!==0&&$u(f)!==$u(c.barEnd)&&(p=0),p+=f);const v=!mn(r)&&!h?r:p;let w=t.getPixelForValue(v);if(this.chart.getDataVisibility(e)?y=t.getPixelForValue(p+g):y=w,x=y-w,Math.abs(x)<o){x=lje(x,t,a)*o,f===a&&(w-=x/2);const S=t.getPixelForDecimal(0),C=t.getPixelForDecimal(1),I=Math.min(S,C),A=Math.max(S,C);w=Math.max(Math.min(w,A),I),y=w+x,s&&!h&&(l._stacks[t.axis]._visualValues[i]=t.getValueForPixel(y)-t.getValueForPixel(w))}if(w===t.getPixelForValue(a)){const S=$u(x)*t.getLineWidthForValue(a)/2;w+=S,x-=S}return{size:x,base:w,head:y,center:y+x/2}}_calculateBarIndexPixels(e,t){const s=t.scale,i=this.options,r=i.skipNull,o=sn(i.maxBarThickness,1/0);let a,l;if(t.grouped){const c=r?this._getStackCount(e):t.stackCount,h=i.barThickness==="flex"?oje(e,t,i,c):rje(e,t,i,c),f=this._getStackIndex(this.index,this._cachedMeta.stack,r?e:void 0);a=h.start+h.chunk*f+h.chunk/2,l=Math.min(o,h.chunk*h.ratio)}else a=s.getPixelForValue(this.getParsed(e)[s.axis],e),l=Math.min(o,t.min*t.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,s=e.data,i=s.length;let r=0;for(;r<i;++r)this.getParsed(r)[t.axis]!==null&&!s[r].hidden&&s[r].draw(this._ctx)}}Ut(q1,"id","bar"),Ut(q1,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Ut(q1,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function nd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class zL{constructor(e){Ut(this,"options");this.options=e||{}}static override(e){Object.assign(zL.prototype,e)}init(){}formats(){return nd()}parse(){return nd()}format(){return nd()}add(){return nd()}diff(){return nd()}startOf(){return nd()}endOf(){return nd()}}var fje={_date:zL};function pje(n,e,t,s){const{controller:i,data:r,_sorted:o}=n,a=i._cachedMeta.iScale,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&r.length){const c=a._reversePixels?nHe:z2;if(s){if(i._sharedOptions){const h=r[0],f=typeof h.getRange=="function"&&h.getRange(e);if(f){const p=c(r,e,t-f),g=c(r,e,t+f);return{lo:p.lo,hi:g.hi}}}}else{const h=c(r,e,t);if(l){const{vScale:f}=i._cachedMeta,{_parsed:p}=n,g=p.slice(0,h.lo+1).reverse().findIndex(x=>!mn(x[f.axis]));h.lo-=Math.max(0,g);const y=p.slice(h.hi).findIndex(x=>!mn(x[f.axis]));h.hi+=Math.max(0,y)}return h}}return{lo:0,hi:r.length-1}}function SI(n,e,t,s,i){const r=n.getSortedVisibleDatasetMetas(),o=t[e];for(let a=0,l=r.length;a<l;++a){const{index:c,data:h}=r[a],{lo:f,hi:p}=pje(r[a],e,o,i);for(let g=f;g<=p;++g){const y=h[g];y.skip||s(y,c,g)}}}function mje(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(s,i){const r=e?Math.abs(s.x-i.x):0,o=t?Math.abs(s.y-i.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function RA(n,e,t,s,i){const r=[];return!i&&!n.isPointInArea(e)||SI(n,t,e,function(a,l,c){!i&&!SZ(a,n.chartArea,0)||a.inRange(e.x,e.y,s)&&r.push({element:a,datasetIndex:l,index:c})},!0),r}function gje(n,e,t,s){let i=[];function r(o,a,l){const{startAngle:c,endAngle:h}=o.getProps(["startAngle","endAngle"],s),{angle:f}=ZWe(o,{x:e.x,y:e.y});eHe(f,c,h)&&i.push({element:o,datasetIndex:a,index:l})}return SI(n,t,e,r),i}function yje(n,e,t,s,i,r){let o=[];const a=mje(t);let l=Number.POSITIVE_INFINITY;function c(h,f,p){const g=h.inRange(e.x,e.y,i);if(s&&!g)return;const y=h.getCenterPoint(i);if(!(!!r||n.isPointInArea(y))&&!g)return;const v=a(e,y);v<l?(o=[{element:h,datasetIndex:f,index:p}],l=v):v===l&&o.push({element:h,datasetIndex:f,index:p})}return SI(n,t,e,c),o}function DA(n,e,t,s,i,r){return!r&&!n.isPointInArea(e)?[]:t==="r"&&!s?gje(n,e,t,i):yje(n,e,t,s,i,r)}function $W(n,e,t,s,i){const r=[],o=t==="x"?"inXRange":"inYRange";let a=!1;return SI(n,t,e,(l,c,h)=>{l[o]&&l[o](e[t],i)&&(r.push({element:l,datasetIndex:c,index:h}),a=a||l.inRange(e.x,e.y,i))}),s&&!a?[]:r}var bje={modes:{index(n,e,t,s){const i=ld(e,n),r=t.axis||"x",o=t.includeInvisible||!1,a=t.intersect?RA(n,i,r,s,o):DA(n,i,r,!1,s,o),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const h=a[0].index,f=c.data[h];f&&!f.skip&&l.push({element:f,datasetIndex:c.index,index:h})}),l):[]},dataset(n,e,t,s){const i=ld(e,n),r=t.axis||"xy",o=t.includeInvisible||!1;let a=t.intersect?RA(n,i,r,s,o):DA(n,i,r,!1,s,o);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let h=0;h<c.length;++h)a.push({element:c[h],datasetIndex:l,index:h})}return a},point(n,e,t,s){const i=ld(e,n),r=t.axis||"xy",o=t.includeInvisible||!1;return RA(n,i,r,s,o)},nearest(n,e,t,s){const i=ld(e,n),r=t.axis||"xy",o=t.includeInvisible||!1;return DA(n,i,r,t.intersect,s,o)},x(n,e,t,s){const i=ld(e,n);return $W(n,i,"x",t.intersect,s)},y(n,e,t,s){const i=ld(e,n);return $W(n,i,"y",t.intersect,s)}}};const LZ=["left","top","right","bottom"];function vb(n,e){return n.filter(t=>t.pos===e)}function OW(n,e){return n.filter(t=>LZ.indexOf(t.pos)===-1&&t.box.axis===e)}function xb(n,e){return n.sort((t,s)=>{const i=e?s:t,r=e?t:s;return i.weight===r.weight?i.index-r.index:i.weight-r.weight})}function vje(n){const e=[];let t,s,i,r,o,a;for(t=0,s=(n||[]).length;t<s;++t)i=n[t],{position:r,options:{stack:o,stackWeight:a=1}}=i,e.push({index:t,box:i,pos:r,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&r+o,stackWeight:a});return e}function xje(n){const e={};for(const t of n){const{stack:s,pos:i,stackWeight:r}=t;if(!s||!LZ.includes(i))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return e}function wje(n,e){const t=xje(n),{vBoxMaxWidth:s,hBoxMaxHeight:i}=e;let r,o,a;for(r=0,o=n.length;r<o;++r){a=n[r];const{fullSize:l}=a.box,c=t[a.stack],h=c&&a.stackWeight/c.weight;a.horizontal?(a.width=h?h*s:l&&e.availableWidth,a.height=i):(a.width=s,a.height=h?h*i:l&&e.availableHeight)}return t}function _je(n){const e=vje(n),t=xb(e.filter(c=>c.box.fullSize),!0),s=xb(vb(e,"left"),!0),i=xb(vb(e,"right")),r=xb(vb(e,"top"),!0),o=xb(vb(e,"bottom")),a=OW(e,"x"),l=OW(e,"y");return{fullSize:t,leftAndTop:s.concat(r),rightAndBottom:i.concat(l).concat(o).concat(a),chartArea:vb(e,"chartArea"),vertical:s.concat(i).concat(l),horizontal:r.concat(o).concat(a)}}function PW(n,e,t,s){return Math.max(n[t],e[t])+Math.max(n[s],e[s])}function MZ(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function Tje(n,e,t,s){const{pos:i,box:r}=t,o=n.maxPadding;if(!Xt(i)){t.size&&(n[i]-=t.size);const f=s[t.stack]||{size:0,count:1};f.size=Math.max(f.size,t.horizontal?r.height:r.width),t.size=f.size/f.count,n[i]+=t.size}r.getPadding&&MZ(o,r.getPadding());const a=Math.max(0,e.outerWidth-PW(o,n,"left","right")),l=Math.max(0,e.outerHeight-PW(o,n,"top","bottom")),c=a!==n.w,h=l!==n.h;return n.w=a,n.h=l,t.horizontal?{same:c,other:h}:{same:h,other:c}}function Sje(n){const e=n.maxPadding;function t(s){const i=Math.max(e[s]-n[s],0);return n[s]+=i,i}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function Eje(n,e){const t=e.maxPadding;function s(i){const r={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{r[o]=Math.max(e[o],t[o])}),r}return s(n?["left","right"]:["top","bottom"])}function Fb(n,e,t,s){const i=[];let r,o,a,l,c,h;for(r=0,o=n.length,c=0;r<o;++r){a=n[r],l=a.box,l.update(a.width||e.w,a.height||e.h,Eje(a.horizontal,e));const{same:f,other:p}=Tje(e,t,a,s);c|=f&&i.length,h=h||p,l.fullSize||i.push(a)}return c&&Fb(i,e,t,s)||h}function o1(n,e,t,s,i){n.top=t,n.left=e,n.right=e+s,n.bottom=t+i,n.width=s,n.height=i}function LW(n,e,t,s){const i=t.padding;let{x:r,y:o}=e;for(const a of n){const l=a.box,c=s[a.stack]||{placed:0,weight:1},h=a.stackWeight/c.weight||1;if(a.horizontal){const f=e.w*h,p=c.size||l.height;H0(c.start)&&(o=c.start),l.fullSize?o1(l,i.left,o,t.outerWidth-i.right-i.left,p):o1(l,e.left+c.placed,o,f,p),c.start=o,c.placed+=f,o=l.bottom}else{const f=e.h*h,p=c.size||l.width;H0(c.start)&&(r=c.start),l.fullSize?o1(l,r,i.top,p,t.outerHeight-i.bottom-i.top):o1(l,r,e.top+c.placed,p,f),c.start=r,c.placed+=f,r=l.right}}e.x=r,e.y=o}var wo={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,s){if(!n)return;const i=ko(n.options.layout.padding),r=Math.max(e-i.width,0),o=Math.max(t-i.height,0),a=_je(n.boxes),l=a.vertical,c=a.horizontal;nn(n.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const h=l.reduce((x,v)=>v.box.options&&v.box.options.display===!1?x:x+1,0)||1,f=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/h,hBoxMaxHeight:o/2}),p=Object.assign({},i);MZ(p,ko(s));const g=Object.assign({maxPadding:p,w:r,h:o,x:i.left,y:i.top},i),y=wje(l.concat(c),f);Fb(a.fullSize,g,f,y),Fb(l,g,f,y),Fb(c,g,f,y)&&Fb(l,g,f,y),Sje(g),LW(a.leftAndTop,g,f,y),g.x+=g.w,g.y+=g.h,LW(a.rightAndBottom,g,f,y),n.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},nn(a.chartArea,x=>{const v=x.box;Object.assign(v,n.chartArea),v.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class FZ{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,s){}removeEventListener(e,t,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,s,i){return t=Math.max(0,t||e.width),s=s||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):s)}}isAttached(e){return!0}updateConfig(e){}}class Cje extends FZ{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const K1="$chartjs",Ije={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},MW=n=>n===null||n==="";function kje(n,e){const t=n.style,s=n.getAttribute("height"),i=n.getAttribute("width");if(n[K1]={initial:{height:s,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",MW(i)){const r=TW(n,"width");r!==void 0&&(n.width=r)}if(MW(s))if(n.style.height==="")n.height=n.width/(e||2);else{const r=TW(n,"height");r!==void 0&&(n.height=r)}return n}const VZ=zHe?{passive:!0}:!1;function Nje(n,e,t){n&&n.addEventListener(e,t,VZ)}function Aje(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,VZ)}function Rje(n,e){const t=Ije[n.type]||n.type,{x:s,y:i}=ld(n,e);return{type:t,chart:e,native:n,x:s!==void 0?s:null,y:i!==void 0?i:null}}function yS(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function Dje(n,e,t){const s=n.canvas,i=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||yS(a.addedNodes,s),o=o&&!yS(a.removedNodes,s);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function $je(n,e,t){const s=n.canvas,i=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||yS(a.removedNodes,s),o=o&&!yS(a.addedNodes,s);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const G0=new Map;let FW=0;function zZ(){const n=window.devicePixelRatio;n!==FW&&(FW=n,G0.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function Oje(n,e){G0.size||window.addEventListener("resize",zZ),G0.set(n,e)}function Pje(n){G0.delete(n),G0.size||window.removeEventListener("resize",zZ)}function Lje(n,e,t){const s=n.canvas,i=s&&VL(s);if(!i)return;const r=vZ((a,l)=>{const c=i.clientWidth;t(a,l),c<i.clientWidth&&t()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,h=l.contentRect.height;c===0&&h===0||r(c,h)});return o.observe(i),Oje(n,r),o}function $A(n,e,t){t&&t.disconnect(),e==="resize"&&Pje(n)}function Mje(n,e,t){const s=n.canvas,i=vZ(r=>{n.ctx!==null&&t(Rje(r,n))},n);return Nje(s,e,i),i}class Fje extends FZ{acquireContext(e,t){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(kje(e,t),s):null}releaseContext(e){const t=e.canvas;if(!t[K1])return!1;const s=t[K1].initial;["height","width"].forEach(r=>{const o=s[r];mn(o)?t.removeAttribute(r):t.setAttribute(r,o)});const i=s.style||{};return Object.keys(i).forEach(r=>{t.style[r]=i[r]}),t.width=t.width,delete t[K1],!0}addEventListener(e,t,s){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),o={attach:Dje,detach:$je,resize:Lje}[t]||Mje;i[t]=o(e,t,s)}removeEventListener(e,t){const s=e.$proxies||(e.$proxies={}),i=s[t];if(!i)return;({attach:$A,detach:$A,resize:$A}[t]||Aje)(e,t,i),s[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,s,i){return VHe(e,t,s,i)}isAttached(e){const t=e&&VL(e);return!!(t&&t.isConnected)}}function Vje(n){return!FL()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?Cje:Fje}var b1;let ey=(b1=class{constructor(){Ut(this,"x");Ut(this,"y");Ut(this,"active",!1);Ut(this,"options");Ut(this,"$animations")}tooltipPosition(e){const{x:t,y:s}=this.getProps(["x","y"],e);return{x:t,y:s}}hasValue(){return pS(this.x)&&pS(this.y)}getProps(e,t){const s=this.$animations;if(!t||!s)return this;const i={};return e.forEach(r=>{i[r]=s[r]&&s[r].active()?s[r]._to:this[r]}),i}},Ut(b1,"defaults",{}),Ut(b1,"defaultRoutes"),b1);function zje(n,e){const t=n.options.ticks,s=Bje(n),i=Math.min(t.maxTicksLimit||s,s),r=t.major.enabled?Wje(e):[],o=r.length,a=r[0],l=r[o-1],c=[];if(o>i)return Hje(e,c,r,o/i),c;const h=Uje(r,e,i);if(o>0){let f,p;const g=o>1?Math.round((l-a)/(o-1)):null;for(a1(e,c,h,mn(g)?0:a-g,a),f=0,p=o-1;f<p;f++)a1(e,c,h,r[f],r[f+1]);return a1(e,c,h,l,mn(g)?e.length:l+g),c}return a1(e,c,h),c}function Bje(n){const e=n.options.offset,t=n._tickSize(),s=n._length/t+(e?0:1),i=n._maxLength/t;return Math.floor(Math.min(s,i))}function Uje(n,e,t){const s=jje(n),i=e.length/t;if(!s)return Math.max(i,1);const r=qWe(s);for(let o=0,a=r.length-1;o<a;o++){const l=r[o];if(l>i)return l}return Math.max(i,1)}function Wje(n){const e=[];let t,s;for(t=0,s=n.length;t<s;t++)n[t].major&&e.push(t);return e}function Hje(n,e,t,s){let i=0,r=t[0],o;for(s=Math.ceil(s),o=0;o<n.length;o++)o===r&&(e.push(n[o]),i++,r=t[i*s])}function a1(n,e,t,s,i){const r=sn(s,0),o=Math.min(sn(i,n.length),n.length);let a=0,l,c,h;for(t=Math.ceil(t),i&&(l=i-s,t=l/Math.floor(l/t)),h=r;h<0;)a++,h=Math.round(r+a*t);for(c=Math.max(r,0);c<o;c++)c===h&&(e.push(n[c]),a++,h=Math.round(r+a*t))}function jje(n){const e=n.length;let t,s;if(e<2)return!1;for(s=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==s)return!1;return s}const Gje=n=>n==="left"?"right":n==="right"?"left":n,VW=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,zW=(n,e)=>Math.min(e||n,n);function BW(n,e){const t=[],s=n.length/e,i=n.length;let r=0;for(;r<i;r+=s)t.push(n[Math.floor(r)]);return t}function qje(n,e,t){const s=n.ticks.length,i=Math.min(e,s-1),r=n._startPixel,o=n._endPixel,a=1e-6;let l=n.getPixelForTick(i),c;if(!(t&&(s===1?c=Math.max(l-r,o-l):e===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(i-1))/2,l+=i<e?c:-c,l<r-a||l>o+a)))return l}function Kje(n,e){nn(n,t=>{const s=t.gc,i=s.length/2;let r;if(i>e){for(r=0;r<i;++r)delete t.data[s[r]];s.splice(0,i)}})}function wb(n){return n.drawTicks?n.tickLength:0}function UW(n,e){if(!n.display)return 0;const t=Oi(n.font,e),s=ko(n.padding);return(Ns(n.text)?n.text.length:1)*t.lineHeight+s.height}function Xje(n,e){return Jg(n,{scale:e,type:"scale"})}function Yje(n,e,t){return Jg(n,{tick:t,index:e,type:"tick"})}function Qje(n,e,t){let s=DL(n);return(t&&e!=="right"||!t&&e==="right")&&(s=Gje(s)),s}function Zje(n,e,t,s){const{top:i,left:r,bottom:o,right:a,chart:l}=n,{chartArea:c,scales:h}=l;let f=0,p,g,y;const x=o-i,v=a-r;if(n.isHorizontal()){if(g=wi(s,r,a),Xt(t)){const w=Object.keys(t)[0],S=t[w];y=h[w].getPixelForValue(S)+x-e}else t==="center"?y=(c.bottom+c.top)/2+x-e:y=VW(n,t,e);p=a-r}else{if(Xt(t)){const w=Object.keys(t)[0],S=t[w];g=h[w].getPixelForValue(S)-v+e}else t==="center"?g=(c.left+c.right)/2-v+e:g=VW(n,t,e);y=wi(s,o,i),f=t==="left"?-qo:qo}return{titleX:g,titleY:y,maxWidth:p,rotation:f}}class ty extends ey{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:s,_suggestedMax:i}=this;return e=Ia(e,Number.POSITIVE_INFINITY),t=Ia(t,Number.NEGATIVE_INFINITY),s=Ia(s,Number.POSITIVE_INFINITY),i=Ia(i,Number.NEGATIVE_INFINITY),{min:Ia(e,s),max:Ia(t,i),minDefined:Io(e),maxDefined:Io(t)}}getMinMax(e){let{min:t,max:s,minDefined:i,maxDefined:r}=this.getUserBounds(),o;if(i&&r)return{min:t,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),i||(t=Math.min(t,o.min)),r||(s=Math.max(s,o.max));return t=r&&t>s?s:t,s=i&&t>s?t:s,{min:Ia(t,Ia(s,t)),max:Ia(s,Ia(t,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Sn(this.options.beforeUpdate,[this])}update(e,t,s){const{beginAtZero:i,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=SHe(this,r,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?BW(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=zje(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,s;this.isHorizontal()?(t=this.left,s=this.right):(t=this.top,s=this.bottom,e=!e),this._startPixel=t,this._endPixel=s,this._reversePixels=e,this._length=s-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Sn(this.options.afterUpdate,[this])}beforeSetDimensions(){Sn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Sn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Sn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Sn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let s,i,r;for(s=0,i=e.length;s<i;s++)r=e[s],r.label=Sn(t.callback,[r.value,s,e],this)}afterTickToLabelConversion(){Sn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Sn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,s=zW(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,r=t.maxRotation;let o=i,a,l,c;if(!this._isVisible()||!t.display||i>=r||s<=1||!this.isHorizontal()){this.labelRotation=i;return}const h=this._getLabelSizes(),f=h.widest.width,p=h.highest.height,g=Ko(this.chart.width-f,0,this.maxWidth);a=e.offset?this.maxWidth/s:g/(s-1),f+6>a&&(a=g/(s-(e.offset?.5:1)),l=this.maxHeight-wb(e.grid)-t.padding-UW(e.title,this.chart.options.font),c=Math.sqrt(f*f+p*p),o=QWe(Math.min(Math.asin(Ko((h.highest.height+6)/a,-1,1)),Math.asin(Ko(l/c,-1,1))-Math.asin(Ko(p/c,-1,1)))),o=Math.max(i,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){Sn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Sn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:s,title:i,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=UW(i,t.options.font);if(a?(e.width=this.maxWidth,e.height=wb(r)+l):(e.height=this.maxHeight,e.width=wb(r)+l),s.display&&this.ticks.length){const{first:c,last:h,widest:f,highest:p}=this._getLabelSizes(),g=s.padding*2,y=wd(this.labelRotation),x=Math.cos(y),v=Math.sin(y);if(a){const w=s.mirror?0:v*f.width+x*p.height;e.height=Math.min(this.maxHeight,e.height+w+g)}else{const w=s.mirror?0:x*f.width+v*p.height;e.width=Math.min(this.maxWidth,e.width+w+g)}this._calculatePadding(c,h,v,x)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,s,i){const{ticks:{align:r,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let p=0,g=0;l?c?(p=i*e.width,g=s*t.height):(p=s*e.height,g=i*t.width):r==="start"?g=t.width:r==="end"?p=e.width:r!=="inner"&&(p=e.width/2,g=t.width/2),this.paddingLeft=Math.max((p-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((g-f+o)*this.width/(this.width-f),0)}else{let h=t.height/2,f=e.height/2;r==="start"?(h=0,f=e.height):r==="end"&&(h=t.height,f=0),this.paddingTop=h+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Sn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,s;for(t=0,s=e.length;t<s;t++)mn(e[t].label)&&(e.splice(t,1),s--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let s=this.ticks;t<s.length&&(s=BW(s,t)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,s){const{ctx:i,_longestTextCache:r}=this,o=[],a=[],l=Math.floor(t/zW(t,s));let c=0,h=0,f,p,g,y,x,v,w,S,C,I,A;for(f=0;f<t;f+=l){if(y=e[f].label,x=this._resolveTickFontOptions(f),i.font=v=x.string,w=r[v]=r[v]||{data:{},gc:[]},S=x.lineHeight,C=I=0,!mn(y)&&!Ns(y))C=yW(i,w.data,w.gc,C,y),I=S;else if(Ns(y))for(p=0,g=y.length;p<g;++p)A=y[p],!mn(A)&&!Ns(A)&&(C=yW(i,w.data,w.gc,C,A),I+=S);o.push(C),a.push(I),c=Math.max(C,c),h=Math.max(I,h)}Kje(r,t);const L=o.indexOf(c),O=a.indexOf(h),N=k=>({width:o[k]||0,height:a[k]||0});return{first:N(0),last:N(t-1),widest:N(L),highest:N(O),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return tHe(this._alignToPixels?td(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const s=t[e];return s.$context||(s.$context=Yje(this.getContext(),e,s))}return this.$context||(this.$context=Xje(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=wd(this.labelRotation),s=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),r=this._getLabelSizes(),o=e.autoSkipPadding||0,a=r?r.widest.width+o:0,l=r?r.highest.height+o:0;return this.isHorizontal()?l*s>a*i?a/s:l/i:l*i<a*s?l/s:a/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,s=this.chart,i=this.options,{grid:r,position:o,border:a}=i,l=r.offset,c=this.isHorizontal(),f=this.ticks.length+(l?1:0),p=wb(r),g=[],y=a.setContext(this.getContext()),x=y.display?y.width:0,v=x/2,w=function(G){return td(s,G,x)};let S,C,I,A,L,O,N,k,$,R,z,V;if(o==="top")S=w(this.bottom),O=this.bottom-p,k=S-v,R=w(e.top)+v,V=e.bottom;else if(o==="bottom")S=w(this.top),R=e.top,V=w(e.bottom)-v,O=S+v,k=this.top+p;else if(o==="left")S=w(this.right),L=this.right-p,N=S-v,$=w(e.left)+v,z=e.right;else if(o==="right")S=w(this.left),$=e.left,z=w(e.right)-v,L=S+v,N=this.left+p;else if(t==="x"){if(o==="center")S=w((e.top+e.bottom)/2+.5);else if(Xt(o)){const G=Object.keys(o)[0],J=o[G];S=w(this.chart.scales[G].getPixelForValue(J))}R=e.top,V=e.bottom,O=S+v,k=O+p}else if(t==="y"){if(o==="center")S=w((e.left+e.right)/2);else if(Xt(o)){const G=Object.keys(o)[0],J=o[G];S=w(this.chart.scales[G].getPixelForValue(J))}L=S-v,N=L-p,$=e.left,z=e.right}const ne=sn(i.ticks.maxTicksLimit,f),Q=Math.max(1,Math.ceil(f/ne));for(C=0;C<f;C+=Q){const G=this.getContext(C),J=r.setContext(G),Z=a.setContext(G),le=J.lineWidth,H=J.color,ee=Z.dash||[],he=Z.dashOffset,ae=J.tickWidth,pe=J.tickColor,_e=J.tickBorderDash||[],Ee=J.tickBorderDashOffset;I=qje(this,C,l),I!==void 0&&(A=td(s,I,le),c?L=N=$=z=A:O=k=R=V=A,g.push({tx1:L,ty1:O,tx2:N,ty2:k,x1:$,y1:R,x2:z,y2:V,width:le,color:H,borderDash:ee,borderDashOffset:he,tickWidth:ae,tickColor:pe,tickBorderDash:_e,tickBorderDashOffset:Ee}))}return this._ticksLength=f,this._borderValue=S,g}_computeLabelItems(e){const t=this.axis,s=this.options,{position:i,ticks:r}=s,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:h,mirror:f}=r,p=wb(s.grid),g=p+h,y=f?-h:g,x=-wd(this.labelRotation),v=[];let w,S,C,I,A,L,O,N,k,$,R,z,V="middle";if(i==="top")L=this.bottom-y,O=this._getXAxisLabelAlignment();else if(i==="bottom")L=this.top+y,O=this._getXAxisLabelAlignment();else if(i==="left"){const Q=this._getYAxisLabelAlignment(p);O=Q.textAlign,A=Q.x}else if(i==="right"){const Q=this._getYAxisLabelAlignment(p);O=Q.textAlign,A=Q.x}else if(t==="x"){if(i==="center")L=(e.top+e.bottom)/2+g;else if(Xt(i)){const Q=Object.keys(i)[0],G=i[Q];L=this.chart.scales[Q].getPixelForValue(G)+g}O=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")A=(e.left+e.right)/2-g;else if(Xt(i)){const Q=Object.keys(i)[0],G=i[Q];A=this.chart.scales[Q].getPixelForValue(G)}O=this._getYAxisLabelAlignment(p).textAlign}t==="y"&&(l==="start"?V="top":l==="end"&&(V="bottom"));const ne=this._getLabelSizes();for(w=0,S=a.length;w<S;++w){C=a[w],I=C.label;const Q=r.setContext(this.getContext(w));N=this.getPixelForTick(w)+r.labelOffset,k=this._resolveTickFontOptions(w),$=k.lineHeight,R=Ns(I)?I.length:1;const G=R/2,J=Q.color,Z=Q.textStrokeColor,le=Q.textStrokeWidth;let H=O;o?(A=N,O==="inner"&&(w===S-1?H=this.options.reverse?"left":"right":w===0?H=this.options.reverse?"right":"left":H="center"),i==="top"?c==="near"||x!==0?z=-R*$+$/2:c==="center"?z=-ne.highest.height/2-G*$+$:z=-ne.highest.height+$/2:c==="near"||x!==0?z=$/2:c==="center"?z=ne.highest.height/2-G*$:z=ne.highest.height-R*$,f&&(z*=-1),x!==0&&!Q.showLabelBackdrop&&(A+=$/2*Math.sin(x))):(L=N,z=(1-R)*$/2);let ee;if(Q.showLabelBackdrop){const he=ko(Q.backdropPadding),ae=ne.heights[w],pe=ne.widths[w];let _e=z-he.top,Ee=0-he.left;switch(V){case"middle":_e-=ae/2;break;case"bottom":_e-=ae;break}switch(O){case"center":Ee-=pe/2;break;case"right":Ee-=pe;break;case"inner":w===S-1?Ee-=pe:w>0&&(Ee-=pe/2);break}ee={left:Ee,top:_e,width:pe+he.width,height:ae+he.height,color:Q.backdropColor}}v.push({label:I,font:k,textOffset:z,options:{rotation:x,color:J,strokeColor:Z,strokeWidth:le,textAlign:H,textBaseline:V,translation:[A,L],backdrop:ee}})}return v}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-wd(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:s,mirror:i,padding:r}}=this.options,o=this._getLabelSizes(),a=e+r,l=o.widest.width;let c,h;return t==="left"?i?(h=this.right+r,s==="near"?c="left":s==="center"?(c="center",h+=l/2):(c="right",h+=l)):(h=this.right-a,s==="near"?c="right":s==="center"?(c="center",h-=l/2):(c="left",h=this.left)):t==="right"?i?(h=this.left+r,s==="near"?c="right":s==="center"?(c="center",h-=l/2):(c="left",h-=l)):(h=this.left+a,s==="near"?c="left":s==="center"?(c="center",h+=l/2):(c="right",h=this.right)):c="right",{textAlign:c,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:s,top:i,width:r,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(s,i,r,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(r=>r.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,s=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let r,o;const a=(l,c,h)=>{!h.width||!h.color||(s.save(),s.lineWidth=h.width,s.strokeStyle=h.color,s.setLineDash(h.borderDash||[]),s.lineDashOffset=h.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(t.display)for(r=0,o=i.length;r<o;++r){const l=i[r];t.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:s,grid:i}}=this,r=s.setContext(this.getContext()),o=s.display?r.width:0;if(!o)return;const a=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,h,f,p;this.isHorizontal()?(c=td(e,this.left,o)-o/2,h=td(e,this.right,a)+a/2,f=p=l):(f=td(e,this.top,o)-o/2,p=td(e,this.bottom,a)+a/2,c=h=l),t.save(),t.lineWidth=r.width,t.strokeStyle=r.color,t.beginPath(),t.moveTo(c,f),t.lineTo(h,p),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,i=this._computeLabelArea();i&&$L(s,i);const r=this.getLabelItems(e);for(const o of r){const a=o.options,l=o.font,c=o.label,h=o.textOffset;j0(s,c,0,h,l,a)}i&&OL(s)}drawTitle(){const{ctx:e,options:{position:t,title:s,reverse:i}}=this;if(!s.display)return;const r=Oi(s.font),o=ko(s.padding),a=s.align;let l=r.lineHeight/2;t==="bottom"||t==="center"||Xt(t)?(l+=o.bottom,Ns(s.text)&&(l+=r.lineHeight*(s.text.length-1))):l+=o.top;const{titleX:c,titleY:h,maxWidth:f,rotation:p}=Zje(this,l,t,a);j0(e,s.text,0,0,r,{color:s.color,maxWidth:f,rotation:p,textAlign:Qje(a,t,i),textBaseline:"middle",translation:[c,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,s=sn(e.grid&&e.grid.z,-1),i=sn(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==ty.prototype.draw?[{z:t,draw:r=>{this.draw(r)}}]:[{z:s,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",i=[];let r,o;for(r=0,o=t.length;r<o;++r){const a=t[r];a[s]===this.id&&(!e||a.type===e)&&i.push(a)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Oi(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class l1{constructor(e,t,s){this.type=e,this.scope=t,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let s;t6e(t)&&(s=this.register(t));const i=this.items,r=e.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in i||(i[r]=e,Jje(e,o,s),this.override&&os.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,s=e.id,i=this.scope;s in t&&delete t[s],i&&s in os[i]&&(delete os[i][s],this.override&&delete sf[s])}}function Jje(n,e,t){const s=W0(Object.create(null),[t?os.get(t):{},os.get(e),n.defaults]);os.set(e,s),n.defaultRoutes&&e6e(e,n.defaultRoutes),n.descriptors&&os.describe(e,n.descriptors)}function e6e(n,e){Object.keys(e).forEach(t=>{const s=t.split("."),i=s.pop(),r=[n].concat(s).join("."),o=e[t].split("."),a=o.pop(),l=o.join(".");os.route(r,i,l,a)})}function t6e(n){return"id"in n&&"defaults"in n}class n6e{constructor(){this.controllers=new l1(n0,"datasets",!0),this.elements=new l1(ey,"elements"),this.plugins=new l1(Object,"plugins"),this.scales=new l1(ty,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,s){[...t].forEach(i=>{const r=s||this._getRegistryForType(i);s||r.isForType(i)||r===this.plugins&&i.id?this._exec(e,r,i):nn(i,o=>{const a=s||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,t,s){const i=AL(e);Sn(s["before"+i],[],s),t[e](s),Sn(s["after"+i],[],s)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const s=this._typedRegistries[t];if(s.isForType(e))return s}return this.plugins}_get(e,t,s){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return i}}var Na=new n6e;class s6e{constructor(){this._init=[]}notify(e,t,s,i){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const r=i?this._descriptors(e).filter(i):this._descriptors(e),o=this._notify(r,e,t,s);return t==="afterDestroy"&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,t,s,i){i=i||{};for(const r of e){const o=r.plugin,a=o[s],l=[t,i,r.options];if(Sn(a,l,o)===!1&&i.cancelable)return!1}return!0}invalidate(){mn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const s=e&&e.config,i=sn(s.options&&s.options.plugins,{}),r=i6e(s);return i===!1&&!t?[]:o6e(e,r,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],s=this._cache,i=(r,o)=>r.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(i(t,s),e,"stop"),this._notify(i(s,t),e,"start")}}function i6e(n){const e={},t=[],s=Object.keys(Na.plugins.items);for(let r=0;r<s.length;r++)t.push(Na.getPlugin(s[r]));const i=n.plugins||[];for(let r=0;r<i.length;r++){const o=i[r];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function r6e(n,e){return!e&&n===!1?null:n===!0?{}:n}function o6e(n,{plugins:e,localIds:t},s,i){const r=[],o=n.getContext();for(const a of e){const l=a.id,c=r6e(s[l],i);c!==null&&r.push({plugin:a,options:a6e(n.config,{plugin:a,local:t[l]},c,o)})}return r}function a6e(n,{plugin:e,local:t},s,i){const r=n.pluginScopeKeys(e),o=n.getOptionScopes(s,r);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function U2(n,e){const t=os.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function l6e(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function c6e(n,e){return n===e?"_index_":"_value_"}function WW(n){if(n==="x"||n==="y"||n==="r")return n}function u6e(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function W2(n,...e){if(WW(n))return n;for(const t of e){const s=t.axis||u6e(t.position)||n.length>1&&WW(n[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function HW(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function h6e(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(s=>s.xAxisID===n||s.yAxisID===n);if(t.length)return HW(n,"x",t[0])||HW(n,"y",t[0])}return{}}function d6e(n,e){const t=sf[n.type]||{scales:{}},s=e.scales||{},i=U2(n.type,e),r=Object.create(null);return Object.keys(s).forEach(o=>{const a=s[o];if(!Xt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=W2(o,a,h6e(o,n),os.scales[a.type]),c=c6e(l,i),h=t.scales||{};r[o]=Jb(Object.create(null),[{axis:l},a,h[l],h[c]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,l=o.indexAxis||U2(a,e),h=(sf[a]||{}).scales||{};Object.keys(h).forEach(f=>{const p=l6e(f,l),g=o[p+"AxisID"]||p;r[g]=r[g]||Object.create(null),Jb(r[g],[{axis:p},s[g],h[f]])})}),Object.keys(r).forEach(o=>{const a=r[o];Jb(a,[os.scales[a.type],os.scale])}),r}function BZ(n){const e=n.options||(n.options={});e.plugins=sn(e.plugins,{}),e.scales=d6e(n,e)}function UZ(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function f6e(n){return n=n||{},n.data=UZ(n.data),BZ(n),n}const jW=new Map,WZ=new Set;function c1(n,e){let t=jW.get(n);return t||(t=e(),jW.set(n,t),WZ.add(t)),t}const _b=(n,e,t)=>{const s=xm(e,t);s!==void 0&&n.add(s)};class p6e{constructor(e){this._config=f6e(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=UZ(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),BZ(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return c1(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return c1(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return c1(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,s=this.type;return c1(`${s}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const s=this._scopeCache;let i=s.get(e);return(!i||t)&&(i=new Map,s.set(e,i)),i}getOptionScopes(e,t,s){const{options:i,type:r}=this,o=this._cachedScopes(e,s),a=o.get(t);if(a)return a;const l=new Set;t.forEach(h=>{e&&(l.add(e),h.forEach(f=>_b(l,e,f))),h.forEach(f=>_b(l,i,f)),h.forEach(f=>_b(l,sf[r]||{},f)),h.forEach(f=>_b(l,os,f)),h.forEach(f=>_b(l,B2,f))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),WZ.has(t)&&o.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,sf[t]||{},os.datasets[t]||{},{type:t},os,B2]}resolveNamedOptions(e,t,s,i=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=GW(this._resolverCache,e,i);let l=o;if(g6e(o,t)){r.$shared=!1,s=th(s)?s():s;const c=this.createResolver(e,s,a);l=wm(o,s,c)}for(const c of t)r[c]=l[c];return r}createResolver(e,t,s=[""],i){const{resolver:r}=GW(this._resolverCache,e,s);return Xt(t)?wm(r,t,void 0,i):r}}function GW(n,e,t){let s=n.get(e);s||(s=new Map,n.set(e,s));const i=t.join();let r=s.get(i);return r||(r={resolver:PL(e,t),subPrefixes:t.filter(a=>!a.toLowerCase().includes("hover"))},s.set(i,r)),r}const m6e=n=>Xt(n)&&Object.getOwnPropertyNames(n).some(e=>th(n[e]));function g6e(n,e){const{isScriptable:t,isIndexable:s}=IZ(n);for(const i of e){const r=t(i),o=s(i),a=(o||r)&&n[i];if(r&&(th(a)||m6e(a))||o&&Ns(a))return!0}return!1}var y6e="4.4.8";const b6e=["top","bottom","left","right","chartArea"];function qW(n,e){return n==="top"||n==="bottom"||b6e.indexOf(n)===-1&&e==="x"}function KW(n,e){return function(t,s){return t[n]===s[n]?t[e]-s[e]:t[n]-s[n]}}function XW(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Sn(t&&t.onComplete,[n],e)}function v6e(n){const e=n.chart,t=e.options.animation;Sn(t&&t.onProgress,[n],e)}function HZ(n){return FL()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const X1={},YW=n=>{const e=HZ(n);return Object.values(X1).filter(t=>t.canvas===e).pop()};function x6e(n,e,t){const s=Object.keys(n);for(const i of s){const r=+i;if(r>=e){const o=n[i];delete n[i],(t>0||r>e)&&(n[r+t]=o)}}}function w6e(n,e,t,s){return!t||n.type==="mouseout"?null:s?e:n}function u1(n,e,t){return n.options.clip?n[t]:e[t]}function _6e(n,e){const{xScale:t,yScale:s}=n;return t&&s?{left:u1(t,e,"left"),right:u1(t,e,"right"),top:u1(s,e,"top"),bottom:u1(s,e,"bottom")}:e}var lu;let EI=(lu=class{static register(...e){Na.add(...e),QW()}static unregister(...e){Na.remove(...e),QW()}constructor(e,t){const s=this.config=new p6e(t),i=HZ(e),r=YW(i);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||Vje(i)),this.platform.updateConfig(s);const a=this.platform.acquireContext(i,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,h=l&&l.width;if(this.id=VWe(),this.ctx=a,this.canvas=l,this.width=h,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new s6e,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=rHe(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],X1[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Pl.listen(this,"complete",XW),Pl.listen(this,"progress",v6e),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:s,height:i,_aspectRatio:r}=this;return mn(e)?t&&r?r:i?s/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Na}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():_W(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return bW(this.canvas,this.ctx),this}stop(){return Pl.stop(this),this}resize(e,t){Pl.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const s=this.options,i=this.canvas,r=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,e,t,r),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,_W(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Sn(s.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};nn(t,(s,i)=>{s.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,s=this.scales,i=Object.keys(s).reduce((o,a)=>(o[a]=!1,o),{});let r=[];t&&(r=r.concat(Object.keys(t).map(o=>{const a=t[o],l=W2(o,a),c=l==="r",h=l==="x";return{options:a,dposition:c?"chartArea":h?"bottom":"left",dtype:c?"radialLinear":h?"category":"linear"}}))),nn(r,o=>{const a=o.options,l=a.id,c=W2(l,a),h=sn(a.type,o.dtype);(a.position===void 0||qW(a.position,c)!==qW(o.dposition))&&(a.position=o.dposition),i[l]=!0;let f=null;if(l in s&&s[l].type===h)f=s[l];else{const p=Na.getScale(h);f=new p({id:l,type:h,ctx:this.ctx,chart:this}),s[f.id]=f}f.init(a,e)}),nn(i,(o,a)=>{o||delete s[a]}),nn(s,o=>{wo.configure(this,o,o.options),wo.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,s=e.length;if(e.sort((i,r)=>i.index-r.index),s>t){for(let i=t;i<s;++i)this._destroyDatasetMeta(i);e.splice(t,s-t)}this._sortedMetasets=e.slice(0).sort(KW("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((s,i)=>{t.filter(r=>r===s._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let s,i;for(this._removeUnreferencedMetasets(),s=0,i=t.length;s<i;s++){const r=t[s];let o=this.getDatasetMeta(s);const a=r.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=a,o.indexAxis=r.indexAxis||U2(a,this.options),o.order=r.order||0,o.index=s,o.label=""+r.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const l=Na.getController(a),{datasetElementType:c,dataElementType:h}=os.datasets[a];Object.assign(l,{dataElementType:Na.getElement(h),datasetElementType:c&&Na.getElement(c)}),o.controller=new l(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){nn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const s=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,h=this.data.datasets.length;c<h;c++){const{controller:f}=this.getDatasetMeta(c),p=!i&&r.indexOf(f)===-1;f.buildOrUpdateElements(p),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),i||nn(r,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(KW("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){nn(this.scales,e=>{wo.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!lW(t,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:s,start:i,count:r}of t){const o=s==="_removeElements"?-r:r;x6e(e,i,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,s=r=>new Set(e.filter(o=>o[0]===r).map((o,a)=>a+","+o.splice(1).join(","))),i=s(0);for(let r=1;r<t;r++)if(!lW(i,s(r)))return;return Array.from(i).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;wo.update(this,this.width,this.height,e);const t=this.chartArea,s=t.width<=0||t.height<=0;this._layers=[],nn(this.boxes,i=>{s&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,r)=>{i._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,s=this.data.datasets.length;t<s;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,s=this.data.datasets.length;t<s;++t)this._updateDataset(t,th(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const s=this.getDatasetMeta(e),i={meta:s,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(s.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Pl.has(this)?this.attached&&!Pl.running(this)&&Pl.start(this):(this.draw(),XW({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,s=[];let i,r;for(i=0,r=t.length;i<r;++i){const o=t[i];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,s=e._clip,i=!s.disabled,r=_6e(e,this.chartArea),o={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",o)!==!1&&(i&&$L(t,{left:s.left===!1?0:r.left-s.left,right:s.right===!1?this.width:r.right+s.right,top:s.top===!1?0:r.top-s.top,bottom:s.bottom===!1?this.height:r.bottom+s.bottom}),e.controller.draw(),i&&OL(t),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(e){return SZ(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,s,i){const r=bje.modes[t];return typeof r=="function"?r(this,e,s,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],s=this._metasets;let i=s.filter(r=>r&&r._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},s.push(i)),i}getContext(){return this.$context||(this.$context=Jg(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!t.hidden}setDatasetVisibility(e,t){const s=this.getDatasetMeta(e);s.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,s){const i=s?"show":"hide",r=this.getDatasetMeta(e),o=r.controller._resolveAnimations(void 0,i);H0(t)?(r.data[t].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(r,{visible:s}),this.update(a=>a.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Pl.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),bW(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete X1[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,s=(r,o)=>{t.addEventListener(this,r,o),e[r]=o},i=(r,o,a)=>{r.offsetX=o,r.offsetY=a,this._eventHandler(r)};nn(this.options.events,r=>s(r,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,s=(l,c)=>{t.addEventListener(this,l,c),e[l]=c},i=(l,c)=>{e[l]&&(t.removeEventListener(this,l,c),delete e[l])},r=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),s("resize",r),s("detach",o)};o=()=>{this.attached=!1,i("resize",r),this._stop(),this._resize(0,0),s("attach",a)},t.isAttached(this.canvas)?a():o()}unbindEvents(){nn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},nn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,s){const i=s?"set":"remove";let r,o,a,l;for(t==="dataset"&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+i+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],s=e.map(({datasetIndex:r,index:o})=>{const a=this.getDatasetMeta(r);if(!a)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:a.data[o],index:o}});!hS(s,t)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,t))}notifyPlugins(e,t,s){return this._plugins.notify(this,e,t,s)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,s){const i=this.options.hover,r=(l,c)=>l.filter(h=>!c.some(f=>h.datasetIndex===f.datasetIndex&&h.index===f.index)),o=r(t,e),a=s?e:r(e,t);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(e,t){const s={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,i)===!1)return;const r=this._handleEvent(e,t,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,i),(r||s.changed)&&this.render(),this}_handleEvent(e,t,s){const{_active:i=[],options:r}=this,o=t,a=this._getActiveElements(e,i,s,o),l=jWe(e),c=w6e(e,this._lastEvent,s,l);s&&(this._lastEvent=null,Sn(r.onHover,[e,a,this],this),l&&Sn(r.onClick,[e,a,this],this));const h=!hS(a,i);return(h||t)&&(this._active=a,this._updateHoverStyles(a,i,t)),this._lastEvent=c,h}_getActiveElements(e,t,s,i){if(e.type==="mouseout")return[];if(!s)return t;const r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,i)}},Ut(lu,"defaults",os),Ut(lu,"instances",X1),Ut(lu,"overrides",sf),Ut(lu,"registry",Na),Ut(lu,"version",y6e),Ut(lu,"getChart",YW),lu);function QW(){return nn(EI.instances,n=>n._plugins.invalidate())}function jZ(n,e){const{x:t,y:s,base:i,width:r,height:o}=n.getProps(["x","y","base","width","height"],e);let a,l,c,h,f;return n.horizontal?(f=o/2,a=Math.min(t,i),l=Math.max(t,i),c=s-f,h=s+f):(f=r/2,a=t-f,l=t+f,c=Math.min(s,i),h=Math.max(s,i)),{left:a,top:c,right:l,bottom:h}}function wu(n,e,t,s){return n?0:Ko(e,t,s)}function T6e(n,e,t){const s=n.options.borderWidth,i=n.borderSkipped,r=CZ(s);return{t:wu(i.top,r.top,0,t),r:wu(i.right,r.right,0,e),b:wu(i.bottom,r.bottom,0,t),l:wu(i.left,r.left,0,e)}}function S6e(n,e,t){const{enableBorderRadius:s}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,r=qp(i),o=Math.min(e,t),a=n.borderSkipped,l=s||Xt(i);return{topLeft:wu(!l||a.top||a.left,r.topLeft,0,o),topRight:wu(!l||a.top||a.right,r.topRight,0,o),bottomLeft:wu(!l||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:wu(!l||a.bottom||a.right,r.bottomRight,0,o)}}function E6e(n){const e=jZ(n),t=e.right-e.left,s=e.bottom-e.top,i=T6e(n,t/2,s/2),r=S6e(n,t/2,s/2);return{outer:{x:e.left,y:e.top,w:t,h:s,radius:r},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:s-i.t-i.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,r.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(i.b,i.r))}}}}function OA(n,e,t,s){const i=e===null,r=t===null,a=n&&!(i&&r)&&jZ(n,s);return a&&(i||kp(e,a.left,a.right))&&(r||kp(t,a.top,a.bottom))}function C6e(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function I6e(n,e){n.rect(e.x,e.y,e.w,e.h)}function PA(n,e,t={}){const s=n.x!==t.x?-e:0,i=n.y!==t.y?-e:0,r=(n.x+n.w!==t.x+t.w?e:0)-s,o=(n.y+n.h!==t.y+t.h?e:0)-i;return{x:n.x+s,y:n.y+i,w:n.w+r,h:n.h+o,radius:n.radius}}class Y1 extends ey{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:s,backgroundColor:i}}=this,{inner:r,outer:o}=E6e(this),a=C6e(o.radius)?mS:I6e;e.save(),(o.w!==r.w||o.h!==r.h)&&(e.beginPath(),a(e,PA(o,t,r)),e.clip(),a(e,PA(r,-t,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),a(e,PA(r,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,s){return OA(this,e,t,s)}inXRange(e,t){return OA(this,e,null,t)}inYRange(e,t){return OA(this,null,e,t)}getCenterPoint(e){const{x:t,y:s,base:i,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(t+i)/2:t,y:r?s:(s+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Ut(Y1,"id","bar"),Ut(Y1,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Ut(Y1,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const ZW=(n,e)=>{let{boxHeight:t=e,boxWidth:s=e}=n;return n.usePointStyle&&(t=Math.min(t,e),s=n.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:t,itemHeight:Math.max(e,t)}},k6e=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class JW extends ey{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,s){this.maxWidth=e,this.maxHeight=t,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Sn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(s=>e.filter(s,this.chart.data))),e.sort&&(t=t.sort((s,i)=>e.sort(s,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,i=Oi(s.font),r=i.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=ZW(s,r);let c,h;t.font=i.string,this.isHorizontal()?(c=this.maxWidth,h=this._fitRows(o,r,a,l)+10):(h=this.maxHeight,c=this._fitCols(o,i,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(h,e.maxHeight||this.maxHeight)}_fitRows(e,t,s,i){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],h=i+a;let f=e;r.textAlign="left",r.textBaseline="middle";let p=-1,g=-h;return this.legendItems.forEach((y,x)=>{const v=s+t/2+r.measureText(y.text).width;(x===0||c[c.length-1]+v+2*a>o)&&(f+=h,c[c.length-(x>0?0:1)]=0,g+=h,p++),l[x]={left:0,top:g,row:p,width:v,height:i},c[c.length-1]+=v+a}),f}_fitCols(e,t,s,i){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],h=o-e;let f=a,p=0,g=0,y=0,x=0;return this.legendItems.forEach((v,w)=>{const{itemWidth:S,itemHeight:C}=N6e(s,t,r,v,i);w>0&&g+C+2*a>h&&(f+=p+a,c.push({width:p,height:g}),y+=p+a,x++,p=g=0),l[w]={left:y,top:g,col:x,width:S,height:C},p=Math.max(p,S),g+=C+a}),f+=p,c.push({width:p,height:g}),f}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:s,labels:{padding:i},rtl:r}}=this,o=Kp(r,this.left,this.width);if(this.isHorizontal()){let a=0,l=wi(s,this.left+i,this.right-this.lineWidths[a]);for(const c of t)a!==c.row&&(a=c.row,l=wi(s,this.left+i,this.right-this.lineWidths[a])),c.top+=this.top+e+i,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+i}else{let a=0,l=wi(s,this.top+e+i,this.bottom-this.columnSizes[a].height);for(const c of t)c.col!==a&&(a=c.col,l=wi(s,this.top+e+i,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+i,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;$L(e,this),this._draw(),OL(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:s,ctx:i}=this,{align:r,labels:o}=e,a=os.color,l=Kp(e.rtl,this.left,this.width),c=Oi(o.font),{padding:h}=o,f=c.size,p=f/2;let g;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:y,boxHeight:x,itemHeight:v}=ZW(o,f),w=function(L,O,N){if(isNaN(y)||y<=0||isNaN(x)||x<0)return;i.save();const k=sn(N.lineWidth,1);if(i.fillStyle=sn(N.fillStyle,a),i.lineCap=sn(N.lineCap,"butt"),i.lineDashOffset=sn(N.lineDashOffset,0),i.lineJoin=sn(N.lineJoin,"miter"),i.lineWidth=k,i.strokeStyle=sn(N.strokeStyle,a),i.setLineDash(sn(N.lineDash,[])),o.usePointStyle){const $={radius:x*Math.SQRT2/2,pointStyle:N.pointStyle,rotation:N.rotation,borderWidth:k},R=l.xPlus(L,y/2),z=O+p;TZ(i,$,R,z,o.pointStyleWidth&&y)}else{const $=O+Math.max((f-x)/2,0),R=l.leftForLtr(L,y),z=qp(N.borderRadius);i.beginPath(),Object.values(z).some(V=>V!==0)?mS(i,{x:R,y:$,w:y,h:x,radius:z}):i.rect(R,$,y,x),i.fill(),k!==0&&i.stroke()}i.restore()},S=function(L,O,N){j0(i,N.text,L,O+v/2,c,{strikethrough:N.hidden,textAlign:l.textAlign(N.textAlign)})},C=this.isHorizontal(),I=this._computeTitleHeight();C?g={x:wi(r,this.left+h,this.right-s[0]),y:this.top+h+I,line:0}:g={x:this.left+h,y:wi(r,this.top+I+h,this.bottom-t[0].height),line:0},RZ(this.ctx,e.textDirection);const A=v+h;this.legendItems.forEach((L,O)=>{i.strokeStyle=L.fontColor,i.fillStyle=L.fontColor;const N=i.measureText(L.text).width,k=l.textAlign(L.textAlign||(L.textAlign=o.textAlign)),$=y+p+N;let R=g.x,z=g.y;l.setWidth(this.width),C?O>0&&R+$+h>this.right&&(z=g.y+=A,g.line++,R=g.x=wi(r,this.left+h,this.right-s[g.line])):O>0&&z+A>this.bottom&&(R=g.x=R+t[g.line].width+h,g.line++,z=g.y=wi(r,this.top+I+h,this.bottom-t[g.line].height));const V=l.x(R);if(w(V,z,L),R=oHe(k,R+y+p,C?R+$:this.right,e.rtl),S(l.x(R),z,L),C)g.x+=$+h;else if(typeof L.text!="string"){const ne=c.lineHeight;g.y+=GZ(L,ne)+h}else g.y+=A}),DZ(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,s=Oi(t.font),i=ko(t.padding);if(!t.display)return;const r=Kp(e.rtl,this.left,this.width),o=this.ctx,a=t.position,l=s.size/2,c=i.top+l;let h,f=this.left,p=this.width;if(this.isHorizontal())p=Math.max(...this.lineWidths),h=this.top+c,f=wi(e.align,f,this.right-p);else{const y=this.columnSizes.reduce((x,v)=>Math.max(x,v.height),0);h=c+wi(e.align,this.top,this.bottom-y-e.labels.padding-this._computeTitleHeight())}const g=wi(a,f,f+p);o.textAlign=r.textAlign(DL(a)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=s.string,j0(o,t.text,g,h,s)}_computeTitleHeight(){const e=this.options.title,t=Oi(e.font),s=ko(e.padding);return e.display?t.lineHeight+s.height:0}_getLegendItemAt(e,t){let s,i,r;if(kp(e,this.left,this.right)&&kp(t,this.top,this.bottom)){for(r=this.legendHitBoxes,s=0;s<r.length;++s)if(i=r[s],kp(e,i.left,i.left+i.width)&&kp(t,i.top,i.top+i.height))return this.legendItems[s]}return null}handleEvent(e){const t=this.options;if(!D6e(e.type,t))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,r=k6e(i,s);i&&!r&&Sn(t.onLeave,[e,i,this],this),this._hoveredItem=s,s&&!r&&Sn(t.onHover,[e,s,this],this)}else s&&Sn(t.onClick,[e,s,this],this)}}function N6e(n,e,t,s,i){const r=A6e(s,n,e,t),o=R6e(i,s,e.lineHeight);return{itemWidth:r,itemHeight:o}}function A6e(n,e,t,s){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((r,o)=>r.length>o.length?r:o)),e+t.size/2+s.measureText(i).width}function R6e(n,e,t){let s=n;return typeof e.text!="string"&&(s=GZ(e,t)),s}function GZ(n,e){const t=n.text?n.text.length:0;return e*t}function D6e(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var $6e={id:"legend",_element:JW,start(n,e,t){const s=n.legend=new JW({ctx:n.ctx,options:t,chart:n});wo.configure(n,s,t),wo.addBox(n,s)},stop(n){wo.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const s=n.legend;wo.configure(n,s,t),s.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const s=e.datasetIndex,i=t.chart;i.isDatasetVisible(s)?(i.hide(s),e.hidden=!0):(i.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:s,textAlign:i,color:r,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(t?0:void 0),h=ko(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:r,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class qZ extends ey{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const i=Ns(s.text)?s.text.length:1;this._padding=ko(s.padding);const r=i*Oi(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:s,bottom:i,right:r,options:o}=this,a=o.align;let l=0,c,h,f;return this.isHorizontal()?(h=wi(a,s,r),f=t+e,c=r-s):(o.position==="left"?(h=s+e,f=wi(a,i,t),l=Li*-.5):(h=r-e,f=wi(a,t,i),l=Li*.5),c=i-t),{titleX:h,titleY:f,maxWidth:c,rotation:l}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const s=Oi(t.font),r=s.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(r);j0(e,t.text,0,0,s,{color:t.color,maxWidth:l,rotation:c,textAlign:DL(t.align),textBaseline:"middle",translation:[o,a]})}}function O6e(n,e){const t=new qZ({ctx:n.ctx,options:e,chart:n});wo.configure(n,t,e),wo.addBox(n,t),n.titleBlock=t}var P6e={id:"title",_element:qZ,start(n,e,t){O6e(n,t)},stop(n){const e=n.titleBlock;wo.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const s=n.titleBlock;wo.configure(n,s,t),s.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Vb={average(n){if(!n.length)return!1;let e,t,s=new Set,i=0,r=0;for(e=0,t=n.length;e<t;++e){const a=n[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),i+=l.y,++r}}return r===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:i/r}},nearest(n,e){if(!n.length)return!1;let t=e.x,s=e.y,i=Number.POSITIVE_INFINITY,r,o,a;for(r=0,o=n.length;r<o;++r){const l=n[r].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),h=JWe(e,c);h<i&&(i=h,a=l)}}if(a){const l=a.tooltipPosition();t=l.x,s=l.y}return{x:t,y:s}}};function ka(n,e){return e&&(Ns(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function Ll(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function L6e(n,e){const{element:t,datasetIndex:s,index:i}=e,r=n.getDatasetMeta(s).controller,{label:o,value:a}=r.getLabelAndValue(i);return{chart:n,label:o,parsed:r.getParsed(i),raw:n.data.datasets[s].data[i],formattedValue:a,dataset:r.getDataset(),dataIndex:i,datasetIndex:s,element:t}}function eH(n,e){const t=n.chart.ctx,{body:s,footer:i,title:r}=n,{boxWidth:o,boxHeight:a}=e,l=Oi(e.bodyFont),c=Oi(e.titleFont),h=Oi(e.footerFont),f=r.length,p=i.length,g=s.length,y=ko(e.padding);let x=y.height,v=0,w=s.reduce((I,A)=>I+A.before.length+A.lines.length+A.after.length,0);if(w+=n.beforeBody.length+n.afterBody.length,f&&(x+=f*c.lineHeight+(f-1)*e.titleSpacing+e.titleMarginBottom),w){const I=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;x+=g*I+(w-g)*l.lineHeight+(w-1)*e.bodySpacing}p&&(x+=e.footerMarginTop+p*h.lineHeight+(p-1)*e.footerSpacing);let S=0;const C=function(I){v=Math.max(v,t.measureText(I).width+S)};return t.save(),t.font=c.string,nn(n.title,C),t.font=l.string,nn(n.beforeBody.concat(n.afterBody),C),S=e.displayColors?o+2+e.boxPadding:0,nn(s,I=>{nn(I.before,C),nn(I.lines,C),nn(I.after,C)}),S=0,t.font=h.string,nn(n.footer,C),t.restore(),v+=y.width,{width:v,height:x}}function M6e(n,e){const{y:t,height:s}=e;return t<s/2?"top":t>n.height-s/2?"bottom":"center"}function F6e(n,e,t,s){const{x:i,width:r}=s,o=t.caretSize+t.caretPadding;if(n==="left"&&i+r+o>e.width||n==="right"&&i-r-o<0)return!0}function V6e(n,e,t,s){const{x:i,width:r}=t,{width:o,chartArea:{left:a,right:l}}=n;let c="center";return s==="center"?c=i<=(a+l)/2?"left":"right":i<=r/2?c="left":i>=o-r/2&&(c="right"),F6e(c,n,e,t)&&(c="center"),c}function tH(n,e,t){const s=t.yAlign||e.yAlign||M6e(n,t);return{xAlign:t.xAlign||e.xAlign||V6e(n,e,t,s),yAlign:s}}function z6e(n,e){let{x:t,width:s}=n;return e==="right"?t-=s:e==="center"&&(t-=s/2),t}function B6e(n,e,t){let{y:s,height:i}=n;return e==="top"?s+=t:e==="bottom"?s-=i+t:s-=i/2,s}function nH(n,e,t,s){const{caretSize:i,caretPadding:r,cornerRadius:o}=n,{xAlign:a,yAlign:l}=t,c=i+r,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:g}=qp(o);let y=z6e(e,a);const x=B6e(e,l,c);return l==="center"?a==="left"?y+=c:a==="right"&&(y-=c):a==="left"?y-=Math.max(h,p)+i:a==="right"&&(y+=Math.max(f,g)+i),{x:Ko(y,0,s.width-e.width),y:Ko(x,0,s.height-e.height)}}function h1(n,e,t){const s=ko(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-s.right:n.x+s.left}function sH(n){return ka([],Ll(n))}function U6e(n,e,t){return Jg(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function iH(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const KZ={beforeTitle:$l,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,s=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return t[e.dataIndex]}return""},afterTitle:$l,beforeBody:$l,beforeLabel:$l,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return mn(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:$l,afterBody:$l,beforeFooter:$l,footer:$l,afterFooter:$l};function ur(n,e,t,s){const i=n[e].call(t,s);return typeof i>"u"?KZ[e].call(t,s):i}class H2 extends ey{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,s=this.options.setContext(this.getContext()),i=s.enabled&&t.options.animation&&s.animations,r=new $Z(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=U6e(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:s}=t,i=ur(s,"beforeTitle",this,e),r=ur(s,"title",this,e),o=ur(s,"afterTitle",this,e);let a=[];return a=ka(a,Ll(i)),a=ka(a,Ll(r)),a=ka(a,Ll(o)),a}getBeforeBody(e,t){return sH(ur(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:s}=t,i=[];return nn(e,r=>{const o={before:[],lines:[],after:[]},a=iH(s,r);ka(o.before,Ll(ur(a,"beforeLabel",this,r))),ka(o.lines,ur(a,"label",this,r)),ka(o.after,Ll(ur(a,"afterLabel",this,r))),i.push(o)}),i}getAfterBody(e,t){return sH(ur(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:s}=t,i=ur(s,"beforeFooter",this,e),r=ur(s,"footer",this,e),o=ur(s,"afterFooter",this,e);let a=[];return a=ka(a,Ll(i)),a=ka(a,Ll(r)),a=ka(a,Ll(o)),a}_createItems(e){const t=this._active,s=this.chart.data,i=[],r=[],o=[];let a=[],l,c;for(l=0,c=t.length;l<c;++l)a.push(L6e(this.chart,t[l]));return e.filter&&(a=a.filter((h,f,p)=>e.filter(h,f,p,s))),e.itemSort&&(a=a.sort((h,f)=>e.itemSort(h,f,s))),nn(a,h=>{const f=iH(e.callbacks,h);i.push(ur(f,"labelColor",this,h)),r.push(ur(f,"labelPointStyle",this,h)),o.push(ur(f,"labelTextColor",this,h))}),this.labelColors=i,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=a,a}update(e,t){const s=this.options.setContext(this.getContext()),i=this._active;let r,o=[];if(!i.length)this.opacity!==0&&(r={opacity:0});else{const a=Vb[s.position].call(this,i,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const l=this._size=eH(this,s),c=Object.assign({},a,l),h=tH(this.chart,s,c),f=nH(s,c,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,r={opacity:1,x:f.x,y:f.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,s,i){const r=this.getCaretPosition(e,s,i);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,s){const{xAlign:i,yAlign:r}=this,{caretSize:o,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:h,bottomRight:f}=qp(a),{x:p,y:g}=e,{width:y,height:x}=t;let v,w,S,C,I,A;return r==="center"?(I=g+x/2,i==="left"?(v=p,w=v-o,C=I+o,A=I-o):(v=p+y,w=v+o,C=I-o,A=I+o),S=v):(i==="left"?w=p+Math.max(l,h)+o:i==="right"?w=p+y-Math.max(c,f)-o:w=this.caretX,r==="top"?(C=g,I=C-o,v=w-o,S=w+o):(C=g+x,I=C+o,v=w+o,S=w-o),A=C),{x1:v,x2:w,x3:S,y1:C,y2:I,y3:A}}drawTitle(e,t,s){const i=this.title,r=i.length;let o,a,l;if(r){const c=Kp(s.rtl,this.x,this.width);for(e.x=h1(this,s.titleAlign,s),t.textAlign=c.textAlign(s.titleAlign),t.textBaseline="middle",o=Oi(s.titleFont),a=s.titleSpacing,t.fillStyle=s.titleColor,t.font=o.string,l=0;l<r;++l)t.fillText(i[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===r&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,t,s,i,r){const o=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=r,h=Oi(r.bodyFont),f=h1(this,"left",r),p=i.x(f),g=l<h.lineHeight?(h.lineHeight-l)/2:0,y=t.y+g;if(r.usePointStyle){const x={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},v=i.leftForLtr(p,c)+c/2,w=y+l/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,vW(e,x,v,w),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,vW(e,x,v,w)}else{e.lineWidth=Xt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const x=i.leftForLtr(p,c),v=i.leftForLtr(i.xPlus(p,1),c-2),w=qp(o.borderRadius);Object.values(w).some(S=>S!==0)?(e.beginPath(),e.fillStyle=r.multiKeyBackground,mS(e,{x,y,w:c,h:l,radius:w}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),mS(e,{x:v,y:y+1,w:c-2,h:l-2,radius:w}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(x,y,c,l),e.strokeRect(x,y,c,l),e.fillStyle=o.backgroundColor,e.fillRect(v,y+1,c-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,t,s){const{body:i}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:h}=s,f=Oi(s.bodyFont);let p=f.lineHeight,g=0;const y=Kp(s.rtl,this.x,this.width),x=function(N){t.fillText(N,y.x(e.x+g),e.y+p/2),e.y+=p+r},v=y.textAlign(o);let w,S,C,I,A,L,O;for(t.textAlign=o,t.textBaseline="middle",t.font=f.string,e.x=h1(this,v,s),t.fillStyle=s.bodyColor,nn(this.beforeBody,x),g=a&&v!=="right"?o==="center"?c/2+h:c+2+h:0,I=0,L=i.length;I<L;++I){for(w=i[I],S=this.labelTextColors[I],t.fillStyle=S,nn(w.before,x),C=w.lines,a&&C.length&&(this._drawColorBox(t,e,I,y,s),p=Math.max(f.lineHeight,l)),A=0,O=C.length;A<O;++A)x(C[A]),p=f.lineHeight;nn(w.after,x)}g=0,p=f.lineHeight,nn(this.afterBody,x),e.y-=r}drawFooter(e,t,s){const i=this.footer,r=i.length;let o,a;if(r){const l=Kp(s.rtl,this.x,this.width);for(e.x=h1(this,s.footerAlign,s),e.y+=s.footerMarginTop,t.textAlign=l.textAlign(s.footerAlign),t.textBaseline="middle",o=Oi(s.footerFont),t.fillStyle=s.footerColor,t.font=o.string,a=0;a<r;++a)t.fillText(i[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,t,s,i){const{xAlign:r,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:h}=s,{topLeft:f,topRight:p,bottomLeft:g,bottomRight:y}=qp(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(a+f,l),o==="top"&&this.drawCaret(e,t,s,i),t.lineTo(a+c-p,l),t.quadraticCurveTo(a+c,l,a+c,l+p),o==="center"&&r==="right"&&this.drawCaret(e,t,s,i),t.lineTo(a+c,l+h-y),t.quadraticCurveTo(a+c,l+h,a+c-y,l+h),o==="bottom"&&this.drawCaret(e,t,s,i),t.lineTo(a+g,l+h),t.quadraticCurveTo(a,l+h,a,l+h-g),o==="center"&&r==="left"&&this.drawCaret(e,t,s,i),t.lineTo(a,l+f),t.quadraticCurveTo(a,l,a+f,l),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,s=this.$animations,i=s&&s.x,r=s&&s.y;if(i||r){const o=Vb[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=eH(this,e),l=Object.assign({},o,this._size),c=tH(t,e,l),h=nH(e,l,c,t);(i._to!==h.x||r._to!==h.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},r={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=ko(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(r,e,i,t),RZ(e,t.textDirection),r.y+=o.top,this.drawTitle(r,e,t),this.drawBody(r,e,t),this.drawFooter(r,e,t),DZ(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const s=this._active,i=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),r=!hS(s,i),o=this._positionChanged(i,t);(r||o)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,s=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,r=this._active||[],o=this._getActiveElements(e,r,t,s),a=this._positionChanged(o,e),l=t||!hS(o,r)||a;return l&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,s,i){const r=this.options;if(e.type==="mouseout")return[];if(!i)return t.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,r.mode,r,s);return r.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:s,caretY:i,options:r}=this,o=Vb[r.position].call(this,e,t);return o!==!1&&(s!==o.x||i!==o.y)}}Ut(H2,"positioners",Vb);var W6e={id:"tooltip",_element:H2,positioners:Vb,afterInit(n,e,t){t&&(n.tooltip=new H2({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:KZ},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const H6e=(n,e,t,s)=>(typeof e=="string"?(t=n.push(e)-1,s.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function j6e(n,e,t,s){const i=n.indexOf(e);if(i===-1)return H6e(n,e,t,s);const r=n.lastIndexOf(e);return i!==r?t:i}const G6e=(n,e)=>n===null?null:Ko(Math.round(n),0,e);function rH(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class j2 extends ty{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const s=this.getLabels();for(const{index:i,label:r}of t)s[i]===r&&s.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(mn(e))return null;const s=this.getLabels();return t=isFinite(t)&&s[t]===e?t:j6e(s,e,sn(t,e),this._addedLabels),G6e(t,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:s,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),t||(i=this.getLabels().length-1)),this.min=s,this.max=i}buildTicks(){const e=this.min,t=this.max,s=this.options.offset,i=[];let r=this.getLabels();r=e===0&&t===r.length-1?r:r.slice(e,t+1),this._valueRange=Math.max(r.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=t;o++)i.push({value:o});return i}getLabelForValue(e){return rH.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Ut(j2,"id","category"),Ut(j2,"defaults",{ticks:{callback:rH}});function q6e(n,e){const t=[],{bounds:i,step:r,min:o,max:a,precision:l,count:c,maxTicks:h,maxDigits:f,includeBounds:p}=n,g=r||1,y=h-1,{min:x,max:v}=e,w=!mn(o),S=!mn(a),C=!mn(c),I=(v-x)/(f+1);let A=uW((v-x)/y/g)*g,L,O,N,k;if(A<1e-14&&!w&&!S)return[{value:x},{value:v}];k=Math.ceil(v/A)-Math.floor(x/A),k>y&&(A=uW(k*A/y/g)*g),mn(l)||(L=Math.pow(10,l),A=Math.ceil(A*L)/L),i==="ticks"?(O=Math.floor(x/A)*A,N=Math.ceil(v/A)*A):(O=x,N=v),w&&S&&r&&XWe((a-o)/r,A/1e3)?(k=Math.round(Math.min((a-o)/A,h)),A=(a-o)/k,O=o,N=a):C?(O=w?o:O,N=S?a:N,k=c-1,A=(N-O)/k):(k=(N-O)/A,G1(k,Math.round(k),A/1e3)?k=Math.round(k):k=Math.ceil(k));const $=Math.max(hW(A),hW(O));L=Math.pow(10,mn(l)?$:l),O=Math.round(O*L)/L,N=Math.round(N*L)/L;let R=0;for(w&&(p&&O!==o?(t.push({value:o}),O<o&&R++,G1(Math.round((O+R*A)*L)/L,o,oH(o,I,n))&&R++):O<o&&R++);R<k;++R){const z=Math.round((O+R*A)*L)/L;if(S&&z>a)break;t.push({value:z})}return S&&p&&N!==a?t.length&&G1(t[t.length-1].value,a,oH(a,I,n))?t[t.length-1].value=a:t.push({value:a}):(!S||N===a)&&t.push({value:N}),t}function oH(n,e,{horizontal:t,minRotation:s}){const i=wd(s),r=(t?Math.sin(i):Math.cos(i))||.001,o=.75*e*(""+n).length;return Math.min(e/r,o)}class K6e extends ty{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return mn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:s}=this.getUserBounds();let{min:i,max:r}=this;const o=l=>i=t?i:l,a=l=>r=s?r:l;if(e){const l=$u(i),c=$u(r);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(i===r){let l=r===0?1:Math.abs(r*.05);a(r+l),e||o(i-l)}this.min=i,this.max=r}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:s}=e,i;return s?(i=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const i={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},r=this._range||this,o=q6e(i,r);return e.bounds==="ticks"&&YWe(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const i=(s-t)/Math.max(e.length-1,1)/2;t-=i,s+=i}this._startValue=t,this._endValue=s,this._valueRange=s-t}getLabelForValue(e){return wZ(e,this.chart.options.locale,this.options.ticks.format)}}class G2 extends K6e{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Io(e)?e:0,this.max=Io(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,s=wd(this.options.ticks.minRotation),i=(e?Math.sin(s):Math.cos(s))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,r.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Ut(G2,"id","linear"),Ut(G2,"defaults",{ticks:{callback:_Z.formatters.numeric}});const CI={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},mr=Object.keys(CI);function aH(n,e){return n-e}function lH(n,e){if(mn(e))return null;const t=n._adapter,{parser:s,round:i,isoWeekday:r}=n._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),Io(o)||(o=typeof s=="string"?t.parse(o,s):t.parse(o)),o===null?null:(i&&(o=i==="week"&&(pS(r)||r===!0)?t.startOf(o,"isoWeek",r):t.startOf(o,i)),+o)}function cH(n,e,t,s){const i=mr.length;for(let r=mr.indexOf(n);r<i-1;++r){const o=CI[mr[r]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(a*o.size))<=s)return mr[r]}return mr[i-1]}function X6e(n,e,t,s,i){for(let r=mr.length-1;r>=mr.indexOf(t);r--){const o=mr[r];if(CI[o].common&&n._adapter.diff(i,s,o)>=e-1)return o}return mr[t?mr.indexOf(t):0]}function Y6e(n){for(let e=mr.indexOf(n)+1,t=mr.length;e<t;++e)if(CI[mr[e]].common)return mr[e]}function uH(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:s,hi:i}=RL(t,e),r=t[s]>=e?t[s]:t[i];n[r]=!0}}function Q6e(n,e,t,s){const i=n._adapter,r=+i.startOf(e[0].value,s),o=e[e.length-1].value;let a,l;for(a=r;a<=o;a=+i.add(a,1,s))l=t[a],l>=0&&(e[l].major=!0);return e}function hH(n,e,t){const s=[],i={},r=e.length;let o,a;for(o=0;o<r;++o)a=e[o],i[a]=o,s.push({value:a,major:!1});return r===0||!t?s:Q6e(n,s,i,t)}class bS extends ty{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const s=e.time||(e.time={}),i=this._adapter=new fje._date(e.adapters.date);i.init(t),Jb(s.displayFormats,i.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:lH(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,s=e.time.unit||"day";let{min:i,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!a&&!isNaN(c.max)&&(r=Math.max(r,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=Io(i)&&!isNaN(i)?i:+t.startOf(Date.now(),s),r=Io(r)&&!isNaN(r)?r:+t.endOf(Date.now(),s)+1,this.min=Math.min(i,r-1),this.max=Math.max(i+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],s=e[e.length-1]),{min:t,max:s}}buildTicks(){const e=this.options,t=e.time,s=e.ticks,i=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const r=this.min,o=this.max,a=sHe(i,r,o);return this._unit=t.unit||(s.autoSkip?cH(t.minUnit,this.min,this.max,this._getLabelCapacity(r)):X6e(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:Y6e(this._unit),this.initOffsets(i),e.reverse&&a.reverse(),hH(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,s=0,i,r;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,r=this.getDecimalForValue(e[e.length-1]),e.length===1?s=r:s=(r-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=Ko(t,0,o),s=Ko(s,0,o),this._offsets={start:t,end:s,factor:1/(t+1+s)}}_generate(){const e=this._adapter,t=this.min,s=this.max,i=this.options,r=i.time,o=r.unit||cH(r.minUnit,t,s,this._getLabelCapacity(t)),a=sn(i.ticks.stepSize,1),l=o==="week"?r.isoWeekday:!1,c=pS(l)||l===!0,h={};let f=t,p,g;if(c&&(f=+e.startOf(f,"isoWeek",l)),f=+e.startOf(f,c?"day":o),e.diff(s,t,o)>1e5*a)throw new Error(t+" and "+s+" are too far apart with stepSize of "+a+" "+o);const y=i.ticks.source==="data"&&this.getDataTimestamps();for(p=f,g=0;p<s;p=+e.add(p,a,o),g++)uH(h,p,y);return(p===s||i.bounds==="ticks"||g===1)&&uH(h,p,y),Object.keys(h).sort(aH).map(x=>+x)}getLabelForValue(e){const t=this._adapter,s=this.options.time;return s.tooltipFormat?t.format(e,s.tooltipFormat):t.format(e,s.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,r=this._unit,o=t||i[r];return this._adapter.format(e,o)}_tickFormatFunction(e,t,s,i){const r=this.options,o=r.ticks.callback;if(o)return Sn(o,[e,t,s],this);const a=r.time.displayFormats,l=this._unit,c=this._majorUnit,h=l&&a[l],f=c&&a[c],p=s[t],g=c&&f&&p&&p.major;return this._adapter.format(e,i||(g?f:h))}generateTickLabels(e){let t,s,i;for(t=0,s=e.length;t<s;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+s)*t.factor)}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,s=this.ctx.measureText(e).width,i=wd(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:s*r+a*o,h:s*o+a*r}}_getLabelCapacity(e){const t=this.options.time,s=t.displayFormats,i=s[t.unit]||s.millisecond,r=this._tickFormatFunction(e,0,hH(this,[e],this._majorUnit),i),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],t,s;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,s=i.length;t<s;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,s;if(e.length)return e;const i=this.getLabels();for(t=0,s=i.length;t<s;++t)e.push(lH(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return yZ(e.sort(aH))}}Ut(bS,"id","time"),Ut(bS,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function d1(n,e,t){let s=0,i=n.length-1,r,o,a,l;t?(e>=n[s].pos&&e<=n[i].pos&&({lo:s,hi:i}=z2(n,"pos",e)),{pos:r,time:a}=n[s],{pos:o,time:l}=n[i]):(e>=n[s].time&&e<=n[i].time&&({lo:s,hi:i}=z2(n,"time",e)),{time:r,pos:a}=n[s],{time:o,pos:l}=n[i]);const c=o-r;return c?a+(l-a)*(e-r)/c:a}class dH extends bS{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=d1(t,this.min),this._tableRange=d1(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:s}=this,i=[],r=[];let o,a,l,c,h;for(o=0,a=e.length;o<a;++o)c=e[o],c>=t&&c<=s&&i.push(c);if(i.length<2)return[{time:t,pos:0},{time:s,pos:1}];for(o=0,a=i.length;o<a;++o)h=i[o+1],l=i[o-1],c=i[o],Math.round((h+l)/2)!==c&&r.push({time:c,pos:o/(a-1)});return r}_generate(){const e=this.min,t=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(t)||s.length===1)&&s.push(t),s.sort((i,r)=>i-r)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),s=this.getLabelTimestamps();return t.length&&s.length?e=this.normalize(t.concat(s)):e=t.length?t:s,e=this._cache.all=e,e}getDecimalForValue(e){return(d1(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return d1(this._table,s*this._tableRange+this._minPos,!0)}}Ut(dH,"id","timeseries"),Ut(dH,"defaults",bS.defaults);const XZ="label";function fH(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function Z6e(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function YZ(n,e){n.labels=e}function QZ(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:XZ;const s=[];n.datasets=e.map(i=>{const r=n.datasets.find(o=>o[t]===i[t]);return!r||!i.data||s.includes(r)?{...i}:(s.push(r),Object.assign(r,i),r)})}function J6e(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:XZ;const t={labels:[],datasets:[]};return YZ(t,n.labels),QZ(t,n.datasets,e),t}function e5e(n,e){const{height:t=150,width:s=300,redraw:i=!1,datasetIdKey:r,type:o,data:a,options:l,plugins:c=[],fallbackContent:h,updateMode:f,...p}=n,g=oe.useRef(null),y=oe.useRef(null),x=()=>{g.current&&(y.current=new EI(g.current,{type:o,data:J6e(a,r),options:l&&{...l},plugins:c}),fH(e,y.current))},v=()=>{fH(e,null),y.current&&(y.current.destroy(),y.current=null)};return oe.useEffect(()=>{!i&&y.current&&l&&Z6e(y.current,l)},[i,l]),oe.useEffect(()=>{!i&&y.current&&YZ(y.current.config.data,a.labels)},[i,a.labels]),oe.useEffect(()=>{!i&&y.current&&a.datasets&&QZ(y.current.config.data,a.datasets,r)},[i,a.datasets]),oe.useEffect(()=>{y.current&&(i?(v(),setTimeout(x)):y.current.update(f))},[i,l,a.labels,a.datasets,f]),oe.useEffect(()=>{y.current&&(v(),setTimeout(x))},[o]),oe.useEffect(()=>(x(),()=>v()),[]),Kl.createElement("canvas",{ref:g,role:"img",height:t,width:s,...p},h)}const t5e=oe.forwardRef(e5e);function n5e(n,e){return EI.register(e),oe.forwardRef((t,s)=>Kl.createElement(t5e,{...t,ref:s,type:n}))}const s5e=n5e("bar",q1);EI.register(j2,G2,Y1,P6e,W6e,$6e);const i5e=()=>{const[n,e]=oe.useState(0),[t,s]=oe.useState([]),i=50;oe.useEffect(()=>{const a=mY(_2(Zb,"loggedMeals"),l=>{let c=0;const h=[];l.docs.forEach(f=>{const p=f.data();if(p.fiberContent){const g=parseFloat(p.fiberContent);c+=g,h.push({id:f.id,name:p.name,fiberContent:g})}}),e(c),s(h)});return()=>a()},[]);const r=async a=>{try{await pY(VP(Zb,"loggedMeals",a)),console.log(`Meal with ID ${a} deleted`)}catch(l){console.error("Error deleting meal:",l)}},o={labels:t.map(a=>a.name),datasets:[{label:"Fiber Content (g)",data:t.map(a=>a.fiberContent),backgroundColor:"rgba(75, 192, 192, 0.6)",borderColor:"rgba(75, 192, 192,1)",borderWidth:1}]};return be.jsxs("div",{className:"p-6",children:[be.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Fiber Intake Progress"}),be.jsx("div",{className:"relative w-full h-6 bg-gray-300 rounded-full overflow-hidden",children:be.jsx("div",{className:"h-full bg-green-500 transition-all",style:{width:`${n/i*100}%`}})}),be.jsxs("p",{className:"mt-2 text-gray-700 text-lg",children:[n.toFixed(1),"g / ",i,"g of fiber consumed"]}),be.jsx("h3",{className:"text-lg font-semibold mt-4",children:"Meal History"}),be.jsx("ul",{children:t.length>0?t.map((a,l)=>be.jsxs("li",{className:"p-2 border-b text-lg m-2 flex items-center",children:[a.name,": ",a.fiberContent,"g Fiber",be.jsx(uZ,{onClick:()=>r(a.id),className:"ml-auto cursor-pointer text-red-500"})]},a.id)):be.jsx("li",{className:"p-2 text-gray-500",children:"No meals logged yet"})}),be.jsx("h3",{className:"text-lg font-semibold mt-4",children:"Fiber Intake Chart"}),be.jsx("div",{className:"mt-4",children:be.jsx(s5e,{data:o,options:{responsive:!0,maintainAspectRatio:!1}})}),be.jsx(NS,{})]})},r5e="/assets/apple-BQXBQEa3.jpg",o5e=()=>{const n=Im(),e=()=>{n("/signup")};return be.jsxs("div",{className:"container font-sans ",children:[be.jsxs("section",{className:"bg-green-100 py-12 rounded-xl",children:[be.jsxs("div",{className:"container mx-auto px-4 text-center",children:[be.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Discover the Power of Fiber"}),be.jsx("p",{className:"text-xl text-gray-700 mb-8 lg:text-center",children:"Embrace a healthier lifestyle with fiber-rich foods that nourish your body and support overall wellness."}),be.jsx("div",{className:"flex justify-center ",children:be.jsx("img",{src:r5e,alt:"Assorted Fiber Foods",className:"w-full max-w-md rounded shadow-lg"})})]}),be.jsx("button",{className:`bg-primary text-white py-3 px-6 rounded-lg mt-8 mx-auto block\r
        hover:bg-primary-dark duration-200 transition-colors`,onClick:e,children:"Get Started"})]}),be.jsx("section",{className:"bg-white py-12",children:be.jsxs("div",{className:"container mx-auto px-4",children:[be.jsx("h2",{className:"text-3xl font-bold text-center mb-6 flex",children:"Education Hub: All About Fiber"}),be.jsx("div",{className:"max-w-3xl mx-auto",children:be.jsxs("article",{className:"prose mx-auto",children:[be.jsx("h3",{children:"What is Fiber?"}),be.jsx("p",{children:"Fiber is an essential nutrient that plays a critical role in digestion, helps regulate blood sugar levels, and can aid in maintaining a healthy weight."}),be.jsx("h4",{children:"Recommended Daily Fiber Intake"}),be.jsxs("ul",{children:[be.jsxs("li",{children:[be.jsx("strong",{children:"Men:"})," 38 grams per day"]}),be.jsxs("li",{children:[be.jsx("strong",{children:"Women:"})," 25 grams per day"]})]}),be.jsx("h4",{children:"Key Benefits of Fiber"}),be.jsx("p",{children:"Consuming adequate fiber helps lower cholesterol levels, improves bowel regularity, and supports overall gut health."}),be.jsx("h4",{children:"Top Fiber Sources"}),be.jsx("p",{children:"Increase your intake with foods such as fruits, vegetables, whole grains, legumes, and nuts. Incorporating these foods into your diet can easily help you meet your daily fiber goals."})]})})]})})]})},ZZ=oe.createContext({});function a5e(n){const e=oe.useRef(null);return e.current===null&&(e.current=n()),e.current}const BL=oe.createContext(null),JZ=oe.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function l5e(n=!0){const e=oe.useContext(BL);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:s,register:i}=e,r=oe.useId();oe.useEffect(()=>{if(n)return i(r)},[n]);const o=oe.useCallback(()=>n&&s&&s(r),[r,s,n]);return!t&&s?[!1,o]:[!0]}const UL=typeof window<"u",c5e=UL?oe.useLayoutEffect:oe.useEffect,Ur=n=>n;let eJ=Ur;function WL(n){let e;return()=>(e===void 0&&(e=n()),e)}const _m=(n,e,t)=>{const s=e-n;return s===0?1:(t-n)/s},Jl=n=>n*1e3,ec=n=>n/1e3,u5e={useManualTiming:!1},f1=["read","resolveKeyframes","update","preRender","render","postRender"],pH={value:null};function h5e(n,e){let t=new Set,s=new Set,i=!1,r=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},l=0;function c(f){o.has(f)&&(h.schedule(f),n()),l++,f(a)}const h={schedule:(f,p=!1,g=!1)=>{const x=g&&i?t:s;return p&&o.add(f),x.has(f)||x.add(f),f},cancel:f=>{s.delete(f),o.delete(f)},process:f=>{if(a=f,i){r=!0;return}i=!0,[t,s]=[s,t],t.forEach(c),e&&pH.value&&pH.value.frameloop[e].push(l),l=0,t.clear(),i=!1,r&&(r=!1,h.process(f))}};return h}const d5e=40;function tJ(n,e){let t=!1,s=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>t=!0,o=f1.reduce((w,S)=>(w[S]=h5e(r,e?S:void 0),w),{}),{read:a,resolveKeyframes:l,update:c,preRender:h,render:f,postRender:p}=o,g=()=>{const w=performance.now();t=!1,i.delta=s?1e3/60:Math.max(Math.min(w-i.timestamp,d5e),1),i.timestamp=w,i.isProcessing=!0,a.process(i),l.process(i),c.process(i),h.process(i),f.process(i),p.process(i),i.isProcessing=!1,t&&e&&(s=!1,n(g))},y=()=>{t=!0,s=!0,i.isProcessing||n(g)};return{schedule:f1.reduce((w,S)=>{const C=o[S];return w[S]=(I,A=!1,L=!1)=>(t||y(),C.schedule(I,A,L)),w},{}),cancel:w=>{for(let S=0;S<f1.length;S++)o[f1[S]].cancel(w)},state:i,steps:o}}const{schedule:_n,cancel:nh,state:ci,steps:LA}=tJ(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ur,!0),nJ=oe.createContext({strict:!1}),mH={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Tm={};for(const n in mH)Tm[n]={isEnabled:e=>mH[n].some(t=>!!e[t])};function f5e(n){for(const e in n)Tm[e]={...Tm[e],...n[e]}}const p5e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function vS(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||p5e.has(n)}let sJ=n=>!vS(n);function m5e(n){n&&(sJ=e=>e.startsWith("on")?!vS(e):n(e))}try{m5e(require("@emotion/is-prop-valid").default)}catch{}function g5e(n,e,t){const s={};for(const i in n)i==="values"&&typeof n.values=="object"||(sJ(i)||t===!0&&vS(i)||!e&&!vS(i)||n.draggable&&i.startsWith("onDrag"))&&(s[i]=n[i]);return s}function y5e(n){if(typeof Proxy>"u")return n;const e=new Map,t=(...s)=>n(...s);return new Proxy(t,{get:(s,i)=>i==="create"?n:(e.has(i)||e.set(i,n(i)),e.get(i))})}const II=oe.createContext({});function kI(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function q0(n){return typeof n=="string"||Array.isArray(n)}const HL=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],jL=["initial",...HL];function NI(n){return kI(n.animate)||jL.some(e=>q0(n[e]))}function iJ(n){return!!(NI(n)||n.variants)}function b5e(n,e){if(NI(n)){const{initial:t,animate:s}=n;return{initial:t===!1||q0(t)?t:void 0,animate:q0(s)?s:void 0}}return n.inherit!==!1?e:{}}function v5e(n){const{initial:e,animate:t}=b5e(n,oe.useContext(II));return oe.useMemo(()=>({initial:e,animate:t}),[gH(e),gH(t)])}function gH(n){return Array.isArray(n)?n.join(" "):n}const x5e=Symbol.for("motionComponentSymbol");function Np(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function w5e(n,e,t){return oe.useCallback(s=>{s&&n.onMount&&n.onMount(s),e&&(s?e.mount(s):e.unmount()),t&&(typeof t=="function"?t(s):Np(t)&&(t.current=s))},[e])}const GL=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),_5e="framerAppearId",rJ="data-"+GL(_5e),{schedule:qL}=tJ(queueMicrotask,!1),oJ=oe.createContext({});function T5e(n,e,t,s,i){var r,o;const{visualElement:a}=oe.useContext(II),l=oe.useContext(nJ),c=oe.useContext(BL),h=oe.useContext(JZ).reducedMotion,f=oe.useRef(null);s=s||l.renderer,!f.current&&s&&(f.current=s(n,{visualState:e,parent:a,props:t,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h}));const p=f.current,g=oe.useContext(oJ);p&&!p.projection&&i&&(p.type==="html"||p.type==="svg")&&S5e(f.current,t,i,g);const y=oe.useRef(!1);oe.useInsertionEffect(()=>{p&&y.current&&p.update(t,c)});const x=t[rJ],v=oe.useRef(!!x&&!(!((r=window.MotionHandoffIsComplete)===null||r===void 0)&&r.call(window,x))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,x)));return c5e(()=>{p&&(y.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),qL.render(p.render),v.current&&p.animationState&&p.animationState.animateChanges())}),oe.useEffect(()=>{p&&(!v.current&&p.animationState&&p.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)===null||w===void 0||w.call(window,x)}),v.current=!1))}),p}function S5e(n,e,t,s){const{layoutId:i,layout:r,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:aJ(n.parent)),n.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:!!o||a&&Np(a),visualElement:n,animationType:typeof r=="string"?r:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:c})}function aJ(n){if(n)return n.options.allowProjection!==!1?n.projection:aJ(n.parent)}function E5e({preloadedFeatures:n,createVisualElement:e,useRender:t,useVisualState:s,Component:i}){var r,o;n&&f5e(n);function a(c,h){let f;const p={...oe.useContext(JZ),...c,layoutId:C5e(c)},{isStatic:g}=p,y=v5e(c),x=s(c,g);if(!g&&UL){I5e();const v=k5e(p);f=v.MeasureLayout,y.visualElement=T5e(i,x,p,e,v.ProjectionNode)}return be.jsxs(II.Provider,{value:y,children:[f&&y.visualElement?be.jsx(f,{visualElement:y.visualElement,...p}):null,t(i,c,w5e(x,y.visualElement,h),x,g,y.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(o=(r=i.displayName)!==null&&r!==void 0?r:i.name)!==null&&o!==void 0?o:""})`}`;const l=oe.forwardRef(a);return l[x5e]=i,l}function C5e({layoutId:n}){const e=oe.useContext(ZZ).id;return e&&n!==void 0?e+"-"+n:n}function I5e(n,e){oe.useContext(nJ).strict}function k5e(n){const{drag:e,layout:t}=Tm;if(!e&&!t)return{};const s={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(n)||t!=null&&t.isEnabled(n)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const lJ=n=>e=>typeof e=="string"&&e.startsWith(n),KL=lJ("--"),N5e=lJ("var(--"),XL=n=>N5e(n)?A5e.test(n.split("/*")[0].trim()):!1,A5e=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,K0={};function R5e(n){for(const e in n)K0[e]=n[e],KL(e)&&(K0[e].isCSSVariable=!0)}const ny=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],If=new Set(ny);function cJ(n,{layout:e,layoutId:t}){return If.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!K0[n]||n==="opacity")}const Pi=n=>!!(n&&n.getVelocity),uJ=(n,e)=>e&&typeof n=="number"?e.transform(n):n,dc=(n,e,t)=>t>e?e:t<n?n:t,sy={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},X0={...sy,transform:n=>dc(0,1,n)},p1={...sy,default:1},aw=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),uu=aw("deg"),qa=aw("%"),nt=aw("px"),D5e=aw("vh"),$5e=aw("vw"),yH={...qa,parse:n=>qa.parse(n)/100,transform:n=>qa.transform(n*100)},O5e={borderWidth:nt,borderTopWidth:nt,borderRightWidth:nt,borderBottomWidth:nt,borderLeftWidth:nt,borderRadius:nt,radius:nt,borderTopLeftRadius:nt,borderTopRightRadius:nt,borderBottomRightRadius:nt,borderBottomLeftRadius:nt,width:nt,maxWidth:nt,height:nt,maxHeight:nt,top:nt,right:nt,bottom:nt,left:nt,padding:nt,paddingTop:nt,paddingRight:nt,paddingBottom:nt,paddingLeft:nt,margin:nt,marginTop:nt,marginRight:nt,marginBottom:nt,marginLeft:nt,backgroundPositionX:nt,backgroundPositionY:nt},P5e={rotate:uu,rotateX:uu,rotateY:uu,rotateZ:uu,scale:p1,scaleX:p1,scaleY:p1,scaleZ:p1,skew:uu,skewX:uu,skewY:uu,distance:nt,translateX:nt,translateY:nt,translateZ:nt,x:nt,y:nt,z:nt,perspective:nt,transformPerspective:nt,opacity:X0,originX:yH,originY:yH,originZ:nt},bH={...sy,transform:Math.round},YL={...O5e,...P5e,zIndex:bH,size:nt,fillOpacity:X0,strokeOpacity:X0,numOctaves:bH},L5e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},M5e=ny.length;function F5e(n,e,t){let s="",i=!0;for(let r=0;r<M5e;r++){const o=ny[r],a=n[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||t){const c=uJ(a,YL[o]);if(!l){i=!1;const h=L5e[o]||o;s+=`${h}(${c}) `}t&&(e[o]=c)}}return s=s.trim(),t?s=t(e,i?"":s):i&&(s="none"),s}function QL(n,e,t){const{style:s,vars:i,transformOrigin:r}=n;let o=!1,a=!1;for(const l in e){const c=e[l];if(If.has(l)){o=!0;continue}else if(KL(l)){i[l]=c;continue}else{const h=uJ(c,YL[l]);l.startsWith("origin")?(a=!0,r[l]=h):s[l]=h}}if(e.transform||(o||t?s.transform=F5e(e,n.transform,t):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:h=0}=r;s.transformOrigin=`${l} ${c} ${h}`}}const ZL=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function hJ(n,e,t){for(const s in e)!Pi(e[s])&&!cJ(s,t)&&(n[s]=e[s])}function V5e({transformTemplate:n},e){return oe.useMemo(()=>{const t=ZL();return QL(t,e,n),Object.assign({},t.vars,t.style)},[e])}function z5e(n,e){const t=n.style||{},s={};return hJ(s,t,n),Object.assign(s,V5e(n,e)),s}function B5e(n,e){const t={},s=z5e(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=s,t}const U5e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function JL(n){return typeof n!="string"||n.includes("-")?!1:!!(U5e.indexOf(n)>-1||/[A-Z]/u.test(n))}const W5e={offset:"stroke-dashoffset",array:"stroke-dasharray"},H5e={offset:"strokeDashoffset",array:"strokeDasharray"};function j5e(n,e,t=1,s=0,i=!0){n.pathLength=1;const r=i?W5e:H5e;n[r.offset]=nt.transform(-s);const o=nt.transform(e),a=nt.transform(t);n[r.array]=`${o} ${a}`}function vH(n,e,t){return typeof n=="string"?n:nt.transform(e+t*n)}function G5e(n,e,t){const s=vH(e,n.x,n.width),i=vH(t,n.y,n.height);return`${s} ${i}`}function eM(n,{attrX:e,attrY:t,attrScale:s,originX:i,originY:r,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},h,f){if(QL(n,c,f),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:g,dimensions:y}=n;p.transform&&(y&&(g.transform=p.transform),delete p.transform),y&&(i!==void 0||r!==void 0||g.transform)&&(g.transformOrigin=G5e(y,i!==void 0?i:.5,r!==void 0?r:.5)),e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),s!==void 0&&(p.scale=s),o!==void 0&&j5e(p,o,a,l,!1)}const dJ=()=>({...ZL(),attrs:{}}),tM=n=>typeof n=="string"&&n.toLowerCase()==="svg";function q5e(n,e,t,s){const i=oe.useMemo(()=>{const r=dJ();return eM(r,e,tM(s),n.transformTemplate),{...r.attrs,style:{...r.style}}},[e]);if(n.style){const r={};hJ(r,n.style,n),i.style={...r,...i.style}}return i}function K5e(n=!1){return(t,s,i,{latestValues:r},o)=>{const l=(JL(t)?q5e:B5e)(s,r,o,t),c=g5e(s,typeof t=="string",n),h=t!==oe.Fragment?{...c,...l,ref:i}:{},{children:f}=s,p=oe.useMemo(()=>Pi(f)?f.get():f,[f]);return oe.createElement(t,{...h,children:p})}}function xH(n){const e=[{},{}];return n==null||n.values.forEach((t,s)=>{e[0][s]=t.get(),e[1][s]=t.getVelocity()}),e}function nM(n,e,t,s){if(typeof e=="function"){const[i,r]=xH(s);e=e(t!==void 0?t:n.custom,i,r)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[i,r]=xH(s);e=e(t!==void 0?t:n.custom,i,r)}return e}const q2=n=>Array.isArray(n),X5e=n=>!!(n&&typeof n=="object"&&n.mix&&n.toValue),Y5e=n=>q2(n)?n[n.length-1]||0:n;function Q1(n){const e=Pi(n)?n.get():n;return X5e(e)?e.toValue():e}function Q5e({scrapeMotionValuesFromProps:n,createRenderState:e,onUpdate:t},s,i,r){const o={latestValues:Z5e(s,i,r,n),renderState:e()};return t&&(o.onMount=a=>t({props:s,current:a,...o}),o.onUpdate=a=>t(a)),o}const fJ=n=>(e,t)=>{const s=oe.useContext(II),i=oe.useContext(BL),r=()=>Q5e(n,e,s,i);return t?r():a5e(r)};function Z5e(n,e,t,s){const i={},r=s(n,{});for(const p in r)i[p]=Q1(r[p]);let{initial:o,animate:a}=n;const l=NI(n),c=iJ(n);e&&c&&!l&&n.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const f=h?a:o;if(f&&typeof f!="boolean"&&!kI(f)){const p=Array.isArray(f)?f:[f];for(let g=0;g<p.length;g++){const y=nM(n,p[g]);if(y){const{transitionEnd:x,transition:v,...w}=y;for(const S in w){let C=w[S];if(Array.isArray(C)){const I=h?C.length-1:0;C=C[I]}C!==null&&(i[S]=C)}for(const S in x)i[S]=x[S]}}}return i}function sM(n,e,t){var s;const{style:i}=n,r={};for(const o in i)(Pi(i[o])||e.style&&Pi(e.style[o])||cJ(o,n)||((s=t==null?void 0:t.getValue(o))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(r[o]=i[o]);return r}const J5e={useVisualState:fJ({scrapeMotionValuesFromProps:sM,createRenderState:ZL})};function pJ(n,e){try{e.dimensions=typeof n.getBBox=="function"?n.getBBox():n.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}function mJ(n,{style:e,vars:t},s,i){Object.assign(n.style,e,i&&i.getProjectionStyles(s));for(const r in t)n.style.setProperty(r,t[r])}const gJ=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function yJ(n,e,t,s){mJ(n,e,void 0,s);for(const i in e.attrs)n.setAttribute(gJ.has(i)?i:GL(i),e.attrs[i])}function bJ(n,e,t){const s=sM(n,e,t);for(const i in n)if(Pi(n[i])||Pi(e[i])){const r=ny.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;s[r]=n[i]}return s}const wH=["x","y","width","height","cx","cy","r"],eGe={useVisualState:fJ({scrapeMotionValuesFromProps:bJ,createRenderState:dJ,onUpdate:({props:n,prevProps:e,current:t,renderState:s,latestValues:i})=>{if(!t)return;let r=!!n.drag;if(!r){for(const a in i)if(If.has(a)){r=!0;break}}if(!r)return;let o=!e;if(e)for(let a=0;a<wH.length;a++){const l=wH[a];n[l]!==e[l]&&(o=!0)}o&&_n.read(()=>{pJ(t,s),_n.render(()=>{eM(s,i,tM(t.tagName),n.transformTemplate),yJ(t,s)})})}})};function tGe(n,e){return function(s,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...JL(s)?eGe:J5e,preloadedFeatures:n,useRender:K5e(i),createVisualElement:e,Component:s};return E5e(o)}}function Y0(n,e,t){const s=n.getProps();return nM(s,e,t!==void 0?t:s.custom,n)}const nGe=WL(()=>window.ScrollTimeline!==void 0);class sGe{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=t}attachTimeline(e,t){const s=this.animations.map(i=>{if(nGe()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{s.forEach((i,r)=>{i&&i(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class iGe extends sGe{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function iM(n,e){return n?n[e]||n.default||n:void 0}const K2=2e4;function vJ(n){let e=0;const t=50;let s=n.next(e);for(;!s.done&&e<K2;)e+=t,s=n.next(e);return e>=K2?1/0:e}function rM(n){return typeof n=="function"}function _H(n,e){n.timeline=e,n.onfinish=null}const oM=n=>Array.isArray(n)&&typeof n[0]=="number",rGe={linearEasing:void 0};function oGe(n,e){const t=WL(n);return()=>{var s;return(s=rGe[e])!==null&&s!==void 0?s:t()}}const xS=oGe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),xJ=(n,e,t=10)=>{let s="";const i=Math.max(Math.round(e/t),2);for(let r=0;r<i;r++)s+=n(_m(0,i-1,r))+", ";return`linear(${s.substring(0,s.length-2)})`};function wJ(n){return!!(typeof n=="function"&&xS()||!n||typeof n=="string"&&(n in X2||xS())||oM(n)||Array.isArray(n)&&n.every(wJ))}const zb=([n,e,t,s])=>`cubic-bezier(${n}, ${e}, ${t}, ${s})`,X2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:zb([0,.65,.55,1]),circOut:zb([.55,0,1,.45]),backIn:zb([.31,.01,.66,-.59]),backOut:zb([.33,1.53,.69,.99])};function _J(n,e){if(n)return typeof n=="function"&&xS()?xJ(n,e):oM(n)?zb(n):Array.isArray(n)?n.map(t=>_J(t,e)||X2.easeOut):X2[n]}const zo={x:!1,y:!1};function TJ(){return zo.x||zo.y}function aGe(n,e,t){var s;if(n instanceof EventTarget)return[n];if(typeof n=="string"){let i=document;const r=(s=void 0)!==null&&s!==void 0?s:i.querySelectorAll(n);return r?Array.from(r):[]}return Array.from(n)}function SJ(n,e){const t=aGe(n),s=new AbortController,i={passive:!0,...e,signal:s.signal};return[t,i,()=>s.abort()]}function TH(n){return!(n.pointerType==="touch"||TJ())}function lGe(n,e,t={}){const[s,i,r]=SJ(n,t),o=a=>{if(!TH(a))return;const{target:l}=a,c=e(l,a);if(typeof c!="function"||!l)return;const h=f=>{TH(f)&&(c(f),l.removeEventListener("pointerleave",h))};l.addEventListener("pointerleave",h,i)};return s.forEach(a=>{a.addEventListener("pointerenter",o,i)}),r}function wS(n,e){const t=`${e}PointerCapture`;if(n.target instanceof Element&&t in n.target&&n.pointerId!==void 0)try{n.target[t](n.pointerId)}catch{}}const EJ=(n,e)=>e?n===e?!0:EJ(n,e.parentElement):!1,aM=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,cGe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function uGe(n){return cGe.has(n.tagName)||n.tabIndex!==-1}const Bb=new WeakSet;function SH(n){return e=>{e.key==="Enter"&&n(e)}}function MA(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const hGe=(n,e)=>{const t=n.currentTarget;if(!t)return;const s=SH(()=>{if(Bb.has(t))return;MA(t,"down");const i=SH(()=>{MA(t,"up")}),r=()=>MA(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",r,e)});t.addEventListener("keydown",s,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",s),e)};function EH(n){return aM(n)&&!TJ()}function dGe(n,e,t={}){const[s,i,r]=SJ(n,t),o=a=>{const l=a.currentTarget;if(!l||!EH(a)||Bb.has(l))return;Bb.add(l),wS(a,"set");const c=e(l,a),h=(g,y)=>{l.removeEventListener("pointerup",f),l.removeEventListener("pointercancel",p),wS(g,"release"),!(!EH(g)||!Bb.has(l))&&(Bb.delete(l),typeof c=="function"&&c(g,{success:y}))},f=g=>{(g.isTrusted?fGe(g,l instanceof Element?l.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}):!1)?h(g,!1):h(g,!(l instanceof Element)||EJ(l,g.target))},p=g=>{h(g,!1)};l.addEventListener("pointerup",f,i),l.addEventListener("pointercancel",p,i),l.addEventListener("lostpointercapture",p,i)};return s.forEach(a=>{a=t.useGlobalTarget?window:a;let l=!1;a instanceof HTMLElement&&(l=!0,!uGe(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0)),a.addEventListener("pointerdown",o,i),l&&a.addEventListener("focus",c=>hGe(c,i),i)}),r}function fGe(n,e){return n.clientX<e.left||n.clientX>e.right||n.clientY<e.top||n.clientY>e.bottom}function pGe(n){return n==="x"||n==="y"?zo[n]?null:(zo[n]=!0,()=>{zo[n]=!1}):zo.x||zo.y?null:(zo.x=zo.y=!0,()=>{zo.x=zo.y=!1})}const CJ=new Set(["width","height","top","left","right","bottom",...ny]);let Z1;function mGe(){Z1=void 0}const Ka={now:()=>(Z1===void 0&&Ka.set(ci.isProcessing||u5e.useManualTiming?ci.timestamp:performance.now()),Z1),set:n=>{Z1=n,queueMicrotask(mGe)}};function lM(n,e){n.indexOf(e)===-1&&n.push(e)}function cM(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}class uM{constructor(){this.subscriptions=[]}add(e){return lM(this.subscriptions,e),()=>cM(this.subscriptions,e)}notify(e,t,s){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,s);else for(let r=0;r<i;r++){const o=this.subscriptions[r];o&&o(e,t,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function IJ(n,e){return e?n*(1e3/e):0}const CH=30,gGe=n=>!isNaN(parseFloat(n));class yGe{constructor(e,t={}){this.version="12.4.7",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,i=!0)=>{const r=Ka.now();this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ka.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=gGe(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new uM);const s=this.events[e].add(t);return e==="change"?()=>{s(),_n.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,s){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ka.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>CH)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,CH);return IJ(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Q0(n,e){return new yGe(n,e)}function bGe(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,Q0(t))}function vGe(n,e){const t=Y0(n,e);let{transitionEnd:s={},transition:i={},...r}=t||{};r={...r,...s};for(const o in r){const a=Y5e(r[o]);bGe(n,o,a)}}function xGe(n){return!!(Pi(n)&&n.add)}function Y2(n,e){const t=n.getValue("willChange");if(xGe(t))return t.add(e)}function kJ(n){return n.props[rJ]}const NJ=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,wGe=1e-7,_Ge=12;function TGe(n,e,t,s,i){let r,o,a=0;do o=e+(t-e)/2,r=NJ(o,s,i)-n,r>0?t=o:e=o;while(Math.abs(r)>wGe&&++a<_Ge);return o}function lw(n,e,t,s){if(n===e&&t===s)return Ur;const i=r=>TGe(r,0,1,n,t);return r=>r===0||r===1?r:NJ(i(r),e,s)}const AJ=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,RJ=n=>e=>1-n(1-e),DJ=lw(.33,1.53,.69,.99),hM=RJ(DJ),$J=AJ(hM),OJ=n=>(n*=2)<1?.5*hM(n):.5*(2-Math.pow(2,-10*(n-1))),dM=n=>1-Math.sin(Math.acos(n)),PJ=RJ(dM),LJ=AJ(dM),MJ=n=>/^0[^.\s]+$/u.test(n);function SGe(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||MJ(n):!0}const s0=n=>Math.round(n*1e5)/1e5,fM=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function EGe(n){return n==null}const CGe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,pM=(n,e)=>t=>!!(typeof t=="string"&&CGe.test(t)&&t.startsWith(n)||e&&!EGe(t)&&Object.prototype.hasOwnProperty.call(t,e)),FJ=(n,e,t)=>s=>{if(typeof s!="string")return s;const[i,r,o,a]=s.match(fM);return{[n]:parseFloat(i),[e]:parseFloat(r),[t]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},IGe=n=>dc(0,255,n),FA={...sy,transform:n=>Math.round(IGe(n))},_d={test:pM("rgb","red"),parse:FJ("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:s=1})=>"rgba("+FA.transform(n)+", "+FA.transform(e)+", "+FA.transform(t)+", "+s0(X0.transform(s))+")"};function kGe(n){let e="",t="",s="",i="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),s=n.substring(5,7),i=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),s=n.substring(3,4),i=n.substring(4,5),e+=e,t+=t,s+=s,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(s,16),alpha:i?parseInt(i,16)/255:1}}const Q2={test:pM("#"),parse:kGe,transform:_d.transform},Ap={test:pM("hsl","hue"),parse:FJ("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:s=1})=>"hsla("+Math.round(n)+", "+qa.transform(s0(e))+", "+qa.transform(s0(t))+", "+s0(X0.transform(s))+")"},_i={test:n=>_d.test(n)||Q2.test(n)||Ap.test(n),parse:n=>_d.test(n)?_d.parse(n):Ap.test(n)?Ap.parse(n):Q2.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?_d.transform(n):Ap.transform(n)},NGe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function AGe(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(fM))===null||e===void 0?void 0:e.length)||0)+(((t=n.match(NGe))===null||t===void 0?void 0:t.length)||0)>0}const VJ="number",zJ="color",RGe="var",DGe="var(",IH="${}",$Ge=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Z0(n){const e=n.toString(),t=[],s={color:[],number:[],var:[]},i=[];let r=0;const a=e.replace($Ge,l=>(_i.test(l)?(s.color.push(r),i.push(zJ),t.push(_i.parse(l))):l.startsWith(DGe)?(s.var.push(r),i.push(RGe),t.push(l)):(s.number.push(r),i.push(VJ),t.push(parseFloat(l))),++r,IH)).split(IH);return{values:t,split:a,indexes:s,types:i}}function BJ(n){return Z0(n).values}function UJ(n){const{split:e,types:t}=Z0(n),s=e.length;return i=>{let r="";for(let o=0;o<s;o++)if(r+=e[o],i[o]!==void 0){const a=t[o];a===VJ?r+=s0(i[o]):a===zJ?r+=_i.transform(i[o]):r+=i[o]}return r}}const OGe=n=>typeof n=="number"?0:n;function PGe(n){const e=BJ(n);return UJ(n)(e.map(OGe))}const sh={test:AGe,parse:BJ,createTransformer:UJ,getAnimatableNone:PGe},LGe=new Set(["brightness","contrast","saturate","opacity"]);function MGe(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[s]=t.match(fM)||[];if(!s)return n;const i=t.replace(s,"");let r=LGe.has(e)?1:0;return s!==t&&(r*=100),e+"("+r+i+")"}const FGe=/\b([a-z-]*)\(.*?\)/gu,Z2={...sh,getAnimatableNone:n=>{const e=n.match(FGe);return e?e.map(MGe).join(" "):n}},VGe={...YL,color:_i,backgroundColor:_i,outlineColor:_i,fill:_i,stroke:_i,borderColor:_i,borderTopColor:_i,borderRightColor:_i,borderBottomColor:_i,borderLeftColor:_i,filter:Z2,WebkitFilter:Z2},mM=n=>VGe[n];function WJ(n,e){let t=mM(n);return t!==Z2&&(t=sh),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const zGe=new Set(["auto","none","0"]);function BGe(n,e,t){let s=0,i;for(;s<n.length&&!i;){const r=n[s];typeof r=="string"&&!zGe.has(r)&&Z0(r).values.length&&(i=n[s]),s++}if(i&&t)for(const r of e)n[r]=WJ(t,i)}const kH=n=>n===sy||n===nt,NH=(n,e)=>parseFloat(n.split(", ")[e]),AH=(n,e)=>(t,{transform:s})=>{if(s==="none"||!s)return 0;const i=s.match(/^matrix3d\((.+)\)$/u);if(i)return NH(i[1],e);{const r=s.match(/^matrix\((.+)\)$/u);return r?NH(r[1],n):0}},UGe=new Set(["x","y","z"]),WGe=ny.filter(n=>!UGe.has(n));function HGe(n){const e=[];return WGe.forEach(t=>{const s=n.getValue(t);s!==void 0&&(e.push([t,s.get()]),s.set(t.startsWith("scale")?1:0))}),e}const Sm={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:AH(4,13),y:AH(5,14)};Sm.translateX=Sm.x;Sm.translateY=Sm.y;const Dd=new Set;let J2=!1,eD=!1;function HJ(){if(eD){const n=Array.from(Dd).filter(s=>s.needsMeasurement),e=new Set(n.map(s=>s.element)),t=new Map;e.forEach(s=>{const i=HGe(s);i.length&&(t.set(s,i),s.render())}),n.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const i=t.get(s);i&&i.forEach(([r,o])=>{var a;(a=s.getValue(r))===null||a===void 0||a.set(o)})}),n.forEach(s=>s.measureEndState()),n.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}eD=!1,J2=!1,Dd.forEach(n=>n.complete()),Dd.clear()}function jJ(){Dd.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(eD=!0)})}function jGe(){jJ(),HJ()}class gM{constructor(e,t,s,i,r,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=s,this.motionValue=i,this.element=r,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Dd.add(this),J2||(J2=!0,_n.read(jJ),_n.resolveKeyframes(HJ))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:s,motionValue:i}=this;for(let r=0;r<e.length;r++)if(e[r]===null)if(r===0){const o=i==null?void 0:i.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(s&&t){const l=s.readValue(t,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),i&&o===void 0&&i.set(e[0])}else e[r]=e[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Dd.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Dd.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const GJ=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n),GGe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function qGe(n){const e=GGe.exec(n);if(!e)return[,];const[,t,s,i]=e;return[`--${t??s}`,i]}function qJ(n,e,t=1){const[s,i]=qGe(n);if(!s)return;const r=window.getComputedStyle(e).getPropertyValue(s);if(r){const o=r.trim();return GJ(o)?parseFloat(o):o}return XL(i)?qJ(i,e,t+1):i}const KJ=n=>e=>e.test(n),KGe={test:n=>n==="auto",parse:n=>n},XJ=[sy,nt,qa,uu,$5e,D5e,KGe],RH=n=>XJ.find(KJ(n));class YJ extends gM{constructor(e,t,s,i,r){super(e,t,s,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:s}=this;if(!t||!t.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),XL(c))){const h=qJ(c,t.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!CJ.has(s)||e.length!==2)return;const[i,r]=e,o=RH(i),a=RH(r);if(o!==a)if(kH(o)&&kH(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,s=[];for(let i=0;i<e.length;i++)SGe(e[i])&&s.push(i);s.length&&BGe(e,s,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Sm[s](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(s,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:s,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const r=t.getValue(s);r&&r.jump(this.measuredOrigin,!1);const o=i.length-1,a=i[o];i[o]=Sm[s](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const DH=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(sh.test(n)||n==="0")&&!n.startsWith("url("));function XGe(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function YGe(n,e,t,s){const i=n[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const r=n[n.length-1],o=DH(i,e),a=DH(r,e);return!o||!a?!1:XGe(n)||(t==="spring"||rM(t))&&s}const QGe=n=>n!==null;function AI(n,{repeat:e,repeatType:t="loop"},s){const i=n.filter(QGe),r=e&&t!=="loop"&&e%2===1?0:i.length-1;return!r||s===void 0?i[r]:s}const ZGe=40;class QJ{constructor({autoplay:e=!0,delay:t=0,type:s="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ka.now(),this.options={autoplay:e,delay:t,type:s,repeat:i,repeatDelay:r,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>ZGe?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&jGe(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Ka.now(),this.hasAttemptedResolve=!0;const{name:s,type:i,velocity:r,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!YGe(e,s,i,r))if(o)this.options.duration=0;else{l&&l(AI(e,this.options,t)),a&&a(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Fn=(n,e,t)=>n+(e-n)*t;function VA(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function JGe({hue:n,saturation:e,lightness:t,alpha:s}){n/=360,e/=100,t/=100;let i=0,r=0,o=0;if(!e)i=r=o=t;else{const a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;i=VA(l,a,n+1/3),r=VA(l,a,n),o=VA(l,a,n-1/3)}return{red:Math.round(i*255),green:Math.round(r*255),blue:Math.round(o*255),alpha:s}}function _S(n,e){return t=>t>0?e:n}const zA=(n,e,t)=>{const s=n*n,i=t*(e*e-s)+s;return i<0?0:Math.sqrt(i)},eqe=[Q2,_d,Ap],tqe=n=>eqe.find(e=>e.test(n));function $H(n){const e=tqe(n);if(!e)return!1;let t=e.parse(n);return e===Ap&&(t=JGe(t)),t}const OH=(n,e)=>{const t=$H(n),s=$H(e);if(!t||!s)return _S(n,e);const i={...t};return r=>(i.red=zA(t.red,s.red,r),i.green=zA(t.green,s.green,r),i.blue=zA(t.blue,s.blue,r),i.alpha=Fn(t.alpha,s.alpha,r),_d.transform(i))},nqe=(n,e)=>t=>e(n(t)),cw=(...n)=>n.reduce(nqe),tD=new Set(["none","hidden"]);function sqe(n,e){return tD.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function iqe(n,e){return t=>Fn(n,e,t)}function yM(n){return typeof n=="number"?iqe:typeof n=="string"?XL(n)?_S:_i.test(n)?OH:aqe:Array.isArray(n)?ZJ:typeof n=="object"?_i.test(n)?OH:rqe:_S}function ZJ(n,e){const t=[...n],s=t.length,i=n.map((r,o)=>yM(r)(r,e[o]));return r=>{for(let o=0;o<s;o++)t[o]=i[o](r);return t}}function rqe(n,e){const t={...n,...e},s={};for(const i in t)n[i]!==void 0&&e[i]!==void 0&&(s[i]=yM(n[i])(n[i],e[i]));return i=>{for(const r in s)t[r]=s[r](i);return t}}function oqe(n,e){var t;const s=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const o=e.types[r],a=n.indexes[o][i[o]],l=(t=n.values[a])!==null&&t!==void 0?t:0;s[r]=l,i[o]++}return s}const aqe=(n,e)=>{const t=sh.createTransformer(e),s=Z0(n),i=Z0(e);return s.indexes.var.length===i.indexes.var.length&&s.indexes.color.length===i.indexes.color.length&&s.indexes.number.length>=i.indexes.number.length?tD.has(n)&&!i.values.length||tD.has(e)&&!s.values.length?sqe(n,e):cw(ZJ(oqe(s,i),i.values),t):_S(n,e)};function JJ(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Fn(n,e,t):yM(n)(n,e)}const lqe=5;function eee(n,e,t){const s=Math.max(e-lqe,0);return IJ(t-n(s),e-s)}const Gn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},PH=.001;function cqe({duration:n=Gn.duration,bounce:e=Gn.bounce,velocity:t=Gn.velocity,mass:s=Gn.mass}){let i,r,o=1-e;o=dc(Gn.minDamping,Gn.maxDamping,o),n=dc(Gn.minDuration,Gn.maxDuration,ec(n)),o<1?(i=c=>{const h=c*o,f=h*n,p=h-t,g=nD(c,o),y=Math.exp(-f);return PH-p/g*y},r=c=>{const f=c*o*n,p=f*t+t,g=Math.pow(o,2)*Math.pow(c,2)*n,y=Math.exp(-f),x=nD(Math.pow(c,2),o);return(-i(c)+PH>0?-1:1)*((p-g)*y)/x}):(i=c=>{const h=Math.exp(-c*n),f=(c-t)*n+1;return-.001+h*f},r=c=>{const h=Math.exp(-c*n),f=(t-c)*(n*n);return h*f});const a=5/n,l=hqe(i,r,a);if(n=Jl(n),isNaN(l))return{stiffness:Gn.stiffness,damping:Gn.damping,duration:n};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:n}}}const uqe=12;function hqe(n,e,t){let s=t;for(let i=1;i<uqe;i++)s=s-n(s)/e(s);return s}function nD(n,e){return n*Math.sqrt(1-e*e)}const dqe=["duration","bounce"],fqe=["stiffness","damping","mass"];function LH(n,e){return e.some(t=>n[t]!==void 0)}function pqe(n){let e={velocity:Gn.velocity,stiffness:Gn.stiffness,damping:Gn.damping,mass:Gn.mass,isResolvedFromDuration:!1,...n};if(!LH(n,fqe)&&LH(n,dqe))if(n.visualDuration){const t=n.visualDuration,s=2*Math.PI/(t*1.2),i=s*s,r=2*dc(.05,1,1-(n.bounce||0))*Math.sqrt(i);e={...e,mass:Gn.mass,stiffness:i,damping:r}}else{const t=cqe(n);e={...e,...t,mass:Gn.mass},e.isResolvedFromDuration=!0}return e}function tee(n=Gn.visualDuration,e=Gn.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:s,restDelta:i}=t;const r=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],a={done:!1,value:r},{stiffness:l,damping:c,mass:h,duration:f,velocity:p,isResolvedFromDuration:g}=pqe({...t,velocity:-ec(t.velocity||0)}),y=p||0,x=c/(2*Math.sqrt(l*h)),v=o-r,w=ec(Math.sqrt(l/h)),S=Math.abs(v)<5;s||(s=S?Gn.restSpeed.granular:Gn.restSpeed.default),i||(i=S?Gn.restDelta.granular:Gn.restDelta.default);let C;if(x<1){const A=nD(w,x);C=L=>{const O=Math.exp(-x*w*L);return o-O*((y+x*w*v)/A*Math.sin(A*L)+v*Math.cos(A*L))}}else if(x===1)C=A=>o-Math.exp(-w*A)*(v+(y+w*v)*A);else{const A=w*Math.sqrt(x*x-1);C=L=>{const O=Math.exp(-x*w*L),N=Math.min(A*L,300);return o-O*((y+x*w*v)*Math.sinh(N)+A*v*Math.cosh(N))/A}}const I={calculatedDuration:g&&f||null,next:A=>{const L=C(A);if(g)a.done=A>=f;else{let O=0;x<1&&(O=A===0?Jl(y):eee(C,A,L));const N=Math.abs(O)<=s,k=Math.abs(o-L)<=i;a.done=N&&k}return a.value=a.done?o:L,a},toString:()=>{const A=Math.min(vJ(I),K2),L=xJ(O=>I.next(A*O).value,A,30);return A+"ms "+L}};return I}function MH({keyframes:n,velocity:e=0,power:t=.8,timeConstant:s=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:h}){const f=n[0],p={done:!1,value:f},g=N=>a!==void 0&&N<a||l!==void 0&&N>l,y=N=>a===void 0?l:l===void 0||Math.abs(a-N)<Math.abs(l-N)?a:l;let x=t*e;const v=f+x,w=o===void 0?v:o(v);w!==v&&(x=w-f);const S=N=>-x*Math.exp(-N/s),C=N=>w+S(N),I=N=>{const k=S(N),$=C(N);p.done=Math.abs(k)<=c,p.value=p.done?w:$};let A,L;const O=N=>{g(p.value)&&(A=N,L=tee({keyframes:[p.value,y(p.value)],velocity:eee(C,N,p.value),damping:i,stiffness:r,restDelta:c,restSpeed:h}))};return O(0),{calculatedDuration:null,next:N=>{let k=!1;return!L&&A===void 0&&(k=!0,I(N),O(N)),A!==void 0&&N>=A?L.next(N-A):(!k&&I(N),p)}}}const mqe=lw(.42,0,1,1),gqe=lw(0,0,.58,1),nee=lw(.42,0,.58,1),yqe=n=>Array.isArray(n)&&typeof n[0]!="number",bqe={linear:Ur,easeIn:mqe,easeInOut:nee,easeOut:gqe,circIn:dM,circInOut:LJ,circOut:PJ,backIn:hM,backInOut:$J,backOut:DJ,anticipate:OJ},FH=n=>{if(oM(n)){eJ(n.length===4);const[e,t,s,i]=n;return lw(e,t,s,i)}else if(typeof n=="string")return bqe[n];return n};function vqe(n,e,t){const s=[],i=t||JJ,r=n.length-1;for(let o=0;o<r;o++){let a=i(n[o],n[o+1]);if(e){const l=Array.isArray(e)?e[o]||Ur:e;a=cw(l,a)}s.push(a)}return s}function xqe(n,e,{clamp:t=!0,ease:s,mixer:i}={}){const r=n.length;if(eJ(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const o=n[0]===n[1];n[0]>n[r-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=vqe(e,s,i),l=a.length,c=h=>{if(o&&h<n[0])return e[0];let f=0;if(l>1)for(;f<n.length-2&&!(h<n[f+1]);f++);const p=_m(n[f],n[f+1],h);return a[f](p)};return t?h=>c(dc(n[0],n[r-1],h)):c}function wqe(n,e){const t=n[n.length-1];for(let s=1;s<=e;s++){const i=_m(0,e,s);n.push(Fn(t,1,i))}}function _qe(n){const e=[0];return wqe(e,n.length-1),e}function Tqe(n,e){return n.map(t=>t*e)}function Sqe(n,e){return n.map(()=>e||nee).splice(0,n.length-1)}function TS({duration:n=300,keyframes:e,times:t,ease:s="easeInOut"}){const i=yqe(s)?s.map(FH):FH(s),r={done:!1,value:e[0]},o=Tqe(t&&t.length===e.length?t:_qe(e),n),a=xqe(o,e,{ease:Array.isArray(i)?i:Sqe(e,i)});return{calculatedDuration:n,next:l=>(r.value=a(l),r.done=l>=n,r)}}const Eqe=n=>{const e=({timestamp:t})=>n(t);return{start:()=>_n.update(e,!0),stop:()=>nh(e),now:()=>ci.isProcessing?ci.timestamp:Ka.now()}},Cqe={decay:MH,inertia:MH,tween:TS,keyframes:TS,spring:tee},Iqe=n=>n/100;class bM extends QJ{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:t,motionValue:s,element:i,keyframes:r}=this.options,o=(i==null?void 0:i.KeyframeResolver)||gM,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(r,a,t,s,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:r,velocity:o=0}=this.options,a=rM(t)?t:Cqe[t]||TS;let l,c;a!==TS&&typeof e[0]!="number"&&(l=cw(Iqe,JJ(e[0],e[1])),e=[0,100]);const h=a({...this.options,keyframes:e});r==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=vJ(h));const{calculatedDuration:f}=h,p=f+i,g=p*(s+1)-i;return{generator:h,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:f,resolvedDuration:p,totalDuration:g}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:s}=this;if(!s){const{keyframes:N}=this.options;return{done:!0,value:N[N.length-1]}}const{finalKeyframe:i,generator:r,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:h,resolvedDuration:f}=s;if(this.startTime===null)return r.next(0);const{delay:p,repeat:g,repeatType:y,repeatDelay:x,onUpdate:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const w=this.currentTime-p*(this.speed>=0?1:-1),S=this.speed>=0?w<0:w>h;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let C=this.currentTime,I=r;if(g){const N=Math.min(this.currentTime,h)/f;let k=Math.floor(N),$=N%1;!$&&N>=1&&($=1),$===1&&k--,k=Math.min(k,g+1),!!(k%2)&&(y==="reverse"?($=1-$,x&&($-=x/f)):y==="mirror"&&(I=o)),C=dc(0,1,$)*f}const A=S?{done:!1,value:l[0]}:I.next(C);a&&(A.value=a(A.value));let{done:L}=A;!S&&c!==null&&(L=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const O=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&L);return O&&i!==void 0&&(A.value=AI(l,this.options,i)),v&&v(A.value),O&&this.finish(),A}get duration(){const{resolved:e}=this;return e?ec(e.calculatedDuration):0}get time(){return ec(this.currentTime)}set time(e){e=Jl(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=ec(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Eqe,onPlay:t,startTime:s}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const kqe=new Set(["opacity","clipPath","filter","transform"]);function Nqe(n,e,t,{delay:s=0,duration:i=300,repeat:r=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:t};l&&(c.offset=l);const h=_J(a,i);return Array.isArray(h)&&(c.easing=h),n.animate(c,{delay:s,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:r+1,direction:o==="reverse"?"alternate":"normal"})}const Aqe=WL(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),SS=10,Rqe=2e4;function Dqe(n){return rM(n.type)||n.type==="spring"||!wJ(n.ease)}function $qe(n,e){const t=new bM({...e,keyframes:n,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:n[0]};const i=[];let r=0;for(;!s.done&&r<Rqe;)s=t.sample(r),i.push(s.value),r+=SS;return{times:void 0,keyframes:i,duration:r-SS,ease:"linear"}}const see={anticipate:OJ,backInOut:$J,circInOut:LJ};function Oqe(n){return n in see}class VH extends QJ{constructor(e){super(e);const{name:t,motionValue:s,element:i,keyframes:r}=this.options;this.resolver=new YJ(r,(o,a)=>this.onKeyframesResolved(o,a),t,s,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:s=300,times:i,ease:r,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof r=="string"&&xS()&&Oqe(r)&&(r=see[r]),Dqe(this.options)){const{onComplete:f,onUpdate:p,motionValue:g,element:y,...x}=this.options,v=$qe(e,x);e=v.keyframes,e.length===1&&(e[1]=e[0]),s=v.duration,i=v.times,r=v.ease,o="keyframes"}const h=Nqe(a.owner.current,l,e,{...this.options,duration:s,times:i,ease:r});return h.startTime=c??this.calcStartTime(),this.pendingTimeline?(_H(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:f}=this.options;a.set(AI(e,this.options,t)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:s,times:i,type:o,ease:r,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return ec(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return ec(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:s}=t;s.currentTime=Jl(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:s}=t;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Ur;const{animation:s}=t;_H(s,e)}return Ur}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:s,duration:i,type:r,ease:o,times:a}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:h,onComplete:f,element:p,...g}=this.options,y=new bM({...g,keyframes:s,duration:i,type:r,ease:o,times:a,isGenerator:!0}),x=Jl(this.time);c.setWithVelocity(y.sample(x-SS).value,y.sample(x).value,SS)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:s,repeatDelay:i,repeatType:r,damping:o,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return Aqe()&&s&&kqe.has(s)&&!l&&!c&&!i&&r!=="mirror"&&o!==0&&a!=="inertia"}}const Pqe={type:"spring",stiffness:500,damping:25,restSpeed:10},Lqe=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Mqe={type:"keyframes",duration:.8},Fqe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Vqe=(n,{keyframes:e})=>e.length>2?Mqe:If.has(n)?n.startsWith("scale")?Lqe(e[1]):Pqe:Fqe;function zqe({when:n,delay:e,delayChildren:t,staggerChildren:s,staggerDirection:i,repeat:r,repeatType:o,repeatDelay:a,from:l,elapsed:c,...h}){return!!Object.keys(h).length}const vM=(n,e,t,s={},i,r)=>o=>{const a=iM(s,n)||{},l=a.delay||s.delay||0;let{elapsed:c=0}=s;c=c-Jl(l);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:p=>{e.set(p),a.onUpdate&&a.onUpdate(p)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:r?void 0:i};zqe(a)||(h={...h,...Vqe(n,h)}),h.duration&&(h.duration=Jl(h.duration)),h.repeatDelay&&(h.repeatDelay=Jl(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(f=!0)),f&&!r&&e.get()!==void 0){const p=AI(h.keyframes,a);if(p!==void 0)return _n.update(()=>{h.onUpdate(p),h.onComplete()}),new iGe([])}return!r&&VH.supports(h)?new VH(h):new bM(h)};function Bqe({protectedKeys:n,needsAnimating:e},t){const s=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,s}function iee(n,e,{delay:t=0,transitionOverride:s,type:i}={}){var r;let{transition:o=n.getDefaultTransition(),transitionEnd:a,...l}=e;s&&(o=s);const c=[],h=i&&n.animationState&&n.animationState.getState()[i];for(const f in l){const p=n.getValue(f,(r=n.latestValues[f])!==null&&r!==void 0?r:null),g=l[f];if(g===void 0||h&&Bqe(h,f))continue;const y={delay:t,...iM(o||{},f)};let x=!1;if(window.MotionHandoffAnimation){const w=kJ(n);if(w){const S=window.MotionHandoffAnimation(w,f,_n);S!==null&&(y.startTime=S,x=!0)}}Y2(n,f),p.start(vM(f,p,g,n.shouldReduceMotion&&CJ.has(f)?{type:!1}:y,n,x));const v=p.animation;v&&c.push(v)}return a&&Promise.all(c).then(()=>{_n.update(()=>{a&&vGe(n,a)})}),c}function sD(n,e,t={}){var s;const i=Y0(n,e,t.type==="exit"?(s=n.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:r=n.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(r=t.transitionOverride);const o=i?()=>Promise.all(iee(n,i,t)):()=>Promise.resolve(),a=n.variantChildren&&n.variantChildren.size?(c=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:p}=r;return Uqe(n,e,h+c,f,p,t)}:()=>Promise.resolve(),{when:l}=r;if(l){const[c,h]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>h())}else return Promise.all([o(),a(t.delay)])}function Uqe(n,e,t=0,s=0,i=1,r){const o=[],a=(n.variantChildren.size-1)*s,l=i===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(n.variantChildren).sort(Wqe).forEach((c,h)=>{c.notify("AnimationStart",e),o.push(sD(c,e,{...r,delay:t+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function Wqe(n,e){return n.sortNodePosition(e)}function Hqe(n,e,t={}){n.notify("AnimationStart",e);let s;if(Array.isArray(e)){const i=e.map(r=>sD(n,r,t));s=Promise.all(i)}else if(typeof e=="string")s=sD(n,e,t);else{const i=typeof e=="function"?Y0(n,e,t.custom):e;s=Promise.all(iee(n,i,t))}return s.then(()=>{n.notify("AnimationComplete",e)})}function ree(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let s=0;s<t;s++)if(e[s]!==n[s])return!1;return!0}const jqe=jL.length;function oee(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?oee(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<jqe;t++){const s=jL[t],i=n.props[s];(q0(i)||i===!1)&&(e[s]=i)}return e}const Gqe=[...HL].reverse(),qqe=HL.length;function Kqe(n){return e=>Promise.all(e.map(({animation:t,options:s})=>Hqe(n,t,s)))}function Xqe(n){let e=Kqe(n),t=zH(),s=!0;const i=l=>(c,h)=>{var f;const p=Y0(n,h,l==="exit"?(f=n.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(p){const{transition:g,transitionEnd:y,...x}=p;c={...c,...x,...y}}return c};function r(l){e=l(n)}function o(l){const{props:c}=n,h=oee(n.parent)||{},f=[],p=new Set;let g={},y=1/0;for(let v=0;v<qqe;v++){const w=Gqe[v],S=t[w],C=c[w]!==void 0?c[w]:h[w],I=q0(C),A=w===l?S.isActive:null;A===!1&&(y=v);let L=C===h[w]&&C!==c[w]&&I;if(L&&s&&n.manuallyAnimateOnMount&&(L=!1),S.protectedKeys={...g},!S.isActive&&A===null||!C&&!S.prevProp||kI(C)||typeof C=="boolean")continue;const O=Yqe(S.prevProp,C);let N=O||w===l&&S.isActive&&!L&&I||v>y&&I,k=!1;const $=Array.isArray(C)?C:[C];let R=$.reduce(i(w),{});A===!1&&(R={});const{prevResolvedValues:z={}}=S,V={...z,...R},ne=J=>{N=!0,p.has(J)&&(k=!0,p.delete(J)),S.needsAnimating[J]=!0;const Z=n.getValue(J);Z&&(Z.liveStyle=!1)};for(const J in V){const Z=R[J],le=z[J];if(g.hasOwnProperty(J))continue;let H=!1;q2(Z)&&q2(le)?H=!ree(Z,le):H=Z!==le,H?Z!=null?ne(J):p.add(J):Z!==void 0&&p.has(J)?ne(J):S.protectedKeys[J]=!0}S.prevProp=C,S.prevResolvedValues=R,S.isActive&&(g={...g,...R}),s&&n.blockInitialAnimation&&(N=!1),N&&(!(L&&O)||k)&&f.push(...$.map(J=>({animation:J,options:{type:w}})))}if(p.size){const v={};if(typeof c.initial!="boolean"){const w=Y0(n,Array.isArray(c.initial)?c.initial[0]:c.initial);w&&w.transition&&(v.transition=w.transition)}p.forEach(w=>{const S=n.getBaseTarget(w),C=n.getValue(w);C&&(C.liveStyle=!0),v[w]=S??null}),f.push({animation:v})}let x=!!f.length;return s&&(c.initial===!1||c.initial===c.animate)&&!n.manuallyAnimateOnMount&&(x=!1),s=!1,x?e(f):Promise.resolve()}function a(l,c){var h;if(t[l].isActive===c)return Promise.resolve();(h=n.variantChildren)===null||h===void 0||h.forEach(p=>{var g;return(g=p.animationState)===null||g===void 0?void 0:g.setActive(l,c)}),t[l].isActive=c;const f=o(l);for(const p in t)t[p].protectedKeys={};return f}return{animateChanges:o,setActive:a,setAnimateFunction:r,getState:()=>t,reset:()=>{t=zH(),s=!0}}}function Yqe(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!ree(e,n):!1}function sd(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function zH(){return{animate:sd(!0),whileInView:sd(),whileHover:sd(),whileTap:sd(),whileDrag:sd(),whileFocus:sd(),exit:sd()}}class yh{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Qqe extends yh{constructor(e){super(e),e.animationState||(e.animationState=Xqe(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();kI(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let Zqe=0;class Jqe extends yh{constructor(){super(...arguments),this.id=Zqe++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const e9e={animation:{Feature:Qqe},exit:{Feature:Jqe}};function J0(n,e,t,s={passive:!0}){return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t)}function uw(n){return{point:{x:n.pageX,y:n.pageY}}}const t9e=n=>e=>aM(e)&&n(e,uw(e));function Rp(n,e,t,s){return J0(n,e,t9e(t),s)}function aee({top:n,left:e,right:t,bottom:s}){return{x:{min:e,max:t},y:{min:n,max:s}}}function n9e({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function s9e(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),s=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:s.y,right:s.x}}const lee=1e-4,i9e=1-lee,r9e=1+lee,cee=.01,o9e=0-cee,a9e=0+cee;function Qi(n){return n.max-n.min}function l9e(n,e,t){return Math.abs(n-e)<=t}function BH(n,e,t,s=.5){n.origin=s,n.originPoint=Fn(e.min,e.max,n.origin),n.scale=Qi(t)/Qi(e),n.translate=Fn(t.min,t.max,n.origin)-n.originPoint,(n.scale>=i9e&&n.scale<=r9e||isNaN(n.scale))&&(n.scale=1),(n.translate>=o9e&&n.translate<=a9e||isNaN(n.translate))&&(n.translate=0)}function i0(n,e,t,s){BH(n.x,e.x,t.x,s?s.originX:void 0),BH(n.y,e.y,t.y,s?s.originY:void 0)}function UH(n,e,t){n.min=t.min+e.min,n.max=n.min+Qi(e)}function c9e(n,e,t){UH(n.x,e.x,t.x),UH(n.y,e.y,t.y)}function WH(n,e,t){n.min=e.min-t.min,n.max=n.min+Qi(e)}function r0(n,e,t){WH(n.x,e.x,t.x),WH(n.y,e.y,t.y)}const HH=()=>({translate:0,scale:1,origin:0,originPoint:0}),Dp=()=>({x:HH(),y:HH()}),jH=()=>({min:0,max:0}),ss=()=>({x:jH(),y:jH()});function fo(n){return[n("x"),n("y")]}function BA(n){return n===void 0||n===1}function iD({scale:n,scaleX:e,scaleY:t}){return!BA(n)||!BA(e)||!BA(t)}function cd(n){return iD(n)||uee(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function uee(n){return GH(n.x)||GH(n.y)}function GH(n){return n&&n!=="0%"}function ES(n,e,t){const s=n-t,i=e*s;return t+i}function qH(n,e,t,s,i){return i!==void 0&&(n=ES(n,i,s)),ES(n,t,s)+e}function rD(n,e=0,t=1,s,i){n.min=qH(n.min,e,t,s,i),n.max=qH(n.max,e,t,s,i)}function hee(n,{x:e,y:t}){rD(n.x,e.translate,e.scale,e.originPoint),rD(n.y,t.translate,t.scale,t.originPoint)}const KH=.999999999999,XH=1.0000000000001;function u9e(n,e,t,s=!1){const i=t.length;if(!i)return;e.x=e.y=1;let r,o;for(let a=0;a<i;a++){r=t[a],o=r.projectionDelta;const{visualElement:l}=r.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&r.options.layoutScroll&&r.scroll&&r!==r.root&&Op(n,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,hee(n,o)),s&&cd(r.latestValues)&&Op(n,r.latestValues))}e.x<XH&&e.x>KH&&(e.x=1),e.y<XH&&e.y>KH&&(e.y=1)}function $p(n,e){n.min=n.min+e,n.max=n.max+e}function YH(n,e,t,s,i=.5){const r=Fn(n.min,n.max,i);rD(n,e,t,r,s)}function Op(n,e){YH(n.x,e.x,e.scaleX,e.scale,e.originX),YH(n.y,e.y,e.scaleY,e.scale,e.originY)}function dee(n,e){return aee(s9e(n.getBoundingClientRect(),e))}function h9e(n,e,t){const s=dee(n,t),{scroll:i}=e;return i&&($p(s.x,i.offset.x),$p(s.y,i.offset.y)),s}const QH=(n,e)=>Math.abs(n-e);function d9e(n,e){const t=QH(n.x,e.x),s=QH(n.y,e.y);return Math.sqrt(t**2+s**2)}class fee{constructor(e,t,{transformPagePoint:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=WA(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,p=d9e(h.offset,{x:0,y:0})>=3;if(!f&&!p)return;const{point:g}=h,{timestamp:y}=ci;this.history.push({...g,timestamp:y});const{onStart:x,onMove:v}=this.handlers;f||(x&&x(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{if(h.target instanceof Element&&h.target.hasPointerCapture&&h.pointerId!==void 0)try{if(!h.target.hasPointerCapture(h.pointerId))return}catch{}this.lastMoveEvent=h,this.lastMoveEventInfo=UA(f,this.transformPagePoint),_n.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{wS(h,"release"),this.end();const{onEnd:p,onSessionEnd:g,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=WA(h.type==="pointercancel"||h.type==="lostpointercapture"?this.lastMoveEventInfo:UA(f,this.transformPagePoint),this.history);this.startEvent&&p&&p(h,x),g&&g(h,x)},!aM(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=s;const r=uw(e),o=UA(r,this.transformPagePoint),{point:a}=o,{timestamp:l}=ci;this.history=[{...a,timestamp:l}];const{onSessionStart:c}=t;c&&c(e,WA(o,this.history)),wS(e,"set"),this.removeListeners=cw(Rp(e.currentTarget,"pointermove",this.handlePointerMove),Rp(e.currentTarget,"pointerup",this.handlePointerUp),Rp(e.currentTarget,"pointercancel",this.handlePointerUp),Rp(e.currentTarget,"lostpointercapture",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),nh(this.updatePoint)}}function UA(n,e){return e?{point:e(n.point)}:n}function ZH(n,e){return{x:n.x-e.x,y:n.y-e.y}}function WA({point:n},e){return{point:n,delta:ZH(n,pee(e)),offset:ZH(n,f9e(e)),velocity:p9e(e,.1)}}function f9e(n){return n[0]}function pee(n){return n[n.length-1]}function p9e(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,s=null;const i=pee(n);for(;t>=0&&(s=n[t],!(i.timestamp-s.timestamp>Jl(e)));)t--;if(!s)return{x:0,y:0};const r=ec(i.timestamp-s.timestamp);if(r===0)return{x:0,y:0};const o={x:(i.x-s.x)/r,y:(i.y-s.y)/r};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function m9e(n,{min:e,max:t},s){return e!==void 0&&n<e?n=s?Fn(e,n,s.min):Math.max(n,e):t!==void 0&&n>t&&(n=s?Fn(t,n,s.max):Math.min(n,t)),n}function JH(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function g9e(n,{top:e,left:t,bottom:s,right:i}){return{x:JH(n.x,t,i),y:JH(n.y,e,s)}}function ej(n,e){let t=e.min-n.min,s=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,s]=[s,t]),{min:t,max:s}}function y9e(n,e){return{x:ej(n.x,e.x),y:ej(n.y,e.y)}}function b9e(n,e){let t=.5;const s=Qi(n),i=Qi(e);return i>s?t=_m(e.min,e.max-s,n.min):s>i&&(t=_m(n.min,n.max-i,e.min)),dc(0,1,t)}function v9e(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const oD=.35;function x9e(n=oD){return n===!1?n=0:n===!0&&(n=oD),{x:tj(n,"left","right"),y:tj(n,"top","bottom")}}function tj(n,e,t){return{min:nj(n,e),max:nj(n,t)}}function nj(n,e){return typeof n=="number"?n:n[e]||0}const w9e=new WeakMap;class _9e{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ss(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(uw(h).point)},r=(h,f)=>{const{drag:p,dragPropagation:g,onDragStart:y}=this.getProps();if(p&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=pGe(p),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fo(v=>{let w=this.getAxisMotionValue(v).get()||0;if(qa.test(w)){const{projection:S}=this.visualElement;if(S&&S.layout){const C=S.layout.layoutBox[v];C&&(w=Qi(C)*(parseFloat(w)/100))}}this.originPoint[v]=w}),y&&_n.postRender(()=>y(h,f)),Y2(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(h,f)=>{const{dragPropagation:p,dragDirectionLock:g,onDirectionLock:y,onDrag:x}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:v}=f;if(g&&this.currentDirection===null){this.currentDirection=T9e(v),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",f.point,v),this.updateAxis("y",f.point,v),this.visualElement.render(),x&&x(h,f)},a=(h,f)=>this.stop(h,f),l=()=>fo(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new fee(e,{onSessionStart:i,onStart:r,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c})}stop(e,t){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&_n.postRender(()=>r(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,s){const{drag:i}=this.getProps();if(!s||!m1(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=m9e(o,this.constraints[e],this.elastic[e])),r.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:s}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,r=this.constraints;t&&Np(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=g9e(i.layoutBox,t):this.constraints=!1,this.elastic=x9e(s),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&fo(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=v9e(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Np(e))return!1;const s=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=h9e(s,i.root,this.visualElement.getTransformPagePoint());let o=y9e(i.layout.layoutBox,r);if(t){const a=t(n9e(o));this.hasMutatedConstraints=!!a,a&&(o=aee(a))}return o}startAnimation(e){const{drag:t,dragMomentum:s,dragElastic:i,dragTransition:r,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=fo(h=>{if(!m1(h,t,this.currentDirection))return;let f=l&&l[h]||{};o&&(f={min:0,max:0});const p=i?200:1e6,g=i?40:1e7,y={type:"inertia",velocity:s?e[h]:0,bounceStiffness:p,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...r,...f};return this.startAxisValueAnimation(h,y)});return Promise.all(c).then(a)}startAxisValueAnimation(e,t){const s=this.getAxisMotionValue(e);return Y2(this.visualElement,e),s.start(vM(e,s,0,t,this.visualElement,!1))}stopAnimation(){fo(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){fo(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),i=s[t];return i||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){fo(t=>{const{drag:s}=this.getProps();if(!m1(t,s,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[t];r.set(e[t]-Fn(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:s}=this.visualElement;if(!Np(t)||!s||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};fo(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();i[o]=b9e({min:l,max:l},this.constraints[o])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),fo(o=>{if(!m1(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Fn(l,c,i[o]))})}addListeners(){if(!this.visualElement.current)return;w9e.set(this.visualElement,this);const e=this.visualElement.current,t=Rp(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();Np(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),_n.read(s);const o=J0(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(fo(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=l[h].translate,f.set(f.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),t(),r(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:s=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:o=oD,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:s,dragPropagation:i,dragConstraints:r,dragElastic:o,dragMomentum:a}}}function m1(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function T9e(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class S9e extends yh{constructor(e){super(e),this.removeGroupControls=Ur,this.removeListeners=Ur,this.controls=new _9e(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ur}unmount(){this.removeGroupControls(),this.removeListeners()}}const sj=n=>(e,t)=>{n&&_n.postRender(()=>n(e,t))};class E9e extends yh{constructor(){super(...arguments),this.removePointerDownListener=Ur}onPointerDown(e){this.session=new fee(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:s,onPanEnd:i}=this.node.getProps();return{onSessionStart:sj(e),onStart:sj(t),onMove:s,onEnd:(r,o)=>{delete this.session,i&&_n.postRender(()=>i(r,o))}}}mount(){this.removePointerDownListener=Rp(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const J1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ij(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Tb={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(nt.test(n))n=parseFloat(n);else return n;const t=ij(n,e.target.x),s=ij(n,e.target.y);return`${t}% ${s}%`}},C9e={correct:(n,{treeScale:e,projectionDelta:t})=>{const s=n,i=sh.parse(n);if(i.length>5)return s;const r=sh.createTransformer(n),o=typeof i[0]!="number"?1:0,a=t.x.scale*e.x,l=t.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const c=Fn(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=c),typeof i[3+o]=="number"&&(i[3+o]/=c),r(i)}};class I9e extends oe.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:s,layoutId:i}=this.props,{projection:r}=e;R5e(k9e),r&&(t.group&&t.group.add(r),s&&s.register&&i&&s.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),J1.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:s,drag:i,isPresent:r}=this.props,o=s.projection;return o&&(o.isPresent=r,i||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?o.promote():o.relegate()||_n.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),qL.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:s}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),s&&s.deregister&&s.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function mee(n){const[e,t]=l5e(),s=oe.useContext(ZZ);return be.jsx(I9e,{...n,layoutGroup:s,switchLayoutGroup:oe.useContext(oJ),isPresent:e,safeToRemove:t})}const k9e={borderRadius:{...Tb,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Tb,borderTopRightRadius:Tb,borderBottomLeftRadius:Tb,borderBottomRightRadius:Tb,boxShadow:C9e};function N9e(n,e,t){const s=Pi(n)?n:Q0(n);return s.start(vM("",s,e,t)),s.animation}function A9e(n){return n instanceof SVGElement&&n.tagName!=="svg"}const R9e=(n,e)=>n.depth-e.depth;class D9e{constructor(){this.children=[],this.isDirty=!1}add(e){lM(this.children,e),this.isDirty=!0}remove(e){cM(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(R9e),this.isDirty=!1,this.children.forEach(e)}}function $9e(n,e){const t=Ka.now(),s=({timestamp:i})=>{const r=i-t;r>=e&&(nh(s),n(r-e))};return _n.read(s,!0),()=>nh(s)}const gee=["TopLeft","TopRight","BottomLeft","BottomRight"],O9e=gee.length,rj=n=>typeof n=="string"?parseFloat(n):n,oj=n=>typeof n=="number"||nt.test(n);function P9e(n,e,t,s,i,r){i?(n.opacity=Fn(0,t.opacity!==void 0?t.opacity:1,L9e(s)),n.opacityExit=Fn(e.opacity!==void 0?e.opacity:1,0,M9e(s))):r&&(n.opacity=Fn(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,s));for(let o=0;o<O9e;o++){const a=`border${gee[o]}Radius`;let l=aj(e,a),c=aj(t,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||oj(l)===oj(c)?(n[a]=Math.max(Fn(rj(l),rj(c),s),0),(qa.test(c)||qa.test(l))&&(n[a]+="%")):n[a]=c}(e.rotate||t.rotate)&&(n.rotate=Fn(e.rotate||0,t.rotate||0,s))}function aj(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const L9e=yee(0,.5,PJ),M9e=yee(.5,.95,Ur);function yee(n,e,t){return s=>s<n?0:s>e?1:t(_m(n,e,s))}function lj(n,e){n.min=e.min,n.max=e.max}function ho(n,e){lj(n.x,e.x),lj(n.y,e.y)}function cj(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function uj(n,e,t,s,i){return n-=e,n=ES(n,1/t,s),i!==void 0&&(n=ES(n,1/i,s)),n}function F9e(n,e=0,t=1,s=.5,i,r=n,o=n){if(qa.test(e)&&(e=parseFloat(e),e=Fn(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Fn(r.min,r.max,s);n===r&&(a-=e),n.min=uj(n.min,e,t,a,i),n.max=uj(n.max,e,t,a,i)}function hj(n,e,[t,s,i],r,o){F9e(n,e[t],e[s],e[i],e.scale,r,o)}const V9e=["x","scaleX","originX"],z9e=["y","scaleY","originY"];function dj(n,e,t,s){hj(n.x,e,V9e,t?t.x:void 0,s?s.x:void 0),hj(n.y,e,z9e,t?t.y:void 0,s?s.y:void 0)}function fj(n){return n.translate===0&&n.scale===1}function bee(n){return fj(n.x)&&fj(n.y)}function pj(n,e){return n.min===e.min&&n.max===e.max}function B9e(n,e){return pj(n.x,e.x)&&pj(n.y,e.y)}function mj(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function vee(n,e){return mj(n.x,e.x)&&mj(n.y,e.y)}function gj(n){return Qi(n.x)/Qi(n.y)}function yj(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class U9e{constructor(){this.members=[]}add(e){lM(this.members,e),e.scheduleRender()}remove(e){if(cM(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let s;for(let i=t;i>=0;i--){const r=this.members[i];if(r.isPresent!==!1){s=r;break}}return s?(this.promote(s),!0):!1}promote(e,t){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,t&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:s}=e;t.onExitComplete&&t.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function W9e(n,e,t){let s="";const i=n.x.translate/e.x,r=n.y.translate/e.y,o=(t==null?void 0:t.z)||0;if((i||r||o)&&(s=`translate3d(${i}px, ${r}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:c,rotate:h,rotateX:f,rotateY:p,skewX:g,skewY:y}=t;c&&(s=`perspective(${c}px) ${s}`),h&&(s+=`rotate(${h}deg) `),f&&(s+=`rotateX(${f}deg) `),p&&(s+=`rotateY(${p}deg) `),g&&(s+=`skewX(${g}deg) `),y&&(s+=`skewY(${y}deg) `)}const a=n.x.scale*e.x,l=n.y.scale*e.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const HA=["","X","Y","Z"],H9e={visibility:"hidden"},bj=1e3;let j9e=0;function jA(n,e,t,s){const{latestValues:i}=e;i[n]&&(t[n]=i[n],e.setStaticValue(n,0),s&&(s[n]=0))}function xee(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=kJ(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:r}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",_n,!(i||r))}const{parent:s}=n;s&&!s.hasCheckedOptimisedAppear&&xee(s)}function wee({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:s,resetTransform:i}){return class{constructor(o={},a=e==null?void 0:e()){this.id=j9e++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(K9e),this.nodes.forEach(J9e),this.nodes.forEach(e8e),this.nodes.forEach(X9e)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new D9e)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new uM),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=A9e(o),this.instance=o;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),n){let f;const p=()=>this.root.updateBlockedByResize=!1;n(o,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=$9e(p,250),J1.hasAnimatedSinceResize&&(J1.hasAnimatedSinceResize=!1,this.nodes.forEach(xj))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:p,hasRelativeLayoutChanged:g,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||h.getDefaultTransition()||r8e,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=h.getProps(),S=!this.targetLayout||!vee(this.targetLayout,y),C=!p&&g;if(this.options.layoutRoot||this.resumeFrom||C||p&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,C);const I={...iM(x,"layout"),onPlay:v,onComplete:w};(h.shouldReduceMotion||this.options.layoutRoot)&&(I.delay=0,I.type=!1),this.startAnimation(I)}else p||xj(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,nh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(t8e),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&xee(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(vj);return}this.isUpdating||this.nodes.forEach(Q9e),this.isUpdating=!1,this.nodes.forEach(Z9e),this.nodes.forEach(G9e),this.nodes.forEach(q9e),this.clearAllSnapshots();const a=Ka.now();ci.delta=dc(0,1e3/60,a-ci.timestamp),ci.timestamp=a,ci.isProcessing=!0,LA.update.process(ci),LA.preRender.process(ci),LA.render.process(ci),ci.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,qL.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Y9e),this.sharedNodes.forEach(n8e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,_n.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){_n.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Qi(this.snapshot.measuredBox.x)&&!Qi(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ss(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!bee(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;o&&(a||cd(this.latestValues)||h)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),o8e(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return ss();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(a8e))){const{scroll:h}=this.root;h&&($p(l.x,h.offset.x),$p(l.y,h.offset.y))}return l}removeElementScroll(o){var a;const l=ss();if(ho(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const h=this.path[c],{scroll:f,options:p}=h;h!==this.root&&f&&p.layoutScroll&&(f.wasRoot&&ho(l,o),$p(l.x,f.offset.x),$p(l.y,f.offset.y))}return l}applyTransform(o,a=!1){const l=ss();ho(l,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Op(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),cd(h.latestValues)&&Op(l,h.latestValues)}return cd(this.latestValues)&&Op(l,this.latestValues),l}removeTransform(o){const a=ss();ho(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!cd(c.latestValues))continue;iD(c.latestValues)&&c.updateSnapshot();const h=ss(),f=c.measurePageBox();ho(h,f),dj(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return cd(this.latestValues)&&dj(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ci.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:p}=this.options;if(!(!this.layout||!(f||p))){if(this.resolvedRelativeTargetAt=ci.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),r0(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),ho(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ss(),this.targetWithTransforms=ss()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),c9e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ho(this.target,this.layout.layoutBox),hee(this.target,this.targetDelta)):ho(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),r0(this.relativeTargetOrigin,this.target,g.target),ho(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||iD(this.parent.latestValues)||uee(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ci.timestamp&&(c=!1),c)return;const{layout:h,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||f))return;ho(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,g=this.treeScale.y;u9e(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ss());const{target:y}=a;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(cj(this.prevProjectionDelta.x,this.projectionDelta.x),cj(this.prevProjectionDelta.y,this.projectionDelta.y)),i0(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==g||!yj(this.projectionDelta.x,this.prevProjectionDelta.x)||!yj(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Dp(),this.projectionDelta=Dp(),this.projectionDeltaWithTransform=Dp()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},f=Dp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const p=ss(),g=l?l.source:void 0,y=this.layout?this.layout.source:void 0,x=g!==y,v=this.getStack(),w=!v||v.members.length<=1,S=!!(x&&!w&&this.options.crossfade===!0&&!this.path.some(i8e));this.animationProgress=0;let C;this.mixTargetDelta=I=>{const A=I/1e3;wj(f.x,o.x,A),wj(f.y,o.y,A),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(r0(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),s8e(this.relativeTarget,this.relativeTargetOrigin,p,A),C&&B9e(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=ss()),ho(C,this.relativeTarget)),x&&(this.animationValues=h,P9e(h,c,this.latestValues,A,S,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(nh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=_n.update(()=>{J1.hasAnimatedSinceResize=!0,this.currentAnimation=N9e(0,bj,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(bj),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:h}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&_ee(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||ss();const f=Qi(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+f;const p=Qi(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+p}ho(a,l),Op(a,h),i0(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new U9e),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&jA("z",o,c,this.animationValues);for(let h=0;h<HA.length;h++)jA(`rotate${HA[h]}`,o,c,this.animationValues),jA(`skew${HA[h]}`,o,c,this.animationValues);o.render();for(const h in c)o.setStaticValue(h,c[h]),this.animationValues&&(this.animationValues[h]=c[h]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return H9e;const c={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=Q1(o==null?void 0:o.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=Q1(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!cd(this.latestValues)&&(x.transform=h?h({},""):"none",this.hasProjected=!1),x}const p=f.animationValues||f.latestValues;this.applyTransformsToTarget(),c.transform=W9e(this.projectionDeltaWithTransform,this.treeScale,p),h&&(c.transform=h(p,c.transform));const{x:g,y}=this.projectionDelta;c.transformOrigin=`${g.origin*100}% ${y.origin*100}% 0`,f.animationValues?c.opacity=f===this?(l=(a=p.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:c.opacity=f===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const x in K0){if(p[x]===void 0)continue;const{correct:v,applyTo:w,isCSSVariable:S}=K0[x],C=c.transform==="none"?p[x]:v(p[x],f);if(w){const I=w.length;for(let A=0;A<I;A++)c[w[A]]=C}else S?this.options.visualElement.renderState.vars[x]=C:c[x]=C}return this.options.layoutId&&(c.pointerEvents=f===this?Q1(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(vj),this.root.sharedNodes.clear()}}}function G9e(n){n.updateLayout()}function q9e(n){var e;const t=((e=n.resumeFrom)===null||e===void 0?void 0:e.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:i}=n.layout,{animationType:r}=n.options,o=t.source!==n.layout.source;r==="size"?fo(f=>{const p=o?t.measuredBox[f]:t.layoutBox[f],g=Qi(p);p.min=s[f].min,p.max=p.min+g}):_ee(r,t.layoutBox,s)&&fo(f=>{const p=o?t.measuredBox[f]:t.layoutBox[f],g=Qi(s[f]);p.max=p.min+g,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[f].max=n.relativeTarget[f].min+g)});const a=Dp();i0(a,s,t.layoutBox);const l=Dp();o?i0(l,n.applyTransform(i,!0),t.measuredBox):i0(l,s,t.layoutBox);const c=!bee(a);let h=!1;if(!n.resumeFrom){const f=n.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:p,layout:g}=f;if(p&&g){const y=ss();r0(y,t.layoutBox,p.layoutBox);const x=ss();r0(x,s,g.layoutBox),vee(y,x)||(h=!0),f.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=y,n.relativeParent=f)}}}n.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeLayoutChanged:h})}else if(n.isLead()){const{onExitComplete:s}=n.options;s&&s()}n.options.transition=void 0}function K9e(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function X9e(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function Y9e(n){n.clearSnapshot()}function vj(n){n.clearMeasurements()}function Q9e(n){n.isLayoutDirty=!1}function Z9e(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function xj(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function J9e(n){n.resolveTargetDelta()}function e8e(n){n.calcProjection()}function t8e(n){n.resetSkewAndRotation()}function n8e(n){n.removeLeadSnapshot()}function wj(n,e,t){n.translate=Fn(e.translate,0,t),n.scale=Fn(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function _j(n,e,t,s){n.min=Fn(e.min,t.min,s),n.max=Fn(e.max,t.max,s)}function s8e(n,e,t,s){_j(n.x,e.x,t.x,s),_j(n.y,e.y,t.y,s)}function i8e(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const r8e={duration:.45,ease:[.4,0,.1,1]},Tj=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),Sj=Tj("applewebkit/")&&!Tj("chrome/")?Math.round:Ur;function Ej(n){n.min=Sj(n.min),n.max=Sj(n.max)}function o8e(n){Ej(n.x),Ej(n.y)}function _ee(n,e,t){return n==="position"||n==="preserve-aspect"&&!l9e(gj(e),gj(t),.2)}function a8e(n){var e;return n!==n.root&&((e=n.scroll)===null||e===void 0?void 0:e.wasRoot)}const l8e=wee({attachResizeListener:(n,e)=>J0(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),GA={current:void 0},Tee=wee({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!GA.current){const n=new l8e({});n.mount(window),n.setOptions({layoutScroll:!0}),GA.current=n}return GA.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),c8e={pan:{Feature:E9e},drag:{Feature:S9e,ProjectionNode:Tee,MeasureLayout:mee}};function Cj(n,e,t){const{props:s}=n;n.animationState&&s.whileHover&&n.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,r=s[i];r&&_n.postRender(()=>r(e,uw(e)))}class u8e extends yh{mount(){const{current:e}=this.node;e&&(this.unmount=lGe(e,(t,s)=>(Cj(this.node,s,"Start"),i=>Cj(this.node,i,"End"))))}unmount(){}}class h8e extends yh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=cw(J0(this.node.current,"focus",()=>this.onFocus()),J0(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Ij(n,e,t){const{props:s}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&s.whileTap&&n.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),r=s[i];r&&_n.postRender(()=>r(e,uw(e)))}class d8e extends yh{mount(){const{current:e}=this.node;e&&(this.unmount=dGe(e,(t,s)=>(Ij(this.node,s,"Start"),(i,{success:r})=>Ij(this.node,i,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const aD=new WeakMap,qA=new WeakMap,f8e=n=>{const e=aD.get(n.target);e&&e(n)},p8e=n=>{n.forEach(f8e)};function m8e({root:n,...e}){const t=n||document;qA.has(t)||qA.set(t,{});const s=qA.get(t),i=JSON.stringify(e);return s[i]||(s[i]=new IntersectionObserver(p8e,{root:n,...e})),s[i]}function g8e(n,e,t){const s=m8e(e);return aD.set(n,t),s.observe(n),()=>{aD.delete(n),s.unobserve(n)}}const y8e={some:0,all:1};class b8e extends yh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:s,amount:i="some",once:r}=e,o={root:t?t.current:void 0,rootMargin:s,threshold:typeof i=="number"?i:y8e[i]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,r&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),p=c?h:f;p&&p(l)};return g8e(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(v8e(e,t))&&this.startObserver()}unmount(){}}function v8e({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const x8e={inView:{Feature:b8e},tap:{Feature:d8e},focus:{Feature:h8e},hover:{Feature:u8e}},w8e={layout:{ProjectionNode:Tee,MeasureLayout:mee}},lD={current:null},See={current:!1};function _8e(){if(See.current=!0,!!UL)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>lD.current=n.matches;n.addListener(e),e()}else lD.current=!1}const T8e=[...XJ,_i,sh],S8e=n=>T8e.find(KJ(n)),E8e=new WeakMap;function C8e(n,e,t){for(const s in e){const i=e[s],r=t[s];if(Pi(i))n.addValue(s,i);else if(Pi(r))n.addValue(s,Q0(i,{owner:n}));else if(r!==i)if(n.hasValue(s)){const o=n.getValue(s);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(s);n.addValue(s,Q0(o!==void 0?o:i,{owner:n}))}}for(const s in t)e[s]===void 0&&n.removeValue(s);return e}const kj=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class I8e{scrapeMotionValuesFromProps(e,t,s){return{}}constructor({parent:e,props:t,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:r,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=gM,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=Ka.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,_n.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:h}=o;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=t.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=t,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!r,this.isControllingVariants=NI(t),this.isVariantNode=iJ(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const g in p){const y=p[g];l[g]!==void 0&&Pi(y)&&y.set(l[g],!1)}}mount(e){this.current=e,E8e.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,s)=>this.bindToMotionValue(s,t)),See.current||_8e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:lD.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),nh(this.notifyUpdate),nh(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=If.has(e);s&&this.onBindTransform&&this.onBindTransform();const i=t.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&_n.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),r=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),r(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Tm){const t=Tm[e];if(!t)continue;const{isEnabled:s,Feature:i}=t;if(!this.features[e]&&i&&s(this.props)&&(this.features[e]=new i(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ss()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let s=0;s<kj.length;s++){const i=kj[s];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const r="on"+i,o=e[r];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=C8e(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const s=this.values.get(e);t!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&t!==void 0&&(s=Q0(t===null?void 0:t,{owner:this}),this.addValue(e,s)),s}readValue(e,t){var s;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(GJ(i)||MJ(i))?i=parseFloat(i):!S8e(i)&&sh.test(t)&&(i=WJ(e,t)),this.setBaseTarget(e,Pi(i)?i.get():i)),Pi(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:s}=this.props;let i;if(typeof s=="string"||typeof s=="object"){const o=nM(this.props,s,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(i=o[e])}if(s&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!Pi(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new uM),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class Eee extends I8e{constructor(){super(...arguments),this.KeyframeResolver=YJ}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:s}){delete t[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Pi(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function k8e(n){return window.getComputedStyle(n)}class N8e extends Eee{constructor(){super(...arguments),this.type="html",this.renderInstance=mJ}readValueFromInstance(e,t){if(If.has(t)){const s=mM(t);return s&&s.default||0}else{const s=k8e(e),i=(KL(t)?s.getPropertyValue(t):s[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return dee(e,t)}build(e,t,s){QL(e,t,s.transformTemplate)}scrapeMotionValuesFromProps(e,t,s){return sM(e,t,s)}}class A8e extends Eee{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ss,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&pJ(this.current,this.renderState)}}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(If.has(t)){const s=mM(t);return s&&s.default||0}return t=gJ.has(t)?t:GL(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,s){return bJ(e,t,s)}onBindTransform(){this.current&&!this.renderState.dimensions&&_n.postRender(this.updateDimensions)}build(e,t,s){eM(e,t,this.isSVGTag,s.transformTemplate)}renderInstance(e,t,s,i){yJ(e,t,s,i)}mount(e){this.isSVGTag=tM(e.tagName),super.mount(e)}}const R8e=(n,e)=>JL(n)?new A8e(e):new N8e(e,{allowProjection:n!==oe.Fragment}),D8e=tGe({...e9e,...x8e,...c8e,...w8e},R8e),cD=y5e(D8e);function $8e(){const[n,e]=oe.useState(""),[t,s]=oe.useState(""),[i,r]=oe.useState(null),o=Im(),a=async l=>{l.preventDefault(),r(null);try{await G4e(B0,n,t),o("/home")}catch{r("Failed to create account. Try again.")}};return be.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 md:max-h-screen sm:max-h-screen sm:max-w-screen",children:be.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md",children:[be.jsx("h2",{className:"text-2xl font-bold text-center text-gray-800 mb-6",children:"Sign Up"}),i&&be.jsx("p",{className:"text-red-500 text-center mb-4",children:i}),be.jsxs("form",{onSubmit:a,className:"space-y-4",children:[be.jsxs("div",{children:[be.jsx("label",{className:"block text-gray-700 mb-1",children:"Email"}),be.jsx("input",{type:"email",value:n,onChange:l=>e(l.target.value),required:!0,placeholder:"Enter your email",className:"w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),be.jsxs("div",{children:[be.jsx("label",{className:"block text-gray-700 mb-1",children:"Password"}),be.jsx("input",{type:"password",value:t,onChange:l=>s(l.target.value),required:!0,placeholder:"Enter your password",className:"w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),be.jsx(cD.button,{whileHover:{scale:1.05},type:"submit",className:"w-full py-3 bg-green-500 text-white font-semibold rounded-md shadow-lg hover:bg-green-600 transition",children:"Create Account"})]}),be.jsxs("p",{className:"mt-4 text-center text-gray-600",children:["Already have an account?"," ",be.jsx(Td,{to:"/login",className:"text-green-600 hover:underline",children:"Sign in"})]})]})})}const O8e=()=>{const[n,e]=oe.useState(""),[t,s]=oe.useState(""),[i,r]=oe.useState(null),[o,a]=oe.useState(!1),l=Im(),c=async f=>{f.preventDefault(),r(null),a(!0);try{await q4e(B0,n,t),l("/home")}catch{r("Invalid email or password. Try again.")}finally{a(!1)}},h=async()=>{r(null),a(!0);try{await vUe(B0,dWe),l("/home")}catch{r("Google sign-in failed. Try again Later and allow popup.")}finally{a(!1)}};return be.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:be.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-lg shadow-md",children:[be.jsx("h2",{className:"text-2xl font-bold text-center text-gray-800 mb-6",children:"Login"}),i&&be.jsx("p",{className:"text-red-500 text-center mb-4",children:i}),be.jsxs("form",{onSubmit:c,className:"space-y-4",children:[be.jsxs("div",{children:[be.jsx("label",{className:"block text-gray-700 mb-1",children:"Email"}),be.jsx("input",{type:"email",value:n,onChange:f=>e(f.target.value),required:!0,placeholder:"Enter your email",className:"w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),be.jsxs("div",{children:[be.jsx("label",{className:"block text-gray-700 mb-1",children:"Password"}),be.jsx("input",{type:"password",value:t,onChange:f=>s(f.target.value),required:!0,placeholder:"Enter your password",className:"w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),be.jsx(cD.button,{whileHover:{scale:1.05},type:"submit",disabled:o,className:`w-full py-3 text-white font-semibold rounded-md shadow-lg transition ${o?"bg-gray-400":"bg-green-500 hover:bg-green-600"}`,children:o?"Logging in...":"Sign In"})]}),be.jsxs("div",{className:"mt-4 text-center",children:[be.jsx("p",{className:"text-gray-600",children:"Or sign in with"}),be.jsxs(cD.button,{whileHover:{scale:1.05},onClick:h,disabled:o,className:`mt-2 flex items-center justify-center w-full py-3 border border-gray-300 rounded-md shadow-md bg-white hover:bg-gray-200 transition ${o?"bg-gray-400":""}`,children:[be.jsx("img",{src:"https://www.svgrepo.com/show/355037/google.svg",alt:"Google Logo",className:"w-6 h-6 mr-2"}),"Sign in with Google"]})]}),be.jsxs("p",{className:"mt-4 text-center text-gray-600",children:["Don't have an account?"," ",be.jsx(Td,{to:"/signup",className:"text-green-600 hover:underline",children:"Sign up"})]})]})})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cee="firebasestorage.googleapis.com",Iee="storageBucket",P8e=2*60*1e3,L8e=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends ol{constructor(e,t,s=0){super(KA(e),`Firebase Storage: ${t} (${KA(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,es.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return KA(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Yn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Yn||(Yn={}));function KA(n){return"storage/"+n}function xM(){const n="An unknown error occurred, please check the error payload for server response.";return new es(Yn.UNKNOWN,n)}function M8e(n){return new es(Yn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function F8e(n){return new es(Yn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function V8e(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new es(Yn.UNAUTHENTICATED,n)}function z8e(){return new es(Yn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function B8e(n){return new es(Yn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function U8e(){return new es(Yn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function W8e(){return new es(Yn.CANCELED,"User canceled the upload/download.")}function H8e(n){return new es(Yn.INVALID_URL,"Invalid URL '"+n+"'.")}function j8e(n){return new es(Yn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function G8e(){return new es(Yn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Iee+"' property when initializing the app?")}function q8e(){return new es(Yn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function K8e(){return new es(Yn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function X8e(n){return new es(Yn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function uD(n){return new es(Yn.INVALID_ARGUMENT,n)}function kee(){return new es(Yn.APP_DELETED,"The Firebase app was deleted.")}function Y8e(n){return new es(Yn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function o0(n,e){return new es(Yn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Sb(n){throw new es(Yn.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=Lr.makeFromUrl(e,t)}catch{return new Lr(e,"")}if(s.path==="")return s;throw j8e(e)}static makeFromUrl(e,t){let s=null;const i="([A-Za-z0-9.\\-_]+)";function r(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(I){I.path_=decodeURIComponent(I.path)}const h="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${f}/${h}/b/${i}/o${p}`,"i"),y={bucket:1,path:3},x=t===Cee?"(?:storage.googleapis.com|storage.cloud.google.com)":t,v="([^?#]*)",w=new RegExp(`^https?://${x}/${i}/${v}`,"i"),C=[{regex:a,indices:l,postModify:r},{regex:g,indices:y,postModify:c},{regex:w,indices:{bucket:1,path:2},postModify:c}];for(let I=0;I<C.length;I++){const A=C[I],L=A.regex.exec(e);if(L){const O=L[A.indices.bucket];let N=L[A.indices.path];N||(N=""),s=new Lr(O,N),A.postModify(s);break}}if(s==null)throw H8e(e);return s}}class Q8e{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z8e(n,e,t){let s=1,i=null,r=null,o=!1,a=0;function l(){return a===2}let c=!1;function h(...v){c||(c=!0,e.apply(null,v))}function f(v){i=setTimeout(()=>{i=null,n(g,l())},v)}function p(){r&&clearTimeout(r)}function g(v,...w){if(c){p();return}if(v){p(),h.call(null,v,...w);return}if(l()||o){p(),h.call(null,v,...w);return}s<64&&(s*=2);let C;a===1?(a=2,C=0):C=(s+Math.random())*1e3,f(C)}let y=!1;function x(v){y||(y=!0,p(),!c&&(i!==null?(v||(a=2),clearTimeout(i),f(0)):v||(a=1)))}return f(0),r=setTimeout(()=>{o=!0,x(!0)},t),x}function J8e(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e7e(n){return n!==void 0}function t7e(n){return typeof n=="object"&&!Array.isArray(n)}function wM(n){return typeof n=="string"||n instanceof String}function Nj(n){return _M()&&n instanceof Blob}function _M(){return typeof Blob<"u"}function Aj(n,e,t,s){if(s<e)throw uD(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw uD(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TM(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function Nee(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const i=e(s)+"="+e(n[s]);t=t+i+"&"}return t=t.slice(0,-1),t}var $d;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})($d||($d={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n7e(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,r=e.indexOf(n)!==-1;return t||i||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s7e{constructor(e,t,s,i,r,o,a,l,c,h,f,p=!0){this.url_=e,this.method_=t,this.headers_=s,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,y)=>{this.resolve_=g,this.reject_=y,this.start_()})}start_(){const e=(s,i)=>{if(i){s(!1,new g1(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===$d.NO_ERROR,l=r.getStatus();if(!a||n7e(l,this.additionalRetryCodes_)&&this.retry){const h=r.getErrorCode()===$d.ABORT;s(!1,new g1(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;s(!0,new g1(c,r))})},t=(s,i)=>{const r=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());e7e(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=xM();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?kee():W8e();o(l)}else{const l=U8e();o(l)}};this.canceled_?t(!1,new g1(!1,null,!0)):this.backoffId_=Z8e(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&J8e(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class g1{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function i7e(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function r7e(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function o7e(n,e){e&&(n["X-Firebase-GMPID"]=e)}function a7e(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function l7e(n,e,t,s,i,r,o=!0){const a=Nee(n.urlParams),l=n.url+a,c=Object.assign({},n.headers);return o7e(c,e),i7e(c,t),r7e(c,r),a7e(c,s),new s7e(l,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c7e(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function u7e(...n){const e=c7e();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(_M())return new Blob(n);throw new es(Yn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function h7e(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d7e(n){if(typeof atob>"u")throw X8e("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class XA{constructor(e,t){this.data=e,this.contentType=t||null}}function f7e(n,e){switch(n){case Ma.RAW:return new XA(Aee(e));case Ma.BASE64:case Ma.BASE64URL:return new XA(Ree(n,e));case Ma.DATA_URL:return new XA(m7e(e),g7e(e))}throw xM()}function Aee(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const r=s,o=n.charCodeAt(++t);s=65536|(r&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function p7e(n){let e;try{e=decodeURIComponent(n)}catch{throw o0(Ma.DATA_URL,"Malformed data URL.")}return Aee(e)}function Ree(n,e){switch(n){case Ma.BASE64:{const i=e.indexOf("-")!==-1,r=e.indexOf("_")!==-1;if(i||r)throw o0(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Ma.BASE64URL:{const i=e.indexOf("+")!==-1,r=e.indexOf("/")!==-1;if(i||r)throw o0(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=d7e(e)}catch(i){throw i.message.includes("polyfill")?i:o0(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s}class Dee{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw o0(Ma.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=y7e(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function m7e(n){const e=new Dee(n);return e.base64?Ree(Ma.BASE64,e.rest):p7e(e.rest)}function g7e(n){return new Dee(n).contentType}function y7e(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,t){let s=0,i="";Nj(e)?(this.data_=e,s=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(Nj(this.data_)){const s=this.data_,i=h7e(s,e,t);return i===null?null:new mu(i)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new mu(s,!0)}}static getBlob(...e){if(_M()){const t=e.map(s=>s instanceof mu?s.data_:s);return new mu(u7e.apply(null,t))}else{const t=e.map(o=>wM(o)?f7e(Ma.RAW,o).data:o.data_);let s=0;t.forEach(o=>{s+=o.byteLength});const i=new Uint8Array(s);let r=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[r++]=o[a]}),new mu(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $ee(n){let e;try{e=JSON.parse(n)}catch{return null}return t7e(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b7e(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function v7e(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function Oee(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x7e(n,e){return e}class qi{constructor(e,t,s,i){this.server=e,this.local=t||e,this.writable=!!s,this.xform=i||x7e}}let y1=null;function w7e(n){return!wM(n)||n.length<2?n:Oee(n)}function Pee(){if(y1)return y1;const n=[];n.push(new qi("bucket")),n.push(new qi("generation")),n.push(new qi("metageneration")),n.push(new qi("name","fullPath",!0));function e(r,o){return w7e(o)}const t=new qi("name");t.xform=e,n.push(t);function s(r,o){return o!==void 0?Number(o):o}const i=new qi("size");return i.xform=s,n.push(i),n.push(new qi("timeCreated")),n.push(new qi("updated")),n.push(new qi("md5Hash",null,!0)),n.push(new qi("cacheControl",null,!0)),n.push(new qi("contentDisposition",null,!0)),n.push(new qi("contentEncoding",null,!0)),n.push(new qi("contentLanguage",null,!0)),n.push(new qi("contentType",null,!0)),n.push(new qi("metadata","customMetadata",!0)),y1=n,y1}function _7e(n,e){function t(){const s=n.bucket,i=n.fullPath,r=new Lr(s,i);return e._makeStorageReference(r)}Object.defineProperty(n,"ref",{get:t})}function T7e(n,e,t){const s={};s.type="file";const i=t.length;for(let r=0;r<i;r++){const o=t[r];s[o.local]=o.xform(s,e[o.server])}return _7e(s,n),s}function Lee(n,e,t){const s=$ee(e);return s===null?null:T7e(n,s,t)}function S7e(n,e,t,s){const i=$ee(e);if(i===null||!wM(i.downloadTokens))return null;const r=i.downloadTokens;if(r.length===0)return null;const o=encodeURIComponent;return r.split(",").map(c=>{const h=n.bucket,f=n.fullPath,p="/b/"+o(h)+"/o/"+o(f),g=TM(p,t,s),y=Nee({alt:"media",token:c});return g+y})[0]}function E7e(n,e){const t={},s=e.length;for(let i=0;i<s;i++){const r=e[i];r.writable&&(t[r.server]=n[r.local])}return JSON.stringify(t)}class Mee{constructor(e,t,s,i){this.url=e,this.method=t,this.handler=s,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fee(n){if(!n)throw xM()}function C7e(n,e){function t(s,i){const r=Lee(n,i,e);return Fee(r!==null),r}return t}function I7e(n,e){function t(s,i){const r=Lee(n,i,e);return Fee(r!==null),S7e(r,i,n.host,n._protocol)}return t}function Vee(n){function e(t,s){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=z8e():i=V8e():t.getStatus()===402?i=F8e(n.bucket):t.getStatus()===403?i=B8e(n.path):i=s,i.status=t.getStatus(),i.serverResponse=s.serverResponse,i}return e}function k7e(n){const e=Vee(n);function t(s,i){let r=e(s,i);return s.getStatus()===404&&(r=M8e(n.path)),r.serverResponse=i.serverResponse,r}return t}function N7e(n,e,t){const s=e.fullServerUrl(),i=TM(s,n.host,n._protocol),r="GET",o=n.maxOperationRetryTime,a=new Mee(i,r,I7e(n,t),o);return a.errorHandler=k7e(e),a}function A7e(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function R7e(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=A7e(null,e)),s}function D7e(n,e,t,s,i){const r=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let C="";for(let I=0;I<2;I++)C=C+Math.random().toString().slice(2);return C}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=R7e(e,s,i),h=E7e(c,t),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,p=`\r
--`+l+"--",g=mu.getBlob(f,s,p);if(g===null)throw q8e();const y={name:c.fullPath},x=TM(r,n.host,n._protocol),v="POST",w=n.maxUploadRetryTime,S=new Mee(x,v,C7e(n,t),w);return S.urlParams=y,S.headers=o,S.body=g.uploadData(),S.errorHandler=Vee(e),S}class $7e{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=$d.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=$d.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=$d.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,i){if(this.sent_)throw Sb("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const r in i)i.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,i[r].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sb("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sb("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sb("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sb("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class O7e extends $7e{initXhr(){this.xhr_.responseType="text"}}function zee(){return new O7e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,t){this._service=e,t instanceof Lr?this._location=t:this._location=Lr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new rf(e,t)}get root(){const e=new Lr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Oee(this._location.path)}get storage(){return this._service}get parent(){const e=b7e(this._location.path);if(e===null)return null;const t=new Lr(this._location.bucket,e);return new rf(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Y8e(e)}}function P7e(n,e,t){n._throwIfRoot("uploadBytes");const s=D7e(n.storage,n._location,Pee(),new mu(e,!0),t);return n.storage.makeRequestWithTokens(s,zee).then(i=>({metadata:i,ref:n}))}function L7e(n){n._throwIfRoot("getDownloadURL");const e=N7e(n.storage,n._location,Pee());return n.storage.makeRequestWithTokens(e,zee).then(t=>{if(t===null)throw K8e();return t})}function M7e(n,e){const t=v7e(n._location.path,e),s=new Lr(n._location.bucket,t);return new rf(n.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F7e(n){return/^[A-Za-z]+:\/\//.test(n)}function V7e(n,e){return new rf(n,e)}function Bee(n,e){if(n instanceof SM){const t=n;if(t._bucket==null)throw G8e();const s=new rf(t,t._bucket);return e!=null?Bee(s,e):s}else return e!==void 0?M7e(n,e):n}function z7e(n,e){if(e&&F7e(e)){if(n instanceof SM)return V7e(n,e);throw uD("To use ref(service, url), the first argument must be a Storage instance.")}else return Bee(n,e)}function Rj(n,e){const t=e==null?void 0:e[Iee];return t==null?null:Lr.makeFromBucketSpec(t,n)}function B7e(n,e,t,s={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=s;i&&(n._overrideAuthToken=typeof i=="string"?i:hP(i,n.app.options.projectId))}class SM{constructor(e,t,s,i,r){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=Cee,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=P8e,this._maxUploadRetryTime=L8e,this._requests=new Set,i!=null?this._bucket=Lr.makeFromBucketSpec(i,this._host):this._bucket=Rj(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Lr.makeFromBucketSpec(this._url,e):this._bucket=Rj(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Aj("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Aj("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Xi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new rf(this,e)}_makeRequest(e,t,s,i,r=!0){if(this._deleted)return new Q8e(kee());{const o=l7e(e,this._appId,s,i,t,this._firebaseVersion,r);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[s,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,i).getPromise()}}const Dj="@firebase/storage",$j="0.13.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uee="storage";function U7e(n,e,t){return n=Bn(n),P7e(n,e,t)}function W7e(n){return n=Bn(n),L7e(n)}function H7e(n,e){return n=Bn(n),z7e(n,e)}function j7e(n=eI(),e){n=Bn(n);const s=jx(n,Uee).getImmediate({identifier:e}),i=cP("storage");return i&&G7e(s,...i),s}function G7e(n,e,t,s={}){B7e(n,e,t,s)}function q7e(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new SM(t,s,i,e,ph)}function K7e(){qu(new oc(Uee,q7e,"PUBLIC").setMultipleInstances(!0)),To(Dj,$j,""),To(Dj,$j,"esm2017")}K7e();const X7e=()=>{const n=cZ(),e=n.currentUser,t=j7e(),[s,i]=oe.useState((e==null?void 0:e.photoURL)||""),[r,o]=oe.useState(!1),a=Im();oe.useEffect(()=>{e!=null&&e.photoURL&&i(e.photoURL)},[e]);const l=async h=>{const f=h.target.files[0];if(!f)return;o(!0);const p=H7e(t,`profile_pictures/${e.uid}`);await U7e(p,f);const g=await W7e(p);await X4e(e,{photoURL:g}),i(g),o(!1)},c=async()=>{await J4e(n),a("/")};return be.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100",children:[be.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 w-96 text-center",children:[be.jsx("h2",{className:"text-xl font-bold",children:"Profile"}),be.jsxs("div",{className:"relative w-24 h-24 mx-auto mt-4",children:[be.jsx("img",{src:s||"https://via.placeholder.com/100",alt:"Profile",className:"w-full h-full rounded-full border-2 border-gray-300 object-cover"}),be.jsx("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:l,accept:"image/*"})]}),be.jsx("h3",{className:"text-lg font-semibold mt-4",children:(e==null?void 0:e.displayName)||"User"}),be.jsx("p",{className:"text-gray-600",children:e==null?void 0:e.email}),r&&be.jsx("p",{className:"text-blue-500 text-sm",children:"Uploading..."}),be.jsx("button",{className:"mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",onClick:c,children:"Logout"})]}),be.jsx(NS,{})]})};function Y7e(){return be.jsx(zse,{children:be.jsxs(gse,{children:[be.jsx(cu,{path:"/",element:be.jsx(o5e,{})}),be.jsx(cu,{path:"/home",element:be.jsx(oie,{})}),be.jsx(cu,{path:"/track",element:be.jsx(gWe,{})}),be.jsx(cu,{path:"/progress",element:be.jsx(i5e,{})}),be.jsx(cu,{path:"/signup",element:be.jsx($8e,{})}),be.jsx(cu,{path:"/login",element:be.jsx(O8e,{})}),be.jsx(cu,{path:"/profile",element:be.jsx(X7e,{})})]})})}Cne.createRoot(document.getElementById("root")).render(be.jsx(oe.StrictMode,{children:be.jsx(Y7e,{})}));
